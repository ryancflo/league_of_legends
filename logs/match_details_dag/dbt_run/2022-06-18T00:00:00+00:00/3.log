[2022-06-20 06:57:46,780] {taskinstance.py:1037} INFO - Dependencies all met for <TaskInstance: match_details_dag.dbt_run scheduled__2022-06-18T00:00:00+00:00 [None]>
[2022-06-20 06:57:46,790] {taskinstance.py:1037} INFO - Dependencies all met for <TaskInstance: match_details_dag.dbt_run scheduled__2022-06-18T00:00:00+00:00 [None]>
[2022-06-20 06:57:46,791] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 06:57:46,791] {taskinstance.py:1244} INFO - Starting attempt 3 of 4
[2022-06-20 06:57:46,791] {taskinstance.py:1245} INFO - 
--------------------------------------------------------------------------------
[2022-06-20 06:57:46,802] {taskinstance.py:1264} INFO - Executing <Task(BashOperator): dbt_run> on 2022-06-18 00:00:00+00:00
[2022-06-20 06:57:46,807] {standard_task_runner.py:52} INFO - Started process 362 to run task
[2022-06-20 06:57:46,810] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'match_details_dag', 'dbt_run', 'scheduled__2022-06-18T00:00:00+00:00', '--job-id', '196', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/matchData_dag.py', '--cfg-path', '/tmp/tmph44gr1cq', '--error-file', '/tmp/tmp584gph_6']
[2022-06-20 06:57:46,810] {standard_task_runner.py:77} INFO - Job 196: Subtask dbt_run
[2022-06-20 06:57:46,854] {logging_mixin.py:109} INFO - Running <TaskInstance: match_details_dag.dbt_run scheduled__2022-06-18T00:00:00+00:00 [running]> on host ebe3cc7dbee2
[2022-06-20 06:57:46,902] {taskinstance.py:1429} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=admin
AIRFLOW_CTX_DAG_ID=match_details_dag
AIRFLOW_CTX_TASK_ID=dbt_run
AIRFLOW_CTX_EXECUTION_DATE=2022-06-18T00:00:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-06-18T00:00:00+00:00
[2022-06-20 06:57:46,903] {subprocess.py:62} INFO - Tmp dir root location: 
 /tmp
[2022-06-20 06:57:46,904] {subprocess.py:74} INFO - Running command: ['bash', '-c', 'cd /opt/***/dbt && dbt deps && dbt run']
[2022-06-20 06:57:46,915] {subprocess.py:85} INFO - Output:
[2022-06-20 06:57:49,723] {subprocess.py:89} INFO - 06:57:49  Running with dbt=1.1.0
[2022-06-20 06:57:50,480] {subprocess.py:89} INFO - 06:57:50  Installing dbt-labs/dbt_utils
[2022-06-20 06:57:51,048] {subprocess.py:89} INFO - 06:57:51    Installed from version 0.8.5
[2022-06-20 06:57:51,049] {subprocess.py:89} INFO - 06:57:51    Updated version available: 0.8.6
[2022-06-20 06:57:51,049] {subprocess.py:89} INFO - 06:57:51
[2022-06-20 06:57:51,050] {subprocess.py:89} INFO - 06:57:51  Updates available for packages: ['dbt-labs/dbt_utils']
[2022-06-20 06:57:51,050] {subprocess.py:89} INFO - Update your versions in packages.yml, then run dbt deps
[2022-06-20 06:57:55,470] {subprocess.py:89} INFO - 06:57:55  Running with dbt=1.1.0
[2022-06-20 06:57:55,646] {subprocess.py:89} INFO - 06:57:55  Found 17 models, 32 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 24 sources, 0 exposures, 0 metrics
[2022-06-20 06:57:55,650] {subprocess.py:89} INFO - 06:57:55
[2022-06-20 06:57:57,074] {subprocess.py:89} INFO - 06:57:57  Concurrency: 10 threads (target='dev')
[2022-06-20 06:57:57,074] {subprocess.py:89} INFO - 06:57:57
[2022-06-20 06:57:57,095] {subprocess.py:89} INFO - 06:57:57  1 of 16 START table model PUBLIC.final_champions ............................... [RUN]
[2022-06-20 06:57:57,101] {subprocess.py:89} INFO - 06:57:57  2 of 16 START table model PUBLIC.final_items ................................... [RUN]
[2022-06-20 06:57:57,106] {subprocess.py:89} INFO - 06:57:57  3 of 16 START table model PUBLIC.final_maps .................................... [RUN]
[2022-06-20 06:57:57,109] {subprocess.py:89} INFO - 06:57:57  4 of 16 START incremental model PUBLIC.final_match_details ..................... [RUN]
[2022-06-20 06:57:57,110] {subprocess.py:89} INFO - 06:57:57  5 of 16 START incremental model PUBLIC.final_match_info ........................ [RUN]
[2022-06-20 06:57:57,115] {subprocess.py:89} INFO - 06:57:57  6 of 16 START incremental model PUBLIC.final_players ........................... [RUN]
[2022-06-20 06:57:57,117] {subprocess.py:89} INFO - 06:57:57  7 of 16 START table model PUBLIC.final_runes_reforged .......................... [RUN]
[2022-06-20 06:57:57,118] {subprocess.py:89} INFO - 06:57:57  8 of 16 START table model PUBLIC.final_summonerspells .......................... [RUN]
[2022-06-20 06:57:57,119] {subprocess.py:89} INFO - 06:57:57  9 of 16 START view model PUBLIC.stg_champions .................................. [RUN]
[2022-06-20 06:57:57,120] {subprocess.py:89} INFO - 06:57:57  10 of 16 START view model PUBLIC.stg_items ..................................... [RUN]
[2022-06-20 06:58:00,052] {subprocess.py:89} INFO - 06:58:00  9 of 16 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 2.93s]
[2022-06-20 06:58:00,056] {subprocess.py:89} INFO - 06:58:00  11 of 16 START view model PUBLIC.stg_maps ...................................... [RUN]
[2022-06-20 06:58:00,093] {subprocess.py:89} INFO - 06:58:00  6 of 16 ERROR creating incremental model PUBLIC.final_players .................. [[31mERROR[0m in 2.97s]
[2022-06-20 06:58:00,103] {subprocess.py:89} INFO - 06:58:00  3 of 16 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 2.99s]
[2022-06-20 06:58:00,103] {subprocess.py:89} INFO - 06:58:00  12 of 16 START view model PUBLIC.stg_match_details ............................. [RUN]
[2022-06-20 06:58:00,111] {subprocess.py:89} INFO - 06:58:00  13 of 16 START view model PUBLIC.stg_match_info ................................ [RUN]
[2022-06-20 06:58:00,277] {subprocess.py:89} INFO - 06:58:00  10 of 16 OK created view model PUBLIC.stg_items ................................ [[32mSUCCESS 1[0m in 3.14s]
[2022-06-20 06:58:00,291] {subprocess.py:89} INFO - 06:58:00  14 of 16 START view model PUBLIC.stg_players ................................... [RUN]
[2022-06-20 06:58:00,727] {subprocess.py:89} INFO - 06:58:00  1 of 16 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 3.63s]
[2022-06-20 06:58:00,750] {subprocess.py:89} INFO - 06:58:00  15 of 16 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
[2022-06-20 06:58:01,184] {subprocess.py:89} INFO - 06:58:01  8 of 16 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 4.06s]
[2022-06-20 06:58:01,187] {subprocess.py:89} INFO - 06:58:01  16 of 16 START view model PUBLIC.stg_summonerspells ............................ [RUN]
[2022-06-20 06:58:01,338] {subprocess.py:89} INFO - 06:58:01  13 of 16 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.23s]
[2022-06-20 06:58:01,518] {subprocess.py:89} INFO - 06:58:01  15 of 16 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 0.77s]
[2022-06-20 06:58:02,137] {subprocess.py:89} INFO - 06:58:02  2 of 16 OK created table model PUBLIC.final_items .............................. [[32mSUCCESS 1[0m in 5.03s]
[2022-06-20 06:58:02,161] {subprocess.py:89} INFO - 06:58:02  7 of 16 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.04s]
[2022-06-20 06:58:02,167] {subprocess.py:89} INFO - 06:58:02  5 of 16 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 5.06s]
[2022-06-20 06:58:02,282] {subprocess.py:89} INFO - 06:58:02  12 of 16 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 2.15s]
[2022-06-20 06:58:02,373] {subprocess.py:89} INFO - 06:58:02  11 of 16 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 2.31s]
[2022-06-20 06:58:02,455] {subprocess.py:89} INFO - 06:58:02  4 of 16 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 5.35s]
[2022-06-20 06:58:02,495] {subprocess.py:89} INFO - 06:58:02  14 of 16 OK created view model PUBLIC.stg_players .............................. [[32mSUCCESS 1[0m in 2.17s]
[2022-06-20 06:58:02,816] {subprocess.py:89} INFO - 06:58:02  16 of 16 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.63s]
[2022-06-20 06:58:02,820] {subprocess.py:89} INFO - 06:58:02
[2022-06-20 06:58:02,821] {subprocess.py:89} INFO - 06:58:02  Finished running 8 view models, 3 incremental models, 5 table models in 7.17s.
[2022-06-20 06:58:02,837] {subprocess.py:89} INFO - 06:58:02
[2022-06-20 06:58:02,837] {subprocess.py:89} INFO - 06:58:02  [31mCompleted with 1 error and 0 warnings:[0m
[2022-06-20 06:58:02,838] {subprocess.py:89} INFO - 06:58:02
[2022-06-20 06:58:02,838] {subprocess.py:89} INFO - 06:58:02  [33mDatabase Error in model final_players (models/warehouse/final_players.sql)[0m
[2022-06-20 06:58:02,839] {subprocess.py:89} INFO - 06:58:02    001003 (42000): SQL compilation error:
[2022-06-20 06:58:02,839] {subprocess.py:89} INFO - 06:58:02    syntax error line 29 at position 0 unexpected 'final_players'.
[2022-06-20 06:58:02,839] {subprocess.py:89} INFO - 06:58:02    compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_players.sql
[2022-06-20 06:58:02,840] {subprocess.py:89} INFO - 06:58:02
[2022-06-20 06:58:02,841] {subprocess.py:89} INFO - 06:58:02  Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
[2022-06-20 06:58:03,589] {subprocess.py:93} INFO - Command exited with return code 1
[2022-06-20 06:58:03,599] {taskinstance.py:1718} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1334, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1460, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1516, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 187, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2022-06-20 06:58:03,604] {taskinstance.py:1272} INFO - Marking task as UP_FOR_RETRY. dag_id=match_details_dag, task_id=dbt_run, execution_date=20220618T000000, start_date=20220620T065746, end_date=20220620T065803
[2022-06-20 06:58:03,617] {standard_task_runner.py:89} ERROR - Failed to execute job 196 for task dbt_run
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/task/task_runner/standard_task_runner.py", line 85, in _start_by_fork
    args.func(args, dag=self.dag)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/cli/cli_parser.py", line 48, in command
    return func(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/cli.py", line 92, in wrapper
    return f(*args, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/cli/commands/task_command.py", line 298, in task_run
    _run_task_by_selected_method(args, dag, ti)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/cli/commands/task_command.py", line 107, in _run_task_by_selected_method
    _run_raw_task(args, ti)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/cli/commands/task_command.py", line 180, in _run_raw_task
    ti._run_raw_task(
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/utils/session.py", line 70, in wrapper
    return func(*args, session=session, **kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1334, in _run_raw_task
    self._execute_task_with_callbacks(context)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1460, in _execute_task_with_callbacks
    result = self._execute_task(context, self.task)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 1516, in _execute_task
    result = execute_callable(context=context)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/bash.py", line 187, in execute
    raise AirflowException(
airflow.exceptions.AirflowException: Bash command failed. The command returned a non-zero exit code 1.
[2022-06-20 06:58:03,646] {local_task_job.py:154} INFO - Task exited with return code 1
[2022-06-20 06:58:03,675] {local_task_job.py:264} INFO - 0 downstream tasks scheduled from follow-on schedule check
