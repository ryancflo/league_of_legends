2022-06-07 20:44:42.114754 (MainThread): Running with dbt=0.21.1
2022-06-07 20:44:42.812264 (MainThread): You have an incompatible version of 'pyarrow' installed (6.0.1), please install a version that adheres to: 'pyarrow<3.1.0,>=3.0.0; extra == "pandas"'
2022-06-07 20:44:43.128395 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-06-07 20:44:43.129100 (MainThread): Tracking: tracking
2022-06-07 20:44:43.129439 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f104c4d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed8436040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed8436df0>]}
2022-06-07 20:44:43.137531 (MainThread): Set downloads directory='/tmp/dbt-downloads-6_5e2u8x'
2022-06-07 20:44:43.138120 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-06-07 20:44:43.514914 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-06-07 20:44:43.515706 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-06-07 20:44:43.830603 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-06-07 20:44:43.880505 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2022-06-07 20:44:44.234395 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2022-06-07 20:44:44.235228 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-06-07 20:44:44.552418 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-06-07 20:44:44.574164 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2022-06-07 20:44:44.939278 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2022-06-07 20:44:44.940668 (MainThread): Installing dbt-labs/dbt_utils@0.8.0
2022-06-07 20:44:45.399202 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f104c4d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed83663d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ed84365b0>]}
2022-06-07 20:44:45.399601 (MainThread): Flushing usage events
2022-06-07 20:44:45.728132 (MainThread): Encountered an error:
2022-06-07 20:44:45.728796 (MainThread): [Errno 13] Permission denied: '/opt/airflow/dbt/packages/dbt-utils-0.8.0'
2022-06-07 20:44:45.730753 (MainThread): Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/deps.py", line 66, in run
    package.install(self.config, renderer)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/deps/registry.py", line 74, in install
    system.untar_package(tar_path, deps_path, package_name)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/system.py", line 490, in untar_package
    tarball.extractall(dest_dir)
  File "/usr/local/lib/python3.8/tarfile.py", line 2028, in extractall
    self.extract(tarinfo, path, set_attrs=not tarinfo.isdir(),
  File "/usr/local/lib/python3.8/tarfile.py", line 2069, in extract
    self._extract_member(tarinfo, os.path.join(path, tarinfo.name),
  File "/usr/local/lib/python3.8/tarfile.py", line 2143, in _extract_member
    self.makedir(tarinfo, targetpath)
  File "/usr/local/lib/python3.8/tarfile.py", line 2172, in makedir
    os.mkdir(targetpath, 0o700)
PermissionError: [Errno 13] Permission denied: '/opt/airflow/dbt/packages/dbt-utils-0.8.0'

2022-06-07 20:45:31.223467 (MainThread): Running with dbt=0.21.1
2022-06-07 20:45:31.906903 (MainThread): You have an incompatible version of 'pyarrow' installed (6.0.1), please install a version that adheres to: 'pyarrow<3.1.0,>=3.0.0; extra == "pandas"'
2022-06-07 20:45:32.259956 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-06-07 20:45:32.260625 (MainThread): Tracking: tracking
2022-06-07 20:45:32.261018 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f432d574ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42f54c1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42f54c19d0>]}
2022-06-07 20:45:32.261781 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f432d574ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42f54c1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42f54c19d0>]}
2022-06-07 20:45:32.262441 (MainThread): Flushing usage events
2022-06-07 20:45:32.663688 (MainThread): Encountered an error:
2022-06-07 20:45:32.664508 (MainThread): [Errno 13] Permission denied: '/opt/airflow/dbt/dbt_packages'
2022-06-07 20:45:32.666500 (MainThread): Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/deps.py", line 46, in run
    system.make_directory(self.config.modules_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/system.py", line 109, in make_directory
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/system.py", line 103, in make_directory
    os.makedirs(path)
  File "/usr/local/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: '/opt/airflow/dbt/dbt_packages'

2022-06-07 20:46:53.476629 (MainThread): Running with dbt=0.21.1
2022-06-07 20:46:54.136002 (MainThread): You have an incompatible version of 'pyarrow' installed (6.0.1), please install a version that adheres to: 'pyarrow<3.1.0,>=3.0.0; extra == "pandas"'
2022-06-07 20:46:54.499153 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-06-07 20:46:54.499743 (MainThread): Tracking: tracking
2022-06-07 20:46:54.500079 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effedd9fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb5d4d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb5d4dca0>]}
2022-06-07 20:46:54.500534 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effedd9fd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb5d4d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7effb5d4dca0>]}
2022-06-07 20:46:54.500863 (MainThread): Flushing usage events
2022-06-07 20:46:54.927049 (MainThread): Encountered an error:
2022-06-07 20:46:54.927700 (MainThread): [Errno 13] Permission denied: '/opt/airflow/dbt/dbt_packages'
2022-06-07 20:46:54.929316 (MainThread): Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/deps.py", line 46, in run
    system.make_directory(self.config.modules_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/system.py", line 109, in make_directory
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/system.py", line 103, in make_directory
    os.makedirs(path)
  File "/usr/local/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: '/opt/airflow/dbt/dbt_packages'

2022-06-07 20:50:56.795610 (MainThread): Running with dbt=0.21.1
2022-06-07 20:50:57.466515 (MainThread): You have an incompatible version of 'pyarrow' installed (6.0.1), please install a version that adheres to: 'pyarrow<3.1.0,>=3.0.0; extra == "pandas"'
2022-06-07 20:50:57.796535 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-06-07 20:50:57.797101 (MainThread): Tracking: tracking
2022-06-07 20:50:57.797396 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeba474dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe82302c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe82302d30>]}
2022-06-07 20:50:57.797848 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbeba474dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe82302c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe82302d30>]}
2022-06-07 20:50:57.798168 (MainThread): Flushing usage events
2022-06-07 20:50:58.206344 (MainThread): Encountered an error:
2022-06-07 20:50:58.207043 (MainThread): [Errno 13] Permission denied: '/opt/airflow/dbt/dbt_packages'
2022-06-07 20:50:58.208686 (MainThread): Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/deps.py", line 46, in run
    system.make_directory(self.config.modules_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/system.py", line 109, in make_directory
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/system.py", line 103, in make_directory
    os.makedirs(path)
  File "/usr/local/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: '/opt/airflow/dbt/dbt_packages'

2022-06-07 20:55:51.807354 (MainThread): Running with dbt=0.21.1
2022-06-07 20:55:52.482042 (MainThread): You have an incompatible version of 'pyarrow' installed (6.0.1), please install a version that adheres to: 'pyarrow<3.1.0,>=3.0.0; extra == "pandas"'
2022-06-07 20:55:52.789433 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-06-07 20:55:52.790060 (MainThread): Tracking: tracking
2022-06-07 20:55:52.790413 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbfe22c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f87d7aac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f87d7ac10>]}
2022-06-07 20:55:52.790937 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fbfe22c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f87d7aac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f87d7ac10>]}
2022-06-07 20:55:52.791279 (MainThread): Flushing usage events
2022-06-07 20:55:53.177738 (MainThread): Encountered an error:
2022-06-07 20:55:53.178608 (MainThread): [Errno 13] Permission denied: '/opt/airflow/dbt/dbt_packages'
2022-06-07 20:55:53.180342 (MainThread): Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/deps.py", line 46, in run
    system.make_directory(self.config.modules_path)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/system.py", line 109, in make_directory
    raise e
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/clients/system.py", line 103, in make_directory
    os.makedirs(path)
  File "/usr/local/lib/python3.8/os.py", line 223, in makedirs
    mkdir(name, mode)
PermissionError: [Errno 13] Permission denied: '/opt/airflow/dbt/dbt_packages'

2022-06-07 21:01:18.318871 (MainThread): Running with dbt=0.21.1
2022-06-07 21:01:19.010103 (MainThread): You have an incompatible version of 'pyarrow' installed (6.0.1), please install a version that adheres to: 'pyarrow<3.1.0,>=3.0.0; extra == "pandas"'
2022-06-07 21:01:19.319347 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-06-07 21:01:19.320017 (MainThread): Tracking: tracking
2022-06-07 21:01:19.320350 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13929f9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135a99cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135a99c940>]}
2022-06-07 21:01:19.321191 (MainThread): Set downloads directory='/tmp/dbt-downloads-vfphv9qe'
2022-06-07 21:01:19.321643 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-06-07 21:01:19.507623 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-06-07 21:01:19.508377 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-06-07 21:01:19.626164 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-06-07 21:01:19.649788 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2022-06-07 21:01:19.813462 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2022-06-07 21:01:19.814377 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-06-07 21:01:19.936995 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-06-07 21:01:19.959520 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2022-06-07 21:01:20.122432 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2022-06-07 21:01:20.122960 (MainThread): Installing dbt-labs/dbt_utils@0.8.0
2022-06-07 21:01:20.593514 (MainThread):   Installed from version 0.8.0
2022-06-07 21:01:20.593832 (MainThread):   Updated version available: 0.8.5
2022-06-07 21:01:20.594330 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '89f924c2-1836-400b-8a29-ed07d379a99b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135a8cf550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135a8cf490>]}
2022-06-07 21:01:20.595025 (MainThread): 
Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2022-06-07 21:01:20.596034 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135a8cb0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13929f9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f135a8cf070>]}
2022-06-07 21:01:20.596523 (MainThread): Flushing usage events
2022-06-07 21:10:54.172815 (MainThread): Running with dbt=0.21.1
2022-06-07 21:10:54.949045 (MainThread): You have an incompatible version of 'pyarrow' installed (6.0.1), please install a version that adheres to: 'pyarrow<3.1.0,>=3.0.0; extra == "pandas"'
2022-06-07 21:10:55.389991 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-06-07 21:10:55.390527 (MainThread): Tracking: tracking
2022-06-07 21:10:55.390853 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b59ccf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85edb81be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b5b05400>]}
2022-06-07 21:10:55.391786 (MainThread): Set downloads directory='/tmp/dbt-downloads-odvt4eta'
2022-06-07 21:10:55.392169 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-06-07 21:10:55.572068 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-06-07 21:10:55.573237 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-06-07 21:10:55.694130 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-06-07 21:10:55.727766 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.5.json
2022-06-07 21:10:55.895924 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.5.json 200
2022-06-07 21:10:55.896548 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-06-07 21:10:56.014454 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-06-07 21:10:56.035638 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.5.json
2022-06-07 21:10:56.206600 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.5.json 200
2022-06-07 21:10:56.207271 (MainThread): Installing dbt-labs/dbt_utils@0.8.5
2022-06-07 21:10:56.787508 (MainThread):   Installed from version 0.8.5
2022-06-07 21:10:56.787997 (MainThread):   Up to date!
2022-06-07 21:10:56.788755 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '69570e1a-c403-4ea4-8a14-b14ebf04d5e4', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b5aa9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b5af5a30>]}
2022-06-07 21:10:56.789678 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85edb81be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b5af5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85b5af5c10>]}
2022-06-07 21:10:56.790433 (MainThread): Flushing usage events
2022-06-07 21:11:00.555296 (MainThread): Got an exception trying to initialize tracking
2022-06-07 21:11:00.555698 (MainThread): Running with dbt=0.21.1
2022-06-07 21:11:01.410623 (MainThread): You have an incompatible version of 'pyarrow' installed (6.0.1), please install a version that adheres to: 'pyarrow<3.1.0,>=3.0.0; extra == "pandas"'
2022-06-07 21:11:01.735963 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/opt/airflow/dbt', project_dir='/opt/airflow/dbt', record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-07 21:11:01.737263 (MainThread): Tracking: do not track
2022-06-07 21:11:01.753079 (MainThread): Flushing usage events
2022-06-07 21:11:01.753484 (MainThread): Encountered an error:
2022-06-07 21:11:01.753749 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.1
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /opt/airflow/dbt_packages/dbt_utils/dbt_project.yml

Error encountered in /opt/airflow/dbt_packages/dbt_utils
2022-06-07 21:11:01.758008 (MainThread): Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.1
    Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /opt/airflow/dbt_packages/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.1
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /opt/airflow/dbt_packages/dbt_utils/dbt_project.yml

Error encountered in /opt/airflow/dbt_packages/dbt_utils

2022-06-07 21:16:46.226757 (MainThread): Running with dbt=0.21.1
2022-06-07 21:16:46.920073 (MainThread): You have an incompatible version of 'pyarrow' installed (6.0.1), please install a version that adheres to: 'pyarrow<3.1.0,>=3.0.0; extra == "pandas"'
2022-06-07 21:16:47.280494 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.deps.DepsTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/home/airflow/.dbt', project_dir=None, record_timing_info=None, rpc_method='deps', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', warn_error=False, which='deps', write_json=True)
2022-06-07 21:16:47.281025 (MainThread): Tracking: tracking
2022-06-07 21:16:47.281406 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45c7b43f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458fa3c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458fa3cfa0>]}
2022-06-07 21:16:47.282263 (MainThread): Set downloads directory='/tmp/dbt-downloads-zxgudlwf'
2022-06-07 21:16:47.282709 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-06-07 21:16:47.647254 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/index.json 200
2022-06-07 21:16:47.647994 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-06-07 21:16:47.964055 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-06-07 21:16:47.988368 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2022-06-07 21:16:48.344299 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2022-06-07 21:16:48.345302 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-06-07 21:16:48.658478 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-06-07 21:16:48.683152 (MainThread): Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json
2022-06-07 21:16:49.045521 (MainThread): Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils/0.8.0.json 200
2022-06-07 21:16:49.046493 (MainThread): Installing dbt-labs/dbt_utils@0.8.0
2022-06-07 21:16:49.564986 (MainThread):   Installed from version 0.8.0
2022-06-07 21:16:49.565305 (MainThread):   Updated version available: 0.8.5
2022-06-07 21:16:49.565657 (MainThread): Sending event: {'category': 'dbt', 'action': 'package', 'label': '9e5ac811-961b-43ff-98ce-37bdf3ad4704', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458fa3c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458fa3c100>]}
2022-06-07 21:16:49.566046 (MainThread): 
Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2022-06-07 21:16:49.566768 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458f9c18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458fa3c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f458fa3cf10>]}
2022-06-07 21:16:49.567281 (MainThread): Flushing usage events
2022-06-07 21:16:53.053592 (MainThread): Got an exception trying to initialize tracking
2022-06-07 21:16:53.053824 (MainThread): Running with dbt=0.21.1
2022-06-07 21:16:53.773854 (MainThread): You have an incompatible version of 'pyarrow' installed (6.0.1), please install a version that adheres to: 'pyarrow<3.1.0,>=3.0.0; extra == "pandas"'
2022-06-07 21:16:54.089680 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', partial_parse=None, profile=None, profiles_dir='/opt/airflow/dbt', project_dir='/opt/airflow/dbt', record_timing_info=None, rpc_method='run', select=None, selector_name=None, single_threaded=False, state=None, strict=False, target='dev', test_new_parser=False, threads=None, use_cache=True, use_colors=None, use_experimental_parser=False, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2022-06-07 21:16:54.090691 (MainThread): Tracking: do not track
2022-06-07 21:16:54.106655 (MainThread): Flushing usage events
2022-06-07 21:16:54.107072 (MainThread): Encountered an error:
2022-06-07 21:16:54.107393 (MainThread): Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.1
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /opt/airflow/dbt_packages/dbt_utils/dbt_project.yml

Error encountered in /opt/airflow/dbt_packages/dbt_utils
2022-06-07 21:16:54.108987 (MainThread): Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/runtime.py", line 367, in load_projects
    project = self.new_project(str(path))
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/runtime.py", line 144, in new_project
    project = Project.from_project_root(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/project.py", line 643, in from_project_root
    return partial.render(renderer)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/project.py", line 289, in render
    return self.create_project(rendered)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/project.py", line 301, in create_project
    dbt_version = _get_required_version(
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/project.py", line 226, in _get_required_version
    validate_version(dbt_version, project_dict['name'])
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/project.py", line 203, in validate_version
    raise DbtProjectError(msg)
dbt.exceptions.DbtProjectError: Runtime Error
  This version of dbt is not supported with the 'dbt_utils' package.
    Installed version of dbt: =0.21.1
    Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
  Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
  

Error encountered in /opt/airflow/dbt_packages/dbt_utils/dbt_project.yml

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 179, in get_full_manifest
    projects = config.load_dependencies()
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/runtime.py", line 347, in load_dependencies
    for project_name, project in self.load_projects(project_paths):
  File "/home/airflow/.local/lib/python3.8/site-packages/dbt/config/runtime.py", line 369, in load_projects
    raise DbtProjectError(
dbt.exceptions.DbtProjectError: Runtime Error
  Failed to read package: Runtime Error
    This version of dbt is not supported with the 'dbt_utils' package.
      Installed version of dbt: =0.21.1
      Required version of dbt for 'dbt_utils': ['>=1.0.0', '<2.0.0']
    Check the requirements for the 'dbt_utils' package, or run dbt again with --no-version-check
    
  
  Error encountered in /opt/airflow/dbt_packages/dbt_utils/dbt_project.yml

Error encountered in /opt/airflow/dbt_packages/dbt_utils



============================== 2022-06-07 21:42:23.170440 | e3ca3888-0c0f-4e75-9a14-0376d4bd3c4a ==============================
21:42:23.170566 [info ] [MainThread]: Running with dbt=1.1.0
21:42:23.171486 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
21:42:23.171704 [debug] [MainThread]: Tracking: tracking
21:42:23.173204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9d35c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9d35c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9d35cc10>]}
21:42:23.175849 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-janl5x3_'
21:42:23.176632 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
21:42:23.562198 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
21:42:23.563164 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
21:42:23.873263 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
21:42:23.946299 [info ] [MainThread]: Installing dbt-labs/dbt_utils
21:42:24.426528 [info ] [MainThread]:   Installed from version 0.8.0
21:42:24.427053 [info ] [MainThread]:   Updated version available: 0.8.5
21:42:24.427578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e3ca3888-0c0f-4e75-9a14-0376d4bd3c4a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9d336d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9d336850>]}
21:42:24.427891 [info ] [MainThread]: 
21:42:24.428335 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
21:42:24.429068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8da265f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9d3365e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d9d3fdca0>]}


============================== 2022-06-07 21:42:29.195848 | f351d168-4270-46c8-8bc1-5f0bcec78a26 ==============================
21:42:29.195871 [info ] [MainThread]: Running with dbt=1.1.0
21:42:29.196382 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:42:29.197068 [debug] [MainThread]: Tracking: do not track
21:42:29.218249 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
21:42:29.251616 [debug] [MainThread]: Parsing macros/match_details.sql
21:42:29.251921 [debug] [MainThread]: Parsing macros/adapters.sql
21:42:29.295579 [debug] [MainThread]: Parsing macros/catalog.sql
21:42:29.297809 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
21:42:29.299137 [debug] [MainThread]: Parsing macros/materializations/merge.sql
21:42:29.304182 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
21:42:29.325876 [debug] [MainThread]: Parsing macros/materializations/table.sql
21:42:29.340135 [debug] [MainThread]: Parsing macros/materializations/view.sql
21:42:29.343850 [debug] [MainThread]: Parsing macros/materializations/seed.sql
21:42:29.360090 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:42:29.384489 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:42:29.404832 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:42:29.417562 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:42:29.423425 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:42:29.428845 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:42:29.438607 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:42:29.452837 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:42:29.458752 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:42:29.461318 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:42:29.463985 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:42:29.474361 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:42:29.479723 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:42:29.480669 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:42:29.482026 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:42:29.483290 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:42:29.484908 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:42:29.487439 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:42:29.491645 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:42:29.493719 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:42:29.495850 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:42:29.501166 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:42:29.517386 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:42:29.523919 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:42:29.525887 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:42:29.536874 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:42:29.556962 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:42:29.570537 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:42:29.586204 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:42:29.615455 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:42:29.627698 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:42:29.641391 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:42:29.649196 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:42:29.652272 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:42:29.654071 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:42:29.661280 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:42:29.666179 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:42:29.669852 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:42:29.677650 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:42:29.681192 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
21:42:29.683574 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
21:42:29.684843 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
21:42:29.694971 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
21:42:29.697256 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
21:42:29.699137 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
21:42:29.702494 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
21:42:29.705645 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
21:42:29.710953 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
21:42:29.712882 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
21:42:29.715023 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
21:42:29.716365 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
21:42:29.723367 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
21:42:29.727341 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
21:42:29.729964 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
21:42:29.731375 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
21:42:29.733493 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
21:42:29.735101 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
21:42:29.736891 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
21:42:29.738443 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
21:42:29.744074 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
21:42:29.745399 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
21:42:29.748780 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
21:42:29.755151 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
21:42:29.758236 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
21:42:29.760302 [debug] [MainThread]: Parsing macros/sql/star.sql
21:42:29.765407 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
21:42:29.767593 [debug] [MainThread]: Parsing macros/sql/pivot.sql
21:42:29.772093 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
21:42:29.774042 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
21:42:29.783176 [debug] [MainThread]: Parsing macros/sql/union.sql
21:42:29.791990 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
21:42:29.794011 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
21:42:29.800497 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
21:42:29.805135 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
21:42:29.809050 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
21:42:29.813058 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
21:42:29.817984 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
21:42:29.824171 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
21:42:29.829970 [debug] [MainThread]: Parsing macros/sql/groupby.sql
21:42:29.831635 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
21:42:29.833388 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
21:42:29.835864 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
21:42:29.839633 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
21:42:29.840950 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
21:42:29.842362 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
21:42:29.844030 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
21:42:29.845507 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
21:42:29.869895 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
21:42:29.872769 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
21:42:29.876347 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
21:42:29.878772 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
21:42:29.880617 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
21:42:29.883451 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
21:42:29.885879 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
21:42:29.887921 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
21:42:29.891048 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
21:42:29.899943 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
21:42:29.904071 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
21:42:29.906769 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
21:42:29.908266 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
21:42:29.909764 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
21:42:29.911409 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
21:42:29.915295 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
21:42:29.917202 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
21:42:30.430853 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
21:42:30.450251 [debug] [MainThread]: 1603: static parser failed on staging_datadragon/stg_items.sql


============================== 2022-06-07 21:43:41.353578 | d017d53a-b762-45ba-97d9-79e9bd2cf67b ==============================
21:43:41.353616 [info ] [MainThread]: Running with dbt=1.1.0
21:43:41.354471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
21:43:41.354736 [debug] [MainThread]: Tracking: tracking
21:43:41.355858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0683dfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0683dfac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0683dfaf0>]}
21:43:41.356619 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rcd14zks'
21:43:41.356961 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
21:43:41.717938 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
21:43:41.718693 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
21:43:42.122356 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
21:43:42.225495 [info ] [MainThread]: Installing dbt-labs/dbt_utils
21:43:42.781292 [info ] [MainThread]:   Installed from version 0.8.0
21:43:42.781708 [info ] [MainThread]:   Updated version available: 0.8.5
21:43:42.782124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd017d53a-b762-45ba-97d9-79e9bd2cf67b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0683dfaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0683f4220>]}
21:43:42.782401 [info ] [MainThread]: 
21:43:42.782765 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
21:43:42.783352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0683f4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa06d7c12e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0683fcfd0>]}


============================== 2022-06-07 21:43:47.541910 | ebeeb7c5-c57b-4a75-858b-4cf99e967126 ==============================
21:43:47.541943 [info ] [MainThread]: Running with dbt=1.1.0
21:43:47.542769 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:43:47.542986 [debug] [MainThread]: Tracking: do not track
21:43:47.565369 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
21:43:47.589815 [debug] [MainThread]: Parsing macros/match_details.sql
21:43:47.590188 [debug] [MainThread]: Parsing macros/adapters.sql
21:43:47.637670 [debug] [MainThread]: Parsing macros/catalog.sql
21:43:47.639837 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
21:43:47.641167 [debug] [MainThread]: Parsing macros/materializations/merge.sql
21:43:47.645805 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
21:43:47.655628 [debug] [MainThread]: Parsing macros/materializations/table.sql
21:43:47.659425 [debug] [MainThread]: Parsing macros/materializations/view.sql
21:43:47.662869 [debug] [MainThread]: Parsing macros/materializations/seed.sql
21:43:47.669162 [debug] [MainThread]: Parsing macros/adapters/columns.sql
21:43:47.682040 [debug] [MainThread]: Parsing macros/adapters/relation.sql
21:43:47.693011 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
21:43:47.698754 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
21:43:47.704875 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
21:43:47.711703 [debug] [MainThread]: Parsing macros/adapters/schema.sql
21:43:47.715769 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
21:43:47.724423 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
21:43:47.727220 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
21:43:47.729096 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
21:43:47.730873 [debug] [MainThread]: Parsing macros/etc/datetime.sql
21:43:47.739745 [debug] [MainThread]: Parsing macros/etc/statement.sql
21:43:47.745455 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
21:43:47.746396 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
21:43:47.747409 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
21:43:47.748428 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
21:43:47.750045 [debug] [MainThread]: Parsing macros/materializations/configs.sql
21:43:47.752964 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
21:43:47.757597 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
21:43:47.759727 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
21:43:47.762360 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
21:43:47.767595 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
21:43:47.785880 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
21:43:47.793510 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
21:43:47.795692 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
21:43:47.807871 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
21:43:47.827908 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
21:43:47.843113 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
21:43:47.858961 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
21:43:47.878214 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
21:43:47.890883 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
21:43:47.892790 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
21:43:47.898613 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
21:43:47.902583 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
21:43:47.904710 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
21:43:47.912749 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
21:43:47.916831 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
21:43:47.920567 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
21:43:47.929435 [debug] [MainThread]: Parsing tests/generic/builtin.sql
21:43:47.935020 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
21:43:47.936961 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
21:43:47.937960 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
21:43:47.948456 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
21:43:47.950623 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
21:43:47.953655 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
21:43:47.956755 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
21:43:47.959475 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
21:43:47.963831 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
21:43:47.965559 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
21:43:47.967627 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
21:43:47.969111 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
21:43:47.975948 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
21:43:47.979835 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
21:43:47.982326 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
21:43:47.983751 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
21:43:47.985839 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
21:43:47.987403 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
21:43:47.989018 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
21:43:47.990906 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
21:43:47.997560 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
21:43:47.998882 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
21:43:48.001177 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
21:43:48.003526 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
21:43:48.006721 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
21:43:48.008754 [debug] [MainThread]: Parsing macros/sql/star.sql
21:43:48.013960 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
21:43:48.016044 [debug] [MainThread]: Parsing macros/sql/pivot.sql
21:43:48.021236 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
21:43:48.023423 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
21:43:48.031904 [debug] [MainThread]: Parsing macros/sql/union.sql
21:43:48.043106 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
21:43:48.045263 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
21:43:48.051705 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
21:43:48.058227 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
21:43:48.062744 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
21:43:48.066880 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
21:43:48.072278 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
21:43:48.079439 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
21:43:48.085056 [debug] [MainThread]: Parsing macros/sql/groupby.sql
21:43:48.086583 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
21:43:48.088341 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
21:43:48.090855 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
21:43:48.094369 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
21:43:48.095556 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
21:43:48.096818 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
21:43:48.098132 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
21:43:48.099452 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
21:43:48.123642 [debug] [MainThread]: Parsing macros/schema_tests/expression_is_true.sql
21:43:48.125883 [debug] [MainThread]: Parsing macros/schema_tests/not_accepted_values.sql
21:43:48.128190 [debug] [MainThread]: Parsing macros/schema_tests/cardinality_equality.sql
21:43:48.130335 [debug] [MainThread]: Parsing macros/schema_tests/test_not_null_where.sql
21:43:48.132084 [debug] [MainThread]: Parsing macros/schema_tests/sequential_values.sql
21:43:48.135937 [debug] [MainThread]: Parsing macros/schema_tests/not_null_proportion.sql
21:43:48.138757 [debug] [MainThread]: Parsing macros/schema_tests/recency.sql
21:43:48.140745 [debug] [MainThread]: Parsing macros/schema_tests/accepted_range.sql
21:43:48.143411 [debug] [MainThread]: Parsing macros/schema_tests/mutually_exclusive_ranges.sql
21:43:48.152152 [debug] [MainThread]: Parsing macros/schema_tests/equality.sql
21:43:48.156094 [debug] [MainThread]: Parsing macros/schema_tests/relationships_where.sql
21:43:48.158476 [debug] [MainThread]: Parsing macros/schema_tests/not_constant.sql
21:43:48.162997 [debug] [MainThread]: Parsing macros/schema_tests/at_least_one.sql
21:43:48.164781 [debug] [MainThread]: Parsing macros/schema_tests/test_unique_where.sql
21:43:48.166621 [debug] [MainThread]: Parsing macros/schema_tests/unique_combination_of_columns.sql
21:43:48.169950 [debug] [MainThread]: Parsing macros/schema_tests/fewer_rows_than.sql
21:43:48.171944 [debug] [MainThread]: Parsing macros/schema_tests/equal_rowcount.sql
21:43:48.623919 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
21:43:48.638059 [debug] [MainThread]: 1603: static parser failed on staging_datadragon/stg_items.sql


============================== 2022-06-10 00:23:33.228532 | 6bc4d5ae-9d9d-4a05-9ddd-87414f45cb21 ==============================
00:23:33.228552 [info ] [MainThread]: Running with dbt=1.1.0
00:23:33.230143 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
00:23:33.230459 [debug] [MainThread]: Tracking: tracking
00:23:33.231765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50ea01730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50ea016d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50ea01220>]}
00:23:33.233246 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-wlcfwkav'
00:23:33.233750 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
00:23:33.640084 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
00:23:33.640982 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
00:23:33.957702 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
00:23:34.010390 [info ] [MainThread]: Installing dbt-labs/dbt_utils
00:23:34.626329 [info ] [MainThread]:   Installed from version 0.8.5
00:23:34.626806 [info ] [MainThread]:   Up to date!
00:23:34.627291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6bc4d5ae-9d9d-4a05-9ddd-87414f45cb21', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50ea01550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50ea01520>]}
00:23:34.627967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50e8775e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50e960100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff50ea01580>]}


============================== 2022-06-10 00:23:38.947879 | 530ae15c-798b-40ee-a7d9-85701b01e989 ==============================
00:23:38.947915 [info ] [MainThread]: Running with dbt=1.1.0
00:23:38.948576 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:23:38.948773 [debug] [MainThread]: Tracking: do not track
00:23:38.969982 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
00:23:39.017235 [debug] [MainThread]: Parsing macros/match_details.sql
00:23:39.017566 [debug] [MainThread]: Parsing macros/adapters.sql
00:23:39.057671 [debug] [MainThread]: Parsing macros/catalog.sql
00:23:39.059761 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
00:23:39.061163 [debug] [MainThread]: Parsing macros/materializations/merge.sql
00:23:39.065891 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
00:23:39.078568 [debug] [MainThread]: Parsing macros/materializations/table.sql
00:23:39.082295 [debug] [MainThread]: Parsing macros/materializations/view.sql
00:23:39.084176 [debug] [MainThread]: Parsing macros/materializations/seed.sql
00:23:39.090397 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:23:39.101923 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:23:39.113573 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:23:39.118811 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:23:39.121983 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:23:39.126119 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:23:39.130012 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:23:39.137588 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:23:39.140425 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:23:39.142111 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:23:39.143723 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:23:39.154972 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:23:39.160658 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:23:39.161582 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:23:39.162529 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:23:39.163519 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:23:39.165324 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:23:39.167829 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:23:39.172243 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:23:39.174247 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:23:39.176148 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:23:39.182607 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:23:39.201733 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:23:39.208309 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:23:39.210181 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:23:39.221657 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:23:39.240354 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:23:39.253644 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:23:39.269177 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:23:39.286160 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:23:39.297068 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:23:39.298783 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:23:39.304004 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:23:39.307671 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:23:39.309255 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:23:39.316545 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:23:39.319347 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:23:39.323323 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:23:39.330579 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:23:39.334304 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
00:23:39.344087 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
00:23:39.350314 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
00:23:39.351426 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
00:23:39.361339 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
00:23:39.363538 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
00:23:39.365403 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
00:23:39.366963 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
00:23:39.368712 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
00:23:39.372445 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
00:23:39.374719 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
00:23:39.378574 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
00:23:39.380075 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
00:23:39.381933 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
00:23:39.382985 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
00:23:39.390569 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
00:23:39.395408 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
00:23:39.397904 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
00:23:39.400192 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
00:23:39.401909 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
00:23:39.404037 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
00:23:39.405633 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
00:23:39.407375 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
00:23:39.408760 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
00:23:39.414105 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
00:23:39.415561 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
00:23:39.417681 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
00:23:39.420210 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
00:23:39.422998 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
00:23:39.424786 [debug] [MainThread]: Parsing macros/sql/star.sql
00:23:39.428710 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
00:23:39.430804 [debug] [MainThread]: Parsing macros/sql/pivot.sql
00:23:39.435697 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
00:23:39.437734 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
00:23:39.440823 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
00:23:39.449409 [debug] [MainThread]: Parsing macros/sql/union.sql
00:23:39.460660 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
00:23:39.462561 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
00:23:39.468692 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
00:23:39.473472 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
00:23:39.476977 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
00:23:39.481554 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
00:23:39.488988 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
00:23:39.493830 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
00:23:39.500933 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
00:23:39.507273 [debug] [MainThread]: Parsing macros/sql/groupby.sql
00:23:39.508797 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
00:23:39.511203 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
00:23:39.514060 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
00:23:39.515727 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
00:23:39.519246 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
00:23:39.520732 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
00:23:39.522054 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
00:23:39.523387 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
00:23:39.524726 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
00:23:39.548868 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
00:23:39.550994 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
00:23:39.553240 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
00:23:39.555546 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
00:23:39.557443 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
00:23:39.560831 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
00:23:39.563406 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
00:23:39.565293 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
00:23:39.568116 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
00:23:39.577861 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
00:23:39.581846 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
00:23:39.584202 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
00:23:39.585562 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
00:23:39.586921 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
00:23:39.588789 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
00:23:39.591800 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
00:23:39.593481 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
00:23:40.038848 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
00:23:40.051584 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
00:23:40.054456 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
00:23:40.057476 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
00:23:40.060445 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
00:23:40.063843 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
00:23:40.066525 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_players.sql
00:23:40.069726 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
00:23:40.072808 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/maps.sql
00:23:40.076047 [debug] [MainThread]: 1603: static parser failed on warehouse/match_details.sql


============================== 2022-06-10 00:30:59.825842 | 81ac0d70-f362-4a28-98d4-1d8e21dca029 ==============================
00:30:59.825858 [info ] [MainThread]: Running with dbt=1.1.0
00:30:59.826337 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
00:30:59.826522 [debug] [MainThread]: Tracking: tracking
00:30:59.827545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57f010be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57f010b220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57f010b700>]}
00:30:59.828622 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nfki4zmb'
00:30:59.829327 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
00:31:00.051898 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
00:31:00.052653 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
00:31:00.171151 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
00:31:00.234672 [info ] [MainThread]: Installing dbt-labs/dbt_utils
00:31:00.833255 [info ] [MainThread]:   Installed from version 0.8.5
00:31:00.833697 [info ] [MainThread]:   Up to date!
00:31:00.834135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '81ac0d70-f362-4a28-98d4-1d8e21dca029', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57f010b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57f028f610>]}
00:31:00.834899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57f55bbf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57f00f5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57f00eeee0>]}


============================== 2022-06-10 00:31:05.505370 | 8eec78d1-c645-46ba-b3bf-02db336b19b8 ==============================
00:31:05.505391 [info ] [MainThread]: Running with dbt=1.1.0
00:31:05.505919 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:31:05.506127 [debug] [MainThread]: Tracking: do not track
00:31:05.527496 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
00:31:05.549258 [debug] [MainThread]: Parsing macros/match_details.sql
00:31:05.549685 [debug] [MainThread]: Parsing macros/adapters.sql
00:31:05.594080 [debug] [MainThread]: Parsing macros/catalog.sql
00:31:05.596457 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
00:31:05.597850 [debug] [MainThread]: Parsing macros/materializations/merge.sql
00:31:05.602411 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
00:31:05.612418 [debug] [MainThread]: Parsing macros/materializations/table.sql
00:31:05.616216 [debug] [MainThread]: Parsing macros/materializations/view.sql
00:31:05.617838 [debug] [MainThread]: Parsing macros/materializations/seed.sql
00:31:05.625417 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:31:05.642400 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:31:05.653510 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:31:05.658657 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:31:05.661981 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:31:05.665714 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:31:05.668162 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:31:05.676480 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:31:05.679920 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:31:05.681927 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:31:05.683830 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:31:05.693446 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:31:05.699344 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:31:05.700326 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:31:05.701416 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:31:05.702523 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:31:05.705113 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:31:05.708154 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:31:05.713860 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:31:05.716080 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:31:05.718277 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:31:05.723997 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:31:05.744403 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:31:05.752747 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:31:05.754896 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:31:05.766336 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:31:05.785917 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:31:05.800696 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:31:05.816982 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:31:05.837202 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:31:05.848790 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:31:05.851058 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:31:05.856013 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:31:05.859111 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:31:05.860790 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:31:05.867872 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:31:05.870779 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:31:05.874025 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:31:05.881780 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:31:05.885887 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
00:31:05.895183 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
00:31:05.902300 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
00:31:05.903447 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
00:31:05.914975 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
00:31:05.917208 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
00:31:05.918799 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
00:31:05.920594 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
00:31:05.922433 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
00:31:05.925447 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
00:31:05.927692 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
00:31:05.932961 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
00:31:05.934419 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
00:31:05.936308 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
00:31:05.937394 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
00:31:05.943929 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
00:31:05.947708 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
00:31:05.950150 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
00:31:05.952344 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
00:31:05.953669 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
00:31:05.956353 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
00:31:05.957876 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
00:31:05.959451 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
00:31:05.960711 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
00:31:05.966241 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
00:31:05.967599 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
00:31:05.969363 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
00:31:05.972183 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
00:31:05.975061 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
00:31:05.976951 [debug] [MainThread]: Parsing macros/sql/star.sql
00:31:05.981485 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
00:31:05.983307 [debug] [MainThread]: Parsing macros/sql/pivot.sql
00:31:05.987544 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
00:31:05.989341 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
00:31:05.992375 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
00:31:06.000859 [debug] [MainThread]: Parsing macros/sql/union.sql
00:31:06.012354 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
00:31:06.014295 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
00:31:06.020368 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
00:31:06.025058 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
00:31:06.029178 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
00:31:06.033082 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
00:31:06.041418 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
00:31:06.046410 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
00:31:06.053133 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
00:31:06.059780 [debug] [MainThread]: Parsing macros/sql/groupby.sql
00:31:06.061341 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
00:31:06.063196 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
00:31:06.065870 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
00:31:06.067693 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
00:31:06.071310 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
00:31:06.072964 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
00:31:06.074450 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
00:31:06.075767 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
00:31:06.076942 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
00:31:06.104073 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
00:31:06.106547 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
00:31:06.109158 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
00:31:06.111507 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
00:31:06.113212 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
00:31:06.116456 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
00:31:06.118985 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
00:31:06.122337 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
00:31:06.126234 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
00:31:06.135155 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
00:31:06.139655 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
00:31:06.142164 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
00:31:06.143712 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
00:31:06.145169 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
00:31:06.146728 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
00:31:06.150020 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
00:31:06.152173 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
00:31:06.647898 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
00:31:06.661334 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
00:31:06.665653 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
00:31:06.668412 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
00:31:06.671852 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
00:31:06.674656 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
00:31:06.677496 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 00:34:36.696309 | 3ed296ca-306c-4e2b-99e0-e761e91fdb23 ==============================
00:34:36.696329 [info ] [MainThread]: Running with dbt=1.1.0
00:34:36.696881 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
00:34:36.697169 [debug] [MainThread]: Tracking: tracking
00:34:36.698953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f55907c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f55907d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f55907730>]}
00:34:36.700216 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-mrt1vshw'
00:34:36.700984 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
00:34:36.939630 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
00:34:36.940764 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
00:34:37.119074 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
00:34:37.186993 [info ] [MainThread]: Installing dbt-labs/dbt_utils
00:34:37.770431 [info ] [MainThread]:   Installed from version 0.8.5
00:34:37.770886 [info ] [MainThread]:   Up to date!
00:34:37.771287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3ed296ca-306c-4e2b-99e0-e761e91fdb23', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5585ed30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f559fda30>]}
00:34:37.771791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5590cac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5587abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f55866370>]}


============================== 2022-06-10 00:34:43.137874 | 4ae1cb10-ac17-4401-b45c-d4854442f456 ==============================
00:34:43.137902 [info ] [MainThread]: Running with dbt=1.1.0
00:34:43.138868 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:34:43.139138 [debug] [MainThread]: Tracking: do not track
00:34:43.172301 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
00:34:43.198697 [debug] [MainThread]: Parsing macros/match_details.sql
00:34:43.199222 [debug] [MainThread]: Parsing macros/adapters.sql
00:34:43.249851 [debug] [MainThread]: Parsing macros/catalog.sql
00:34:43.252397 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
00:34:43.254042 [debug] [MainThread]: Parsing macros/materializations/merge.sql
00:34:43.259489 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
00:34:43.273957 [debug] [MainThread]: Parsing macros/materializations/table.sql
00:34:43.279008 [debug] [MainThread]: Parsing macros/materializations/view.sql
00:34:43.281016 [debug] [MainThread]: Parsing macros/materializations/seed.sql
00:34:43.288806 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:34:43.303672 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:34:43.320870 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:34:43.327901 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:34:43.332706 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:34:43.336433 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:34:43.341130 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:34:43.355595 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:34:43.359957 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:34:43.362519 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:34:43.364608 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:34:43.377407 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:34:43.384142 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:34:43.385416 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:34:43.387095 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:34:43.388505 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:34:43.390569 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:34:43.394923 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:34:43.400674 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:34:43.403661 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:34:43.406146 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:34:43.412772 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:34:43.434354 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:34:43.444448 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:34:43.447131 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:34:43.460789 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:34:43.486389 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:34:43.503002 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:34:43.522028 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:34:43.541156 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:34:43.555057 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:34:43.557407 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:34:43.564151 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:34:43.568216 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:34:43.570736 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:34:43.580043 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:34:43.584162 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:34:43.589212 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:34:43.598614 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:34:43.605871 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
00:34:43.616850 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
00:34:43.624470 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
00:34:43.626044 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
00:34:43.638091 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
00:34:43.640613 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
00:34:43.643008 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
00:34:43.646260 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
00:34:43.648351 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
00:34:43.653360 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
00:34:43.656059 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
00:34:43.661287 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
00:34:43.663465 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
00:34:43.665845 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
00:34:43.667301 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
00:34:43.674562 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
00:34:43.678748 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
00:34:43.681576 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
00:34:43.684020 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
00:34:43.685682 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
00:34:43.687993 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
00:34:43.689742 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
00:34:43.691710 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
00:34:43.693676 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
00:34:43.699762 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
00:34:43.701312 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
00:34:43.703357 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
00:34:43.706205 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
00:34:43.710054 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
00:34:43.712095 [debug] [MainThread]: Parsing macros/sql/star.sql
00:34:43.716770 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
00:34:43.718836 [debug] [MainThread]: Parsing macros/sql/pivot.sql
00:34:43.724427 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
00:34:43.727268 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
00:34:43.731417 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
00:34:43.741590 [debug] [MainThread]: Parsing macros/sql/union.sql
00:34:43.755730 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
00:34:43.758310 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
00:34:43.766413 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
00:34:43.775618 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
00:34:43.780652 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
00:34:43.786070 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
00:34:43.796945 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
00:34:43.802734 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
00:34:43.811809 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
00:34:43.822817 [debug] [MainThread]: Parsing macros/sql/groupby.sql
00:34:43.825508 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
00:34:43.828190 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
00:34:43.831553 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
00:34:43.834006 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
00:34:43.838096 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
00:34:43.839880 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
00:34:43.841797 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
00:34:43.843359 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
00:34:43.844845 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
00:34:43.874961 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
00:34:43.877521 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
00:34:43.880667 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
00:34:43.883399 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
00:34:43.885344 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
00:34:43.889055 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
00:34:43.891885 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
00:34:43.894312 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
00:34:43.897714 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
00:34:43.907689 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
00:34:43.913666 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
00:34:43.916793 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
00:34:43.918333 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
00:34:43.919857 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
00:34:43.921760 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
00:34:43.925211 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
00:34:43.927256 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
00:34:44.517833 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
00:34:44.540616 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
00:34:44.547644 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
00:34:44.551991 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
00:34:44.557977 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
00:34:44.562896 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
00:34:44.566200 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 00:54:58.544415 | 102df033-f797-490d-a441-2177d9592ec0 ==============================
00:54:58.544433 [info ] [MainThread]: Running with dbt=1.1.0
00:54:58.545022 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
00:54:58.545268 [debug] [MainThread]: Tracking: tracking
00:54:58.546628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4449f2ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4449d5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4449d5bb0>]}
00:54:58.547485 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-g626_qno'
00:54:58.547827 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
00:54:58.790246 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
00:54:58.790964 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
00:54:58.960753 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
00:54:59.050502 [info ] [MainThread]: Installing dbt-labs/dbt_utils
00:54:59.665376 [info ] [MainThread]:   Installed from version 0.8.5
00:54:59.666556 [info ] [MainThread]:   Up to date!
00:54:59.667461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '102df033-f797-490d-a441-2177d9592ec0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4449d5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc444b76250>]}
00:54:59.668891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc449db62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4449dc160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc444a80ee0>]}


============================== 2022-06-10 00:55:04.882375 | a466a63b-0d34-4665-86ac-d21964596ccf ==============================
00:55:04.882397 [info ] [MainThread]: Running with dbt=1.1.0
00:55:04.883057 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:55:04.883328 [debug] [MainThread]: Tracking: do not track
00:55:04.907186 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
00:55:04.930360 [debug] [MainThread]: Parsing macros/match_details.sql
00:55:04.930747 [debug] [MainThread]: Parsing macros/adapters.sql
00:55:04.981309 [debug] [MainThread]: Parsing macros/catalog.sql
00:55:04.983741 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
00:55:04.985102 [debug] [MainThread]: Parsing macros/materializations/merge.sql
00:55:04.990013 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
00:55:05.001065 [debug] [MainThread]: Parsing macros/materializations/table.sql
00:55:05.005193 [debug] [MainThread]: Parsing macros/materializations/view.sql
00:55:05.007114 [debug] [MainThread]: Parsing macros/materializations/seed.sql
00:55:05.014135 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:55:05.027528 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:55:05.045688 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:55:05.052579 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:55:05.056784 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:55:05.061757 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:55:05.067005 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:55:05.076461 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:55:05.080495 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:55:05.083867 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:55:05.087028 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:55:05.098395 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:55:05.104237 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:55:05.105379 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:55:05.106634 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:55:05.107937 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:55:05.109956 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:55:05.114377 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:55:05.120576 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:55:05.124293 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:55:05.128439 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:55:05.135887 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:55:05.155524 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:55:05.163727 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:55:05.166431 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:55:05.181614 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:55:05.209760 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:55:05.224610 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:55:05.245487 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:55:05.273267 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:55:05.285739 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:55:05.287754 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:55:05.293504 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:55:05.296856 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:55:05.298681 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:55:05.307259 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:55:05.310610 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:55:05.314541 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:55:05.325275 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:55:05.329480 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
00:55:05.340288 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
00:55:05.348041 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
00:55:05.349699 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
00:55:05.363176 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
00:55:05.366889 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
00:55:05.370117 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
00:55:05.372774 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
00:55:05.375979 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
00:55:05.380772 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
00:55:05.383869 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
00:55:05.388543 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
00:55:05.390702 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
00:55:05.392994 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
00:55:05.394465 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
00:55:05.404061 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
00:55:05.408335 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
00:55:05.412536 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
00:55:05.415933 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
00:55:05.417599 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
00:55:05.420094 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
00:55:05.422283 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
00:55:05.424578 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
00:55:05.426131 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
00:55:05.434125 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
00:55:05.435967 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
00:55:05.438096 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
00:55:05.441280 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
00:55:05.445385 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
00:55:05.447712 [debug] [MainThread]: Parsing macros/sql/star.sql
00:55:05.452277 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
00:55:05.454895 [debug] [MainThread]: Parsing macros/sql/pivot.sql
00:55:05.461262 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
00:55:05.464456 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
00:55:05.470116 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
00:55:05.482980 [debug] [MainThread]: Parsing macros/sql/union.sql
00:55:05.499190 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
00:55:05.501578 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
00:55:05.512809 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
00:55:05.520704 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
00:55:05.525676 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
00:55:05.530450 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
00:55:05.539731 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
00:55:05.545269 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
00:55:05.553024 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
00:55:05.564233 [debug] [MainThread]: Parsing macros/sql/groupby.sql
00:55:05.566903 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
00:55:05.570869 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
00:55:05.575301 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
00:55:05.578409 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
00:55:05.584616 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
00:55:05.586625 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
00:55:05.588998 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
00:55:05.591129 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
00:55:05.593085 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
00:55:05.626231 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
00:55:05.629566 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
00:55:05.633459 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
00:55:05.636431 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
00:55:05.638801 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
00:55:05.644227 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
00:55:05.648715 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
00:55:05.655900 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
00:55:05.661512 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
00:55:05.682856 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
00:55:05.690208 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
00:55:05.694478 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
00:55:05.697053 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
00:55:05.699911 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
00:55:05.704626 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
00:55:05.714146 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
00:55:05.717445 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
00:55:06.336550 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
00:55:06.350629 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
00:55:06.353851 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
00:55:06.357395 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
00:55:06.360932 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
00:55:06.364610 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
00:55:06.367533 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 00:58:39.670879 | 5d0c6d15-3c37-4595-bc39-d34f206b8bfb ==============================
00:58:39.670893 [info ] [MainThread]: Running with dbt=1.1.0
00:58:39.671393 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
00:58:39.671632 [debug] [MainThread]: Tracking: tracking
00:58:39.672713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0cefcf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0cefc220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0cefc790>]}
00:58:39.673468 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7ai759a5'
00:58:39.673830 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
00:58:40.052529 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
00:58:40.054452 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
00:58:40.365375 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
00:58:40.420870 [info ] [MainThread]: Installing dbt-labs/dbt_utils
00:58:41.021581 [info ] [MainThread]:   Installed from version 0.8.5
00:58:41.022486 [info ] [MainThread]:   Up to date!
00:58:41.023019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5d0c6d15-3c37-4595-bc39-d34f206b8bfb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0cefc6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0cfc0220>]}
00:58:41.023670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0ce13640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0cee04c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0cef4160>]}


============================== 2022-06-10 00:58:45.506015 | cde3d78a-db16-4c3d-af88-0de1d91a22e2 ==============================
00:58:45.506038 [info ] [MainThread]: Running with dbt=1.1.0
00:58:45.506665 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:58:45.506881 [debug] [MainThread]: Tracking: do not track
00:58:45.532496 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
00:58:45.556782 [debug] [MainThread]: Parsing macros/match_details.sql
00:58:45.557137 [debug] [MainThread]: Parsing macros/adapters.sql
00:58:45.600609 [debug] [MainThread]: Parsing macros/catalog.sql
00:58:45.602778 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
00:58:45.604107 [debug] [MainThread]: Parsing macros/materializations/merge.sql
00:58:45.609629 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
00:58:45.620108 [debug] [MainThread]: Parsing macros/materializations/table.sql
00:58:45.624194 [debug] [MainThread]: Parsing macros/materializations/view.sql
00:58:45.626163 [debug] [MainThread]: Parsing macros/materializations/seed.sql
00:58:45.632223 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:58:45.643426 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:58:45.653833 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:58:45.658869 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:58:45.662307 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:58:45.665343 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:58:45.668077 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:58:45.675828 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:58:45.678773 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:58:45.680678 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:58:45.682377 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:58:45.692315 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:58:45.697467 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:58:45.698434 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:58:45.699736 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:58:45.700999 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:58:45.702671 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:58:45.705266 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:58:45.709476 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:58:45.711552 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:58:45.713553 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:58:45.718885 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:58:45.737418 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:58:45.744370 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:58:45.746381 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:58:45.757718 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:58:45.780371 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:58:45.792914 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:58:45.808392 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:58:45.824664 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:58:45.836428 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:58:45.838490 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:58:45.844169 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:58:45.847290 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:58:45.848921 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:58:45.856527 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:58:45.859533 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:58:45.863133 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:58:45.871125 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:58:45.874810 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
00:58:45.884023 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
00:58:45.891955 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
00:58:45.893282 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
00:58:45.903218 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
00:58:45.905527 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
00:58:45.907281 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
00:58:45.908669 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
00:58:45.910450 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
00:58:45.913475 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
00:58:45.915532 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
00:58:45.919427 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
00:58:45.920853 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
00:58:45.922811 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
00:58:45.923995 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
00:58:45.932148 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
00:58:45.936134 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
00:58:45.938870 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
00:58:45.941550 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
00:58:45.943094 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
00:58:45.945346 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
00:58:45.948154 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
00:58:45.950205 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
00:58:45.951633 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
00:58:45.958397 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
00:58:45.959677 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
00:58:45.961181 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
00:58:45.963410 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
00:58:45.966131 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
00:58:45.967842 [debug] [MainThread]: Parsing macros/sql/star.sql
00:58:45.971652 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
00:58:45.973521 [debug] [MainThread]: Parsing macros/sql/pivot.sql
00:58:45.978065 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
00:58:45.979954 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
00:58:45.983017 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
00:58:45.991820 [debug] [MainThread]: Parsing macros/sql/union.sql
00:58:46.003958 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
00:58:46.006064 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
00:58:46.012455 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
00:58:46.017324 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
00:58:46.021446 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
00:58:46.025417 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
00:58:46.033224 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
00:58:46.038020 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
00:58:46.046484 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
00:58:46.055022 [debug] [MainThread]: Parsing macros/sql/groupby.sql
00:58:46.056604 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
00:58:46.058397 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
00:58:46.060889 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
00:58:46.062630 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
00:58:46.067766 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
00:58:46.069230 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
00:58:46.070635 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
00:58:46.072078 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
00:58:46.073428 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
00:58:46.099437 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
00:58:46.101715 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
00:58:46.104199 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
00:58:46.106619 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
00:58:46.108335 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
00:58:46.111962 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
00:58:46.115283 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
00:58:46.117276 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
00:58:46.119857 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
00:58:46.129890 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
00:58:46.133863 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
00:58:46.136430 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
00:58:46.137849 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
00:58:46.139687 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
00:58:46.141407 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
00:58:46.144808 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
00:58:46.146642 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
00:58:46.732468 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
00:58:46.750258 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
00:58:46.753763 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
00:58:46.758506 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
00:58:46.765423 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
00:58:46.770455 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
00:58:46.776827 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 01:07:08.945256 | f48369da-8da4-4b78-9d5e-06675853b8ad ==============================
01:07:08.945272 [info ] [MainThread]: Running with dbt=1.1.0
01:07:08.945755 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
01:07:08.945934 [debug] [MainThread]: Tracking: tracking
01:07:08.947025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e2b168b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e2b16970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e2b16ac0>]}
01:07:08.947765 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-cg5leabs'
01:07:08.948161 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
01:07:09.337705 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
01:07:09.338408 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
01:07:09.648614 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
01:07:09.700745 [info ] [MainThread]: Installing dbt-labs/dbt_utils
01:07:10.370672 [info ] [MainThread]:   Installed from version 0.8.5
01:07:10.371097 [info ] [MainThread]:   Up to date!
01:07:10.371532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f48369da-8da4-4b78-9d5e-06675853b8ad', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e2b0a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e2a806a0>]}
01:07:10.372068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e5376eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e2b827c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24e2b82670>]}


============================== 2022-06-10 01:07:14.731008 | 406aa597-0d20-4c07-9352-fcec81b29e8c ==============================
01:07:14.731038 [info ] [MainThread]: Running with dbt=1.1.0
01:07:14.731953 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
01:07:14.732297 [debug] [MainThread]: Tracking: do not track
01:07:14.759581 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
01:07:14.786387 [debug] [MainThread]: Parsing macros/match_details.sql
01:07:14.786888 [debug] [MainThread]: Parsing macros/adapters.sql
01:07:14.835565 [debug] [MainThread]: Parsing macros/catalog.sql
01:07:14.837822 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
01:07:14.839294 [debug] [MainThread]: Parsing macros/materializations/merge.sql
01:07:14.845144 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
01:07:14.859857 [debug] [MainThread]: Parsing macros/materializations/table.sql
01:07:14.864804 [debug] [MainThread]: Parsing macros/materializations/view.sql
01:07:14.866457 [debug] [MainThread]: Parsing macros/materializations/seed.sql
01:07:14.873236 [debug] [MainThread]: Parsing macros/adapters/columns.sql
01:07:14.885186 [debug] [MainThread]: Parsing macros/adapters/relation.sql
01:07:14.897721 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
01:07:14.903665 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
01:07:14.909171 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
01:07:14.913831 [debug] [MainThread]: Parsing macros/adapters/schema.sql
01:07:14.917901 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
01:07:14.928139 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
01:07:14.930873 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
01:07:14.932737 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
01:07:14.934382 [debug] [MainThread]: Parsing macros/etc/datetime.sql
01:07:14.945418 [debug] [MainThread]: Parsing macros/etc/statement.sql
01:07:14.953275 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
01:07:14.954617 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
01:07:14.956208 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
01:07:14.957786 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
01:07:14.960312 [debug] [MainThread]: Parsing macros/materializations/configs.sql
01:07:14.964077 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
01:07:14.970623 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
01:07:14.973285 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
01:07:14.975282 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
01:07:14.980115 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
01:07:14.995598 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
01:07:15.001882 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
01:07:15.004426 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
01:07:15.015595 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
01:07:15.041231 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
01:07:15.055365 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
01:07:15.074708 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
01:07:15.091490 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
01:07:15.102876 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
01:07:15.104803 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
01:07:15.110362 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
01:07:15.113636 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
01:07:15.115413 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
01:07:15.122943 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
01:07:15.125752 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
01:07:15.129911 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
01:07:15.141255 [debug] [MainThread]: Parsing tests/generic/builtin.sql
01:07:15.144918 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
01:07:15.154284 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
01:07:15.161465 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
01:07:15.163160 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
01:07:15.174081 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
01:07:15.176626 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
01:07:15.178561 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
01:07:15.180421 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
01:07:15.182553 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
01:07:15.185962 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
01:07:15.188673 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
01:07:15.193629 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
01:07:15.195638 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
01:07:15.197928 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
01:07:15.199661 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
01:07:15.207752 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
01:07:15.212687 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
01:07:15.215544 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
01:07:15.218373 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
01:07:15.220088 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
01:07:15.222230 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
01:07:15.224394 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
01:07:15.226754 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
01:07:15.228269 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
01:07:15.234118 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
01:07:15.235496 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
01:07:15.237479 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
01:07:15.240852 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
01:07:15.244281 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
01:07:15.246450 [debug] [MainThread]: Parsing macros/sql/star.sql
01:07:15.250873 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
01:07:15.253158 [debug] [MainThread]: Parsing macros/sql/pivot.sql
01:07:15.259029 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
01:07:15.261353 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
01:07:15.265090 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
01:07:15.276162 [debug] [MainThread]: Parsing macros/sql/union.sql
01:07:15.289666 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
01:07:15.291935 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
01:07:15.299095 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
01:07:15.304547 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
01:07:15.308611 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
01:07:15.312853 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
01:07:15.321934 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
01:07:15.329175 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
01:07:15.335512 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
01:07:15.341732 [debug] [MainThread]: Parsing macros/sql/groupby.sql
01:07:15.343237 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
01:07:15.345013 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
01:07:15.347488 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
01:07:15.349236 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
01:07:15.352987 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
01:07:15.354753 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
01:07:15.356827 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
01:07:15.358431 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
01:07:15.360041 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
01:07:15.388479 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
01:07:15.391652 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
01:07:15.395069 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
01:07:15.398081 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
01:07:15.400791 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
01:07:15.405210 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
01:07:15.408442 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
01:07:15.410859 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
01:07:15.415773 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
01:07:15.425611 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
01:07:15.429882 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
01:07:15.433750 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
01:07:15.435416 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
01:07:15.437074 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
01:07:15.439984 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
01:07:15.443378 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
01:07:15.445574 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
01:07:15.989415 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
01:07:16.006425 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
01:07:16.011319 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
01:07:16.014981 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
01:07:16.019356 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
01:07:16.024491 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
01:07:16.029516 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 01:20:47.836396 | 002f52c0-1df0-45ea-b533-a125e3d59810 ==============================
01:20:47.836427 [info ] [MainThread]: Running with dbt=1.1.0
01:20:47.837393 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
01:20:47.837941 [debug] [MainThread]: Tracking: tracking
01:20:47.839958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f3804820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f38048e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f3804a30>]}
01:20:47.841467 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-d8oiqrpi'
01:20:47.841926 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
01:20:48.267147 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
01:20:48.267922 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
01:20:48.576595 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
01:20:48.626831 [info ] [MainThread]: Installing dbt-labs/dbt_utils
01:20:49.226616 [info ] [MainThread]:   Installed from version 0.8.5
01:20:49.227522 [info ] [MainThread]:   Up to date!
01:20:49.228541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '002f52c0-1df0-45ea-b533-a125e3d59810', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f3871520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f37f9880>]}
01:20:49.239146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f8c91ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f3769910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f3804970>]}


============================== 2022-06-10 01:20:53.831142 | b74a30d6-cd7a-47e4-9138-2f5efeb4e693 ==============================
01:20:53.831165 [info ] [MainThread]: Running with dbt=1.1.0
01:20:53.831890 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
01:20:53.832147 [debug] [MainThread]: Tracking: do not track
01:20:53.859849 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
01:20:53.895046 [debug] [MainThread]: Parsing macros/match_details.sql
01:20:53.895931 [debug] [MainThread]: Parsing macros/adapters.sql
01:20:53.954187 [debug] [MainThread]: Parsing macros/catalog.sql
01:20:53.958687 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
01:20:53.960781 [debug] [MainThread]: Parsing macros/materializations/merge.sql
01:20:53.967974 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
01:20:53.982061 [debug] [MainThread]: Parsing macros/materializations/table.sql
01:20:53.987429 [debug] [MainThread]: Parsing macros/materializations/view.sql
01:20:53.990103 [debug] [MainThread]: Parsing macros/materializations/seed.sql
01:20:54.000206 [debug] [MainThread]: Parsing macros/adapters/columns.sql
01:20:54.016882 [debug] [MainThread]: Parsing macros/adapters/relation.sql
01:20:54.033458 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
01:20:54.041772 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
01:20:54.047269 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
01:20:54.052630 [debug] [MainThread]: Parsing macros/adapters/schema.sql
01:20:54.058299 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
01:20:54.072809 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
01:20:54.077853 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
01:20:54.082528 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
01:20:54.085449 [debug] [MainThread]: Parsing macros/etc/datetime.sql
01:20:54.106552 [debug] [MainThread]: Parsing macros/etc/statement.sql
01:20:54.119170 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
01:20:54.120801 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
01:20:54.122256 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
01:20:54.123904 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
01:20:54.126446 [debug] [MainThread]: Parsing macros/materializations/configs.sql
01:20:54.130479 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
01:20:54.137579 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
01:20:54.141239 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
01:20:54.144970 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
01:20:54.156786 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
01:20:54.195127 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
01:20:54.216633 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
01:20:54.220524 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
01:20:54.241795 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
01:20:54.270186 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
01:20:54.283607 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
01:20:54.299591 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
01:20:54.316611 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
01:20:54.327762 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
01:20:54.330706 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
01:20:54.338689 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
01:20:54.342004 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
01:20:54.343746 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
01:20:54.351239 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
01:20:54.354199 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
01:20:54.357762 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
01:20:54.365607 [debug] [MainThread]: Parsing tests/generic/builtin.sql
01:20:54.369476 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
01:20:54.379628 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
01:20:54.386580 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
01:20:54.388272 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
01:20:54.398938 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
01:20:54.400984 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
01:20:54.402492 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
01:20:54.403784 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
01:20:54.405346 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
01:20:54.408272 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
01:20:54.410359 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
01:20:54.414080 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
01:20:54.415396 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
01:20:54.417155 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
01:20:54.418337 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
01:20:54.427037 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
01:20:54.431838 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
01:20:54.434552 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
01:20:54.437496 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
01:20:54.439211 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
01:20:54.441354 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
01:20:54.443070 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
01:20:54.445287 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
01:20:54.446711 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
01:20:54.452597 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
01:20:54.453916 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
01:20:54.455863 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
01:20:54.458989 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
01:20:54.462367 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
01:20:54.464429 [debug] [MainThread]: Parsing macros/sql/star.sql
01:20:54.468410 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
01:20:54.470472 [debug] [MainThread]: Parsing macros/sql/pivot.sql
01:20:54.475386 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
01:20:54.477502 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
01:20:54.481174 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
01:20:54.490497 [debug] [MainThread]: Parsing macros/sql/union.sql
01:20:54.501992 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
01:20:54.504259 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
01:20:54.511170 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
01:20:54.516646 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
01:20:54.522271 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
01:20:54.529104 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
01:20:54.541103 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
01:20:54.548388 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
01:20:54.557716 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
01:20:54.564857 [debug] [MainThread]: Parsing macros/sql/groupby.sql
01:20:54.567218 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
01:20:54.570189 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
01:20:54.572948 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
01:20:54.574837 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
01:20:54.578990 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
01:20:54.580442 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
01:20:54.582241 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
01:20:54.585058 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
01:20:54.587099 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
01:20:54.619732 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
01:20:54.622303 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
01:20:54.624929 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
01:20:54.627418 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
01:20:54.629520 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
01:20:54.632810 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
01:20:54.636247 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
01:20:54.638573 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
01:20:54.641616 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
01:20:54.653524 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
01:20:54.658321 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
01:20:54.661808 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
01:20:54.663733 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
01:20:54.665815 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
01:20:54.668952 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
01:20:54.674325 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
01:20:54.686235 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
01:20:55.323693 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
01:20:55.343777 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
01:20:55.348411 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
01:20:55.352557 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
01:20:55.357978 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
01:20:55.367643 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
01:20:55.372057 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 01:26:02.437786 | 50a1002f-947a-4a21-9878-6c4e1e8e791b ==============================
01:26:02.437801 [info ] [MainThread]: Running with dbt=1.1.0
01:26:02.438239 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
01:26:02.438504 [debug] [MainThread]: Tracking: tracking
01:26:02.439732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23135177f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23135178b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2313517a00>]}
01:26:02.440566 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vlqrfdyh'
01:26:02.440993 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
01:26:02.800289 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
01:26:02.801057 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
01:26:03.107525 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
01:26:03.161686 [info ] [MainThread]: Installing dbt-labs/dbt_utils
01:26:03.732767 [info ] [MainThread]:   Installed from version 0.8.5
01:26:03.733287 [info ] [MainThread]:   Up to date!
01:26:03.733728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '50a1002f-947a-4a21-9878-6c4e1e8e791b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f231350b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2313481160>]}
01:26:03.734307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2315df6f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2313586580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23135864c0>]}


============================== 2022-06-10 01:26:07.984937 | 065493a5-d7d6-4000-ac6f-fa723ac6cd5b ==============================
01:26:07.984959 [info ] [MainThread]: Running with dbt=1.1.0
01:26:07.985517 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
01:26:07.985758 [debug] [MainThread]: Tracking: do not track
01:26:08.007023 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
01:26:08.028041 [debug] [MainThread]: Parsing macros/match_details.sql
01:26:08.028572 [debug] [MainThread]: Parsing macros/adapters.sql
01:26:08.074814 [debug] [MainThread]: Parsing macros/catalog.sql
01:26:08.077059 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
01:26:08.078619 [debug] [MainThread]: Parsing macros/materializations/merge.sql
01:26:08.084589 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
01:26:08.098581 [debug] [MainThread]: Parsing macros/materializations/table.sql
01:26:08.103723 [debug] [MainThread]: Parsing macros/materializations/view.sql
01:26:08.105824 [debug] [MainThread]: Parsing macros/materializations/seed.sql
01:26:08.112880 [debug] [MainThread]: Parsing macros/adapters/columns.sql
01:26:08.125562 [debug] [MainThread]: Parsing macros/adapters/relation.sql
01:26:08.141024 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
01:26:08.147602 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
01:26:08.152096 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
01:26:08.157151 [debug] [MainThread]: Parsing macros/adapters/schema.sql
01:26:08.161466 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
01:26:08.171680 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
01:26:08.174829 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
01:26:08.176796 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
01:26:08.179141 [debug] [MainThread]: Parsing macros/etc/datetime.sql
01:26:08.189057 [debug] [MainThread]: Parsing macros/etc/statement.sql
01:26:08.194568 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
01:26:08.195808 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
01:26:08.197330 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
01:26:08.199099 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
01:26:08.200814 [debug] [MainThread]: Parsing macros/materializations/configs.sql
01:26:08.203582 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
01:26:08.207614 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
01:26:08.209900 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
01:26:08.212688 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
01:26:08.219862 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
01:26:08.238638 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
01:26:08.248195 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
01:26:08.251289 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
01:26:08.264141 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
01:26:08.284850 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
01:26:08.298801 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
01:26:08.314087 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
01:26:08.331042 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
01:26:08.341932 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
01:26:08.343649 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
01:26:08.349335 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
01:26:08.352297 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
01:26:08.354418 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
01:26:08.363026 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
01:26:08.366054 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
01:26:08.369888 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
01:26:08.377608 [debug] [MainThread]: Parsing tests/generic/builtin.sql
01:26:08.381568 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
01:26:08.391029 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
01:26:08.400725 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
01:26:08.402218 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
01:26:08.412832 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
01:26:08.414893 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
01:26:08.416659 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
01:26:08.418503 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
01:26:08.420200 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
01:26:08.423170 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
01:26:08.426806 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
01:26:08.434560 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
01:26:08.437811 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
01:26:08.440172 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
01:26:08.441483 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
01:26:08.448653 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
01:26:08.453053 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
01:26:08.456356 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
01:26:08.459832 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
01:26:08.461896 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
01:26:08.464655 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
01:26:08.466869 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
01:26:08.468834 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
01:26:08.470587 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
01:26:08.476474 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
01:26:08.477683 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
01:26:08.479483 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
01:26:08.482229 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
01:26:08.485295 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
01:26:08.487572 [debug] [MainThread]: Parsing macros/sql/star.sql
01:26:08.491342 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
01:26:08.493328 [debug] [MainThread]: Parsing macros/sql/pivot.sql
01:26:08.498134 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
01:26:08.500246 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
01:26:08.503709 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
01:26:08.512163 [debug] [MainThread]: Parsing macros/sql/union.sql
01:26:08.523402 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
01:26:08.525604 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
01:26:08.533201 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
01:26:08.537894 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
01:26:08.541678 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
01:26:08.545487 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
01:26:08.554469 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
01:26:08.559671 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
01:26:08.568209 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
01:26:08.574756 [debug] [MainThread]: Parsing macros/sql/groupby.sql
01:26:08.576334 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
01:26:08.578396 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
01:26:08.581220 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
01:26:08.582944 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
01:26:08.586785 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
01:26:08.588082 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
01:26:08.590347 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
01:26:08.592549 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
01:26:08.593990 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
01:26:08.622983 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
01:26:08.625424 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
01:26:08.628709 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
01:26:08.631357 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
01:26:08.633250 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
01:26:08.636342 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
01:26:08.638730 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
01:26:08.641024 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
01:26:08.643787 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
01:26:08.652231 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
01:26:08.656509 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
01:26:08.659186 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
01:26:08.661000 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
01:26:08.662461 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
01:26:08.664206 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
01:26:08.667725 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
01:26:08.669551 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
01:26:09.123710 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
01:26:09.138528 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
01:26:09.141948 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
01:26:09.144781 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
01:26:09.148344 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
01:26:09.151024 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
01:26:09.153843 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 01:30:01.533654 | 5ac1be10-818a-4cb2-b8da-f73e89ae9740 ==============================
01:30:01.533673 [info ] [MainThread]: Running with dbt=1.1.0
01:30:01.534271 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
01:30:01.534524 [debug] [MainThread]: Tracking: tracking
01:30:01.535753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c58e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c58e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c58ea00>]}
01:30:01.539357 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ua_9ik0y'
01:30:01.540052 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
01:30:01.776634 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
01:30:01.777479 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
01:30:01.950440 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
01:30:02.007681 [info ] [MainThread]: Installing dbt-labs/dbt_utils
01:30:02.591708 [info ] [MainThread]:   Installed from version 0.8.5
01:30:02.592161 [info ] [MainThread]:   Up to date!
01:30:02.592555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5ac1be10-818a-4cb2-b8da-f73e89ae9740', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c582820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c4f8160>]}
01:30:02.593110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74ebfaf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c5fd580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74c5fd4c0>]}


============================== 2022-06-10 01:30:06.819554 | 59cd8a95-21fb-47e2-9c61-7c2a0f905380 ==============================
01:30:06.819576 [info ] [MainThread]: Running with dbt=1.1.0
01:30:06.820116 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
01:30:06.820305 [debug] [MainThread]: Tracking: do not track
01:30:06.842736 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
01:30:06.865088 [debug] [MainThread]: Parsing macros/match_details.sql
01:30:06.865546 [debug] [MainThread]: Parsing macros/adapters.sql
01:30:06.910655 [debug] [MainThread]: Parsing macros/catalog.sql
01:30:06.913038 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
01:30:06.914326 [debug] [MainThread]: Parsing macros/materializations/merge.sql
01:30:06.918589 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
01:30:06.928953 [debug] [MainThread]: Parsing macros/materializations/table.sql
01:30:06.932581 [debug] [MainThread]: Parsing macros/materializations/view.sql
01:30:06.934418 [debug] [MainThread]: Parsing macros/materializations/seed.sql
01:30:06.940827 [debug] [MainThread]: Parsing macros/adapters/columns.sql
01:30:06.953284 [debug] [MainThread]: Parsing macros/adapters/relation.sql
01:30:06.965387 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
01:30:06.970992 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
01:30:06.975358 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
01:30:06.980024 [debug] [MainThread]: Parsing macros/adapters/schema.sql
01:30:06.983534 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
01:30:06.993497 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
01:30:06.996167 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
01:30:06.998043 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
01:30:07.000058 [debug] [MainThread]: Parsing macros/etc/datetime.sql
01:30:07.010091 [debug] [MainThread]: Parsing macros/etc/statement.sql
01:30:07.015043 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
01:30:07.015925 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
01:30:07.016861 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
01:30:07.017800 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
01:30:07.019567 [debug] [MainThread]: Parsing macros/materializations/configs.sql
01:30:07.022352 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
01:30:07.026807 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
01:30:07.029187 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
01:30:07.031152 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
01:30:07.036544 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
01:30:07.054980 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
01:30:07.061818 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
01:30:07.063771 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
01:30:07.075080 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
01:30:07.094248 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
01:30:07.107641 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
01:30:07.122948 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
01:30:07.138880 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
01:30:07.149754 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
01:30:07.151691 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
01:30:07.156366 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
01:30:07.159600 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
01:30:07.161101 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
01:30:07.168596 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
01:30:07.171507 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
01:30:07.174708 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
01:30:07.182511 [debug] [MainThread]: Parsing tests/generic/builtin.sql
01:30:07.185925 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
01:30:07.195074 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
01:30:07.201297 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
01:30:07.202456 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
01:30:07.212587 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
01:30:07.214853 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
01:30:07.216470 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
01:30:07.217926 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
01:30:07.219659 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
01:30:07.222786 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
01:30:07.224899 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
01:30:07.229801 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
01:30:07.231293 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
01:30:07.233150 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
01:30:07.235089 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
01:30:07.242550 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
01:30:07.248250 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
01:30:07.250758 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
01:30:07.252965 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
01:30:07.254431 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
01:30:07.256351 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
01:30:07.257881 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
01:30:07.259570 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
01:30:07.260730 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
01:30:07.265913 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
01:30:07.267095 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
01:30:07.268775 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
01:30:07.271306 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
01:30:07.274391 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
01:30:07.276673 [debug] [MainThread]: Parsing macros/sql/star.sql
01:30:07.280518 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
01:30:07.282559 [debug] [MainThread]: Parsing macros/sql/pivot.sql
01:30:07.287064 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
01:30:07.288912 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
01:30:07.292436 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
01:30:07.300840 [debug] [MainThread]: Parsing macros/sql/union.sql
01:30:07.312375 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
01:30:07.314262 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
01:30:07.320390 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
01:30:07.325100 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
01:30:07.328911 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
01:30:07.332843 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
01:30:07.340782 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
01:30:07.345872 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
01:30:07.352580 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
01:30:07.359132 [debug] [MainThread]: Parsing macros/sql/groupby.sql
01:30:07.360899 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
01:30:07.362711 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
01:30:07.365180 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
01:30:07.367117 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
01:30:07.371119 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
01:30:07.372513 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
01:30:07.374151 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
01:30:07.375546 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
01:30:07.377146 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
01:30:07.403670 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
01:30:07.405797 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
01:30:07.408723 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
01:30:07.411113 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
01:30:07.413135 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
01:30:07.416722 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
01:30:07.419142 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
01:30:07.421428 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
01:30:07.424254 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
01:30:07.433738 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
01:30:07.438029 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
01:30:07.440551 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
01:30:07.442005 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
01:30:07.443660 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
01:30:07.445480 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
01:30:07.449173 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
01:30:07.451083 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
01:30:07.919807 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
01:30:07.936261 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
01:30:07.939977 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
01:30:07.943919 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
01:30:07.948097 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
01:30:07.951517 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
01:30:07.955115 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 02:08:29.039809 | fac600f5-6f4e-48b4-a098-f83ec8bb1055 ==============================
02:08:29.039831 [info ] [MainThread]: Running with dbt=1.1.0
02:08:29.040486 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:08:29.040927 [debug] [MainThread]: Tracking: tracking
02:08:29.041686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc904914520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc904914580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9049145e0>]}
02:08:29.069896 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
02:08:29.070467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fac600f5-6f4e-48b4-a098-f83ec8bb1055', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc904951c10>]}
02:08:29.099244 [debug] [MainThread]: Parsing macros/match_details.sql
02:08:29.099654 [debug] [MainThread]: Parsing macros/adapters.sql
02:08:29.141883 [debug] [MainThread]: Parsing macros/catalog.sql
02:08:29.144586 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
02:08:29.146060 [debug] [MainThread]: Parsing macros/materializations/merge.sql
02:08:29.150788 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
02:08:29.160728 [debug] [MainThread]: Parsing macros/materializations/table.sql
02:08:29.164796 [debug] [MainThread]: Parsing macros/materializations/view.sql
02:08:29.166490 [debug] [MainThread]: Parsing macros/materializations/seed.sql
02:08:29.172252 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:08:29.183181 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:08:29.194037 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:08:29.199305 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:08:29.202917 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:08:29.206248 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:08:29.209040 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:08:29.216910 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:08:29.219607 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:08:29.221337 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:08:29.223099 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:08:29.232212 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:08:29.237334 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:08:29.238253 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:08:29.239261 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:08:29.240376 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:08:29.241926 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:08:29.244877 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:08:29.248977 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:08:29.250995 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:08:29.252999 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:08:29.257968 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:08:29.273877 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:08:29.280579 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:08:29.282435 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:08:29.293927 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:08:29.311564 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:08:29.324165 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:08:29.338684 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:08:29.353535 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:08:29.364081 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:08:29.365907 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:08:29.370905 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:08:29.374006 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:08:29.375583 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:08:29.382455 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:08:29.385089 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:08:29.388610 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:08:29.396131 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:08:29.399379 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
02:08:29.408592 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
02:08:29.415047 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
02:08:29.416295 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
02:08:29.426119 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
02:08:29.428351 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
02:08:29.430159 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
02:08:29.431602 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
02:08:29.433479 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
02:08:29.436681 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
02:08:29.438813 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
02:08:29.442920 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
02:08:29.444579 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
02:08:29.446459 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
02:08:29.447718 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
02:08:29.454416 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
02:08:29.458013 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
02:08:29.460491 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
02:08:29.462758 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
02:08:29.464240 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
02:08:29.466188 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
02:08:29.467700 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
02:08:29.469341 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
02:08:29.470581 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
02:08:29.475745 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
02:08:29.476997 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
02:08:29.478682 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
02:08:29.481100 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
02:08:29.484357 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
02:08:29.486213 [debug] [MainThread]: Parsing macros/sql/star.sql
02:08:29.489863 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
02:08:29.491761 [debug] [MainThread]: Parsing macros/sql/pivot.sql
02:08:29.496563 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
02:08:29.498766 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
02:08:29.501914 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
02:08:29.512951 [debug] [MainThread]: Parsing macros/sql/union.sql
02:08:29.525686 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
02:08:29.527628 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
02:08:29.533964 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
02:08:29.538707 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
02:08:29.542385 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
02:08:29.546455 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
02:08:29.554105 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
02:08:29.558635 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
02:08:29.565376 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
02:08:29.571459 [debug] [MainThread]: Parsing macros/sql/groupby.sql
02:08:29.573055 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
02:08:29.575150 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
02:08:29.578421 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
02:08:29.580356 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
02:08:29.584347 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
02:08:29.585740 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
02:08:29.587166 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
02:08:29.588645 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
02:08:29.589959 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
02:08:29.613810 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
02:08:29.615998 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
02:08:29.618298 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
02:08:29.620496 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
02:08:29.622172 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
02:08:29.625617 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
02:08:29.628410 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
02:08:29.630643 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
02:08:29.633740 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
02:08:29.642169 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
02:08:29.646263 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
02:08:29.648652 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
02:08:29.650083 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
02:08:29.651586 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
02:08:29.653298 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
02:08:29.656700 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
02:08:29.658593 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
02:08:30.141977 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
02:08:30.155255 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
02:08:30.158036 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
02:08:30.160989 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
02:08:30.164077 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
02:08:30.167186 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
02:08:30.169813 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
02:08:30.288756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc938d5c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc937ef68b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc937ef6be0>]}


============================== 2022-06-10 02:15:47.980230 | eb3957be-b2cb-418e-98ab-2cb7814f91f6 ==============================
02:15:47.980253 [info ] [MainThread]: Running with dbt=1.1.0
02:15:47.980898 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:15:47.981428 [debug] [MainThread]: Tracking: tracking
02:15:47.982068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d906f3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d906f34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d906f3550>]}
02:15:48.010979 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
02:15:48.011628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb3957be-b2cb-418e-98ab-2cb7814f91f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d9066db80>]}
02:15:48.047760 [debug] [MainThread]: Parsing macros/match_details.sql
02:15:48.048172 [debug] [MainThread]: Parsing macros/adapters.sql
02:15:48.120194 [debug] [MainThread]: Parsing macros/catalog.sql
02:15:48.124657 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
02:15:48.126642 [debug] [MainThread]: Parsing macros/materializations/merge.sql
02:15:48.134582 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
02:15:48.154687 [debug] [MainThread]: Parsing macros/materializations/table.sql
02:15:48.164410 [debug] [MainThread]: Parsing macros/materializations/view.sql
02:15:48.170132 [debug] [MainThread]: Parsing macros/materializations/seed.sql
02:15:48.189435 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:15:48.214613 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:15:48.243459 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:15:48.257279 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:15:48.264419 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:15:48.270535 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:15:48.277112 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:15:48.284528 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:15:48.287906 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:15:48.290452 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:15:48.292450 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:15:48.301388 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:15:48.306647 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:15:48.307648 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:15:48.308761 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:15:48.309933 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:15:48.311662 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:15:48.314596 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:15:48.319407 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:15:48.321779 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:15:48.324191 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:15:48.329617 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:15:48.347903 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:15:48.355514 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:15:48.357743 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:15:48.370152 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:15:48.390367 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:15:48.404847 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:15:48.422127 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:15:48.439872 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:15:48.451301 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:15:48.453187 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:15:48.458421 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:15:48.463194 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:15:48.465718 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:15:48.476378 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:15:48.479179 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:15:48.482629 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:15:48.490891 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:15:48.494598 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
02:15:48.504337 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
02:15:48.511289 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
02:15:48.512754 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
02:15:48.524123 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
02:15:48.527564 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
02:15:48.530311 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
02:15:48.532712 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
02:15:48.535614 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
02:15:48.539568 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
02:15:48.541867 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
02:15:48.546371 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
02:15:48.548051 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
02:15:48.550118 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
02:15:48.551431 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
02:15:48.563016 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
02:15:48.567336 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
02:15:48.570226 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
02:15:48.573186 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
02:15:48.574845 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
02:15:48.576850 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
02:15:48.578643 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
02:15:48.580583 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
02:15:48.582142 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
02:15:48.588026 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
02:15:48.589419 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
02:15:48.591186 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
02:15:48.593763 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
02:15:48.596777 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
02:15:48.598901 [debug] [MainThread]: Parsing macros/sql/star.sql
02:15:48.603000 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
02:15:48.605042 [debug] [MainThread]: Parsing macros/sql/pivot.sql
02:15:48.609777 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
02:15:48.611887 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
02:15:48.615352 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
02:15:48.624708 [debug] [MainThread]: Parsing macros/sql/union.sql
02:15:48.639698 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
02:15:48.642891 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
02:15:48.653992 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
02:15:48.662153 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
02:15:48.668790 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
02:15:48.676006 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
02:15:48.687510 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
02:15:48.692583 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
02:15:48.700758 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
02:15:48.707926 [debug] [MainThread]: Parsing macros/sql/groupby.sql
02:15:48.710285 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
02:15:48.713679 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
02:15:48.716609 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
02:15:48.719117 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
02:15:48.723081 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
02:15:48.724895 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
02:15:48.726819 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
02:15:48.728427 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
02:15:48.729932 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
02:15:48.757581 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
02:15:48.759969 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
02:15:48.762765 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
02:15:48.765285 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
02:15:48.767660 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
02:15:48.771058 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
02:15:48.774122 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
02:15:48.776521 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
02:15:48.779538 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
02:15:48.789745 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
02:15:48.794168 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
02:15:48.797073 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
02:15:48.798847 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
02:15:48.800579 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
02:15:48.802770 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
02:15:48.807311 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
02:15:48.810285 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
02:15:49.468396 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
02:15:49.492211 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
02:15:49.495822 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
02:15:49.500178 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
02:15:49.506459 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
02:15:49.510335 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
02:15:49.512951 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
02:15:49.710081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc4b20ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc3c95280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5dc3c9c5e0>]}


============================== 2022-06-10 02:55:58.342322 | 6e7e1dfb-f885-48ab-9e51-a7510a725aa2 ==============================
02:55:58.342338 [info ] [MainThread]: Running with dbt=1.1.0
02:55:58.342911 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
02:55:58.343134 [debug] [MainThread]: Tracking: tracking
02:55:58.344373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c59b07850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c59b07910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c59b07a60>]}
02:55:58.345228 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4u_2ye3z'
02:55:58.345739 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
02:55:58.721660 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
02:55:58.722951 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
02:55:59.032727 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
02:55:59.103756 [info ] [MainThread]: Installing dbt-labs/dbt_utils
02:55:59.691683 [info ] [MainThread]:   Installed from version 0.8.5
02:55:59.692146 [info ] [MainThread]:   Up to date!
02:55:59.692568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6e7e1dfb-f885-48ab-9e51-a7510a725aa2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c59b72610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c59afc8b0>]}
02:55:59.693310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c5ef94ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c59a6c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c59b079a0>]}


============================== 2022-06-10 02:56:05.109829 | 97e2b740-ca9b-4d07-98c9-675c82132e56 ==============================
02:56:05.109855 [info ] [MainThread]: Running with dbt=1.1.0
02:56:05.110562 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:56:05.110782 [debug] [MainThread]: Tracking: do not track
02:56:05.138553 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
02:56:05.170012 [debug] [MainThread]: Parsing macros/match_details.sql
02:56:05.170574 [debug] [MainThread]: Parsing macros/adapters.sql
02:56:05.227879 [debug] [MainThread]: Parsing macros/catalog.sql
02:56:05.230654 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
02:56:05.233115 [debug] [MainThread]: Parsing macros/materializations/merge.sql
02:56:05.240247 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
02:56:05.254467 [debug] [MainThread]: Parsing macros/materializations/table.sql
02:56:05.259297 [debug] [MainThread]: Parsing macros/materializations/view.sql
02:56:05.261217 [debug] [MainThread]: Parsing macros/materializations/seed.sql
02:56:05.270429 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:56:05.289218 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:56:05.306744 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:56:05.315269 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:56:05.320596 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:56:05.326294 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:56:05.330341 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:56:05.343164 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:56:05.346922 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:56:05.349828 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:56:05.351766 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:56:05.363317 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:56:05.368555 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:56:05.370214 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:56:05.371504 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:56:05.372725 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:56:05.374582 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:56:05.378176 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:56:05.382758 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:56:05.385676 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:56:05.388088 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:56:05.394219 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:56:05.414690 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:56:05.422836 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:56:05.425666 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:56:05.439918 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:56:05.463034 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:56:05.477817 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:56:05.495651 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:56:05.512970 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:56:05.524967 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:56:05.527161 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:56:05.533182 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:56:05.536986 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:56:05.538910 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:56:05.546976 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:56:05.550879 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:56:05.554303 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:56:05.562776 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:56:05.567339 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
02:56:05.577705 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
02:56:05.584114 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
02:56:05.585326 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
02:56:05.596082 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
02:56:05.598339 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
02:56:05.600139 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
02:56:05.601609 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
02:56:05.603441 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
02:56:05.607495 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
02:56:05.609793 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
02:56:05.613978 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
02:56:05.615595 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
02:56:05.617505 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
02:56:05.618831 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
02:56:05.625996 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
02:56:05.629807 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
02:56:05.632305 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
02:56:05.635070 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
02:56:05.636672 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
02:56:05.638834 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
02:56:05.640635 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
02:56:05.642432 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
02:56:05.643877 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
02:56:05.649752 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
02:56:05.651097 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
02:56:05.652968 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
02:56:05.656035 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
02:56:05.659528 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
02:56:05.661720 [debug] [MainThread]: Parsing macros/sql/star.sql
02:56:05.665718 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
02:56:05.667757 [debug] [MainThread]: Parsing macros/sql/pivot.sql
02:56:05.673107 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
02:56:05.675549 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
02:56:05.678727 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
02:56:05.688360 [debug] [MainThread]: Parsing macros/sql/union.sql
02:56:05.701296 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
02:56:05.704175 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
02:56:05.711785 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
02:56:05.717236 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
02:56:05.721556 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
02:56:05.725960 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
02:56:05.734323 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
02:56:05.739319 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
02:56:05.748035 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
02:56:05.756711 [debug] [MainThread]: Parsing macros/sql/groupby.sql
02:56:05.758624 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
02:56:05.760729 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
02:56:05.763403 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
02:56:05.765812 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
02:56:05.769698 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
02:56:05.771121 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
02:56:05.773061 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
02:56:05.774732 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
02:56:05.776221 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
02:56:05.803564 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
02:56:05.805677 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
02:56:05.807948 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
02:56:05.810148 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
02:56:05.812267 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
02:56:05.815965 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
02:56:05.818616 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
02:56:05.820595 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
02:56:05.823401 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
02:56:05.832181 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
02:56:05.836278 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
02:56:05.838726 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
02:56:05.840159 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
02:56:05.841621 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
02:56:05.843386 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
02:56:05.846562 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
02:56:05.848440 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
02:56:06.673371 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
02:56:06.693049 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
02:56:06.698321 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
02:56:06.702812 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
02:56:06.708063 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
02:56:06.711894 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
02:56:06.716192 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 22:01:32.234667 | 53ec5c66-4cca-4606-af42-4c744e3f530f ==============================
22:01:32.234684 [info ] [MainThread]: Running with dbt=1.1.0
22:01:32.236062 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
22:01:32.236274 [debug] [MainThread]: Tracking: tracking
22:01:32.237561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d5608b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d5608b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d5608bac0>]}
22:01:32.238497 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-3uu5avez'
22:01:32.239079 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
22:01:32.470024 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
22:01:32.471107 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
22:01:32.657935 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
22:01:32.729402 [info ] [MainThread]: Installing dbt-labs/dbt_utils
22:01:33.311478 [info ] [MainThread]:   Installed from version 0.8.5
22:01:33.311913 [info ] [MainThread]:   Up to date!
22:01:33.312334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '53ec5c66-4cca-4606-af42-4c744e3f530f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d5607f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d55ff6ee0>]}
22:01:33.313015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d5b519d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d560f7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6d560f7790>]}


============================== 2022-06-10 22:01:37.940829 | 30958a34-8b5f-45d8-82c4-9b4500020674 ==============================
22:01:37.940847 [info ] [MainThread]: Running with dbt=1.1.0
22:01:37.941475 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:01:37.941727 [debug] [MainThread]: Tracking: do not track
22:01:37.970674 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
22:01:38.033862 [debug] [MainThread]: Parsing macros/match_details.sql
22:01:38.034290 [debug] [MainThread]: Parsing macros/adapters.sql
22:01:38.091565 [debug] [MainThread]: Parsing macros/catalog.sql
22:01:38.095223 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
22:01:38.097638 [debug] [MainThread]: Parsing macros/materializations/merge.sql
22:01:38.104573 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
22:01:38.117668 [debug] [MainThread]: Parsing macros/materializations/table.sql
22:01:38.121756 [debug] [MainThread]: Parsing macros/materializations/view.sql
22:01:38.124601 [debug] [MainThread]: Parsing macros/materializations/seed.sql
22:01:38.132968 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:01:38.146617 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:01:38.158972 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:01:38.164460 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:01:38.168351 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:01:38.172300 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:01:38.175921 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:01:38.186650 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:01:38.189626 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:01:38.191959 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:01:38.194396 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:01:38.205240 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:01:38.211713 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:01:38.213238 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:01:38.214782 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:01:38.216100 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:01:38.218002 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:01:38.221776 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:01:38.227650 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:01:38.230711 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:01:38.232903 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:01:38.239816 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:01:38.260116 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:01:38.267602 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:01:38.270053 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:01:38.283012 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:01:38.306153 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:01:38.323250 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:01:38.340834 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:01:38.359397 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:01:38.372815 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:01:38.375157 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:01:38.381370 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:01:38.385101 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:01:38.387619 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:01:38.396557 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:01:38.399621 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:01:38.404676 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:01:38.413119 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:01:38.417605 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
22:01:38.427597 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
22:01:38.434777 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
22:01:38.436428 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
22:01:38.447411 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
22:01:38.450308 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
22:01:38.452244 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
22:01:38.453762 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
22:01:38.455650 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
22:01:38.459301 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
22:01:38.461788 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
22:01:38.466445 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
22:01:38.468028 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
22:01:38.470351 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
22:01:38.471712 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
22:01:38.478779 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
22:01:38.482705 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
22:01:38.485478 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
22:01:38.487874 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
22:01:38.489281 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
22:01:38.491253 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
22:01:38.493157 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
22:01:38.494830 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
22:01:38.496094 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
22:01:38.502351 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
22:01:38.503890 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
22:01:38.505999 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
22:01:38.508688 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
22:01:38.511647 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
22:01:38.514164 [debug] [MainThread]: Parsing macros/sql/star.sql
22:01:38.518957 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
22:01:38.521342 [debug] [MainThread]: Parsing macros/sql/pivot.sql
22:01:38.526748 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
22:01:38.528866 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
22:01:38.532796 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
22:01:38.543372 [debug] [MainThread]: Parsing macros/sql/union.sql
22:01:38.558175 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
22:01:38.560998 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
22:01:38.569891 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
22:01:38.576956 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
22:01:38.582054 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
22:01:38.586631 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
22:01:38.597990 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
22:01:38.603670 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
22:01:38.611485 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
22:01:38.619108 [debug] [MainThread]: Parsing macros/sql/groupby.sql
22:01:38.620911 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
22:01:38.623274 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
22:01:38.626509 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
22:01:38.628419 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
22:01:38.633228 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
22:01:38.634701 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
22:01:38.636443 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
22:01:38.638468 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
22:01:38.639888 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
22:01:38.668915 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
22:01:38.671604 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
22:01:38.674578 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
22:01:38.677047 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
22:01:38.679518 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
22:01:38.682927 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
22:01:38.686127 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
22:01:38.688603 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
22:01:38.691433 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
22:01:38.701558 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
22:01:38.706041 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
22:01:38.709123 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
22:01:38.710704 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
22:01:38.712253 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
22:01:38.714959 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
22:01:38.718380 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
22:01:38.721186 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
22:01:39.254009 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
22:01:39.268106 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
22:01:39.271589 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
22:01:39.274612 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
22:01:39.278319 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
22:01:39.281934 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
22:01:39.284976 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 22:32:08.688174 | 96856f1d-189b-4f23-9082-9e8d3333d8ab ==============================
22:32:08.688195 [info ] [MainThread]: Running with dbt=1.1.0
22:32:08.688786 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
22:32:08.689053 [debug] [MainThread]: Tracking: tracking
22:32:08.690275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb7a2db850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb7a2db910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb7a2dba60>]}
22:32:08.691392 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8z_54u50'
22:32:08.692039 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
22:32:09.191724 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
22:32:09.192513 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
22:32:09.513461 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
22:32:09.569495 [info ] [MainThread]: Installing dbt-labs/dbt_utils
22:32:10.267289 [info ] [MainThread]:   Installed from version 0.8.5
22:32:10.267846 [info ] [MainThread]:   Up to date!
22:32:10.268399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '96856f1d-189b-4f23-9082-9e8d3333d8ab', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb7a346550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb7a2d08b0>]}
22:32:10.268997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb7f768ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb7a240940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb7a2db9a0>]}


============================== 2022-06-10 22:32:15.516759 | 869765b7-e93a-4f75-b602-4592843ada86 ==============================
22:32:15.516781 [info ] [MainThread]: Running with dbt=1.1.0
22:32:15.517387 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:32:15.517605 [debug] [MainThread]: Tracking: do not track
22:32:15.540157 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
22:32:15.563572 [debug] [MainThread]: Parsing macros/match_details.sql
22:32:15.564094 [debug] [MainThread]: Parsing macros/adapters.sql
22:32:15.620098 [debug] [MainThread]: Parsing macros/catalog.sql
22:32:15.623021 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
22:32:15.624917 [debug] [MainThread]: Parsing macros/materializations/merge.sql
22:32:15.630840 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
22:32:15.641000 [debug] [MainThread]: Parsing macros/materializations/table.sql
22:32:15.644696 [debug] [MainThread]: Parsing macros/materializations/view.sql
22:32:15.646468 [debug] [MainThread]: Parsing macros/materializations/seed.sql
22:32:15.652690 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:32:15.664883 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:32:15.676563 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:32:15.682087 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:32:15.685725 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:32:15.689089 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:32:15.691915 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:32:15.704999 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:32:15.710940 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:32:15.713493 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:32:15.717231 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:32:15.745806 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:32:15.752936 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:32:15.754305 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:32:15.756195 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:32:15.757344 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:32:15.759510 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:32:15.763085 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:32:15.769767 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:32:15.773261 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:32:15.776329 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:32:15.782910 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:32:15.806291 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:32:15.815566 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:32:15.818576 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:32:15.832728 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:32:15.858675 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:32:15.873485 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:32:15.894408 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:32:15.914579 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:32:15.927674 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:32:15.929846 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:32:15.935241 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:32:15.938690 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:32:15.940548 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:32:15.951044 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:32:15.955880 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:32:15.960115 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:32:15.969463 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:32:15.973583 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
22:32:15.985273 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
22:32:15.993464 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
22:32:15.995479 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
22:32:16.007660 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
22:32:16.010559 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
22:32:16.012942 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
22:32:16.014955 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
22:32:16.017791 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
22:32:16.021553 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
22:32:16.024431 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
22:32:16.028846 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
22:32:16.030721 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
22:32:16.032985 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
22:32:16.034882 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
22:32:16.042652 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
22:32:16.047336 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
22:32:16.050289 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
22:32:16.053381 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
22:32:16.055093 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
22:32:16.057559 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
22:32:16.059295 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
22:32:16.061236 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
22:32:16.062674 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
22:32:16.069261 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
22:32:16.070805 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
22:32:16.072638 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
22:32:16.075471 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
22:32:16.078780 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
22:32:16.081131 [debug] [MainThread]: Parsing macros/sql/star.sql
22:32:16.086318 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
22:32:16.088577 [debug] [MainThread]: Parsing macros/sql/pivot.sql
22:32:16.093568 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
22:32:16.095706 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
22:32:16.099805 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
22:32:16.109718 [debug] [MainThread]: Parsing macros/sql/union.sql
22:32:16.123498 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
22:32:16.125912 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
22:32:16.133422 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
22:32:16.138650 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
22:32:16.143065 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
22:32:16.147666 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
22:32:16.156939 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
22:32:16.162984 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
22:32:16.171864 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
22:32:16.181726 [debug] [MainThread]: Parsing macros/sql/groupby.sql
22:32:16.185538 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
22:32:16.190378 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
22:32:16.193974 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
22:32:16.197528 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
22:32:16.202630 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
22:32:16.204688 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
22:32:16.206572 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
22:32:16.208570 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
22:32:16.211882 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
22:32:16.246527 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
22:32:16.249432 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
22:32:16.252912 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
22:32:16.255855 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
22:32:16.257958 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
22:32:16.261694 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
22:32:16.264405 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
22:32:16.267006 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
22:32:16.270097 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
22:32:16.280342 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
22:32:16.285262 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
22:32:16.289774 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
22:32:16.291821 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
22:32:16.294371 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
22:32:16.296520 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
22:32:16.300476 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
22:32:16.302766 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
22:32:16.873863 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
22:32:16.889132 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
22:32:16.892964 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
22:32:16.896200 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
22:32:16.900045 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
22:32:16.903280 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
22:32:16.907173 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-10 22:32:46.389304 | c067838a-8510-487b-ab31-051aeaecc631 ==============================
22:32:46.389324 [info ] [MainThread]: Running with dbt=1.1.0
22:32:46.390045 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
22:32:46.390618 [debug] [MainThread]: Tracking: tracking
22:32:46.391944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfeb64e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfeb64220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfeb64700>]}
22:32:46.392939 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-6ntywug5'
22:32:46.393398 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
22:32:46.612481 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
22:32:46.613227 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
22:32:46.800901 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
22:32:46.871150 [info ] [MainThread]: Installing dbt-labs/dbt_utils
22:32:47.434703 [info ] [MainThread]:   Installed from version 0.8.5
22:32:47.435131 [info ] [MainThread]:   Up to date!
22:32:47.435562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c067838a-8510-487b-ab31-051aeaecc631', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfeb64730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfece9550>]}
22:32:47.436481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d03f282e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfeb4e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cfeb5c3d0>]}


============================== 2022-06-10 22:32:52.458685 | a768be7c-cdeb-4bcb-9c93-732f85c9f08d ==============================
22:32:52.458705 [info ] [MainThread]: Running with dbt=1.1.0
22:32:52.459309 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
22:32:52.459505 [debug] [MainThread]: Tracking: do not track
22:32:52.479881 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
22:32:52.501220 [debug] [MainThread]: Parsing macros/match_details.sql
22:32:52.501588 [debug] [MainThread]: Parsing macros/adapters.sql
22:32:52.552353 [debug] [MainThread]: Parsing macros/catalog.sql
22:32:52.555903 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
22:32:52.557523 [debug] [MainThread]: Parsing macros/materializations/merge.sql
22:32:52.564393 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
22:32:52.578632 [debug] [MainThread]: Parsing macros/materializations/table.sql
22:32:52.582963 [debug] [MainThread]: Parsing macros/materializations/view.sql
22:32:52.585209 [debug] [MainThread]: Parsing macros/materializations/seed.sql
22:32:52.592503 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:32:52.605835 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:32:52.619259 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:32:52.625589 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:32:52.629586 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:32:52.633681 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:32:52.636881 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:32:52.653675 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:32:52.659756 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:32:52.663222 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:32:52.675674 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:32:52.690907 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:32:52.700204 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:32:52.702224 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:32:52.703541 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:32:52.704782 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:32:52.706626 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:32:52.709745 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:32:52.714516 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:32:52.717654 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:32:52.720193 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:32:52.727077 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:32:52.745298 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:32:52.753003 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:32:52.754881 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:32:52.766333 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:32:52.786003 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:32:52.800661 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:32:52.818945 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:32:52.836746 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:32:52.849018 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:32:52.850898 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:32:52.856542 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:32:52.859845 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:32:52.861747 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:32:52.869563 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:32:52.872354 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:32:52.875990 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:32:52.883758 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:32:52.887238 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
22:32:52.896624 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
22:32:52.903224 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
22:32:52.904521 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
22:32:52.915687 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
22:32:52.918102 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
22:32:52.919855 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
22:32:52.921593 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
22:32:52.923472 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
22:32:52.926703 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
22:32:52.928954 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
22:32:52.933183 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
22:32:52.934732 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
22:32:52.936888 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
22:32:52.938113 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
22:32:52.945014 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
22:32:52.948884 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
22:32:52.951835 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
22:32:52.954322 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
22:32:52.955747 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
22:32:52.957498 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
22:32:52.958979 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
22:32:52.960610 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
22:32:52.961899 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
22:32:52.967511 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
22:32:52.968815 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
22:32:52.970513 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
22:32:52.973134 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
22:32:52.976184 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
22:32:52.978060 [debug] [MainThread]: Parsing macros/sql/star.sql
22:32:52.982028 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
22:32:52.984207 [debug] [MainThread]: Parsing macros/sql/pivot.sql
22:32:52.989085 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
22:32:52.991008 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
22:32:52.994333 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
22:32:53.003904 [debug] [MainThread]: Parsing macros/sql/union.sql
22:32:53.015948 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
22:32:53.018109 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
22:32:53.024698 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
22:32:53.029701 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
22:32:53.033920 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
22:32:53.038248 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
22:32:53.046264 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
22:32:53.051357 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
22:32:53.058375 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
22:32:53.065545 [debug] [MainThread]: Parsing macros/sql/groupby.sql
22:32:53.067235 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
22:32:53.069322 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
22:32:53.072030 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
22:32:53.073757 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
22:32:53.077612 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
22:32:53.079229 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
22:32:53.080697 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
22:32:53.082105 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
22:32:53.083555 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
22:32:53.110458 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
22:32:53.112823 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
22:32:53.115340 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
22:32:53.117977 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
22:32:53.119848 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
22:32:53.123162 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
22:32:53.126239 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
22:32:53.128448 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
22:32:53.131424 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
22:32:53.141196 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
22:32:53.145785 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
22:32:53.148511 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
22:32:53.150065 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
22:32:53.151688 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
22:32:53.153668 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
22:32:53.157017 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
22:32:53.159734 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
22:32:53.657352 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
22:32:53.671434 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
22:32:53.674827 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
22:32:53.677964 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
22:32:53.681839 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
22:32:53.684819 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
22:32:53.688436 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-11 04:10:03.867173 | 6d6f499c-be26-40c7-964d-33f1f928c871 ==============================
04:10:03.867242 [info ] [MainThread]: Running with dbt=1.1.0
04:10:03.868062 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
04:10:03.868353 [debug] [MainThread]: Tracking: tracking
04:10:03.869850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6042bc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6042bc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6042bcb20>]}
04:10:03.870959 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p90sjorn'
04:10:03.871595 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
04:10:04.070029 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
04:10:04.070977 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
04:10:04.195042 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
04:10:04.265837 [info ] [MainThread]: Installing dbt-labs/dbt_utils
04:10:04.896628 [info ] [MainThread]:   Installed from version 0.8.5
04:10:04.897289 [info ] [MainThread]:   Up to date!
04:10:04.898044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6d6f499c-be26-40c7-964d-33f1f928c871', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd604227580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6041947f0>]}
04:10:04.899456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd609724d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6042b09a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd60433c160>]}


============================== 2022-06-11 04:10:10.507995 | b7c3cf57-b525-4728-8e47-0f2497557203 ==============================
04:10:10.508029 [info ] [MainThread]: Running with dbt=1.1.0
04:10:10.508932 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
04:10:10.509424 [debug] [MainThread]: Tracking: do not track
04:10:10.540324 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
04:10:10.571884 [debug] [MainThread]: Parsing macros/match_details.sql
04:10:10.572412 [debug] [MainThread]: Parsing macros/adapters.sql
04:10:10.627409 [debug] [MainThread]: Parsing macros/catalog.sql
04:10:10.630791 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
04:10:10.632517 [debug] [MainThread]: Parsing macros/materializations/merge.sql
04:10:10.638730 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
04:10:10.654116 [debug] [MainThread]: Parsing macros/materializations/table.sql
04:10:10.659256 [debug] [MainThread]: Parsing macros/materializations/view.sql
04:10:10.662041 [debug] [MainThread]: Parsing macros/materializations/seed.sql
04:10:10.670729 [debug] [MainThread]: Parsing macros/adapters/columns.sql
04:10:10.686237 [debug] [MainThread]: Parsing macros/adapters/relation.sql
04:10:10.701635 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
04:10:10.709333 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
04:10:10.714277 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
04:10:10.718968 [debug] [MainThread]: Parsing macros/adapters/schema.sql
04:10:10.724247 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
04:10:10.735325 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
04:10:10.739483 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
04:10:10.742100 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
04:10:10.744497 [debug] [MainThread]: Parsing macros/etc/datetime.sql
04:10:10.756466 [debug] [MainThread]: Parsing macros/etc/statement.sql
04:10:10.764104 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
04:10:10.765422 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
04:10:10.766781 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
04:10:10.768665 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
04:10:10.770830 [debug] [MainThread]: Parsing macros/materializations/configs.sql
04:10:10.774572 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
04:10:10.780705 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
04:10:10.783753 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
04:10:10.786558 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
04:10:10.793148 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
04:10:10.814371 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
04:10:10.823515 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
04:10:10.826346 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
04:10:10.840857 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
04:10:10.864997 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
04:10:10.882124 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
04:10:10.902787 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
04:10:10.925013 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
04:10:10.940288 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
04:10:10.942940 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
04:10:10.949878 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
04:10:10.953959 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
04:10:10.956435 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
04:10:10.966511 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
04:10:10.970381 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
04:10:10.975364 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
04:10:10.986510 [debug] [MainThread]: Parsing tests/generic/builtin.sql
04:10:10.991916 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
04:10:11.004571 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
04:10:11.013256 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
04:10:11.014880 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
04:10:11.029460 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
04:10:11.032413 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
04:10:11.035240 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
04:10:11.037215 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
04:10:11.039454 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
04:10:11.043632 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
04:10:11.046434 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
04:10:11.051952 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
04:10:11.053975 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
04:10:11.056443 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
04:10:11.058035 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
04:10:11.067338 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
04:10:11.072581 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
04:10:11.076102 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
04:10:11.079959 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
04:10:11.082817 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
04:10:11.085857 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
04:10:11.088800 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
04:10:11.091602 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
04:10:11.093910 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
04:10:11.102470 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
04:10:11.104274 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
04:10:11.106541 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
04:10:11.110065 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
04:10:11.114316 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
04:10:11.117186 [debug] [MainThread]: Parsing macros/sql/star.sql
04:10:11.122470 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
04:10:11.125719 [debug] [MainThread]: Parsing macros/sql/pivot.sql
04:10:11.133395 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
04:10:11.137058 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
04:10:11.142245 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
04:10:11.155640 [debug] [MainThread]: Parsing macros/sql/union.sql
04:10:11.172273 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
04:10:11.175284 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
04:10:11.185332 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
04:10:11.193589 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
04:10:11.199433 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
04:10:11.205262 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
04:10:11.215697 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
04:10:11.222479 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
04:10:11.231449 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
04:10:11.241355 [debug] [MainThread]: Parsing macros/sql/groupby.sql
04:10:11.243547 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
04:10:11.246531 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
04:10:11.250731 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
04:10:11.253545 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
04:10:11.259201 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
04:10:11.261325 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
04:10:11.263522 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
04:10:11.265672 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
04:10:11.268163 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
04:10:11.302445 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
04:10:11.305569 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
04:10:11.308971 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
04:10:11.312176 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
04:10:11.314758 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
04:10:11.319225 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
04:10:11.322749 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
04:10:11.325608 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
04:10:11.329481 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
04:10:11.341115 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
04:10:11.346950 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
04:10:11.350411 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
04:10:11.352622 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
04:10:11.354786 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
04:10:11.357160 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
04:10:11.362130 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
04:10:11.364926 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
04:10:12.046468 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
04:10:12.065522 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
04:10:12.070591 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
04:10:12.075666 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
04:10:12.079784 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
04:10:12.084336 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
04:10:12.088664 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-11 04:13:49.464484 | 08c52086-1b52-4e10-bb86-673406b2cb61 ==============================
04:13:49.464501 [info ] [MainThread]: Running with dbt=1.1.0
04:13:49.465199 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
04:13:49.465545 [debug] [MainThread]: Tracking: tracking
04:13:49.467121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c99e83eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c99e832b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c99e83730>]}
04:13:49.468372 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-s0bvggde'
04:13:49.468899 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
04:13:49.824844 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
04:13:49.826092 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
04:13:50.149949 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
04:13:50.256347 [info ] [MainThread]: Installing dbt-labs/dbt_utils
04:13:50.906134 [info ] [MainThread]:   Installed from version 0.8.5
04:13:50.906731 [info ] [MainThread]:   Up to date!
04:13:50.907403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '08c52086-1b52-4e10-bb86-673406b2cb61', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c99e83760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c9a008670>]}
04:13:50.908179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c99e5a640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c99e6e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7c99e7c3d0>]}


============================== 2022-06-11 04:13:56.373968 | 0d7e9f11-89bd-48ff-b874-872d84f60ad3 ==============================
04:13:56.373994 [info ] [MainThread]: Running with dbt=1.1.0
04:13:56.374818 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
04:13:56.375101 [debug] [MainThread]: Tracking: do not track
04:13:56.409273 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
04:13:56.444376 [debug] [MainThread]: Parsing macros/match_details.sql
04:13:56.444952 [debug] [MainThread]: Parsing macros/adapters.sql
04:13:56.521151 [debug] [MainThread]: Parsing macros/catalog.sql
04:13:56.524622 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
04:13:56.526783 [debug] [MainThread]: Parsing macros/materializations/merge.sql
04:13:56.535370 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
04:13:56.558063 [debug] [MainThread]: Parsing macros/materializations/table.sql
04:13:56.565247 [debug] [MainThread]: Parsing macros/materializations/view.sql
04:13:56.568654 [debug] [MainThread]: Parsing macros/materializations/seed.sql
04:13:56.579847 [debug] [MainThread]: Parsing macros/adapters/columns.sql
04:13:56.601197 [debug] [MainThread]: Parsing macros/adapters/relation.sql
04:13:56.623569 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
04:13:56.633818 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
04:13:56.641132 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
04:13:56.646498 [debug] [MainThread]: Parsing macros/adapters/schema.sql
04:13:56.650959 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
04:13:56.663352 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
04:13:56.667349 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
04:13:56.670685 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
04:13:56.672930 [debug] [MainThread]: Parsing macros/etc/datetime.sql
04:13:56.686104 [debug] [MainThread]: Parsing macros/etc/statement.sql
04:13:56.693859 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
04:13:56.695018 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
04:13:56.696659 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
04:13:56.698188 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
04:13:56.700231 [debug] [MainThread]: Parsing macros/materializations/configs.sql
04:13:56.704051 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
04:13:56.709877 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
04:13:56.712964 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
04:13:56.715550 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
04:13:56.721938 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
04:13:56.747116 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
04:13:56.758384 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
04:13:56.761501 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
04:13:56.778678 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
04:13:56.813649 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
04:13:56.832868 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
04:13:56.857443 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
04:13:56.883058 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
04:13:56.899044 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
04:13:56.901303 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
04:13:56.908647 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
04:13:56.913117 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
04:13:56.915059 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
04:13:56.925621 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
04:13:56.931858 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
04:13:56.938750 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
04:13:56.951637 [debug] [MainThread]: Parsing tests/generic/builtin.sql
04:13:56.956774 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
04:13:56.973084 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
04:13:56.984811 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
04:13:56.989174 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
04:13:57.007751 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
04:13:57.012286 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
04:13:57.015115 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
04:13:57.017311 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
04:13:57.019525 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
04:13:57.024141 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
04:13:57.026935 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
04:13:57.033312 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
04:13:57.035733 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
04:13:57.039162 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
04:13:57.041029 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
04:13:57.052145 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
04:13:57.058267 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
04:13:57.061581 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
04:13:57.065682 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
04:13:57.067475 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
04:13:57.070007 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
04:13:57.072626 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
04:13:57.074869 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
04:13:57.076576 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
04:13:57.083878 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
04:13:57.086523 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
04:13:57.089398 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
04:13:57.093678 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
04:13:57.097595 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
04:13:57.100911 [debug] [MainThread]: Parsing macros/sql/star.sql
04:13:57.106362 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
04:13:57.109047 [debug] [MainThread]: Parsing macros/sql/pivot.sql
04:13:57.115143 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
04:13:57.118243 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
04:13:57.122994 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
04:13:57.135540 [debug] [MainThread]: Parsing macros/sql/union.sql
04:13:57.154181 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
04:13:57.157173 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
04:13:57.167774 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
04:13:57.174198 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
04:13:57.179667 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
04:13:57.185556 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
04:13:57.197123 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
04:13:57.203845 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
04:13:57.213478 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
04:13:57.225172 [debug] [MainThread]: Parsing macros/sql/groupby.sql
04:13:57.228828 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
04:13:57.233782 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
04:13:57.239853 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
04:13:57.242975 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
04:13:57.251118 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
04:13:57.254179 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
04:13:57.256556 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
04:13:57.259771 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
04:13:57.263129 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
04:13:57.303791 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
04:13:57.307981 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
04:13:57.312741 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
04:13:57.317480 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
04:13:57.321147 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
04:13:57.327493 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
04:13:57.332604 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
04:13:57.336773 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
04:13:57.340573 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
04:13:57.353888 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
04:13:57.360265 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
04:13:57.364479 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
04:13:57.367237 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
04:13:57.369854 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
04:13:57.373194 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
04:13:57.377827 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
04:13:57.380702 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
04:13:58.057622 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
04:13:58.081410 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
04:13:58.087060 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
04:13:58.093245 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
04:13:58.098769 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
04:13:58.103967 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
04:13:58.109400 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-11 04:15:26.747662 | 069a83b0-6f39-462f-9b8c-62ffdaef823d ==============================
04:15:26.747686 [info ] [MainThread]: Running with dbt=1.1.0
04:15:26.749034 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
04:15:26.749550 [debug] [MainThread]: Tracking: tracking
04:15:26.751015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fcc82ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fcc65b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fcc65bb0>]}
04:15:26.751960 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-qoii7u7z'
04:15:26.752354 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
04:15:27.150546 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
04:15:27.151880 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
04:15:27.467768 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
04:15:27.557223 [info ] [MainThread]: Installing dbt-labs/dbt_utils
04:15:28.170007 [info ] [MainThread]:   Installed from version 0.8.5
04:15:28.170560 [info ] [MainThread]:   Up to date!
04:15:28.171101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '069a83b0-6f39-462f-9b8c-62ffdaef823d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fcc65bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fce062b0>]}
04:15:28.171807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77020462e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fcc6c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76fcd10ee0>]}


============================== 2022-06-11 04:15:33.120449 | 703ca81e-8839-4247-9304-b5d9808db4b5 ==============================
04:15:33.120471 [info ] [MainThread]: Running with dbt=1.1.0
04:15:33.121037 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
04:15:33.121234 [debug] [MainThread]: Tracking: do not track
04:15:33.144851 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
04:15:33.170444 [debug] [MainThread]: Parsing macros/match_details.sql
04:15:33.170832 [debug] [MainThread]: Parsing macros/adapters.sql
04:15:33.223546 [debug] [MainThread]: Parsing macros/catalog.sql
04:15:33.226169 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
04:15:33.227743 [debug] [MainThread]: Parsing macros/materializations/merge.sql
04:15:33.233339 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
04:15:33.246065 [debug] [MainThread]: Parsing macros/materializations/table.sql
04:15:33.251307 [debug] [MainThread]: Parsing macros/materializations/view.sql
04:15:33.253355 [debug] [MainThread]: Parsing macros/materializations/seed.sql
04:15:33.260624 [debug] [MainThread]: Parsing macros/adapters/columns.sql
04:15:33.274105 [debug] [MainThread]: Parsing macros/adapters/relation.sql
04:15:33.287348 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
04:15:33.293811 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
04:15:33.298412 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
04:15:33.302785 [debug] [MainThread]: Parsing macros/adapters/schema.sql
04:15:33.306219 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
04:15:33.316383 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
04:15:33.319981 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
04:15:33.322201 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
04:15:33.324265 [debug] [MainThread]: Parsing macros/etc/datetime.sql
04:15:33.335149 [debug] [MainThread]: Parsing macros/etc/statement.sql
04:15:33.341232 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
04:15:33.342517 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
04:15:33.343717 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
04:15:33.344929 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
04:15:33.346829 [debug] [MainThread]: Parsing macros/materializations/configs.sql
04:15:33.350210 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
04:15:33.355479 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
04:15:33.358080 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
04:15:33.360752 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
04:15:33.367023 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
04:15:33.387013 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
04:15:33.395934 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
04:15:33.398556 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
04:15:33.412202 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
04:15:33.435791 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
04:15:33.450985 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
04:15:33.469759 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
04:15:33.489831 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
04:15:33.504334 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
04:15:33.506660 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
04:15:33.512907 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
04:15:33.517211 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
04:15:33.519775 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
04:15:33.531300 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
04:15:33.534726 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
04:15:33.538965 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
04:15:33.549082 [debug] [MainThread]: Parsing tests/generic/builtin.sql
04:15:33.554581 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
04:15:33.567489 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
04:15:33.576704 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
04:15:33.579035 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
04:15:33.596551 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
04:15:33.600004 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
04:15:33.602241 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
04:15:33.604907 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
04:15:33.607257 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
04:15:33.612538 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
04:15:33.615444 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
04:15:33.621479 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
04:15:33.623498 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
04:15:33.626650 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
04:15:33.628281 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
04:15:33.636567 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
04:15:33.643485 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
04:15:33.647333 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
04:15:33.650887 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
04:15:33.652778 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
04:15:33.655027 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
04:15:33.657353 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
04:15:33.660358 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
04:15:33.662380 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
04:15:33.671431 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
04:15:33.673658 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
04:15:33.675810 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
04:15:33.678859 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
04:15:33.682759 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
04:15:33.685010 [debug] [MainThread]: Parsing macros/sql/star.sql
04:15:33.690017 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
04:15:33.692491 [debug] [MainThread]: Parsing macros/sql/pivot.sql
04:15:33.698057 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
04:15:33.700335 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
04:15:33.704821 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
04:15:33.715404 [debug] [MainThread]: Parsing macros/sql/union.sql
04:15:33.729735 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
04:15:33.732161 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
04:15:33.740234 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
04:15:33.745997 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
04:15:33.751240 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
04:15:33.756539 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
04:15:33.765837 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
04:15:33.771620 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
04:15:33.779880 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
04:15:33.787913 [debug] [MainThread]: Parsing macros/sql/groupby.sql
04:15:33.789849 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
04:15:33.792194 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
04:15:33.795401 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
04:15:33.797868 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
04:15:33.802456 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
04:15:33.804118 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
04:15:33.806305 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
04:15:33.808073 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
04:15:33.809839 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
04:15:33.840210 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
04:15:33.842900 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
04:15:33.846414 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
04:15:33.849493 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
04:15:33.851630 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
04:15:33.855475 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
04:15:33.858385 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
04:15:33.861147 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
04:15:33.864492 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
04:15:33.875218 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
04:15:33.880442 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
04:15:33.883612 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
04:15:33.885366 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
04:15:33.887470 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
04:15:33.889972 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
04:15:33.893951 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
04:15:33.896290 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
04:15:34.577491 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
04:15:34.594798 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
04:15:34.599230 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
04:15:34.602627 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
04:15:34.607469 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
04:15:34.611727 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
04:15:34.615270 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-11 05:47:29.324101 | b4c9a727-129f-4849-92ad-5c35fb87cffb ==============================
05:47:29.324118 [info ] [MainThread]: Running with dbt=1.1.0
05:47:29.324571 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
05:47:29.324771 [debug] [MainThread]: Tracking: tracking
05:47:29.326046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fb465f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fb465b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34fb465d90>]}
05:47:30.248247 [debug] [MainThread]: Executing "git --help"
05:47:30.263132 [debug] [MainThread]: Acquiring new snowflake connection "debug"
05:47:30.265615 [debug] [MainThread]: Using snowflake connection "debug"
05:47:30.265945 [debug] [MainThread]: On debug: select 1 as id
05:47:30.266389 [debug] [MainThread]: Opening a new connection, currently in state init
05:47:31.326458 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.06 seconds
05:47:31.328541 [debug] [MainThread]: On debug: Close
05:47:31.453842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c80efd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c80df0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34c80df370>]}
05:47:31.843368 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-11 06:04:35.760030 | 68d24a46-7eba-472d-bc46-fac40b197916 ==============================
06:04:35.760051 [info ] [MainThread]: Running with dbt=1.1.0
06:04:35.760750 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
06:04:35.761031 [debug] [MainThread]: Tracking: tracking
06:04:35.762756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a055b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a055b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a055ba60>]}
06:04:35.764474 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-542pbn07'
06:04:35.765140 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
06:04:36.233512 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
06:04:36.234390 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
06:04:36.550366 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
06:04:36.622319 [info ] [MainThread]: Installing dbt-labs/dbt_utils
06:04:37.231468 [info ] [MainThread]:   Installed from version 0.8.5
06:04:37.232220 [info ] [MainThread]:   Up to date!
06:04:37.232766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '68d24a46-7eba-472d-bc46-fac40b197916', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a04339a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a0433400>]}
06:04:37.233582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a59e8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a04c0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4a055ba60>]}


============================== 2022-06-11 06:04:43.442161 | e2d6b891-0188-4d8a-b39d-874722f9eed6 ==============================
06:04:43.442189 [info ] [MainThread]: Running with dbt=1.1.0
06:04:43.443213 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
06:04:43.443938 [debug] [MainThread]: Tracking: do not track
06:04:43.477524 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
06:04:43.506918 [debug] [MainThread]: Parsing macros/match_details.sql
06:04:43.507452 [debug] [MainThread]: Parsing macros/adapters.sql
06:04:43.563349 [debug] [MainThread]: Parsing macros/catalog.sql
06:04:43.567015 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
06:04:43.568906 [debug] [MainThread]: Parsing macros/materializations/merge.sql
06:04:43.574693 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
06:04:43.593245 [debug] [MainThread]: Parsing macros/materializations/table.sql
06:04:43.600398 [debug] [MainThread]: Parsing macros/materializations/view.sql
06:04:43.602910 [debug] [MainThread]: Parsing macros/materializations/seed.sql
06:04:43.612838 [debug] [MainThread]: Parsing macros/adapters/columns.sql
06:04:43.629812 [debug] [MainThread]: Parsing macros/adapters/relation.sql
06:04:43.647446 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
06:04:43.655256 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
06:04:43.660977 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
06:04:43.666128 [debug] [MainThread]: Parsing macros/adapters/schema.sql
06:04:43.669926 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
06:04:43.681754 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
06:04:43.685963 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
06:04:43.688775 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
06:04:43.691422 [debug] [MainThread]: Parsing macros/etc/datetime.sql
06:04:43.704730 [debug] [MainThread]: Parsing macros/etc/statement.sql
06:04:43.711642 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
06:04:43.713126 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
06:04:43.714871 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
06:04:43.716519 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
06:04:43.718966 [debug] [MainThread]: Parsing macros/materializations/configs.sql
06:04:43.722915 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
06:04:43.728972 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
06:04:43.732007 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
06:04:43.735145 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
06:04:43.742142 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
06:04:43.764418 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
06:04:43.773390 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
06:04:43.776182 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
06:04:43.791544 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
06:04:43.819002 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
06:04:43.839483 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
06:04:43.860859 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
06:04:43.882953 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
06:04:43.900601 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
06:04:43.904286 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
06:04:43.914416 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
06:04:43.920733 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
06:04:43.923039 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
06:04:43.933022 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
06:04:43.937085 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
06:04:43.941879 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
06:04:43.952578 [debug] [MainThread]: Parsing tests/generic/builtin.sql
06:04:43.957831 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
06:04:43.971442 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
06:04:43.983896 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
06:04:43.985701 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
06:04:43.999652 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
06:04:44.002994 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
06:04:44.006198 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
06:04:44.009433 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
06:04:44.012556 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
06:04:44.018214 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
06:04:44.021584 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
06:04:44.029645 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
06:04:44.032203 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
06:04:44.035187 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
06:04:44.037412 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
06:04:44.049525 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
06:04:44.056175 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
06:04:44.060276 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
06:04:44.064591 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
06:04:44.066879 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
06:04:44.070013 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
06:04:44.072464 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
06:04:44.075648 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
06:04:44.077550 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
06:04:44.086950 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
06:04:44.089147 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
06:04:44.092319 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
06:04:44.096193 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
06:04:44.101867 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
06:04:44.106532 [debug] [MainThread]: Parsing macros/sql/star.sql
06:04:44.114503 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
06:04:44.117564 [debug] [MainThread]: Parsing macros/sql/pivot.sql
06:04:44.124179 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
06:04:44.127066 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
06:04:44.131979 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
06:04:44.143912 [debug] [MainThread]: Parsing macros/sql/union.sql
06:04:44.158905 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
06:04:44.162110 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
06:04:44.170896 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
06:04:44.178327 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
06:04:44.183348 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
06:04:44.188660 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
06:04:44.199117 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
06:04:44.205822 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
06:04:44.215121 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
06:04:44.224258 [debug] [MainThread]: Parsing macros/sql/groupby.sql
06:04:44.226374 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
06:04:44.229000 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
06:04:44.232439 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
06:04:44.234902 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
06:04:44.240101 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
06:04:44.241776 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
06:04:44.243811 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
06:04:44.245772 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
06:04:44.247545 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
06:04:44.280161 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
06:04:44.283103 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
06:04:44.286627 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
06:04:44.289879 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
06:04:44.292381 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
06:04:44.297237 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
06:04:44.301001 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
06:04:44.304013 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
06:04:44.307809 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
06:04:44.319247 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
06:04:44.324657 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
06:04:44.328552 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
06:04:44.331435 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
06:04:44.333703 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
06:04:44.336190 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
06:04:44.340470 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
06:04:44.343115 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
06:04:44.989535 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
06:04:45.006728 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
06:04:45.010629 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
06:04:45.014516 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
06:04:45.018853 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
06:04:45.023114 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
06:04:45.027526 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-11 06:09:51.823614 | d565a81c-1f45-487b-af06-f9e198f4b2a5 ==============================
06:09:51.823639 [info ] [MainThread]: Running with dbt=1.1.0
06:09:51.824647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
06:09:51.824916 [debug] [MainThread]: Tracking: tracking
06:09:51.826311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65afde4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65afde4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65afde4700>]}
06:09:51.827346 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1tnpv8u8'
06:09:51.827924 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
06:09:52.080346 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
06:09:52.081303 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
06:09:52.260023 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
06:09:52.343653 [info ] [MainThread]: Installing dbt-labs/dbt_utils
06:09:52.942314 [info ] [MainThread]:   Installed from version 0.8.5
06:09:52.943152 [info ] [MainThread]:   Up to date!
06:09:52.943891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd565a81c-1f45-487b-af06-f9e198f4b2a5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65afd3bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65afedaa90>]}
06:09:52.944986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65afdeaac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65afd58be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65afd43610>]}


============================== 2022-06-11 06:09:58.677759 | 38b608d0-8414-401f-85ea-dea7d10d56a1 ==============================
06:09:58.677792 [info ] [MainThread]: Running with dbt=1.1.0
06:09:58.678637 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
06:09:58.679014 [debug] [MainThread]: Tracking: do not track
06:09:58.711028 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
06:09:58.750153 [debug] [MainThread]: Parsing macros/match_details.sql
06:09:58.750994 [debug] [MainThread]: Parsing macros/adapters.sql
06:09:58.819299 [debug] [MainThread]: Parsing macros/catalog.sql
06:09:58.822338 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
06:09:58.824017 [debug] [MainThread]: Parsing macros/materializations/merge.sql
06:09:58.830146 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
06:09:58.847439 [debug] [MainThread]: Parsing macros/materializations/table.sql
06:09:58.853740 [debug] [MainThread]: Parsing macros/materializations/view.sql
06:09:58.856141 [debug] [MainThread]: Parsing macros/materializations/seed.sql
06:09:58.864268 [debug] [MainThread]: Parsing macros/adapters/columns.sql
06:09:58.880134 [debug] [MainThread]: Parsing macros/adapters/relation.sql
06:09:58.895307 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
06:09:58.903113 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
06:09:58.908420 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
06:09:58.915113 [debug] [MainThread]: Parsing macros/adapters/schema.sql
06:09:58.921635 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
06:09:58.935819 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
06:09:58.939871 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
06:09:58.942526 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
06:09:58.945396 [debug] [MainThread]: Parsing macros/etc/datetime.sql
06:09:58.958579 [debug] [MainThread]: Parsing macros/etc/statement.sql
06:09:58.965854 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
06:09:58.967376 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
06:09:58.968819 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
06:09:58.970272 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
06:09:58.972735 [debug] [MainThread]: Parsing macros/materializations/configs.sql
06:09:58.977281 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
06:09:58.983508 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
06:09:58.986668 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
06:09:58.989768 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
06:09:58.997135 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
06:09:59.022440 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
06:09:59.032828 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
06:09:59.035631 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
06:09:59.050570 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
06:09:59.075811 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
06:09:59.094550 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
06:09:59.116513 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
06:09:59.139270 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
06:09:59.154504 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
06:09:59.157031 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
06:09:59.164436 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
06:09:59.169240 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
06:09:59.171834 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
06:09:59.182633 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
06:09:59.186874 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
06:09:59.192216 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
06:09:59.203361 [debug] [MainThread]: Parsing tests/generic/builtin.sql
06:09:59.208484 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
06:09:59.221397 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
06:09:59.230928 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
06:09:59.232960 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
06:09:59.247046 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
06:09:59.250060 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
06:09:59.252805 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
06:09:59.255671 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
06:09:59.258591 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
06:09:59.262946 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
06:09:59.266693 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
06:09:59.272978 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
06:09:59.275028 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
06:09:59.277818 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
06:09:59.279662 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
06:09:59.289898 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
06:09:59.295442 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
06:09:59.299794 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
06:09:59.303434 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
06:09:59.305449 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
06:09:59.308594 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
06:09:59.310895 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
06:09:59.313509 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
06:09:59.316980 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
06:09:59.325794 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
06:09:59.327693 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
06:09:59.330248 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
06:09:59.334158 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
06:09:59.338286 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
06:09:59.341065 [debug] [MainThread]: Parsing macros/sql/star.sql
06:09:59.346422 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
06:09:59.350269 [debug] [MainThread]: Parsing macros/sql/pivot.sql
06:09:59.357192 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
06:09:59.359919 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
06:09:59.364415 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
06:09:59.376055 [debug] [MainThread]: Parsing macros/sql/union.sql
06:09:59.391788 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
06:09:59.395220 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
06:09:59.405977 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
06:09:59.413024 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
06:09:59.419148 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
06:09:59.425010 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
06:09:59.437586 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
06:09:59.444089 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
06:09:59.453506 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
06:09:59.462982 [debug] [MainThread]: Parsing macros/sql/groupby.sql
06:09:59.465322 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
06:09:59.468207 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
06:09:59.472053 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
06:09:59.475133 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
06:09:59.481006 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
06:09:59.483517 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
06:09:59.485674 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
06:09:59.488276 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
06:09:59.490716 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
06:09:59.527410 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
06:09:59.530814 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
06:09:59.534317 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
06:09:59.538016 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
06:09:59.540449 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
06:09:59.544970 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
06:09:59.548368 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
06:09:59.551847 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
06:09:59.555732 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
06:09:59.567723 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
06:09:59.573405 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
06:09:59.577017 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
06:09:59.579138 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
06:09:59.581190 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
06:09:59.584638 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
06:09:59.588934 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
06:09:59.591540 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
06:10:00.303740 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
06:10:00.322443 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
06:10:00.327588 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
06:10:00.333953 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
06:10:00.340101 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
06:10:00.344559 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
06:10:00.348772 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql


============================== 2022-06-11 07:00:31.373930 | 42c3ce79-21c2-437f-9a1c-b9781d57fac0 ==============================
07:00:31.373947 [info ] [MainThread]: Running with dbt=1.1.0
07:00:31.374446 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
07:00:31.374663 [debug] [MainThread]: Tracking: tracking
07:00:31.376107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c99a82b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c99a8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c99a8c70>]}
07:00:31.377267 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-l3zjlksg'
07:00:31.377790 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
07:00:31.755913 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
07:00:31.756992 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
07:00:32.071868 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
07:00:32.143210 [info ] [MainThread]: Installing dbt-labs/dbt_utils
07:00:32.692602 [info ] [MainThread]:   Installed from version 0.8.5
07:00:32.693079 [info ] [MainThread]:   Up to date!
07:00:32.693494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '42c3ce79-21c2-437f-9a1c-b9781d57fac0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c99a8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9b2c520>]}
07:00:32.694123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c9b37790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c99a8ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47c99a80a0>]}


============================== 2022-06-11 07:00:37.685765 | 5be4eec9-7e43-404f-be69-faa769430b48 ==============================
07:00:37.685788 [info ] [MainThread]: Running with dbt=1.1.0
07:00:37.686538 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:00:37.687058 [debug] [MainThread]: Tracking: tracking
07:00:37.687622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce80e5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce80e57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce80e5850>]}
07:00:37.712510 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
07:00:37.713153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce8046c40>]}
07:00:37.741362 [debug] [MainThread]: Parsing macros/match_details.sql
07:00:37.741966 [debug] [MainThread]: Parsing macros/adapters.sql
07:00:37.793787 [debug] [MainThread]: Parsing macros/catalog.sql
07:00:37.796379 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
07:00:37.797706 [debug] [MainThread]: Parsing macros/materializations/merge.sql
07:00:37.804392 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
07:00:37.821148 [debug] [MainThread]: Parsing macros/materializations/table.sql
07:00:37.827028 [debug] [MainThread]: Parsing macros/materializations/view.sql
07:00:37.829226 [debug] [MainThread]: Parsing macros/materializations/seed.sql
07:00:37.836041 [debug] [MainThread]: Parsing macros/adapters/columns.sql
07:00:37.849958 [debug] [MainThread]: Parsing macros/adapters/relation.sql
07:00:37.866075 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
07:00:37.873956 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
07:00:37.879119 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
07:00:37.883975 [debug] [MainThread]: Parsing macros/adapters/schema.sql
07:00:37.888045 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
07:00:37.911807 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
07:00:37.917202 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
07:00:37.920705 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
07:00:37.924722 [debug] [MainThread]: Parsing macros/etc/datetime.sql
07:00:37.939279 [debug] [MainThread]: Parsing macros/etc/statement.sql
07:00:37.945371 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
07:00:37.946805 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
07:00:37.948886 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
07:00:37.950941 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
07:00:37.953603 [debug] [MainThread]: Parsing macros/materializations/configs.sql
07:00:37.958961 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
07:00:37.967321 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
07:00:37.970739 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
07:00:37.973442 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
07:00:37.979481 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
07:00:37.997538 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
07:00:38.005425 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
07:00:38.007591 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
07:00:38.018697 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
07:00:38.037376 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
07:00:38.052198 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
07:00:38.070154 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
07:00:38.087226 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
07:00:38.098523 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
07:00:38.100537 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
07:00:38.107122 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
07:00:38.110862 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
07:00:38.112804 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
07:00:38.121840 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
07:00:38.125445 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
07:00:38.129709 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
07:00:38.138713 [debug] [MainThread]: Parsing tests/generic/builtin.sql
07:00:38.143250 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
07:00:38.153934 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
07:00:38.161214 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
07:00:38.162690 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
07:00:38.173857 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
07:00:38.176495 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
07:00:38.178541 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
07:00:38.181115 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
07:00:38.183542 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
07:00:38.188004 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
07:00:38.191301 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
07:00:38.197296 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
07:00:38.199447 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
07:00:38.202551 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
07:00:38.204390 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
07:00:38.213597 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
07:00:38.219124 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
07:00:38.222103 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
07:00:38.225578 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
07:00:38.227285 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
07:00:38.229819 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
07:00:38.232162 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
07:00:38.234532 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
07:00:38.236253 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
07:00:38.242354 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
07:00:38.244154 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
07:00:38.246115 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
07:00:38.249137 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
07:00:38.252366 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
07:00:38.254279 [debug] [MainThread]: Parsing macros/sql/star.sql
07:00:38.259168 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
07:00:38.261418 [debug] [MainThread]: Parsing macros/sql/pivot.sql
07:00:38.267601 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
07:00:38.269693 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
07:00:38.274639 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
07:00:38.286879 [debug] [MainThread]: Parsing macros/sql/union.sql
07:00:38.302426 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
07:00:38.306246 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
07:00:38.313969 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
07:00:38.320263 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
07:00:38.326826 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
07:00:38.333912 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
07:00:38.343074 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
07:00:38.348447 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
07:00:38.357327 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
07:00:38.367950 [debug] [MainThread]: Parsing macros/sql/groupby.sql
07:00:38.369815 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
07:00:38.372122 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
07:00:38.375394 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
07:00:38.377528 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
07:00:38.381844 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
07:00:38.383811 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
07:00:38.385854 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
07:00:38.387659 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
07:00:38.389611 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
07:00:38.418866 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
07:00:38.421372 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
07:00:38.424308 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
07:00:38.426933 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
07:00:38.429816 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
07:00:38.433975 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
07:00:38.437473 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
07:00:38.440429 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
07:00:38.444322 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
07:00:38.454360 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
07:00:38.459527 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
07:00:38.463750 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
07:00:38.466604 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
07:00:38.468455 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
07:00:38.470667 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
07:00:38.476208 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
07:00:38.479319 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
07:00:39.040174 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
07:00:39.056401 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
07:00:39.061105 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
07:00:39.065199 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
07:00:39.070894 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
07:00:39.074770 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
07:00:39.078704 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
07:00:39.267832 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.warehouse
- models.leagueoflegendsdbt.view

07:00:39.278438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d14100fd0>]}
07:00:39.292139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce8046eb0>]}
07:00:39.292684 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
07:00:39.293345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d167d4700>]}
07:00:39.296133 [info ] [MainThread]: 
07:00:39.297097 [debug] [MainThread]: Acquiring new snowflake connection "master"
07:00:39.299435 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
07:00:39.319336 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
07:00:39.319952 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
07:00:39.320441 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:00:40.238185 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.92 seconds
07:00:40.239984 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
07:00:40.367602 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
07:00:40.376749 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
07:00:40.377034 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
07:00:40.377236 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:00:41.182980 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.81 seconds
07:00:41.185325 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
07:00:41.312662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d14100a00>]}
07:00:41.313773 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
07:00:41.314618 [info ] [MainThread]: 
07:00:41.337934 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_champions
07:00:41.338403 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_items
07:00:41.339027 [info ] [Thread-1  ]: 1 of 7 START view model PUBLIC.stg_champions ................................... [RUN]
07:00:41.339347 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_maps
07:00:41.339859 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_match_details
07:00:41.340576 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_match_info
07:00:41.341212 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
07:00:41.341797 [info ] [Thread-2  ]: 2 of 7 START view model PUBLIC.stg_items ....................................... [RUN]
07:00:41.342179 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
07:00:41.343757 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
07:00:41.344424 [info ] [Thread-3  ]: 3 of 7 START view model PUBLIC.stg_maps ........................................ [RUN]
07:00:41.345084 [info ] [Thread-4  ]: 4 of 7 START view model PUBLIC.stg_match_details ............................... [RUN]
07:00:41.345830 [info ] [Thread-5  ]: 5 of 7 START view model PUBLIC.stg_match_info .................................. [RUN]
07:00:41.346448 [info ] [Thread-6  ]: 6 of 7 START view model PUBLIC.stg_runes_reforged .............................. [RUN]
07:00:41.348140 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
07:00:41.348794 [info ] [Thread-7  ]: 7 of 7 START view model PUBLIC.stg_summonerspells .............................. [RUN]
07:00:41.349369 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
07:00:41.350509 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
07:00:41.351957 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
07:00:41.352964 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
07:00:41.354124 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
07:00:41.354595 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_items
07:00:41.356109 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
07:00:41.356616 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_champions
07:00:41.357200 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
07:00:41.357943 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
07:00:41.358783 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
07:00:41.359376 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
07:00:41.360004 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_items
07:00:41.360721 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
07:00:41.366334 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
07:00:41.366940 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_maps
07:00:41.367565 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_match_details
07:00:41.368248 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_match_info
07:00:41.368879 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
07:00:41.375151 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
07:00:41.376045 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
07:00:41.380948 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
07:00:41.387054 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
07:00:41.395816 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
07:00:41.396541 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
07:00:41.402676 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
07:00:41.404041 [debug] [Thread-2  ]: finished collecting timing info
07:00:41.404589 [debug] [Thread-1  ]: finished collecting timing info
07:00:41.405613 [debug] [Thread-3  ]: finished collecting timing info
07:00:41.406964 [debug] [Thread-4  ]: finished collecting timing info
07:00:41.407604 [debug] [Thread-5  ]: finished collecting timing info
07:00:41.408311 [debug] [Thread-6  ]: finished collecting timing info
07:00:41.408835 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_items
07:00:41.409235 [debug] [Thread-7  ]: finished collecting timing info
07:00:41.409940 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_champions
07:00:41.410566 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_maps
07:00:41.411208 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
07:00:41.411929 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
07:00:41.412534 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
07:00:41.423788 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
07:00:41.501816 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
07:00:41.511980 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
07:00:41.514680 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
07:00:41.516408 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
07:00:41.521145 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
07:00:41.526559 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
07:00:41.531067 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
07:00:41.536587 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
07:00:41.546247 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
07:00:41.549925 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
07:00:41.552511 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
07:00:41.554041 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
07:00:41.554835 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_match_info
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
07:00:41.557916 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
07:00:41.559404 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
07:00:41.559941 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_match_details
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
07:00:41.560416 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY id
)

SELECT * FROM pivoted_items
  );
07:00:41.560806 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
07:00:41.561127 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_RUNES_REFORGED
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_RUNES_REFORGED"
-- FROM @MY_AZURE_DATADRAGON_RUNESREFORGED_STAGE
-- file_format = datadragon_fileformat;

WITH tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
07:00:41.561702 [debug] [Thread-5  ]: Opening a new connection, currently in state init
07:00:41.562470 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
07:00:41.563058 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as cooldown
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
07:00:41.563717 [debug] [Thread-4  ]: Opening a new connection, currently in state init
07:00:41.564408 [debug] [Thread-2  ]: Opening a new connection, currently in state init
07:00:41.565010 [debug] [Thread-3  ]: Opening a new connection, currently in state init
07:00:41.565621 [debug] [Thread-6  ]: Opening a new connection, currently in state init
07:00:41.568259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:00:41.571876 [debug] [Thread-7  ]: Opening a new connection, currently in state init
07:00:43.986019 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a4dee4-0000-f76c-0000-d9690004b03a
07:00:43.986376 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_INFO' does not exist or not authorized.
07:00:43.986904 [debug] [Thread-5  ]: finished collecting timing info
07:00:43.987198 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: Close
07:00:44.005631 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a4dee4-0000-f77f-0000-d9690004c052
07:00:44.005930 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_DETAILS' does not exist or not authorized.
07:00:44.006284 [debug] [Thread-4  ]: finished collecting timing info
07:00:44.006868 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: Close
07:00:44.028469 [debug] [Thread-7  ]: Snowflake adapter: Snowflake query id: 01a4dee4-0000-f77f-0000-d9690004c04e
07:00:44.028751 [debug] [Thread-7  ]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'COOLDOWN'
07:00:44.029257 [debug] [Thread-7  ]: finished collecting timing info
07:00:44.029561 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
07:00:44.085210 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.52 seconds
07:00:44.096319 [debug] [Thread-6  ]: finished collecting timing info
07:00:44.096872 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
07:00:44.118202 [debug] [Thread-4  ]: Database Error in model stg_match_details (models/staging/stg_match_details.sql)
  002003 (42S02): SQL compilation error:
  Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_DETAILS' does not exist or not authorized.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_details.sql
07:00:44.119013 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d11006280>]}
07:00:44.119731 [error] [Thread-4  ]: 4 of 7 ERROR creating view model PUBLIC.stg_match_details ...................... [[31mERROR[0m in 2.77s]
07:00:44.120803 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
07:00:44.127239 [debug] [Thread-5  ]: Database Error in model stg_match_info (models/staging/stg_match_info.sql)
  002003 (42S02): SQL compilation error:
  Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_INFO' does not exist or not authorized.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_info.sql
07:00:44.127826 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d1100b790>]}
07:00:44.128481 [error] [Thread-5  ]: 5 of 7 ERROR creating view model PUBLIC.stg_match_info ......................... [[31mERROR[0m in 2.78s]
07:00:44.129358 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
07:00:44.136630 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.57 seconds
07:00:44.139416 [debug] [Thread-1  ]: finished collecting timing info
07:00:44.140354 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: Close
07:00:44.164977 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.6 seconds
07:00:44.167164 [debug] [Thread-2  ]: finished collecting timing info
07:00:44.167561 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: Close
07:00:44.175054 [debug] [Thread-7  ]: Database Error in model stg_summonerspells (models/staging_datadragon/stg_summonerspells.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'COOLDOWN'
  compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_summonerspells.sql
07:00:44.175859 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d10fa7b80>]}
07:00:44.176839 [error] [Thread-7  ]: 7 of 7 ERROR creating view model PUBLIC.stg_summonerspells ..................... [[31mERROR[0m in 2.82s]
07:00:44.177626 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
07:00:44.220879 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d11055a60>]}
07:00:44.221795 [info ] [Thread-6  ]: 6 of 7 OK created view model PUBLIC.stg_runes_reforged ......................... [[32mSUCCESS 1[0m in 2.87s]
07:00:44.223230 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
07:00:44.278152 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.71 seconds
07:00:44.280778 [debug] [Thread-3  ]: finished collecting timing info
07:00:44.281225 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: Close
07:00:44.290315 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d13f5e040>]}
07:00:44.291511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d13f58be0>]}
07:00:44.292352 [info ] [Thread-2  ]: 2 of 7 OK created view model PUBLIC.stg_items .................................. [[32mSUCCESS 1[0m in 2.94s]
07:00:44.293071 [info ] [Thread-1  ]: 1 of 7 OK created view model PUBLIC.stg_champions .............................. [[32mSUCCESS 1[0m in 2.95s]
07:00:44.294210 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_items
07:00:44.295156 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_champions
07:00:44.394688 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5be4eec9-7e43-404f-be69-faa769430b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d13f43400>]}
07:00:44.395853 [info ] [Thread-3  ]: 3 of 7 OK created view model PUBLIC.stg_maps ................................... [[32mSUCCESS 1[0m in 3.04s]
07:00:44.397178 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_maps
07:00:44.401577 [debug] [MainThread]: Acquiring new snowflake connection "master"
07:00:44.402734 [info ] [MainThread]: 
07:00:44.403915 [info ] [MainThread]: Finished running 7 view models in 5.11s.
07:00:44.405009 [debug] [MainThread]: Connection 'master' was properly closed.
07:00:44.405544 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
07:00:44.406011 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
07:00:44.406573 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
07:00:44.407035 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
07:00:44.407513 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
07:00:44.407926 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
07:00:44.408402 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
07:00:44.427846 [info ] [MainThread]: 
07:00:44.428864 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
07:00:44.429797 [info ] [MainThread]: 
07:00:44.430665 [error] [MainThread]: [33mDatabase Error in model stg_match_details (models/staging/stg_match_details.sql)[0m
07:00:44.431685 [error] [MainThread]:   002003 (42S02): SQL compilation error:
07:00:44.432873 [error] [MainThread]:   Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_DETAILS' does not exist or not authorized.
07:00:44.434061 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_details.sql
07:00:44.435556 [info ] [MainThread]: 
07:00:44.436414 [error] [MainThread]: [33mDatabase Error in model stg_match_info (models/staging/stg_match_info.sql)[0m
07:00:44.437285 [error] [MainThread]:   002003 (42S02): SQL compilation error:
07:00:44.440227 [error] [MainThread]:   Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_INFO' does not exist or not authorized.
07:00:44.441130 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_info.sql
07:00:44.441911 [info ] [MainThread]: 
07:00:44.443157 [error] [MainThread]: [33mDatabase Error in model stg_summonerspells (models/staging_datadragon/stg_summonerspells.sql)[0m
07:00:44.443913 [error] [MainThread]:   002025 (42S21): SQL compilation error:
07:00:44.444726 [error] [MainThread]:   duplicate column name 'COOLDOWN'
07:00:44.445699 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_summonerspells.sql
07:00:44.447130 [info ] [MainThread]: 
07:00:44.448556 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
07:00:44.449978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce807ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d16787790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce80e5850>]}


============================== 2022-06-11 07:02:03.140011 | 5df6946d-c508-4d47-9bdb-e0a1cf356f13 ==============================
07:02:03.140027 [info ] [MainThread]: Running with dbt=1.1.0
07:02:03.140801 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
07:02:03.141118 [debug] [MainThread]: Tracking: tracking
07:02:03.142271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29592ad1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29592adcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29592add60>]}
07:02:03.143942 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hyn_lnm1'
07:02:03.144593 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
07:02:03.350076 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
07:02:03.351272 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
07:02:03.474639 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
07:02:03.538751 [info ] [MainThread]: Installing dbt-labs/dbt_utils
07:02:04.147856 [info ] [MainThread]:   Installed from version 0.8.5
07:02:04.148283 [info ] [MainThread]:   Up to date!
07:02:04.148733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5df6946d-c508-4d47-9bdb-e0a1cf356f13', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29592ad5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2959432130>]}
07:02:04.149604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f295e6722e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29592982e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29592986d0>]}


============================== 2022-06-11 07:02:08.960722 | b65ddcdf-ef55-4f1a-9cff-60f5a261818d ==============================
07:02:08.960804 [info ] [MainThread]: Running with dbt=1.1.0
07:02:08.961581 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:02:08.961871 [debug] [MainThread]: Tracking: tracking
07:02:08.962228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f275ab5f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f275ab5f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f275ab5f970>]}
07:02:09.041867 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:02:09.042374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:02:09.043542 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.view
- models.leagueoflegendsdbt.warehouse

07:02:09.053805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278eeab130>]}
07:02:09.068607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278ef144f0>]}
07:02:09.069137 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
07:02:09.069542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278eeaaf10>]}
07:02:09.071997 [info ] [MainThread]: 
07:02:09.072765 [debug] [MainThread]: Acquiring new snowflake connection "master"
07:02:09.074523 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
07:02:09.096517 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
07:02:09.096871 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
07:02:09.097166 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:02:09.890492 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.79 seconds
07:02:09.892252 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
07:02:10.031074 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
07:02:10.043300 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
07:02:10.043778 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
07:02:10.044260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:02:10.855663 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.81 seconds
07:02:10.857792 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
07:02:10.972777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278eeaaf10>]}
07:02:10.973602 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
07:02:10.974113 [info ] [MainThread]: 
07:02:10.995266 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_champions
07:02:10.995812 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_items
07:02:10.996285 [info ] [Thread-1  ]: 1 of 7 START view model PUBLIC.stg_champions ................................... [RUN]
07:02:10.996734 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_maps
07:02:10.997618 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_match_details
07:02:10.998369 [info ] [Thread-2  ]: 2 of 7 START view model PUBLIC.stg_items ....................................... [RUN]
07:02:10.998754 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_match_info
07:02:10.999169 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
07:02:10.999390 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
07:02:11.000137 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
07:02:11.000570 [info ] [Thread-3  ]: 3 of 7 START view model PUBLIC.stg_maps ........................................ [RUN]
07:02:11.000991 [info ] [Thread-4  ]: 4 of 7 START view model PUBLIC.stg_match_details ............................... [RUN]
07:02:11.002042 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
07:02:11.002583 [info ] [Thread-5  ]: 5 of 7 START view model PUBLIC.stg_match_info .................................. [RUN]
07:02:11.003255 [info ] [Thread-6  ]: 6 of 7 START view model PUBLIC.stg_runes_reforged .............................. [RUN]
07:02:11.004148 [info ] [Thread-7  ]: 7 of 7 START view model PUBLIC.stg_summonerspells .............................. [RUN]
07:02:11.004880 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
07:02:11.005951 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
07:02:11.006829 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
07:02:11.007134 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_items
07:02:11.007944 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
07:02:11.008650 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
07:02:11.009733 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
07:02:11.010056 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_champions
07:02:11.010386 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
07:02:11.010679 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
07:02:11.011041 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_items
07:02:11.011412 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
07:02:11.011864 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
07:02:11.012496 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
07:02:11.016959 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
07:02:11.017414 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_maps
07:02:11.017762 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_match_details
07:02:11.022980 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
07:02:11.023568 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_match_info
07:02:11.023979 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
07:02:11.024661 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
07:02:11.029330 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
07:02:11.029889 [debug] [Thread-1  ]: finished collecting timing info
07:02:11.034287 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
07:02:11.038390 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
07:02:11.039050 [debug] [Thread-2  ]: finished collecting timing info
07:02:11.041530 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
07:02:11.045443 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
07:02:11.046166 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_champions
07:02:11.047173 [debug] [Thread-3  ]: finished collecting timing info
07:02:11.048256 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_items
07:02:11.049423 [debug] [Thread-4  ]: finished collecting timing info
07:02:11.049727 [debug] [Thread-5  ]: finished collecting timing info
07:02:11.050891 [debug] [Thread-7  ]: finished collecting timing info
07:02:11.051239 [debug] [Thread-6  ]: finished collecting timing info
07:02:11.067459 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_maps
07:02:11.100619 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
07:02:11.101624 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
07:02:11.102476 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
07:02:11.103150 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
07:02:11.103499 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
07:02:11.103774 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
07:02:11.107498 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
07:02:11.114488 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
07:02:11.118576 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
07:02:11.122717 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
07:02:11.125384 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
07:02:11.128694 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
07:02:11.133556 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
07:02:11.136120 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
07:02:11.142291 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY id
)

SELECT * FROM pivoted_items
  );
07:02:11.145279 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
07:02:11.146048 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
07:02:11.147839 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
07:02:11.148732 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
07:02:11.150061 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
07:02:11.150403 [debug] [Thread-2  ]: Opening a new connection, currently in state init
07:02:11.151680 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
07:02:11.151987 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_match_details
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
07:02:11.152337 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:02:11.152684 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_match_info
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
07:02:11.153040 [debug] [Thread-3  ]: Opening a new connection, currently in state init
07:02:11.153450 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_RUNES_REFORGED
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_RUNES_REFORGED"
-- FROM @MY_AZURE_DATADRAGON_RUNESREFORGED_STAGE
-- file_format = datadragon_fileformat;

WITH tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
07:02:11.159403 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as cooldown
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
07:02:11.159839 [debug] [Thread-4  ]: Opening a new connection, currently in state init
07:02:11.165735 [debug] [Thread-5  ]: Opening a new connection, currently in state init
07:02:11.170049 [debug] [Thread-6  ]: Opening a new connection, currently in state init
07:02:11.174675 [debug] [Thread-7  ]: Opening a new connection, currently in state init
07:02:13.911624 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.76 seconds
07:02:13.920469 [debug] [Thread-1  ]: finished collecting timing info
07:02:13.920778 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: Close
07:02:14.027958 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278e77d5b0>]}
07:02:14.028711 [info ] [Thread-1  ]: 1 of 7 OK created view model PUBLIC.stg_champions .............................. [[32mSUCCESS 1[0m in 3.03s]
07:02:14.029743 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_champions
07:02:14.128639 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.98 seconds
07:02:14.131982 [debug] [Thread-3  ]: finished collecting timing info
07:02:14.133556 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: Close
07:02:14.135821 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a4dee6-0000-f77f-0000-d9690004c06a
07:02:14.137531 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a4dee6-0000-f76c-0000-d9690004b04a
07:02:14.142908 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_INFO' does not exist or not authorized.
07:02:14.144934 [debug] [Thread-7  ]: Snowflake adapter: Snowflake query id: 01a4dee6-0000-f76c-0000-d9690004b046
07:02:14.145503 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_DETAILS' does not exist or not authorized.
07:02:14.146201 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.0 seconds
07:02:14.146744 [debug] [Thread-5  ]: finished collecting timing info
07:02:14.147129 [debug] [Thread-7  ]: Snowflake adapter: Snowflake error: 002025 (42S21): SQL compilation error:
duplicate column name 'COOLDOWN'
07:02:14.147727 [debug] [Thread-4  ]: finished collecting timing info
07:02:14.149709 [debug] [Thread-2  ]: finished collecting timing info
07:02:14.150273 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: Close
07:02:14.150968 [debug] [Thread-7  ]: finished collecting timing info
07:02:14.151344 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: Close
07:02:14.151836 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: Close
07:02:14.153197 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
07:02:14.178328 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.01 seconds
07:02:14.180503 [debug] [Thread-6  ]: finished collecting timing info
07:02:14.180896 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
07:02:14.317968 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278e874dc0>]}
07:02:14.319634 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278e874f70>]}
07:02:14.321760 [info ] [Thread-6  ]: 6 of 7 OK created view model PUBLIC.stg_runes_reforged ......................... [[32mSUCCESS 1[0m in 3.31s]
07:02:14.324871 [debug] [Thread-7  ]: Database Error in model stg_summonerspells (models/staging_datadragon/stg_summonerspells.sql)
  002025 (42S21): SQL compilation error:
  duplicate column name 'COOLDOWN'
  compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_summonerspells.sql
07:02:14.327185 [info ] [Thread-2  ]: 2 of 7 OK created view model PUBLIC.stg_items .................................. [[32mSUCCESS 1[0m in 3.32s]
07:02:14.328433 [debug] [Thread-5  ]: Database Error in model stg_match_info (models/staging/stg_match_info.sql)
  002003 (42S02): SQL compilation error:
  Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_INFO' does not exist or not authorized.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_info.sql
07:02:14.329320 [debug] [Thread-4  ]: Database Error in model stg_match_details (models/staging/stg_match_details.sql)
  002003 (42S02): SQL compilation error:
  Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_DETAILS' does not exist or not authorized.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_details.sql
07:02:14.331216 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278e874ee0>]}
07:02:14.331885 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
07:02:14.332447 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278e852f70>]}
07:02:14.333524 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_items
07:02:14.333920 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278e852ac0>]}
07:02:14.334391 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65ddcdf-ef55-4f1a-9cff-60f5a261818d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278e331340>]}
07:02:14.335126 [info ] [Thread-3  ]: 3 of 7 OK created view model PUBLIC.stg_maps ................................... [[32mSUCCESS 1[0m in 3.33s]
07:02:14.336236 [error] [Thread-7  ]: 7 of 7 ERROR creating view model PUBLIC.stg_summonerspells ..................... [[31mERROR[0m in 3.32s]
07:02:14.337409 [error] [Thread-5  ]: 5 of 7 ERROR creating view model PUBLIC.stg_match_info ......................... [[31mERROR[0m in 3.33s]
07:02:14.338015 [error] [Thread-4  ]: 4 of 7 ERROR creating view model PUBLIC.stg_match_details ...................... [[31mERROR[0m in 3.33s]
07:02:14.339026 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_maps
07:02:14.340248 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
07:02:14.341614 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
07:02:14.343065 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
07:02:14.349079 [debug] [MainThread]: Acquiring new snowflake connection "master"
07:02:14.350057 [info ] [MainThread]: 
07:02:14.350709 [info ] [MainThread]: Finished running 7 view models in 5.28s.
07:02:14.351630 [debug] [MainThread]: Connection 'master' was properly closed.
07:02:14.352261 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
07:02:14.352688 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
07:02:14.353061 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
07:02:14.353367 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
07:02:14.353628 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
07:02:14.353852 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
07:02:14.354146 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
07:02:14.444219 [info ] [MainThread]: 
07:02:14.444750 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
07:02:14.445267 [info ] [MainThread]: 
07:02:14.445980 [error] [MainThread]: [33mDatabase Error in model stg_summonerspells (models/staging_datadragon/stg_summonerspells.sql)[0m
07:02:14.446588 [error] [MainThread]:   002025 (42S21): SQL compilation error:
07:02:14.446963 [error] [MainThread]:   duplicate column name 'COOLDOWN'
07:02:14.447308 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_summonerspells.sql
07:02:14.448000 [info ] [MainThread]: 
07:02:14.448396 [error] [MainThread]: [33mDatabase Error in model stg_match_info (models/staging/stg_match_info.sql)[0m
07:02:14.448769 [error] [MainThread]:   002003 (42S02): SQL compilation error:
07:02:14.449104 [error] [MainThread]:   Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_INFO' does not exist or not authorized.
07:02:14.449582 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_info.sql
07:02:14.450116 [info ] [MainThread]: 
07:02:14.450764 [error] [MainThread]: [33mDatabase Error in model stg_match_details (models/staging/stg_match_details.sql)[0m
07:02:14.451127 [error] [MainThread]:   002003 (42S02): SQL compilation error:
07:02:14.451552 [error] [MainThread]:   Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_DETAILS' does not exist or not authorized.
07:02:14.451892 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_details.sql
07:02:14.452378 [info ] [MainThread]: 
07:02:14.452767 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
07:02:14.453330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278ef66130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278ef66250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f278ef66220>]}


============================== 2022-06-11 07:12:17.781509 | 56dc2ef7-7cd3-414e-874c-f9d1d82df834 ==============================
07:12:17.781526 [info ] [MainThread]: Running with dbt=1.1.0
07:12:17.782442 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
07:12:17.782749 [debug] [MainThread]: Tracking: tracking
07:12:17.784025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb9195e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb9195220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb9195d90>]}
07:12:17.784961 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-j992baai'
07:12:17.785432 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
07:12:18.005514 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
07:12:18.006471 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
07:12:18.131257 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
07:12:18.219631 [info ] [MainThread]: Installing dbt-labs/dbt_utils
07:12:18.861398 [info ] [MainThread]:   Installed from version 0.8.5
07:12:18.862053 [info ] [MainThread]:   Up to date!
07:12:18.862797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '56dc2ef7-7cd3-414e-874c-f9d1d82df834', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb9195130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb931a580>]}
07:12:18.864605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecbe5592e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb9178cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecb917f640>]}


============================== 2022-06-11 07:12:23.488150 | 46053084-beb6-44bf-85e8-e7f7bd392de2 ==============================
07:12:23.488175 [info ] [MainThread]: Running with dbt=1.1.0
07:12:23.488897 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'project_dir': '/opt/airflow/dbt', 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:12:23.489430 [debug] [MainThread]: Tracking: tracking
07:12:23.489995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9541d78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9541d7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9541d7970>]}
07:12:23.556730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
07:12:23.557656 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_match_details_stage
07:12:23.558162 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_match_info_stage
07:12:23.558805 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging/schema.yml
07:12:23.560039 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_summonerspells.sql
07:12:23.581710 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
07:12:23.657627 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.view
- models.leagueoflegendsdbt.warehouse

07:12:23.666155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9834a1d00>]}
07:12:23.679101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9843a7760>]}
07:12:23.679744 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
07:12:23.680390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9843a7910>]}
07:12:23.683351 [info ] [MainThread]: 
07:12:23.684398 [debug] [MainThread]: Acquiring new snowflake connection "master"
07:12:23.686094 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
07:12:23.702952 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
07:12:23.703279 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
07:12:23.703630 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:12:24.542810 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.84 seconds
07:12:24.545040 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
07:12:24.685753 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
07:12:24.700292 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
07:12:24.700615 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
07:12:24.700912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:12:25.238500 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 0.54 seconds
07:12:25.242432 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
07:12:25.372603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff984326340>]}
07:12:25.373311 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
07:12:25.373832 [info ] [MainThread]: 
07:12:25.391859 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_champions
07:12:25.392370 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_items
07:12:25.392954 [info ] [Thread-1  ]: 1 of 7 START view model PUBLIC.stg_champions ................................... [RUN]
07:12:25.393458 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_maps
07:12:25.394017 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_match_details
07:12:25.394561 [info ] [Thread-2  ]: 2 of 7 START view model PUBLIC.stg_items ....................................... [RUN]
07:12:25.394853 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_match_info
07:12:25.395224 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
07:12:25.395796 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
07:12:25.396447 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
07:12:25.396947 [info ] [Thread-3  ]: 3 of 7 START view model PUBLIC.stg_maps ........................................ [RUN]
07:12:25.397403 [info ] [Thread-4  ]: 4 of 7 START view model PUBLIC.stg_match_details ............................... [RUN]
07:12:25.398565 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
07:12:25.399270 [info ] [Thread-5  ]: 5 of 7 START view model PUBLIC.stg_match_info .................................. [RUN]
07:12:25.400075 [info ] [Thread-6  ]: 6 of 7 START view model PUBLIC.stg_runes_reforged .............................. [RUN]
07:12:25.400599 [info ] [Thread-7  ]: 7 of 7 START view model PUBLIC.stg_summonerspells .............................. [RUN]
07:12:25.400936 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
07:12:25.402051 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
07:12:25.403763 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
07:12:25.404564 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_items
07:12:25.406014 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
07:12:25.407322 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
07:12:25.408332 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
07:12:25.408693 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_champions
07:12:25.409005 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
07:12:25.409294 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
07:12:25.409610 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_items
07:12:25.409881 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
07:12:25.410146 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
07:12:25.410425 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
07:12:25.414226 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
07:12:25.414714 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_maps
07:12:25.415074 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_match_details
07:12:25.418403 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
07:12:25.418796 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_match_info
07:12:25.419143 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
07:12:25.419479 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
07:12:25.422886 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
07:12:25.429588 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
07:12:25.430922 [debug] [Thread-1  ]: finished collecting timing info
07:12:25.434106 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
07:12:25.434670 [debug] [Thread-2  ]: finished collecting timing info
07:12:25.437117 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
07:12:25.440844 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
07:12:25.442497 [debug] [Thread-3  ]: finished collecting timing info
07:12:25.442955 [debug] [Thread-4  ]: finished collecting timing info
07:12:25.443359 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_champions
07:12:25.444068 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_items
07:12:25.445732 [debug] [Thread-5  ]: finished collecting timing info
07:12:25.446804 [debug] [Thread-7  ]: finished collecting timing info
07:12:25.447316 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_maps
07:12:25.447909 [debug] [Thread-6  ]: finished collecting timing info
07:12:25.448489 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
07:12:25.509308 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
07:12:25.512371 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
07:12:25.512798 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
07:12:25.513268 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
07:12:25.517171 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
07:12:25.517720 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
07:12:25.588632 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
07:12:25.592517 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
07:12:25.595248 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
07:12:25.599376 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
07:12:25.601364 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
07:12:25.605422 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
07:12:25.606528 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
07:12:25.615332 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
07:12:25.615743 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY id
)

SELECT * FROM pivoted_items
  );
07:12:25.616892 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
07:12:25.617447 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
07:12:25.618753 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
07:12:25.619173 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
07:12:25.620148 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
07:12:25.620371 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_match_details
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
07:12:25.620668 [debug] [Thread-2  ]: Opening a new connection, currently in state init
07:12:25.620962 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_match_info
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
07:12:25.621239 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:12:25.621620 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
07:12:25.621989 [debug] [Thread-3  ]: Opening a new connection, currently in state init
07:12:25.622309 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_RUNES_REFORGED
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_RUNES_REFORGED"
-- FROM @MY_AZURE_DATADRAGON_RUNESREFORGED_STAGE
-- file_format = datadragon_fileformat;

WITH tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
07:12:25.622592 [debug] [Thread-4  ]: Opening a new connection, currently in state init
07:12:25.623879 [debug] [Thread-5  ]: Opening a new connection, currently in state init
07:12:25.631800 [debug] [Thread-7  ]: Opening a new connection, currently in state init
07:12:25.634065 [debug] [Thread-6  ]: Opening a new connection, currently in state init
07:12:28.087111 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.47 seconds
07:12:28.096294 [debug] [Thread-2  ]: finished collecting timing info
07:12:28.096603 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: Close
07:12:28.114031 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.49 seconds
07:12:28.118793 [debug] [Thread-1  ]: finished collecting timing info
07:12:28.119374 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: Close
07:12:28.189686 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.57 seconds
07:12:28.191930 [debug] [Thread-3  ]: finished collecting timing info
07:12:28.192467 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: Close
07:12:28.215542 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a4def0-0000-f77f-0000-d9690004c15e
07:12:28.215988 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_INFO' does not exist or not authorized.
07:12:28.217368 [debug] [Thread-5  ]: finished collecting timing info
07:12:28.218270 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: Close
07:12:28.220783 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9794e5e80>]}
07:12:28.221460 [info ] [Thread-2  ]: 2 of 7 OK created view model PUBLIC.stg_items .................................. [[32mSUCCESS 1[0m in 2.82s]
07:12:28.224286 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_items
07:12:28.229340 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff97e5a9070>]}
07:12:28.229902 [info ] [Thread-1  ]: 1 of 7 OK created view model PUBLIC.stg_champions .............................. [[32mSUCCESS 1[0m in 2.83s]
07:12:28.230962 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_champions
07:12:28.238983 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 2.6 seconds
07:12:28.242130 [debug] [Thread-6  ]: finished collecting timing info
07:12:28.242520 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
07:12:28.246158 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a4def0-0000-f77f-0000-d9690004c166
07:12:28.246700 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_DETAILS' does not exist or not authorized.
07:12:28.247960 [debug] [Thread-4  ]: finished collecting timing info
07:12:28.248384 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: Close
07:12:28.271777 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.64 seconds
07:12:28.273464 [debug] [Thread-7  ]: finished collecting timing info
07:12:28.273765 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
07:12:28.313647 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9794e5b80>]}
07:12:28.314181 [info ] [Thread-3  ]: 3 of 7 OK created view model PUBLIC.stg_maps ................................... [[32mSUCCESS 1[0m in 2.91s]
07:12:28.314875 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_maps
07:12:28.341255 [debug] [Thread-5  ]: Database Error in model stg_match_info (models/staging/stg_match_info.sql)
  002003 (42S02): SQL compilation error:
  Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_INFO' does not exist or not authorized.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_info.sql
07:12:28.341725 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff979501c10>]}
07:12:28.342140 [error] [Thread-5  ]: 5 of 7 ERROR creating view model PUBLIC.stg_match_info ......................... [[31mERROR[0m in 2.94s]
07:12:28.342806 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
07:12:28.356832 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9794e6ca0>]}
07:12:28.357343 [info ] [Thread-6  ]: 6 of 7 OK created view model PUBLIC.stg_runes_reforged ......................... [[32mSUCCESS 1[0m in 2.95s]
07:12:28.358165 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
07:12:28.360781 [debug] [Thread-4  ]: Database Error in model stg_match_details (models/staging/stg_match_details.sql)
  002003 (42S02): SQL compilation error:
  Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_DETAILS' does not exist or not authorized.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_details.sql
07:12:28.361262 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9794e6c70>]}
07:12:28.361791 [error] [Thread-4  ]: 4 of 7 ERROR creating view model PUBLIC.stg_match_details ...................... [[31mERROR[0m in 2.96s]
07:12:28.362489 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
07:12:28.377009 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46053084-beb6-44bf-85e8-e7f7bd392de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff980dba910>]}
07:12:28.377507 [info ] [Thread-7  ]: 7 of 7 OK created view model PUBLIC.stg_summonerspells ......................... [[32mSUCCESS 1[0m in 2.97s]
07:12:28.378070 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
07:12:28.381290 [debug] [MainThread]: Acquiring new snowflake connection "master"
07:12:28.381752 [info ] [MainThread]: 
07:12:28.382126 [info ] [MainThread]: Finished running 7 view models in 4.70s.
07:12:28.382502 [debug] [MainThread]: Connection 'master' was properly closed.
07:12:28.382723 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
07:12:28.382922 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
07:12:28.383142 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
07:12:28.383331 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
07:12:28.383517 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
07:12:28.383777 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
07:12:28.383973 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
07:12:28.396392 [info ] [MainThread]: 
07:12:28.396931 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
07:12:28.397350 [info ] [MainThread]: 
07:12:28.397730 [error] [MainThread]: [33mDatabase Error in model stg_match_info (models/staging/stg_match_info.sql)[0m
07:12:28.398280 [error] [MainThread]:   002003 (42S02): SQL compilation error:
07:12:28.398646 [error] [MainThread]:   Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_INFO' does not exist or not authorized.
07:12:28.398996 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_info.sql
07:12:28.399298 [info ] [MainThread]: 
07:12:28.400018 [error] [MainThread]: [33mDatabase Error in model stg_match_details (models/staging/stg_match_details.sql)[0m
07:12:28.400486 [error] [MainThread]:   002003 (42S02): SQL compilation error:
07:12:28.400932 [error] [MainThread]:   Object 'LEAGUE_OF_LEGENDSDB.PUBLIC.STAGING_MATCH_DETAILS' does not exist or not authorized.
07:12:28.401500 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging/stg_match_details.sql
07:12:28.402361 [info ] [MainThread]: 
07:12:28.402954 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
07:12:28.404185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff98431e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9842ffbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9842ffaf0>]}


============================== 2022-06-13 04:55:06.671819 | 57916769-8bbf-4c7d-b0c6-02438b9dd281 ==============================
04:55:06.671834 [info ] [MainThread]: Running with dbt=1.1.0
04:55:06.678090 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
04:55:06.678466 [debug] [MainThread]: Tracking: tracking
04:55:06.679930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb22532e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb2253e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb2253df0>]}
04:55:06.680948 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-1fdtc1p7'
04:55:06.681356 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
04:55:07.065005 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
04:55:07.066047 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
04:55:07.375185 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
04:55:07.435815 [info ] [MainThread]: Installing dbt-labs/dbt_utils
04:55:08.032804 [info ] [MainThread]:   Installed from version 0.8.5
04:55:08.033338 [info ] [MainThread]:   Up to date!
04:55:08.034134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '57916769-8bbf-4c7d-b0c6-02438b9dd281', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb22378b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb23d9460>]}
04:55:08.035243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb7822400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb22531f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bb2253eb0>]}


============================== 2022-06-13 04:55:15.809977 | 961d82a6-306e-40ce-9b04-1a5031779f55 ==============================
04:55:15.810007 [info ] [MainThread]: Running with dbt=1.1.0
04:55:15.810976 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
04:55:15.811889 [debug] [MainThread]: Tracking: tracking
04:55:15.812878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dfb397f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dfb39850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dfb398b0>]}
04:55:15.862831 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
04:55:15.863669 [info ] [MainThread]: Unable to do partial parsing because profile has changed
04:55:15.864801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '961d82a6-306e-40ce-9b04-1a5031779f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dfaddfd0>]}
04:55:15.936084 [debug] [MainThread]: Parsing macros/match_details.sql
04:55:15.936557 [debug] [MainThread]: Parsing macros/adapters.sql
04:55:15.986304 [debug] [MainThread]: Parsing macros/catalog.sql
04:55:15.988681 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
04:55:15.990277 [debug] [MainThread]: Parsing macros/materializations/merge.sql
04:55:15.995993 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
04:55:16.006930 [debug] [MainThread]: Parsing macros/materializations/table.sql
04:55:16.011032 [debug] [MainThread]: Parsing macros/materializations/view.sql
04:55:16.013172 [debug] [MainThread]: Parsing macros/materializations/seed.sql
04:55:16.019237 [debug] [MainThread]: Parsing macros/adapters/columns.sql
04:55:16.030613 [debug] [MainThread]: Parsing macros/adapters/relation.sql
04:55:16.044018 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
04:55:16.049955 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
04:55:16.053294 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
04:55:16.056897 [debug] [MainThread]: Parsing macros/adapters/schema.sql
04:55:16.059452 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
04:55:16.067030 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
04:55:16.070249 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
04:55:16.072108 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
04:55:16.073795 [debug] [MainThread]: Parsing macros/etc/datetime.sql
04:55:16.083304 [debug] [MainThread]: Parsing macros/etc/statement.sql
04:55:16.089169 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
04:55:16.090144 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
04:55:16.091215 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
04:55:16.092368 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
04:55:16.094068 [debug] [MainThread]: Parsing macros/materializations/configs.sql
04:55:16.097923 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
04:55:16.104213 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
04:55:16.106416 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
04:55:16.108901 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
04:55:16.114080 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
04:55:16.130397 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
04:55:16.137922 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
04:55:16.139873 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
04:55:16.151359 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
04:55:16.170480 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
04:55:16.183335 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
04:55:16.198631 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
04:55:16.215413 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
04:55:16.225962 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
04:55:16.228124 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
04:55:16.233099 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
04:55:16.237036 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
04:55:16.238609 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
04:55:16.246242 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
04:55:16.249602 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
04:55:16.252690 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
04:55:16.260501 [debug] [MainThread]: Parsing tests/generic/builtin.sql
04:55:16.264202 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
04:55:16.273513 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
04:55:16.281157 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
04:55:16.282528 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
04:55:16.297248 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
04:55:16.299662 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
04:55:16.301396 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
04:55:16.302779 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
04:55:16.305015 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
04:55:16.308194 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
04:55:16.310632 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
04:55:16.314742 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
04:55:16.316313 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
04:55:16.318756 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
04:55:16.319962 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
04:55:16.327647 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
04:55:16.331389 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
04:55:16.333897 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
04:55:16.336058 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
04:55:16.337722 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
04:55:16.339768 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
04:55:16.341233 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
04:55:16.342910 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
04:55:16.344068 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
04:55:16.349803 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
04:55:16.351018 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
04:55:16.353116 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
04:55:16.355519 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
04:55:16.358566 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
04:55:16.360577 [debug] [MainThread]: Parsing macros/sql/star.sql
04:55:16.364479 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
04:55:16.366478 [debug] [MainThread]: Parsing macros/sql/pivot.sql
04:55:16.371567 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
04:55:16.373632 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
04:55:16.376761 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
04:55:16.385743 [debug] [MainThread]: Parsing macros/sql/union.sql
04:55:16.399321 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
04:55:16.401533 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
04:55:16.407761 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
04:55:16.412998 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
04:55:16.417616 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
04:55:16.421579 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
04:55:16.429575 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
04:55:16.434320 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
04:55:16.441684 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
04:55:16.449883 [debug] [MainThread]: Parsing macros/sql/groupby.sql
04:55:16.451594 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
04:55:16.453681 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
04:55:16.456725 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
04:55:16.458739 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
04:55:16.463167 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
04:55:16.464769 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
04:55:16.466164 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
04:55:16.467493 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
04:55:16.468706 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
04:55:16.495073 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
04:55:16.497200 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
04:55:16.499656 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
04:55:16.501981 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
04:55:16.503615 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
04:55:16.506792 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
04:55:16.509519 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
04:55:16.511426 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
04:55:16.514714 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
04:55:16.523675 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
04:55:16.528082 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
04:55:16.530421 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
04:55:16.531832 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
04:55:16.533796 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
04:55:16.535553 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
04:55:16.540157 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
04:55:16.542469 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
04:55:17.013230 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
04:55:17.026909 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
04:55:17.029689 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
04:55:17.033659 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
04:55:17.036917 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
04:55:17.041343 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
04:55:17.044555 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
04:55:17.288359 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.view
- models.leagueoflegendsdbt.warehouse

04:55:17.297235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '961d82a6-306e-40ce-9b04-1a5031779f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dfb20910>]}
04:55:17.309330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '961d82a6-306e-40ce-9b04-1a5031779f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dfb20c40>]}
04:55:17.309757 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
04:55:17.310089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '961d82a6-306e-40ce-9b04-1a5031779f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23dfb20c70>]}
04:55:17.312724 [info ] [MainThread]: 
04:55:17.313370 [debug] [MainThread]: Acquiring new snowflake connection "master"
04:55:17.314347 [debug] [MainThread]: Connection 'master' was properly closed.
04:55:17.314758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24109ae400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24109ae2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24109b7a60>]}


============================== 2022-06-13 05:01:23.772739 | 0220ae92-fe53-49ca-bfd4-6482593d9efb ==============================
05:01:23.772761 [info ] [MainThread]: Running with dbt=1.1.0
05:01:23.773386 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:01:23.773728 [debug] [MainThread]: Tracking: tracking
05:01:23.774202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a73761820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a73761880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a737618e0>]}
05:01:23.824394 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
05:01:23.826041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0220ae92-fe53-49ca-bfd4-6482593d9efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a78085fd0>]}
05:01:23.894985 [debug] [MainThread]: Parsing macros/match_details.sql
05:01:23.895541 [debug] [MainThread]: Parsing macros/adapters.sql
05:01:23.960891 [debug] [MainThread]: Parsing macros/catalog.sql
05:01:23.964436 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
05:01:23.966482 [debug] [MainThread]: Parsing macros/materializations/merge.sql
05:01:23.973069 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
05:01:23.985374 [debug] [MainThread]: Parsing macros/materializations/table.sql
05:01:23.991896 [debug] [MainThread]: Parsing macros/materializations/view.sql
05:01:23.995633 [debug] [MainThread]: Parsing macros/materializations/seed.sql
05:01:24.003365 [debug] [MainThread]: Parsing macros/adapters/columns.sql
05:01:24.015893 [debug] [MainThread]: Parsing macros/adapters/relation.sql
05:01:24.026670 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
05:01:24.031922 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
05:01:24.035085 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
05:01:24.038818 [debug] [MainThread]: Parsing macros/adapters/schema.sql
05:01:24.042323 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
05:01:24.050587 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
05:01:24.054808 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
05:01:24.057242 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
05:01:24.059314 [debug] [MainThread]: Parsing macros/etc/datetime.sql
05:01:24.071094 [debug] [MainThread]: Parsing macros/etc/statement.sql
05:01:24.079655 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
05:01:24.080641 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
05:01:24.081860 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
05:01:24.083451 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
05:01:24.085672 [debug] [MainThread]: Parsing macros/materializations/configs.sql
05:01:24.089021 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
05:01:24.093035 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
05:01:24.094959 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
05:01:24.096939 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
05:01:24.101952 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
05:01:24.118664 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
05:01:24.126037 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
05:01:24.127988 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
05:01:24.139438 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
05:01:24.157637 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
05:01:24.170912 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
05:01:24.186540 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
05:01:24.202497 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
05:01:24.214049 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
05:01:24.215786 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
05:01:24.220524 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
05:01:24.223529 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
05:01:24.225066 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
05:01:24.232072 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
05:01:24.234721 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
05:01:24.237902 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
05:01:24.245241 [debug] [MainThread]: Parsing tests/generic/builtin.sql
05:01:24.248711 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
05:01:24.257503 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
05:01:24.263562 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
05:01:24.264662 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
05:01:24.274392 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
05:01:24.276675 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
05:01:24.278683 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
05:01:24.280124 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
05:01:24.281775 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
05:01:24.284786 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
05:01:24.286937 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
05:01:24.291160 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
05:01:24.292783 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
05:01:24.294636 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
05:01:24.295758 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
05:01:24.302061 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
05:01:24.305700 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
05:01:24.308700 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
05:01:24.310836 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
05:01:24.312321 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
05:01:24.314092 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
05:01:24.315539 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
05:01:24.317209 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
05:01:24.318527 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
05:01:24.324212 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
05:01:24.325691 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
05:01:24.327253 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
05:01:24.329852 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
05:01:24.332821 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
05:01:24.334738 [debug] [MainThread]: Parsing macros/sql/star.sql
05:01:24.338614 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
05:01:24.340669 [debug] [MainThread]: Parsing macros/sql/pivot.sql
05:01:24.345148 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
05:01:24.347185 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
05:01:24.350254 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
05:01:24.359018 [debug] [MainThread]: Parsing macros/sql/union.sql
05:01:24.373559 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
05:01:24.375589 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
05:01:24.381854 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
05:01:24.386880 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
05:01:24.390511 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
05:01:24.394266 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
05:01:24.402259 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
05:01:24.406735 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
05:01:24.412996 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
05:01:24.419414 [debug] [MainThread]: Parsing macros/sql/groupby.sql
05:01:24.421032 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
05:01:24.423079 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
05:01:24.425605 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
05:01:24.427338 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
05:01:24.431244 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
05:01:24.433046 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
05:01:24.434633 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
05:01:24.435995 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
05:01:24.437452 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
05:01:24.462323 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
05:01:24.464535 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
05:01:24.466793 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
05:01:24.468894 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
05:01:24.471071 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
05:01:24.474646 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
05:01:24.477412 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
05:01:24.479633 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
05:01:24.482191 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
05:01:24.491063 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
05:01:24.495429 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
05:01:24.497988 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
05:01:24.499704 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
05:01:24.501814 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
05:01:24.503639 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
05:01:24.507368 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
05:01:24.509423 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
05:01:24.988363 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
05:01:25.002715 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
05:01:25.005760 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
05:01:25.010865 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
05:01:25.014686 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
05:01:25.018462 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
05:01:25.023494 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
05:01:25.218094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.view
- models.leagueoflegendsdbt.warehouse

05:01:25.227726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0220ae92-fe53-49ca-bfd4-6482593d9efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a7374fca0>]}
05:01:25.239383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0220ae92-fe53-49ca-bfd4-6482593d9efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a7374fe20>]}
05:01:25.239796 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
05:01:25.240346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0220ae92-fe53-49ca-bfd4-6482593d9efb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a7374fb20>]}
05:01:25.243346 [info ] [MainThread]: 
05:01:25.244074 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:01:25.245284 [debug] [MainThread]: Connection 'master' was properly closed.
05:01:25.245625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a7374f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa46afeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aa46b8a30>]}


============================== 2022-06-13 05:02:06.771165 | 9268a17b-9f09-4927-bbbd-e8fbd816585e ==============================
05:02:06.771178 [info ] [MainThread]: Running with dbt=1.1.0
05:02:06.771592 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
05:02:06.771811 [debug] [MainThread]: Tracking: tracking
05:02:06.773344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9251e1fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9251df7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9251df7bb0>]}
05:02:06.774445 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7j3df2cb'
05:02:06.775039 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
05:02:07.022125 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
05:02:07.022966 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
05:02:07.200257 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
05:02:07.261989 [info ] [MainThread]: Installing dbt-labs/dbt_utils
05:02:07.826613 [info ] [MainThread]:   Installed from version 0.8.5
05:02:07.827178 [info ] [MainThread]:   Up to date!
05:02:07.827780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9268a17b-9f09-4927-bbbd-e8fbd816585e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9251df7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9251fa4460>]}
05:02:07.828672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92573ad400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9251e09160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9251eadee0>]}


============================== 2022-06-13 05:04:39.102530 | 5da5023a-5ca8-43d9-8122-4fe7c5b873ca ==============================
05:04:39.102555 [info ] [MainThread]: Running with dbt=1.1.0
05:04:39.103323 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:04:39.103693 [debug] [MainThread]: Tracking: tracking
05:04:39.104265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5d282880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5d2828e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5d282940>]}
05:04:39.177652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
05:04:39.178108 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
05:04:39.178829 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.warehouse
- models.leagueoflegendsdbt.view

05:04:39.188559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5da5023a-5ca8-43d9-8122-4fe7c5b873ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9159b0d0>]}
05:04:39.205030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5da5023a-5ca8-43d9-8122-4fe7c5b873ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f91607430>]}
05:04:39.205574 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
05:04:39.206115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5da5023a-5ca8-43d9-8122-4fe7c5b873ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9165c040>]}
05:04:39.209603 [info ] [MainThread]: 
05:04:39.210979 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:04:39.214879 [debug] [MainThread]: Connection 'master' was properly closed.
05:04:39.215284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f91607fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f91607100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f915fe850>]}


============================== 2022-06-13 05:21:59.070397 | 090229d4-f030-49eb-8fae-31d18b42a2c7 ==============================
05:21:59.070421 [info ] [MainThread]: Running with dbt=1.1.0
05:21:59.071119 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:21:59.071578 [debug] [MainThread]: Tracking: tracking
05:21:59.072476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f203807a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f203807a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f203807a940>]}
05:21:59.178983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
05:21:59.179924 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging/schema.yml
05:21:59.201053 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
05:21:59.219133 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
05:21:59.239518 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_matchinfo' in the 'models' section of file 'models/staging/schema.yml'
05:21:59.242949 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_matchdetails' in the 'models' section of file 'models/staging/schema.yml'
05:21:59.276767 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.leagueoflegendsdbt.not_null_stg_matchinfo_matchId.487d7c5839' (models/staging/schema.yml) depends on a node named 'stg_matchinfo' which was not found
05:21:59.277398 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.leagueoflegendsdbt.unique_stg_matchinfo_matchId.1fdd37c68c' (models/staging/schema.yml) depends on a node named 'stg_matchinfo' which was not found
05:21:59.277969 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.leagueoflegendsdbt.not_null_stg_matchdetails_matchId.ccf9298db9' (models/staging/schema.yml) depends on a node named 'stg_matchdetails' which was not found
05:21:59.279470 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.leagueoflegendsdbt.unique_stg_matchdetails_matchId.56880de6ad' (models/staging/schema.yml) depends on a node named 'stg_matchdetails' which was not found
05:21:59.293850 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.warehouse
- models.leagueoflegendsdbt.view

05:21:59.306409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '090229d4-f030-49eb-8fae-31d18b42a2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f206291bfd0>]}
05:21:59.322274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '090229d4-f030-49eb-8fae-31d18b42a2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2065e5d430>]}
05:21:59.323235 [info ] [MainThread]: Found 7 models, 10 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
05:21:59.324183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '090229d4-f030-49eb-8fae-31d18b42a2c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20380642e0>]}
05:21:59.328429 [info ] [MainThread]: 
05:21:59.329861 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:21:59.331949 [debug] [MainThread]: Connection 'master' was properly closed.
05:21:59.332465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2065e5d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2065de55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2065ddbd00>]}


============================== 2022-06-13 05:24:49.154142 | 13ac39b1-3329-4054-a646-4dd245ca6b8a ==============================
05:24:49.154202 [info ] [MainThread]: Running with dbt=1.1.0
05:24:49.154781 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:24:49.154998 [debug] [MainThread]: Tracking: tracking
05:24:49.155382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9dca72850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9dca728b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9dca72910>]}
05:24:49.223621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
05:24:49.224562 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging/schema.yml
05:24:49.225153 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging/stg_match_details.sql
05:24:49.225575 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging/stg_match_info.sql
05:24:49.247027 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
05:24:49.265172 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
05:24:49.325363 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.view
- models.leagueoflegendsdbt.warehouse

05:24:49.336061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13ac39b1-3329-4054-a646-4dd245ca6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0b5d3cd0>]}
05:24:49.353085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13ac39b1-3329-4054-a646-4dd245ca6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa10f13310>]}
05:24:49.353868 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
05:24:49.354496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ac39b1-3329-4054-a646-4dd245ca6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa0b5ad340>]}
05:24:49.358915 [info ] [MainThread]: 
05:24:49.360530 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:24:49.361903 [debug] [MainThread]: Connection 'master' was properly closed.
05:24:49.362437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa10f13070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa10eee4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa10e91760>]}


============================== 2022-06-13 05:35:23.198303 | 60965ab0-10fd-4606-815a-dc5cd20c6f86 ==============================
05:35:23.198333 [info ] [MainThread]: Running with dbt=1.1.0
05:35:23.199313 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:35:23.200073 [debug] [MainThread]: Tracking: tracking
05:35:23.202232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed8e26790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed8e267f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9ed8e26850>]}
05:35:24.626364 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
05:35:24.626978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
05:35:24.628333 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.view
- models.leagueoflegendsdbt.warehouse

05:35:24.647212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '60965ab0-10fd-4606-815a-dc5cd20c6f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0d19e100>]}
05:35:25.144940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60965ab0-10fd-4606-815a-dc5cd20c6f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0d260550>]}
05:35:25.145813 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
05:35:25.146934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '60965ab0-10fd-4606-815a-dc5cd20c6f86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0d19cee0>]}
05:35:25.151529 [info ] [MainThread]: 
05:35:25.152948 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:35:25.155289 [debug] [MainThread]: Connection 'master' was properly closed.
05:35:25.155865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0d260070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0d2600a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9f0d200160>]}


============================== 2022-06-13 05:35:54.532545 | 60445d13-fb35-43fa-af0c-d8ee9a78e328 ==============================
05:35:54.532563 [info ] [MainThread]: Running with dbt=1.1.0
05:35:54.533122 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
05:35:54.533364 [debug] [MainThread]: Tracking: tracking
05:35:54.534759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8428ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8405b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8405bb0>]}
05:35:54.535968 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hz3qfgih'
05:35:54.536550 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
05:35:54.761239 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
05:35:54.762390 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
05:35:54.936320 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
05:35:55.020817 [info ] [MainThread]: Installing dbt-labs/dbt_utils
05:35:55.632957 [info ] [MainThread]:   Installed from version 0.8.5
05:35:55.633719 [info ] [MainThread]:   Up to date!
05:35:55.634741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '60445d13-fb35-43fa-af0c-d8ee9a78e328', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8405b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd84ed460>]}
05:35:55.636465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd833e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd840d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbcd8332ee0>]}


============================== 2022-06-13 05:36:05.313930 | 8ed44f89-c416-4830-87fb-337f215fbfc4 ==============================
05:36:05.313963 [info ] [MainThread]: Running with dbt=1.1.0
05:36:05.315184 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
05:36:05.315878 [debug] [MainThread]: Tracking: tracking
05:36:05.317105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa4bc4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa4bc47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaa4bc4820>]}
05:36:05.495087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
05:36:05.495674 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
05:36:05.496964 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.warehouse
- models.leagueoflegendsdbt.view

05:36:05.513493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ed44f89-c416-4830-87fb-337f215fbfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead8f23100>]}
05:36:05.547839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ed44f89-c416-4830-87fb-337f215fbfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead8fe5550>]}
05:36:05.549224 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
05:36:05.550981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ed44f89-c416-4830-87fb-337f215fbfc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead8f21ee0>]}
05:36:05.565882 [info ] [MainThread]: 
05:36:05.568169 [debug] [MainThread]: Acquiring new snowflake connection "master"
05:36:05.570834 [debug] [MainThread]: Connection 'master' was properly closed.
05:36:05.571921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead8fe5070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead8fe50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fead8f86160>]}


============================== 2022-06-14 02:06:55.433699 | 2c4fa18b-7b57-49ad-abc7-9eb9e58bcfb6 ==============================
02:06:55.433715 [info ] [MainThread]: Running with dbt=1.1.0
02:06:55.435266 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
02:06:55.435522 [debug] [MainThread]: Tracking: tracking
02:06:55.436938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88866a1be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88866a1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88866a1eb0>]}
02:06:55.437919 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-b9_p4evb'
02:06:55.438303 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
02:06:55.832229 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
02:06:55.832948 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
02:06:56.148145 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
02:06:56.200578 [info ] [MainThread]: Installing dbt-labs/dbt_utils
02:06:56.778693 [info ] [MainThread]:   Installed from version 0.8.5
02:06:56.779198 [info ] [MainThread]:   Up to date!
02:06:56.779795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '2c4fa18b-7b57-49ad-abc7-9eb9e58bcfb6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88866a1820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f888678b760>]}
02:06:56.780735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88865dd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88866c6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88866aa4c0>]}


============================== 2022-06-14 02:07:19.241647 | edf1c236-39f1-48a0-800e-5f582ca759df ==============================
02:07:19.241671 [info ] [MainThread]: Running with dbt=1.1.0
02:07:19.242363 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:07:19.242565 [debug] [MainThread]: Tracking: tracking
02:07:19.242977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb78050880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb780508e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb78050940>]}
02:07:19.345205 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:07:19.345756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:07:19.347113 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.warehouse
- models.leagueoflegendsdbt.view

02:07:19.358792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edf1c236-39f1-48a0-800e-5f582ca759df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba819b1c0>]}
02:07:19.372679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edf1c236-39f1-48a0-800e-5f582ca759df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba824f070>]}
02:07:19.373285 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 9 sources, 0 exposures, 0 metrics
02:07:19.373734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edf1c236-39f1-48a0-800e-5f582ca759df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba8199fa0>]}
02:07:19.376913 [info ] [MainThread]: 
02:07:19.377585 [debug] [MainThread]: Acquiring new snowflake connection "master"
02:07:19.378866 [debug] [MainThread]: Connection 'master' was properly closed.
02:07:19.379271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba8207160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba8207220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba81fe850>]}


============================== 2022-06-14 02:11:07.690285 | 17ba4dc5-e76f-4cd5-834e-289290d03628 ==============================
02:11:07.690300 [info ] [MainThread]: Running with dbt=1.1.0
02:11:07.690749 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
02:11:07.690937 [debug] [MainThread]: Tracking: tracking
02:11:07.692189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9423816ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9423816670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94238165b0>]}
02:11:07.693489 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-yx2d_qlf'
02:11:07.693943 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
02:11:07.858403 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
02:11:07.859200 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
02:11:07.977824 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
02:11:08.041160 [info ] [MainThread]: Installing dbt-labs/dbt_utils
02:11:08.610493 [info ] [MainThread]:   Installed from version 0.8.5
02:11:08.610957 [info ] [MainThread]:   Up to date!
02:11:08.611326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '17ba4dc5-e76f-4cd5-834e-289290d03628', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94238e1b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94239ce7c0>]}
02:11:08.611853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9428d4b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9423908f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f94238ef5b0>]}


============================== 2022-06-14 02:11:14.521995 | cf46a861-46c1-48cf-af6b-f1d22b90ab34 ==============================
02:11:14.522020 [info ] [MainThread]: Running with dbt=1.1.0
02:11:14.522672 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:11:14.523153 [debug] [MainThread]: Tracking: tracking
02:11:14.523915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5519f58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5519f5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff5519f5970>]}
02:11:14.596286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 8 files changed.
02:11:14.597620 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_champions
02:11:14.598294 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_maps
02:11:14.598876 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_items
02:11:14.599295 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_runes_reforged
02:11:14.599788 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_summonerspells
02:11:14.600155 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_match_details
02:11:14.600441 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_match_info
02:11:14.600714 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging_datadragon/schema.yml
02:11:14.601262 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging/stg_match_info.sql
02:11:14.601833 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_runes_reforged.sql
02:11:14.602374 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging/stg_match_details.sql
02:11:14.602727 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_summonerspells.sql
02:11:14.603089 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_maps.sql
02:11:14.603559 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_champions.sql
02:11:14.603912 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
02:11:14.621301 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
02:11:14.636813 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
02:11:14.641268 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
02:11:14.645338 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
02:11:14.650355 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
02:11:14.654236 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
02:11:14.658016 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
02:11:14.764587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff585debe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff580515340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff580515be0>]}


============================== 2022-06-14 02:12:15.836953 | 22bdd944-3333-45f0-99a0-f22a096d1990 ==============================
02:12:15.836975 [info ] [MainThread]: Running with dbt=1.1.0
02:12:15.837508 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:12:15.837746 [debug] [MainThread]: Tracking: tracking
02:12:15.838209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef381088b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef38108910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef38108970>]}
02:12:15.898225 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 9 files changed.
02:12:15.899014 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_matchdetails
02:12:15.899444 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_matchinfo
02:12:15.899689 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging/schema.yml
02:12:15.900150 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_champions
02:12:15.900433 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_maps
02:12:15.900739 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_items
02:12:15.900925 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_runes_reforged
02:12:15.901186 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_summonerspells
02:12:15.901359 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_match_details
02:12:15.901524 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_match_info
02:12:15.901700 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging_datadragon/schema.yml
02:12:15.901943 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_champions.sql
02:12:15.902175 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_maps.sql
02:12:15.902404 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging/stg_match_info.sql
02:12:15.902780 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging/stg_match_details.sql
02:12:15.903169 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
02:12:15.903711 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_runes_reforged.sql
02:12:15.904080 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_summonerspells.sql
02:12:15.921666 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
02:12:15.936873 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
02:12:15.940290 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
02:12:15.943966 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
02:12:15.948296 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
02:12:15.952542 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
02:12:15.957273 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
02:12:16.048036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef68048dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef627e88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef627e8100>]}


============================== 2022-06-14 02:13:44.352734 | 7148e418-c36c-4726-857d-0bdd158e7d30 ==============================
02:13:44.352763 [info ] [MainThread]: Running with dbt=1.1.0
02:13:44.353407 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:13:44.353692 [debug] [MainThread]: Tracking: tracking
02:13:44.354153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340011f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340011f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f340011f8b0>]}
02:13:44.422719 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 9 files changed.
02:13:44.423601 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_matchdetails
02:13:44.424013 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_matchinfo
02:13:44.424200 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging/schema.yml
02:13:44.424637 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_champions
02:13:44.424924 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_maps
02:13:44.425191 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_items
02:13:44.425369 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_runes_reforged
02:13:44.425629 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_summonerspells
02:13:44.425853 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_match_details
02:13:44.426027 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_match_info
02:13:44.426244 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging_datadragon/schema.yml
02:13:44.426650 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_summonerspells.sql
02:13:44.427045 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
02:13:44.427415 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_runes_reforged.sql
02:13:44.427679 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging/stg_match_details.sql
02:13:44.428015 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_champions.sql
02:13:44.428581 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_maps.sql
02:13:44.429137 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging/stg_match_info.sql
02:13:44.448443 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
02:13:44.466654 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
02:13:44.470028 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
02:13:44.473385 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
02:13:44.479232 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
02:13:44.482924 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
02:13:44.487131 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
02:13:44.585739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342f7b5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342e196ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f342e196310>]}


============================== 2022-06-14 02:17:37.464880 | ea644c55-d9c2-422c-bc35-f3bcee7f9585 ==============================
02:17:37.464904 [info ] [MainThread]: Running with dbt=1.1.0
02:17:37.465528 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:17:37.465759 [debug] [MainThread]: Tracking: tracking
02:17:37.466170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece081790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece0817f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ece081850>]}
02:17:37.530311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 9 files changed.
02:17:37.531220 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_matchdetails
02:17:37.531766 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_matchinfo
02:17:37.532105 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging/schema.yml
02:17:37.532769 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_champions
02:17:37.533305 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_maps
02:17:37.533838 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_items
02:17:37.534123 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_runes_reforged
02:17:37.534483 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_datadragon_summonerspells
02:17:37.534688 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_match_details
02:17:37.534866 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.league_of_legends_data.staging_match_info
02:17:37.535087 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging_datadragon/schema.yml
02:17:37.535404 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging/stg_match_info.sql
02:17:37.535735 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_summonerspells.sql
02:17:37.536174 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging/stg_match_details.sql
02:17:37.536658 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_champions.sql
02:17:37.536975 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_maps.sql
02:17:37.537220 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
02:17:37.537546 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_runes_reforged.sql
02:17:37.560781 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
02:17:37.578879 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
02:17:37.582289 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
02:17:37.585672 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
02:17:37.590638 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
02:17:37.594149 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
02:17:37.597801 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
02:17:37.718003 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.warehouse
- models.leagueoflegendsdbt.view

02:17:37.729532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea644c55-d9c2-422c-bc35-f3bcee7f9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f00d9cf10>]}
02:17:37.747256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea644c55-d9c2-422c-bc35-f3bcee7f9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0249b490>]}
02:17:37.747835 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
02:17:37.748462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea644c55-d9c2-422c-bc35-f3bcee7f9585', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0249b4c0>]}
02:17:37.752263 [info ] [MainThread]: 
02:17:37.753404 [debug] [MainThread]: Acquiring new snowflake connection "master"
02:17:37.755067 [debug] [MainThread]: Connection 'master' was properly closed.
02:17:37.755744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f0242f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f024d6160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f024570a0>]}


============================== 2022-06-14 02:20:32.156256 | c00374de-bbad-4621-932d-2474089e36c8 ==============================
02:20:32.156310 [info ] [MainThread]: Running with dbt=1.1.0
02:20:32.156911 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:20:32.157107 [debug] [MainThread]: Tracking: tracking
02:20:32.157499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d801038b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d80103910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d80103970>]}
02:20:32.220584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:20:32.220989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:20:32.221985 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.view
- models.leagueoflegendsdbt.warehouse

02:20:32.232083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c00374de-bbad-4621-932d-2474089e36c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dafb9cf70>]}
02:20:32.242878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c00374de-bbad-4621-932d-2474089e36c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dafc65280>]}
02:20:32.243341 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
02:20:32.243870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c00374de-bbad-4621-932d-2474089e36c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dafc653a0>]}
02:20:32.246839 [info ] [MainThread]: 
02:20:32.247779 [debug] [MainThread]: Acquiring new snowflake connection "master"
02:20:32.249260 [debug] [MainThread]: Connection 'master' was properly closed.
02:20:32.249783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dafc65d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1dafc65b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1d800724c0>]}


============================== 2022-06-14 02:25:39.328166 | 27737cdf-6db6-4733-8927-3a56956354ef ==============================
02:25:39.328187 [info ] [MainThread]: Running with dbt=1.1.0
02:25:39.328895 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
02:25:39.329123 [debug] [MainThread]: Tracking: tracking
02:25:39.329565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03cfa38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03cfa3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb03cfa3970>]}
02:25:39.386920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:25:39.387198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:25:39.387886 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.leagueoflegendsdbt.warehouse
- models.leagueoflegendsdbt.view

02:25:39.396092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27737cdf-6db6-4733-8927-3a56956354ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb07134bd60>]}
02:25:39.407247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27737cdf-6db6-4733-8927-3a56956354ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb071414160>]}
02:25:39.407652 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
02:25:39.408281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27737cdf-6db6-4733-8927-3a56956354ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb071414280>]}
02:25:39.410517 [info ] [MainThread]: 
02:25:39.410983 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
02:25:39.422013 [info ] [MainThread]: Done.
02:25:39.422696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb071414340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb071414370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0714143d0>]}


============================== 2022-06-14 02:26:36.194721 | f27d70a0-f9cb-43a1-8242-e2e155b097fb ==============================
02:26:36.194747 [info ] [MainThread]: Running with dbt=1.1.0
02:26:36.195421 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
02:26:36.195653 [debug] [MainThread]: Tracking: tracking
02:26:36.195999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ae552910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ae552970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ae5529d0>]}
02:26:36.230586 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:26:36.231073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f27d70a0-f9cb-43a1-8242-e2e155b097fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ae4b0280>]}
02:26:36.252034 [debug] [MainThread]: Parsing macros/match_details.sql
02:26:36.252472 [debug] [MainThread]: Parsing macros/adapters.sql
02:26:36.292668 [debug] [MainThread]: Parsing macros/catalog.sql
02:26:36.295577 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
02:26:36.297497 [debug] [MainThread]: Parsing macros/materializations/merge.sql
02:26:36.303811 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
02:26:36.318262 [debug] [MainThread]: Parsing macros/materializations/table.sql
02:26:36.323527 [debug] [MainThread]: Parsing macros/materializations/view.sql
02:26:36.325858 [debug] [MainThread]: Parsing macros/materializations/seed.sql
02:26:36.334361 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:26:36.349415 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:26:36.361099 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:26:36.365800 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:26:36.368859 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:26:36.371746 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:26:36.374532 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:26:36.382016 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:26:36.384744 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:26:36.386775 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:26:36.388449 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:26:36.397088 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:26:36.401791 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:26:36.402642 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:26:36.403628 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:26:36.404673 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:26:36.406429 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:26:36.408921 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:26:36.413166 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:26:36.415202 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:26:36.417422 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:26:36.422692 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:26:36.439953 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:26:36.447002 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:26:36.448934 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:26:36.460628 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:26:36.478227 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:26:36.490478 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:26:36.505952 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:26:36.521161 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:26:36.532185 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:26:36.533979 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:26:36.538869 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:26:36.542055 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:26:36.543782 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:26:36.551362 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:26:36.553944 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:26:36.557004 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:26:36.564428 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:26:36.567783 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
02:26:36.576406 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
02:26:36.583623 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
02:26:36.584730 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
02:26:36.594491 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
02:26:36.596660 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
02:26:36.598262 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
02:26:36.599816 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
02:26:36.601641 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
02:26:36.604778 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
02:26:36.606896 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
02:26:36.612069 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
02:26:36.613643 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
02:26:36.616374 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
02:26:36.617499 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
02:26:36.623523 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
02:26:36.627335 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
02:26:36.630161 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
02:26:36.632300 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
02:26:36.633561 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
02:26:36.635537 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
02:26:36.636970 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
02:26:36.638494 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
02:26:36.639673 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
02:26:36.644832 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
02:26:36.646044 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
02:26:36.648284 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
02:26:36.650519 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
02:26:36.653417 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
02:26:36.655245 [debug] [MainThread]: Parsing macros/sql/star.sql
02:26:36.659549 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
02:26:36.661592 [debug] [MainThread]: Parsing macros/sql/pivot.sql
02:26:36.667177 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
02:26:36.669351 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
02:26:36.672871 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
02:26:36.681705 [debug] [MainThread]: Parsing macros/sql/union.sql
02:26:36.693607 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
02:26:36.695714 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
02:26:36.702008 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
02:26:36.706794 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
02:26:36.710472 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
02:26:36.714197 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
02:26:36.721400 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
02:26:36.725745 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
02:26:36.732008 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
02:26:36.739787 [debug] [MainThread]: Parsing macros/sql/groupby.sql
02:26:36.741351 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
02:26:36.743186 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
02:26:36.745684 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
02:26:36.747636 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
02:26:36.751269 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
02:26:36.752641 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
02:26:36.754083 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
02:26:36.755706 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
02:26:36.757244 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
02:26:36.781978 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
02:26:36.784118 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
02:26:36.786345 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
02:26:36.788461 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
02:26:36.790031 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
02:26:36.792985 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
02:26:36.795383 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
02:26:36.797277 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
02:26:36.799866 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
02:26:36.808243 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
02:26:36.812439 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
02:26:36.814843 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
02:26:36.816305 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
02:26:36.817676 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
02:26:36.819455 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
02:26:36.823122 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
02:26:36.825089 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
02:26:37.261636 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
02:26:37.273822 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
02:26:37.276853 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
02:26:37.279973 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
02:26:37.283175 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
02:26:37.286826 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
02:26:37.289418 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
02:26:37.472918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f27d70a0-f9cb-43a1-8242-e2e155b097fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6df426ee0>]}
02:26:37.483145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f27d70a0-f9cb-43a1-8242-e2e155b097fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6df426ee0>]}
02:26:37.483605 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
02:26:37.483982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27d70a0-f9cb-43a1-8242-e2e155b097fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e2998a90>]}
02:26:37.485807 [info ] [MainThread]: 
02:26:37.486427 [warn ] [MainThread]: [[33mWARNING[0m]: Nothing to do. Try checking your model configs and model specification args
02:26:37.495829 [info ] [MainThread]: Done.
02:26:37.496530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ae4b6130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ae4b60d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6ae4b6160>]}


============================== 2022-06-14 02:29:32.619015 | c104cbbe-2479-48ac-b4f3-7502458a5ff4 ==============================
02:29:32.619041 [info ] [MainThread]: Running with dbt=1.1.0
02:29:32.619698 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:29:32.619917 [debug] [MainThread]: Tracking: tracking
02:29:32.620266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07700fc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07700fc820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07700fc880>]}
02:29:32.656456 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:29:32.657118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c104cbbe-2479-48ac-b4f3-7502458a5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f077005bf10>]}
02:29:32.683227 [debug] [MainThread]: Parsing macros/match_details.sql
02:29:32.683663 [debug] [MainThread]: Parsing macros/adapters.sql
02:29:32.729907 [debug] [MainThread]: Parsing macros/catalog.sql
02:29:32.732522 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
02:29:32.734114 [debug] [MainThread]: Parsing macros/materializations/merge.sql
02:29:32.741341 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
02:29:32.753663 [debug] [MainThread]: Parsing macros/materializations/table.sql
02:29:32.757732 [debug] [MainThread]: Parsing macros/materializations/view.sql
02:29:32.759626 [debug] [MainThread]: Parsing macros/materializations/seed.sql
02:29:32.765823 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:29:32.777569 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:29:32.789991 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:29:32.795009 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:29:32.798302 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:29:32.802250 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:29:32.805042 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:29:32.813313 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:29:32.816201 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:29:32.818268 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:29:32.820033 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:29:32.828900 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:29:32.834048 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:29:32.834916 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:29:32.835871 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:29:32.836952 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:29:32.838666 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:29:32.841300 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:29:32.845668 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:29:32.847932 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:29:32.850060 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:29:32.855231 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:29:32.873228 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:29:32.881086 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:29:32.884138 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:29:32.896703 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:29:32.914811 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:29:32.928264 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:29:32.943615 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:29:32.961148 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:29:32.973205 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:29:32.975281 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:29:32.981151 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:29:32.984599 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:29:32.987605 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:29:32.995176 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:29:32.998025 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:29:33.001735 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:29:33.009808 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:29:33.013755 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
02:29:33.023702 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
02:29:33.030464 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
02:29:33.031899 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
02:29:33.042677 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
02:29:33.044978 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
02:29:33.047321 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
02:29:33.048861 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
02:29:33.051093 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
02:29:33.054423 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
02:29:33.056797 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
02:29:33.061956 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
02:29:33.063698 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
02:29:33.066332 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
02:29:33.067673 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
02:29:33.074049 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
02:29:33.078700 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
02:29:33.081664 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
02:29:33.084150 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
02:29:33.085713 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
02:29:33.087953 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
02:29:33.089584 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
02:29:33.091565 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
02:29:33.092994 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
02:29:33.098971 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
02:29:33.100309 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
02:29:33.101895 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
02:29:33.104323 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
02:29:33.107133 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
02:29:33.108983 [debug] [MainThread]: Parsing macros/sql/star.sql
02:29:33.112878 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
02:29:33.115073 [debug] [MainThread]: Parsing macros/sql/pivot.sql
02:29:33.120066 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
02:29:33.122336 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
02:29:33.125731 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
02:29:33.134778 [debug] [MainThread]: Parsing macros/sql/union.sql
02:29:33.147308 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
02:29:33.149428 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
02:29:33.156002 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
02:29:33.161078 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
02:29:33.165142 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
02:29:33.169371 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
02:29:33.179382 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
02:29:33.185180 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
02:29:33.193073 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
02:29:33.200384 [debug] [MainThread]: Parsing macros/sql/groupby.sql
02:29:33.202415 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
02:29:33.205183 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
02:29:33.208391 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
02:29:33.210462 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
02:29:33.214547 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
02:29:33.216400 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
02:29:33.217905 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
02:29:33.219627 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
02:29:33.221459 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
02:29:33.247745 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
02:29:33.250193 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
02:29:33.253078 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
02:29:33.255676 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
02:29:33.257848 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
02:29:33.261333 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
02:29:33.264388 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
02:29:33.267197 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
02:29:33.270171 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
02:29:33.280814 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
02:29:33.285852 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
02:29:33.288520 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
02:29:33.290251 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
02:29:33.292011 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
02:29:33.293874 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
02:29:33.298009 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
02:29:33.299993 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
02:29:33.796837 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
02:29:33.811305 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
02:29:33.815284 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
02:29:33.818785 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
02:29:33.822268 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
02:29:33.826207 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
02:29:33.829549 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
02:29:34.037506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c104cbbe-2479-48ac-b4f3-7502458a5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079baf5100>]}
02:29:34.049623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c104cbbe-2479-48ac-b4f3-7502458a5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079baf5be0>]}
02:29:34.050080 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
02:29:34.050479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c104cbbe-2479-48ac-b4f3-7502458a5ff4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079baf57c0>]}
02:29:34.053287 [info ] [MainThread]: 
02:29:34.054050 [debug] [MainThread]: Acquiring new snowflake connection "master"
02:29:34.055287 [debug] [MainThread]: Connection 'master' was properly closed.
02:29:34.055737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079baf5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f079f04f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07700bdcd0>]}


============================== 2022-06-14 02:31:55.902833 | 455dddc9-2541-4bba-b96a-26fb5bfc1967 ==============================
02:31:55.902848 [info ] [MainThread]: Running with dbt=1.1.0
02:31:55.903305 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
02:31:55.903510 [debug] [MainThread]: Tracking: tracking
02:31:55.904572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4296c5e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4296c5e7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4296c5e5e0>]}
02:31:55.905499 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-rxv07_t5'
02:31:55.905880 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
02:31:56.140021 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
02:31:56.140788 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
02:31:56.312774 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
02:31:56.366790 [info ] [MainThread]: Installing dbt-labs/dbt_utils
02:31:56.928557 [info ] [MainThread]:   Installed from version 0.8.5
02:31:56.928979 [info ] [MainThread]:   Up to date!
02:31:56.929423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '455dddc9-2541-4bba-b96a-26fb5bfc1967', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4296c87820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4296c871c0>]}
02:31:56.929915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4296aec670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4296c873a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4296c87760>]}


============================== 2022-06-14 02:32:00.896668 | bc6c38ad-adff-4e3b-a9d0-f7d65ba50436 ==============================
02:32:00.896689 [info ] [MainThread]: Running with dbt=1.1.0
02:32:00.897229 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:32:00.897427 [debug] [MainThread]: Tracking: tracking
02:32:00.897720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427c7467f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427c746850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427c7468b0>]}
02:32:00.930056 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
02:32:00.930742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc6c38ad-adff-4e3b-a9d0-f7d65ba50436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427c6e72e0>]}
02:32:00.954238 [debug] [MainThread]: Parsing macros/match_details.sql
02:32:00.954745 [debug] [MainThread]: Parsing macros/adapters.sql
02:32:00.994762 [debug] [MainThread]: Parsing macros/catalog.sql
02:32:00.996936 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
02:32:00.998208 [debug] [MainThread]: Parsing macros/materializations/merge.sql
02:32:01.003766 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
02:32:01.013182 [debug] [MainThread]: Parsing macros/materializations/table.sql
02:32:01.017903 [debug] [MainThread]: Parsing macros/materializations/view.sql
02:32:01.019498 [debug] [MainThread]: Parsing macros/materializations/seed.sql
02:32:01.024781 [debug] [MainThread]: Parsing macros/adapters/columns.sql
02:32:01.034748 [debug] [MainThread]: Parsing macros/adapters/relation.sql
02:32:01.044598 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
02:32:01.049508 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
02:32:01.052837 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
02:32:01.056477 [debug] [MainThread]: Parsing macros/adapters/schema.sql
02:32:01.059287 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
02:32:01.066694 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
02:32:01.069295 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
02:32:01.071013 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
02:32:01.072864 [debug] [MainThread]: Parsing macros/etc/datetime.sql
02:32:01.082312 [debug] [MainThread]: Parsing macros/etc/statement.sql
02:32:01.087391 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
02:32:01.088507 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
02:32:01.089722 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
02:32:01.090928 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
02:32:01.092645 [debug] [MainThread]: Parsing macros/materializations/configs.sql
02:32:01.095758 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
02:32:01.099914 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
02:32:01.101952 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
02:32:01.103898 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
02:32:01.108989 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
02:32:01.125303 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
02:32:01.132772 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
02:32:01.134823 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
02:32:01.146947 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
02:32:01.167542 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
02:32:01.180348 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
02:32:01.195618 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
02:32:01.212297 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
02:32:01.223316 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
02:32:01.225130 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
02:32:01.230098 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
02:32:01.233157 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
02:32:01.234955 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
02:32:01.242217 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
02:32:01.245064 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
02:32:01.248699 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
02:32:01.256301 [debug] [MainThread]: Parsing tests/generic/builtin.sql
02:32:01.260086 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
02:32:01.268955 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
02:32:01.275693 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
02:32:01.277327 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
02:32:01.287584 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
02:32:01.289933 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
02:32:01.291700 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
02:32:01.293093 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
02:32:01.294894 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
02:32:01.298446 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
02:32:01.300824 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
02:32:01.305187 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
02:32:01.307056 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
02:32:01.309400 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
02:32:01.310829 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
02:32:01.318448 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
02:32:01.322368 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
02:32:01.324878 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
02:32:01.327295 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
02:32:01.328932 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
02:32:01.331018 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
02:32:01.332759 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
02:32:01.334696 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
02:32:01.336449 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
02:32:01.342079 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
02:32:01.343660 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
02:32:01.346259 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
02:32:01.349138 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
02:32:01.352227 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
02:32:01.354160 [debug] [MainThread]: Parsing macros/sql/star.sql
02:32:01.358036 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
02:32:01.360011 [debug] [MainThread]: Parsing macros/sql/pivot.sql
02:32:01.364460 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
02:32:01.366495 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
02:32:01.369745 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
02:32:01.379030 [debug] [MainThread]: Parsing macros/sql/union.sql
02:32:01.390291 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
02:32:01.392427 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
02:32:01.398733 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
02:32:01.403679 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
02:32:01.408325 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
02:32:01.412621 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
02:32:01.420204 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
02:32:01.425221 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
02:32:01.431843 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
02:32:01.438461 [debug] [MainThread]: Parsing macros/sql/groupby.sql
02:32:01.440113 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
02:32:01.442665 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
02:32:01.445608 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
02:32:01.447798 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
02:32:01.451616 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
02:32:01.454567 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
02:32:01.456477 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
02:32:01.458116 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
02:32:01.459470 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
02:32:01.485168 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
02:32:01.487323 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
02:32:01.489724 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
02:32:01.492076 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
02:32:01.493686 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
02:32:01.496767 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
02:32:01.499304 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
02:32:01.501217 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
02:32:01.503999 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
02:32:01.512509 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
02:32:01.516785 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
02:32:01.519653 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
02:32:01.521657 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
02:32:01.523590 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
02:32:01.525661 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
02:32:01.529196 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
02:32:01.531257 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
02:32:01.978179 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
02:32:01.991925 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
02:32:01.994689 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
02:32:01.997535 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
02:32:02.000600 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
02:32:02.004406 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
02:32:02.007551 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
02:32:02.199305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc6c38ad-adff-4e3b-a9d0-f7d65ba50436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42ad5cb7f0>]}
02:32:02.210024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc6c38ad-adff-4e3b-a9d0-f7d65ba50436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42ad5cb820>]}
02:32:02.210454 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
02:32:02.210825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc6c38ad-adff-4e3b-a9d0-f7d65ba50436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42ad5cb670>]}
02:32:02.212834 [info ] [MainThread]: 
02:32:02.213647 [debug] [MainThread]: Acquiring new snowflake connection "master"
02:32:02.214723 [debug] [MainThread]: Connection 'master' was properly closed.
02:32:02.215103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42ad5cb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42ad5c5d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42b0bae850>]}


============================== 2022-06-14 02:37:07.042573 | d7a94fe3-a012-49e1-985d-5e52f2b4a94f ==============================
02:37:07.042592 [info ] [MainThread]: Running with dbt=1.1.0
02:37:07.043113 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
02:37:07.043336 [debug] [MainThread]: Tracking: tracking
02:37:07.044475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b6b5b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b6b5b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b6b5b670>]}
02:37:07.045375 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vevuqooj'
02:37:07.045741 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
02:37:07.434611 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
02:37:07.435866 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
02:37:07.751299 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
02:37:07.802834 [info ] [MainThread]: Installing dbt-labs/dbt_utils
02:37:08.377130 [info ] [MainThread]:   Installed from version 0.8.5
02:37:08.377571 [info ] [MainThread]:   Up to date!
02:37:08.377979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd7a94fe3-a012-49e1-985d-5e52f2b4a94f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b6b81760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b6b81610>]}
02:37:08.378533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b69f3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b6b81280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08b6b81130>]}


============================== 2022-06-14 02:37:12.409472 | fbde4a49-cf19-4271-b6ed-2825389fde32 ==============================
02:37:12.409495 [info ] [MainThread]: Running with dbt=1.1.0
02:37:12.410192 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:37:12.410383 [debug] [MainThread]: Tracking: tracking
02:37:12.410702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca29670af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca29670d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca29670b20>]}
02:37:12.461942 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
02:37:12.462251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
02:37:12.470354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbde4a49-cf19-4271-b6ed-2825389fde32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5d9e1eb0>]}
02:37:12.480608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbde4a49-cf19-4271-b6ed-2825389fde32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca295e7a30>]}
02:37:12.481051 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
02:37:12.481431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbde4a49-cf19-4271-b6ed-2825389fde32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca295e7be0>]}
02:37:12.483427 [info ] [MainThread]: 
02:37:12.484091 [debug] [MainThread]: Acquiring new snowflake connection "master"
02:37:12.484989 [debug] [MainThread]: Connection 'master' was properly closed.
02:37:12.485278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca295e7640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca295e7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca5da4eb50>]}


============================== 2022-06-14 03:01:49.824264 | ace76dce-95df-47d7-a18c-ab0dea421ca7 ==============================
03:01:49.824307 [info ] [MainThread]: Running with dbt=1.1.0
03:01:49.825530 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
03:01:49.826238 [debug] [MainThread]: Tracking: tracking
03:01:49.827120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd88e9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd88e97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd88e9820>]}
03:01:49.871131 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
03:01:49.871718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ace76dce-95df-47d7-a18c-ab0dea421ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd888aeb0>]}
03:01:49.896854 [debug] [MainThread]: Parsing macros/match_details.sql
03:01:49.897365 [debug] [MainThread]: Parsing macros/adapters.sql
03:01:49.941317 [debug] [MainThread]: Parsing macros/catalog.sql
03:01:49.943930 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
03:01:49.945371 [debug] [MainThread]: Parsing macros/materializations/merge.sql
03:01:49.949927 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
03:01:49.961430 [debug] [MainThread]: Parsing macros/materializations/table.sql
03:01:49.965807 [debug] [MainThread]: Parsing macros/materializations/view.sql
03:01:49.968572 [debug] [MainThread]: Parsing macros/materializations/seed.sql
03:01:49.976340 [debug] [MainThread]: Parsing macros/adapters/columns.sql
03:01:49.990805 [debug] [MainThread]: Parsing macros/adapters/relation.sql
03:01:50.003289 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
03:01:50.009486 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
03:01:50.013244 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
03:01:50.016612 [debug] [MainThread]: Parsing macros/adapters/schema.sql
03:01:50.019012 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
03:01:50.028648 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
03:01:50.031823 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
03:01:50.033984 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
03:01:50.036155 [debug] [MainThread]: Parsing macros/etc/datetime.sql
03:01:50.045776 [debug] [MainThread]: Parsing macros/etc/statement.sql
03:01:50.051356 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
03:01:50.052507 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
03:01:50.053691 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
03:01:50.055019 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
03:01:50.057048 [debug] [MainThread]: Parsing macros/materializations/configs.sql
03:01:50.059797 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
03:01:50.064555 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
03:01:50.067143 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
03:01:50.069708 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
03:01:50.074863 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
03:01:50.094005 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
03:01:50.101810 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
03:01:50.104002 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
03:01:50.115245 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
03:01:50.134402 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
03:01:50.147947 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
03:01:50.164007 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
03:01:50.181096 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
03:01:50.192336 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
03:01:50.194502 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
03:01:50.200168 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
03:01:50.203435 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
03:01:50.205311 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
03:01:50.212885 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
03:01:50.215769 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
03:01:50.219565 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
03:01:50.227882 [debug] [MainThread]: Parsing tests/generic/builtin.sql
03:01:50.231739 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
03:01:50.241999 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
03:01:50.249234 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
03:01:50.250852 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
03:01:50.261697 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
03:01:50.264182 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
03:01:50.266338 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
03:01:50.267846 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
03:01:50.269976 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
03:01:50.273456 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
03:01:50.275483 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
03:01:50.280074 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
03:01:50.281499 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
03:01:50.283924 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
03:01:50.285305 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
03:01:50.292330 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
03:01:50.296195 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
03:01:50.301098 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
03:01:50.303570 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
03:01:50.305675 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
03:01:50.307612 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
03:01:50.309149 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
03:01:50.310675 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
03:01:50.312294 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
03:01:50.319698 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
03:01:50.321492 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
03:01:50.323350 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
03:01:50.326203 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
03:01:50.330209 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
03:01:50.332630 [debug] [MainThread]: Parsing macros/sql/star.sql
03:01:50.336534 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
03:01:50.338410 [debug] [MainThread]: Parsing macros/sql/pivot.sql
03:01:50.343309 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
03:01:50.346073 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
03:01:50.349678 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
03:01:50.359149 [debug] [MainThread]: Parsing macros/sql/union.sql
03:01:50.372298 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
03:01:50.375724 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
03:01:50.383396 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
03:01:50.389444 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
03:01:50.394592 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
03:01:50.399288 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
03:01:50.408452 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
03:01:50.414867 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
03:01:50.422964 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
03:01:50.431169 [debug] [MainThread]: Parsing macros/sql/groupby.sql
03:01:50.433824 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
03:01:50.436535 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
03:01:50.440243 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
03:01:50.442753 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
03:01:50.447535 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
03:01:50.449871 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
03:01:50.452352 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
03:01:50.454146 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
03:01:50.455727 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
03:01:50.484604 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
03:01:50.487820 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
03:01:50.490487 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
03:01:50.493297 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
03:01:50.495510 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
03:01:50.499485 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
03:01:50.503183 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
03:01:50.505564 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
03:01:50.509629 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
03:01:50.519529 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
03:01:50.524825 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
03:01:50.528510 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
03:01:50.531220 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
03:01:50.533374 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
03:01:50.536019 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
03:01:50.540046 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
03:01:50.542487 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
03:01:51.063631 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
03:01:51.076734 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
03:01:51.079653 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
03:01:51.082517 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
03:01:51.085763 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
03:01:51.089360 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
03:01:51.092554 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
03:01:51.300127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ace76dce-95df-47d7-a18c-ab0dea421ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ccf2e50>]}
03:01:51.311391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ace76dce-95df-47d7-a18c-ab0dea421ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ccf2f70>]}
03:01:51.311892 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
03:01:51.312440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ace76dce-95df-47d7-a18c-ab0dea421ca7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ccf2490>]}
03:01:51.315249 [info ] [MainThread]: 
03:01:51.316105 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:01:51.317545 [debug] [MainThread]: Connection 'master' was properly closed.
03:01:51.318065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ccf25e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0ccf21f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0cd78d60>]}


============================== 2022-06-14 03:02:32.265097 | e6a1b9e2-84c3-4d45-85e9-ffd8299d2762 ==============================
03:02:32.265131 [info ] [MainThread]: Running with dbt=1.1.0
03:02:32.266303 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
03:02:32.266703 [debug] [MainThread]: Tracking: tracking
03:02:32.267193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb964feb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb964fecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb964feee0>]}
03:02:32.344761 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:02:32.345364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:02:32.353900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6a1b9e2-84c3-4d45-85e9-ffd8299d2762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca89ddf0>]}
03:02:32.365889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6a1b9e2-84c3-4d45-85e9-ffd8299d2762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcaa28970>]}
03:02:32.366512 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
03:02:32.367050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a1b9e2-84c3-4d45-85e9-ffd8299d2762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcaa28b20>]}
03:02:32.370116 [info ] [MainThread]: 
03:02:32.370864 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:02:32.372488 [debug] [MainThread]: Connection 'master' was properly closed.
03:02:32.373121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcaa28580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febcaa28340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febca909a90>]}


============================== 2022-06-14 03:30:56.698006 | 5467cacc-9c13-473d-a6b0-c07c3d1e607d ==============================
03:30:56.698034 [info ] [MainThread]: Running with dbt=1.1.0
03:30:56.698974 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
03:30:56.699427 [debug] [MainThread]: Tracking: tracking
03:30:56.700283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe000d9e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe000d9e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe000d9e970>]}
03:30:56.761207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:30:56.761702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:30:56.770183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5467cacc-9c13-473d-a6b0-c07c3d1e607d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe035131fa0>]}
03:30:56.781682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5467cacc-9c13-473d-a6b0-c07c3d1e607d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0351f4b20>]}
03:30:56.782227 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
03:30:56.782740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5467cacc-9c13-473d-a6b0-c07c3d1e607d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0351f4cd0>]}
03:30:56.785381 [info ] [MainThread]: 
03:30:56.786253 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:30:56.787356 [debug] [MainThread]: Connection 'master' was properly closed.
03:30:56.787780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0351f4730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0351f44f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe03519cc40>]}


============================== 2022-06-14 03:31:26.452171 | f61f270d-6121-4793-9366-f7f00422df7a ==============================
03:31:26.452192 [info ] [MainThread]: Running with dbt=1.1.0
03:31:26.452766 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
03:31:26.452992 [debug] [MainThread]: Tracking: tracking
03:31:26.453350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f880ea5f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f880ea5f940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f880ea5f9a0>]}
03:31:26.522831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:31:26.523166 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:31:26.531394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f61f270d-6121-4793-9366-f7f00422df7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8842e24ee0>]}
03:31:26.543209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f61f270d-6121-4793-9366-f7f00422df7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8842ee7b50>]}
03:31:26.543626 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
03:31:26.544056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f61f270d-6121-4793-9366-f7f00422df7a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8842ee7d00>]}
03:31:26.546700 [info ] [MainThread]: 
03:31:26.547508 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:31:26.548824 [debug] [MainThread]: Connection 'master' was properly closed.
03:31:26.549313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8842ee7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8842ee7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8842e8fc70>]}


============================== 2022-06-14 03:37:27.216378 | 17c491e8-7a89-4be7-8852-096ff5814730 ==============================
03:37:27.216404 [info ] [MainThread]: Running with dbt=1.1.0
03:37:27.217021 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
03:37:27.217252 [debug] [MainThread]: Tracking: tracking
03:37:27.217649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce98050850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce980508b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce98050910>]}
03:37:27.272877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:37:27.273596 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:37:27.282835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17c491e8-7a89-4be7-8852-096ff5814730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec771df40>]}
03:37:27.295271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17c491e8-7a89-4be7-8852-096ff5814730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec77ddac0>]}
03:37:27.295746 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
03:37:27.296112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17c491e8-7a89-4be7-8852-096ff5814730', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec77ddc70>]}
03:37:27.299841 [info ] [MainThread]: 
03:37:27.300831 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:37:27.302204 [debug] [MainThread]: Connection 'master' was properly closed.
03:37:27.302607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec77dd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec77dd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec77ed520>]}


============================== 2022-06-14 03:43:09.104321 | 0ccffb13-2e43-4b99-8a9a-77462578a394 ==============================
03:43:09.104345 [info ] [MainThread]: Running with dbt=1.1.0
03:43:09.104998 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'threads': 8, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
03:43:09.105187 [debug] [MainThread]: Tracking: tracking
03:43:09.105540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9d7abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9d78a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9d7a4b80>]}
03:43:09.156971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:43:09.157255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:43:09.164902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed1b7cd60>]}
03:43:09.174672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed1d0b8e0>]}
03:43:09.175162 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
03:43:09.175515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed1d0ba90>]}
03:43:09.178337 [info ] [MainThread]: 
03:43:09.179034 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:43:09.180433 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
03:43:09.195936 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
03:43:09.196201 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
03:43:09.196369 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:43:09.946092 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.75 seconds
03:43:09.947895 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
03:43:10.066783 [debug] [ThreadPool]: Acquiring new snowflake connection "create_LEAGUE_OF_LEGENDSDB_none"
03:43:10.067178 [debug] [ThreadPool]: Acquiring new snowflake connection "create_LEAGUE_OF_LEGENDSDB_none"
03:43:10.067487 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database='league_of_legendsdb', schema='none', identifier=None)"
03:43:10.073402 [debug] [ThreadPool]: Using snowflake connection "create_LEAGUE_OF_LEGENDSDB_none"
03:43:10.073659 [debug] [ThreadPool]: On create_LEAGUE_OF_LEGENDSDB_none: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "create_LEAGUE_OF_LEGENDSDB_none"} */
create schema if not exists LEAGUE_OF_LEGENDSDB.none
03:43:10.073825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
03:43:10.626863 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.55 seconds
03:43:10.627869 [debug] [ThreadPool]: On create_LEAGUE_OF_LEGENDSDB_none: Close
03:43:10.728018 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_none"
03:43:10.736941 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_none"
03:43:10.737190 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_none: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_none"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.none
03:43:10.737403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
03:43:11.192145 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.45 seconds
03:43:11.193450 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_none: Close
03:43:11.306107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed1bafb50>]}
03:43:11.306918 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
03:43:11.307328 [info ] [MainThread]: 
03:43:11.325251 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_champions
03:43:11.325770 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_items
03:43:11.326185 [info ] [Thread-1  ]: 1 of 7 START view model none.stg_champions ..................................... [RUN]
03:43:11.326505 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_maps
03:43:11.326915 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_match_details
03:43:11.327268 [info ] [Thread-2  ]: 2 of 7 START view model none.stg_items ......................................... [RUN]
03:43:11.327480 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_match_info
03:43:11.327786 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
03:43:11.328166 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
03:43:11.328739 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
03:43:11.329269 [info ] [Thread-3  ]: 3 of 7 START view model none.stg_maps .......................................... [RUN]
03:43:11.329912 [info ] [Thread-4  ]: 4 of 7 START view model none.stg_match_details ................................. [RUN]
03:43:11.330628 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
03:43:11.331052 [info ] [Thread-5  ]: 5 of 7 START view model none.stg_match_info .................................... [RUN]
03:43:11.331560 [info ] [Thread-6  ]: 6 of 7 START view model none.stg_runes_reforged ................................ [RUN]
03:43:11.331929 [info ] [Thread-7  ]: 7 of 7 START view model none.stg_summonerspells ................................ [RUN]
03:43:11.332230 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
03:43:11.333253 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
03:43:11.334063 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
03:43:11.334382 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_items
03:43:11.335210 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
03:43:11.335898 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
03:43:11.336695 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
03:43:11.337158 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_champions
03:43:11.337699 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
03:43:11.338042 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
03:43:11.338301 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_items
03:43:11.338595 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
03:43:11.338847 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
03:43:11.339260 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
03:43:11.342617 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
03:43:11.343310 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_maps
03:43:11.343894 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_match_details
03:43:11.347268 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
03:43:11.347836 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_match_info
03:43:11.348417 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
03:43:11.348867 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
03:43:11.352727 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
03:43:11.353296 [debug] [Thread-1  ]: finished collecting timing info
03:43:11.356677 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
03:43:11.359981 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
03:43:11.363846 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
03:43:11.364253 [debug] [Thread-2  ]: finished collecting timing info
03:43:11.368560 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
03:43:11.369406 [debug] [Thread-3  ]: finished collecting timing info
03:43:11.370303 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_champions
03:43:11.372306 [debug] [Thread-6  ]: finished collecting timing info
03:43:11.372662 [debug] [Thread-4  ]: finished collecting timing info
03:43:11.405174 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
03:43:11.373275 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_items
03:43:11.373862 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_maps
03:43:11.379554 [debug] [Thread-7  ]: finished collecting timing info
03:43:11.395522 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
03:43:11.404644 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
03:43:11.372961 [debug] [Thread-5  ]: finished collecting timing info
03:43:11.408315 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
03:43:11.412383 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
03:43:11.415939 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
03:43:11.416488 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
03:43:11.419756 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
03:43:11.421125 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
03:43:11.423066 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
03:43:11.431384 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
03:43:11.436046 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
03:43:11.439570 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
03:43:11.443139 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
03:43:11.444950 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
03:43:11.447343 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
03:43:11.447820 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
03:43:11.448119 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
03:43:11.448971 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY id
)

SELECT * FROM pivoted_items
  );
03:43:11.450199 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
03:43:11.450752 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
03:43:11.451878 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
03:43:11.452078 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
03:43:11.452437 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:43:11.452906 [debug] [Thread-4  ]: Opening a new connection, currently in state init
03:43:11.453222 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:43:11.453627 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
03:43:11.454093 [debug] [Thread-3  ]: Opening a new connection, currently in state init
03:43:11.454403 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
03:43:11.454686 [debug] [Thread-6  ]: Opening a new connection, currently in state init
03:43:11.465188 [debug] [Thread-7  ]: Opening a new connection, currently in state init
03:43:11.468117 [debug] [Thread-5  ]: Opening a new connection, currently in state init
03:43:12.718118 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.27 seconds
03:43:12.726791 [debug] [Thread-4  ]: finished collecting timing info
03:43:12.729750 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: Close
03:43:12.868707 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed0f1cbe0>]}
03:43:12.871574 [info ] [Thread-4  ]: 4 of 7 OK created view model none.stg_match_details ............................ [[32mSUCCESS 1[0m in 1.53s]
03:43:12.877033 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
03:43:13.105629 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.64 seconds
03:43:13.107855 [debug] [Thread-7  ]: finished collecting timing info
03:43:13.108262 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
03:43:13.219850 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed0f85a60>]}
03:43:13.220969 [info ] [Thread-7  ]: 7 of 7 OK created view model none.stg_summonerspells ........................... [[32mSUCCESS 1[0m in 1.88s]
03:43:13.222623 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
03:43:13.404820 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.95 seconds
03:43:13.406565 [debug] [Thread-1  ]: finished collecting timing info
03:43:13.406859 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: Close
03:43:13.498206 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.04 seconds
03:43:13.499838 [debug] [Thread-3  ]: finished collecting timing info
03:43:13.500093 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: Close
03:43:13.524983 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed0f03bb0>]}
03:43:13.525729 [info ] [Thread-1  ]: 1 of 7 OK created view model none.stg_champions ................................ [[32mSUCCESS 1[0m in 2.20s]
03:43:13.526541 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_champions
03:43:13.530907 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01a4eeff-0000-f895-0000-d96900050092
03:43:13.531161 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'LEAGUE_OF_LEGENDSDB.NONE.STAGING_DATADRAGON_RUNES_REFORGED' does not exist or not authorized.
03:43:13.531508 [debug] [Thread-6  ]: finished collecting timing info
03:43:13.531694 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
03:43:13.593642 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.13 seconds
03:43:13.595272 [debug] [Thread-5  ]: finished collecting timing info
03:43:13.595573 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: Close
03:43:13.600104 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed0fc0df0>]}
03:43:13.600618 [info ] [Thread-3  ]: 3 of 7 OK created view model none.stg_maps ..................................... [[32mSUCCESS 1[0m in 2.27s]
03:43:13.601157 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_maps
03:43:13.627262 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.17 seconds
03:43:13.627989 [debug] [Thread-6  ]: Database Error in model stg_runes_reforged (models/staging_datadragon/stg_runes_reforged.sql)
  002003 (42S02): SQL compilation error:
  Object 'LEAGUE_OF_LEGENDSDB.NONE.STAGING_DATADRAGON_RUNES_REFORGED' does not exist or not authorized.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_runes_reforged.sql
03:43:13.629614 [debug] [Thread-2  ]: finished collecting timing info
03:43:13.630061 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e9d775940>]}
03:43:13.630339 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: Close
03:43:13.630809 [error] [Thread-6  ]: 6 of 7 ERROR creating view model none.stg_runes_reforged ....................... [[31mERROR[0m in 2.29s]
03:43:13.634272 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
03:43:13.700153 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed0fdb2b0>]}
03:43:13.700701 [info ] [Thread-5  ]: 5 of 7 OK created view model none.stg_match_info ............................... [[32mSUCCESS 1[0m in 2.37s]
03:43:13.701254 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
03:43:13.733435 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccffb13-2e43-4b99-8a9a-77462578a394', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed0ea5d90>]}
03:43:13.733964 [info ] [Thread-2  ]: 2 of 7 OK created view model none.stg_items .................................... [[32mSUCCESS 1[0m in 2.40s]
03:43:13.734496 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_items
03:43:13.737089 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:43:13.737594 [info ] [MainThread]: 
03:43:13.737987 [info ] [MainThread]: Finished running 7 view models in 4.56s.
03:43:13.738316 [debug] [MainThread]: Connection 'master' was properly closed.
03:43:13.738535 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
03:43:13.738727 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
03:43:13.738927 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
03:43:13.739094 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
03:43:13.739252 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
03:43:13.739408 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
03:43:13.739637 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
03:43:13.750317 [info ] [MainThread]: 
03:43:13.750751 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:43:13.751098 [info ] [MainThread]: 
03:43:13.751432 [error] [MainThread]: [33mDatabase Error in model stg_runes_reforged (models/staging_datadragon/stg_runes_reforged.sql)[0m
03:43:13.751785 [error] [MainThread]:   002003 (42S02): SQL compilation error:
03:43:13.752175 [error] [MainThread]:   Object 'LEAGUE_OF_LEGENDSDB.NONE.STAGING_DATADRAGON_RUNES_REFORGED' does not exist or not authorized.
03:43:13.752590 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_runes_reforged.sql
03:43:13.753062 [info ] [MainThread]: 
03:43:13.753624 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
03:43:13.754216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed164df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed164ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ed164d8e0>]}


============================== 2022-06-14 03:55:43.595369 | 2d46528f-50b8-424f-b997-c909d35f6d30 ==============================
03:55:43.595391 [info ] [MainThread]: Running with dbt=1.1.0
03:55:43.596480 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'threads': 8, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
03:55:43.596839 [debug] [MainThread]: Tracking: tracking
03:55:43.597349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d5af4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d5af4580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d5af4640>]}
03:55:43.638608 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
03:55:43.639131 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
03:55:43.639613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d5b0aeb0>]}
03:55:43.662644 [debug] [MainThread]: Parsing macros/match_details.sql
03:55:43.663028 [debug] [MainThread]: Parsing macros/adapters.sql
03:55:43.700898 [debug] [MainThread]: Parsing macros/catalog.sql
03:55:43.703067 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
03:55:43.704547 [debug] [MainThread]: Parsing macros/materializations/merge.sql
03:55:43.708705 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
03:55:43.717956 [debug] [MainThread]: Parsing macros/materializations/table.sql
03:55:43.721791 [debug] [MainThread]: Parsing macros/materializations/view.sql
03:55:43.723558 [debug] [MainThread]: Parsing macros/materializations/seed.sql
03:55:43.729456 [debug] [MainThread]: Parsing macros/adapters/columns.sql
03:55:43.740173 [debug] [MainThread]: Parsing macros/adapters/relation.sql
03:55:43.749905 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
03:55:43.755880 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
03:55:43.758950 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
03:55:43.761854 [debug] [MainThread]: Parsing macros/adapters/schema.sql
03:55:43.764172 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
03:55:43.772492 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
03:55:43.775802 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
03:55:43.777840 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
03:55:43.779996 [debug] [MainThread]: Parsing macros/etc/datetime.sql
03:55:43.790021 [debug] [MainThread]: Parsing macros/etc/statement.sql
03:55:43.795191 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
03:55:43.796238 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
03:55:43.797301 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
03:55:43.798541 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
03:55:43.800243 [debug] [MainThread]: Parsing macros/materializations/configs.sql
03:55:43.802869 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
03:55:43.807406 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
03:55:43.809800 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
03:55:43.812581 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
03:55:43.817685 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
03:55:43.833651 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
03:55:43.840703 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
03:55:43.842675 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
03:55:43.853953 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
03:55:43.873266 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
03:55:43.886492 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
03:55:43.902407 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
03:55:43.919375 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
03:55:43.930935 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
03:55:43.932784 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
03:55:43.937936 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
03:55:43.941151 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
03:55:43.942950 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
03:55:43.950363 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
03:55:43.953785 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
03:55:43.957305 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
03:55:43.965074 [debug] [MainThread]: Parsing tests/generic/builtin.sql
03:55:43.968714 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
03:55:43.978704 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
03:55:43.984707 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
03:55:43.985891 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
03:55:43.995624 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
03:55:43.997723 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
03:55:43.999298 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
03:55:44.000630 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
03:55:44.002269 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
03:55:44.005328 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
03:55:44.007535 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
03:55:44.011469 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
03:55:44.012858 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
03:55:44.014586 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
03:55:44.015754 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
03:55:44.023311 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
03:55:44.026886 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
03:55:44.029302 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
03:55:44.031529 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
03:55:44.032885 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
03:55:44.034532 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
03:55:44.036255 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
03:55:44.038300 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
03:55:44.039501 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
03:55:44.044542 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
03:55:44.045807 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
03:55:44.047345 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
03:55:44.049569 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
03:55:44.052504 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
03:55:44.054337 [debug] [MainThread]: Parsing macros/sql/star.sql
03:55:44.058037 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
03:55:44.059953 [debug] [MainThread]: Parsing macros/sql/pivot.sql
03:55:44.064287 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
03:55:44.066219 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
03:55:44.069381 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
03:55:44.077502 [debug] [MainThread]: Parsing macros/sql/union.sql
03:55:44.088684 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
03:55:44.090596 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
03:55:44.096532 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
03:55:44.101459 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
03:55:44.105061 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
03:55:44.109035 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
03:55:44.117392 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
03:55:44.121815 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
03:55:44.128133 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
03:55:44.135680 [debug] [MainThread]: Parsing macros/sql/groupby.sql
03:55:44.137480 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
03:55:44.139520 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
03:55:44.142305 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
03:55:44.144132 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
03:55:44.148222 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
03:55:44.150193 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
03:55:44.152147 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
03:55:44.153472 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
03:55:44.154775 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
03:55:44.178557 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
03:55:44.180689 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
03:55:44.182994 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
03:55:44.185087 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
03:55:44.186737 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
03:55:44.189718 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
03:55:44.192100 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
03:55:44.194197 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
03:55:44.196886 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
03:55:44.205054 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
03:55:44.209185 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
03:55:44.211704 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
03:55:44.213261 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
03:55:44.214772 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
03:55:44.216643 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
03:55:44.220029 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
03:55:44.222061 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
03:55:44.638916 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
03:55:44.650748 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
03:55:44.653450 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
03:55:44.656110 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
03:55:44.658686 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
03:55:44.661853 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
03:55:44.664439 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
03:55:44.839024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d5af0af0>]}
03:55:44.849740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d5af0df0>]}
03:55:44.850155 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
03:55:44.850495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d5af0d00>]}
03:55:44.852521 [info ] [MainThread]: 
03:55:44.853160 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:55:44.854597 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
03:55:44.869663 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
03:55:44.869946 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
03:55:44.870118 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:55:45.731303 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.86 seconds
03:55:45.733185 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
03:55:45.852791 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_none"
03:55:45.861310 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_none"
03:55:45.861631 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_none: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_none"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.none
03:55:45.861798 [debug] [ThreadPool]: Opening a new connection, currently in state closed
03:55:46.310186 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.45 seconds
03:55:46.311874 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_none: Close
03:55:46.432578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32065a9160>]}
03:55:46.433253 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
03:55:46.433620 [info ] [MainThread]: 
03:55:46.450796 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_champions
03:55:46.451388 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_items
03:55:46.452111 [info ] [Thread-1  ]: 1 of 7 START view model none.stg_champions ..................................... [RUN]
03:55:46.452976 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_maps
03:55:46.453580 [info ] [Thread-2  ]: 2 of 7 START view model none.stg_items ......................................... [RUN]
03:55:46.453910 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_match_details
03:55:46.454516 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_match_info
03:55:46.455280 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
03:55:46.455939 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
03:55:46.456259 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
03:55:46.456754 [info ] [Thread-3  ]: 3 of 7 START view model none.stg_maps .......................................... [RUN]
03:55:46.457823 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
03:55:46.458289 [info ] [Thread-4  ]: 4 of 7 START view model none.stg_match_details ................................. [RUN]
03:55:46.458941 [info ] [Thread-5  ]: 5 of 7 START view model none.stg_match_info .................................... [RUN]
03:55:46.459518 [info ] [Thread-6  ]: 6 of 7 START view model none.stg_runes_reforged ................................ [RUN]
03:55:46.459877 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
03:55:46.460211 [info ] [Thread-7  ]: 7 of 7 START view model none.stg_summonerspells ................................ [RUN]
03:55:46.461004 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
03:55:46.461275 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_items
03:55:46.462483 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
03:55:46.463291 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
03:55:46.463970 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
03:55:46.464345 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_champions
03:55:46.465043 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
03:55:46.465330 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
03:55:46.465598 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_items
03:55:46.465969 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
03:55:46.466322 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
03:55:46.466575 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
03:55:46.469830 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
03:55:46.470329 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
03:55:46.470976 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_maps
03:55:46.474868 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
03:55:46.475450 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_match_details
03:55:46.476106 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_match_info
03:55:46.476421 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
03:55:46.476870 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
03:55:46.480086 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
03:55:46.480638 [debug] [Thread-1  ]: finished collecting timing info
03:55:46.484397 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
03:55:46.488268 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
03:55:46.488690 [debug] [Thread-2  ]: finished collecting timing info
03:55:46.492998 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
03:55:46.498054 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
03:55:46.498883 [debug] [Thread-3  ]: finished collecting timing info
03:55:46.499511 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_champions
03:55:46.500896 [debug] [Thread-5  ]: finished collecting timing info
03:55:46.501168 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_items
03:55:46.501551 [debug] [Thread-4  ]: finished collecting timing info
03:55:46.502257 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_maps
03:55:46.502696 [debug] [Thread-7  ]: finished collecting timing info
03:55:46.519904 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
03:55:46.536288 [debug] [Thread-6  ]: finished collecting timing info
03:55:46.539617 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
03:55:46.542621 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
03:55:46.543355 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
03:55:46.547234 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
03:55:46.547735 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
03:55:46.550769 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
03:55:46.551421 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
03:55:46.556555 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
03:55:46.560686 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
03:55:46.565603 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
03:55:46.567740 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
03:55:46.568891 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
03:55:46.573306 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
03:55:46.575496 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
03:55:46.576254 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY id
)

SELECT * FROM pivoted_items
  );
03:55:46.582438 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
03:55:46.588274 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
03:55:46.588522 [debug] [Thread-4  ]: Opening a new connection, currently in state init
03:55:46.583504 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
03:55:46.585334 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
03:55:46.586047 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:55:46.587845 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
03:55:46.582952 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
03:55:46.584412 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
03:55:46.591512 [debug] [Thread-3  ]: Opening a new connection, currently in state init
03:55:46.592517 [debug] [Thread-5  ]: Opening a new connection, currently in state init
03:55:46.596694 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
03:55:46.597214 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:55:46.597566 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
03:55:46.602401 [debug] [Thread-6  ]: Opening a new connection, currently in state init
03:55:46.606869 [debug] [Thread-7  ]: Opening a new connection, currently in state init
03:55:48.905159 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.3 seconds
03:55:48.912554 [debug] [Thread-7  ]: finished collecting timing info
03:55:48.912860 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
03:55:48.936078 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01a4ef0b-0000-f843-0000-d96900051006
03:55:48.936388 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'LEAGUE_OF_LEGENDSDB.NONE.STAGING_DATADRAGON_RUNES_REFORGED' does not exist or not authorized.
03:55:48.936753 [debug] [Thread-6  ]: finished collecting timing info
03:55:48.937070 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
03:55:48.942038 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.35 seconds
03:55:48.943737 [debug] [Thread-3  ]: finished collecting timing info
03:55:48.943986 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: Close
03:55:49.017602 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.43 seconds
03:55:49.018506 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ff11aaf0>]}
03:55:49.020191 [debug] [Thread-2  ]: finished collecting timing info
03:55:49.020789 [info ] [Thread-7  ]: 7 of 7 OK created view model none.stg_summonerspells ........................... [[32mSUCCESS 1[0m in 2.55s]
03:55:49.021116 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: Close
03:55:49.021906 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
03:55:49.036648 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.44 seconds
03:55:49.038420 [debug] [Thread-5  ]: finished collecting timing info
03:55:49.039346 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: Close
03:55:49.042607 [debug] [Thread-6  ]: Database Error in model stg_runes_reforged (models/staging_datadragon/stg_runes_reforged.sql)
  002003 (42S02): SQL compilation error:
  Object 'LEAGUE_OF_LEGENDSDB.NONE.STAGING_DATADRAGON_RUNES_REFORGED' does not exist or not authorized.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_runes_reforged.sql
03:55:49.043650 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ff1d7c70>]}
03:55:49.045175 [error] [Thread-6  ]: 6 of 7 ERROR creating view model none.stg_runes_reforged ....................... [[31mERROR[0m in 2.58s]
03:55:49.046320 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
03:55:49.047904 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ff7b1700>]}
03:55:49.048692 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.45 seconds
03:55:49.049541 [info ] [Thread-3  ]: 3 of 7 OK created view model none.stg_maps ..................................... [[32mSUCCESS 1[0m in 2.59s]
03:55:49.051300 [debug] [Thread-1  ]: finished collecting timing info
03:55:49.052032 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_maps
03:55:49.052294 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: Close
03:55:49.111797 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.52 seconds
03:55:49.113408 [debug] [Thread-4  ]: finished collecting timing info
03:55:49.113652 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: Close
03:55:49.136246 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ff246070>]}
03:55:49.136733 [info ] [Thread-2  ]: 2 of 7 OK created view model none.stg_items .................................... [[32mSUCCESS 1[0m in 2.68s]
03:55:49.137261 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_items
03:55:49.148124 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ff26ca90>]}
03:55:49.148632 [info ] [Thread-5  ]: 5 of 7 OK created view model none.stg_match_info ............................... [[32mSUCCESS 1[0m in 2.69s]
03:55:49.149161 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
03:55:49.155105 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ff1d7310>]}
03:55:49.155673 [info ] [Thread-1  ]: 1 of 7 OK created view model none.stg_champions ................................ [[32mSUCCESS 1[0m in 2.70s]
03:55:49.159160 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_champions
03:55:49.221904 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d46528f-50b8-424f-b997-c909d35f6d30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31ff224790>]}
03:55:49.222394 [info ] [Thread-4  ]: 4 of 7 OK created view model none.stg_match_details ............................ [[32mSUCCESS 1[0m in 2.76s]
03:55:49.222997 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
03:55:49.225645 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:55:49.226163 [info ] [MainThread]: 
03:55:49.226513 [info ] [MainThread]: Finished running 7 view models in 4.37s.
03:55:49.226915 [debug] [MainThread]: Connection 'master' was properly closed.
03:55:49.227198 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
03:55:49.227414 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
03:55:49.227604 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
03:55:49.227827 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
03:55:49.228023 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
03:55:49.228241 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
03:55:49.228415 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
03:55:49.238972 [info ] [MainThread]: 
03:55:49.239497 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:55:49.239958 [info ] [MainThread]: 
03:55:49.240403 [error] [MainThread]: [33mDatabase Error in model stg_runes_reforged (models/staging_datadragon/stg_runes_reforged.sql)[0m
03:55:49.240807 [error] [MainThread]:   002003 (42S02): SQL compilation error:
03:55:49.241297 [error] [MainThread]:   Object 'LEAGUE_OF_LEGENDSDB.NONE.STAGING_DATADRAGON_RUNES_REFORGED' does not exist or not authorized.
03:55:49.241780 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_runes_reforged.sql
03:55:49.242324 [info ] [MainThread]: 
03:55:49.242875 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
03:55:49.243624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d5a94070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d5a4aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31d5aa3910>]}


============================== 2022-06-14 03:57:08.259865 | 835e07cd-0040-41e7-a900-d4e6f8d96c68 ==============================
03:57:08.259891 [info ] [MainThread]: Running with dbt=1.1.0
03:57:08.260453 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'threads': 8, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
03:57:08.260642 [debug] [MainThread]: Tracking: tracking
03:57:08.261043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6458075850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64580758b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6458075910>]}
03:57:08.310191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:57:08.310494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:57:08.317753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6487f48f40>]}
03:57:08.328014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6488000ac0>]}
03:57:08.328500 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
03:57:08.328856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6488000c70>]}
03:57:08.331026 [info ] [MainThread]: 
03:57:08.331680 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:57:08.333016 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
03:57:08.347579 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
03:57:08.347837 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
03:57:08.348014 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:57:09.057772 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.71 seconds
03:57:09.059485 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
03:57:09.174694 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_none"
03:57:09.183626 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_none"
03:57:09.183927 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_none: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_none"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.none
03:57:09.184108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
03:57:09.943098 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.76 seconds
03:57:09.944731 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_none: Close
03:57:10.049463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6487faf910>]}
03:57:10.050110 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
03:57:10.050518 [info ] [MainThread]: 
03:57:10.068087 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_champions
03:57:10.068476 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_items
03:57:10.068856 [info ] [Thread-1  ]: 1 of 7 START view model none.stg_champions ..................................... [RUN]
03:57:10.069216 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_maps
03:57:10.069807 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_match_details
03:57:10.070149 [info ] [Thread-2  ]: 2 of 7 START view model none.stg_items ......................................... [RUN]
03:57:10.070427 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_match_info
03:57:10.070793 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
03:57:10.071270 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
03:57:10.072105 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
03:57:10.072658 [info ] [Thread-3  ]: 3 of 7 START view model none.stg_maps .......................................... [RUN]
03:57:10.073115 [info ] [Thread-4  ]: 4 of 7 START view model none.stg_match_details ................................. [RUN]
03:57:10.073989 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
03:57:10.074429 [info ] [Thread-5  ]: 5 of 7 START view model none.stg_match_info .................................... [RUN]
03:57:10.074910 [info ] [Thread-6  ]: 6 of 7 START view model none.stg_runes_reforged ................................ [RUN]
03:57:10.075378 [info ] [Thread-7  ]: 7 of 7 START view model none.stg_summonerspells ................................ [RUN]
03:57:10.075940 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
03:57:10.077009 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
03:57:10.077752 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
03:57:10.078231 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_items
03:57:10.079162 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
03:57:10.080126 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
03:57:10.080841 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
03:57:10.081249 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_champions
03:57:10.081547 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
03:57:10.081846 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
03:57:10.082099 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_items
03:57:10.082391 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
03:57:10.082628 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
03:57:10.083023 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
03:57:10.086402 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
03:57:10.086956 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_maps
03:57:10.087782 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_match_details
03:57:10.091586 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
03:57:10.092109 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_match_info
03:57:10.092489 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
03:57:10.092861 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
03:57:10.096353 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
03:57:10.100756 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
03:57:10.101179 [debug] [Thread-1  ]: finished collecting timing info
03:57:10.104895 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
03:57:10.105410 [debug] [Thread-2  ]: finished collecting timing info
03:57:10.108863 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
03:57:10.112569 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
03:57:10.113506 [debug] [Thread-3  ]: finished collecting timing info
03:57:10.114422 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_champions
03:57:10.115433 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_items
03:57:10.115727 [debug] [Thread-5  ]: finished collecting timing info
03:57:10.116146 [debug] [Thread-4  ]: finished collecting timing info
03:57:10.116992 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_maps
03:57:10.123444 [debug] [Thread-6  ]: finished collecting timing info
03:57:10.134459 [debug] [Thread-7  ]: finished collecting timing info
03:57:10.147494 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
03:57:10.151104 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
03:57:10.151619 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
03:57:10.152194 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
03:57:10.155706 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
03:57:10.156337 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
03:57:10.156999 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
03:57:10.161440 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
03:57:10.164717 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
03:57:10.167586 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
03:57:10.170981 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
03:57:10.174765 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
03:57:10.176570 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
03:57:10.179521 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
03:57:10.180517 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
03:57:10.181627 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY id
)

SELECT * FROM pivoted_items
  );
03:57:10.182807 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
03:57:10.183559 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
03:57:10.185004 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
03:57:10.190886 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
03:57:10.192720 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
03:57:10.193008 [debug] [Thread-2  ]: Opening a new connection, currently in state init
03:57:10.193917 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
03:57:10.194322 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
03:57:10.194732 [debug] [Thread-3  ]: Opening a new connection, currently in state init
03:57:10.195088 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
03:57:10.198724 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
03:57:10.201987 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.none.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
03:57:10.203019 [debug] [Thread-5  ]: Opening a new connection, currently in state init
03:57:10.204633 [debug] [Thread-6  ]: Opening a new connection, currently in state init
03:57:10.206678 [debug] [Thread-4  ]: Opening a new connection, currently in state init
03:57:10.207241 [debug] [Thread-7  ]: Opening a new connection, currently in state init
03:57:11.901199 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.71 seconds
03:57:11.909084 [debug] [Thread-2  ]: finished collecting timing info
03:57:11.910020 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: Close
03:57:12.039508 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6487817400>]}
03:57:12.041628 [info ] [Thread-2  ]: 2 of 7 OK created view model none.stg_items .................................... [[32mSUCCESS 1[0m in 1.97s]
03:57:12.049845 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_items
03:57:12.121012 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.93 seconds
03:57:12.123097 [debug] [Thread-1  ]: finished collecting timing info
03:57:12.123557 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: Close
03:57:12.139361 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.93 seconds
03:57:12.141187 [debug] [Thread-7  ]: finished collecting timing info
03:57:12.142690 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
03:57:12.251044 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64878173a0>]}
03:57:12.251827 [info ] [Thread-1  ]: 1 of 7 OK created view model none.stg_champions ................................ [[32mSUCCESS 1[0m in 2.18s]
03:57:12.253310 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_champions
03:57:12.264588 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6487812370>]}
03:57:12.265443 [info ] [Thread-7  ]: 7 of 7 OK created view model none.stg_summonerspells ........................... [[32mSUCCESS 1[0m in 2.18s]
03:57:12.266743 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
03:57:12.602163 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01a4ef0d-0000-f7e6-0000-d9690004f116
03:57:12.602466 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'LEAGUE_OF_LEGENDSDB.NONE.STAGING_DATADRAGON_RUNES_REFORGED' does not exist or not authorized.
03:57:12.602788 [debug] [Thread-6  ]: finished collecting timing info
03:57:12.603076 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
03:57:12.637035 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.43 seconds
03:57:12.638775 [debug] [Thread-5  ]: finished collecting timing info
03:57:12.639079 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: Close
03:57:12.693579 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.5 seconds
03:57:12.695862 [debug] [Thread-3  ]: finished collecting timing info
03:57:12.696188 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: Close
03:57:12.707297 [debug] [Thread-6  ]: Database Error in model stg_runes_reforged (models/staging_datadragon/stg_runes_reforged.sql)
  002003 (42S02): SQL compilation error:
  Object 'LEAGUE_OF_LEGENDSDB.NONE.STAGING_DATADRAGON_RUNES_REFORGED' does not exist or not authorized.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_runes_reforged.sql
03:57:12.707790 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6487397220>]}
03:57:12.708202 [error] [Thread-6  ]: 6 of 7 ERROR creating view model none.stg_runes_reforged ....................... [[31mERROR[0m in 2.63s]
03:57:12.708746 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
03:57:12.756616 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64879185b0>]}
03:57:12.757122 [info ] [Thread-5  ]: 5 of 7 OK created view model none.stg_match_info ............................... [[32mSUCCESS 1[0m in 2.68s]
03:57:12.757656 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
03:57:12.767947 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.56 seconds
03:57:12.769565 [debug] [Thread-4  ]: finished collecting timing info
03:57:12.769841 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: Close
03:57:12.870641 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64873bf340>]}
03:57:12.871154 [info ] [Thread-4  ]: 4 of 7 OK created view model none.stg_match_details ............................ [[32mSUCCESS 1[0m in 2.79s]
03:57:12.871682 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
03:57:12.897339 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '835e07cd-0040-41e7-a900-d4e6f8d96c68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64872869a0>]}
03:57:12.897840 [info ] [Thread-3  ]: 3 of 7 OK created view model none.stg_maps ..................................... [[32mSUCCESS 1[0m in 2.82s]
03:57:12.898366 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_maps
03:57:12.900991 [debug] [MainThread]: Acquiring new snowflake connection "master"
03:57:12.901484 [info ] [MainThread]: 
03:57:12.901819 [info ] [MainThread]: Finished running 7 view models in 4.57s.
03:57:12.902136 [debug] [MainThread]: Connection 'master' was properly closed.
03:57:12.902379 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
03:57:12.902602 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
03:57:12.902844 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
03:57:12.903039 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
03:57:12.903237 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
03:57:12.903419 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
03:57:12.903634 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
03:57:12.971194 [info ] [MainThread]: 
03:57:12.971606 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
03:57:12.971953 [info ] [MainThread]: 
03:57:12.972303 [error] [MainThread]: [33mDatabase Error in model stg_runes_reforged (models/staging_datadragon/stg_runes_reforged.sql)[0m
03:57:12.972641 [error] [MainThread]:   002003 (42S02): SQL compilation error:
03:57:12.973021 [error] [MainThread]:   Object 'LEAGUE_OF_LEGENDSDB.NONE.STAGING_DATADRAGON_RUNES_REFORGED' does not exist or not authorized.
03:57:12.973565 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_runes_reforged.sql
03:57:12.974031 [info ] [MainThread]: 
03:57:12.974505 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
03:57:12.975154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64580988e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f648bca0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64580b35e0>]}


============================== 2022-06-14 04:05:50.766589 | 80e95c61-6fc7-4119-994f-5bf1d35aef5b ==============================
04:05:50.766613 [info ] [MainThread]: Running with dbt=1.1.0
04:05:50.767163 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
04:05:50.767358 [debug] [MainThread]: Tracking: tracking
04:05:50.767682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddb4ec880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddb4ec8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddb4ec940>]}
04:05:50.799131 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
04:05:50.799680 [info ] [MainThread]: Unable to do partial parsing because profile has changed
04:05:50.800054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddb513160>]}
04:05:50.822186 [debug] [MainThread]: Parsing macros/match_details.sql
04:05:50.822548 [debug] [MainThread]: Parsing macros/adapters.sql
04:05:50.860290 [debug] [MainThread]: Parsing macros/catalog.sql
04:05:50.862366 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
04:05:50.863640 [debug] [MainThread]: Parsing macros/materializations/merge.sql
04:05:50.868015 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
04:05:50.881310 [debug] [MainThread]: Parsing macros/materializations/table.sql
04:05:50.886509 [debug] [MainThread]: Parsing macros/materializations/view.sql
04:05:50.888347 [debug] [MainThread]: Parsing macros/materializations/seed.sql
04:05:50.894044 [debug] [MainThread]: Parsing macros/adapters/columns.sql
04:05:50.905554 [debug] [MainThread]: Parsing macros/adapters/relation.sql
04:05:50.920290 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
04:05:50.926839 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
04:05:50.930006 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
04:05:50.932773 [debug] [MainThread]: Parsing macros/adapters/schema.sql
04:05:50.935419 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
04:05:50.942644 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
04:05:50.945327 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
04:05:50.947076 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
04:05:50.948790 [debug] [MainThread]: Parsing macros/etc/datetime.sql
04:05:50.957234 [debug] [MainThread]: Parsing macros/etc/statement.sql
04:05:50.961957 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
04:05:50.962770 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
04:05:50.963769 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
04:05:50.964746 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
04:05:50.966277 [debug] [MainThread]: Parsing macros/materializations/configs.sql
04:05:50.968682 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
04:05:50.972625 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
04:05:50.974530 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
04:05:50.976434 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
04:05:50.982954 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
04:05:50.998351 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
04:05:51.005091 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
04:05:51.007022 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
04:05:51.017694 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
04:05:51.034753 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
04:05:51.046831 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
04:05:51.061453 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
04:05:51.076220 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
04:05:51.086467 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
04:05:51.088282 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
04:05:51.092921 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
04:05:51.095690 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
04:05:51.097150 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
04:05:51.104227 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
04:05:51.107549 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
04:05:51.110578 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
04:05:51.119514 [debug] [MainThread]: Parsing tests/generic/builtin.sql
04:05:51.122716 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
04:05:51.132221 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
04:05:51.138136 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
04:05:51.139201 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
04:05:51.149783 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
04:05:51.151930 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
04:05:51.153465 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
04:05:51.154824 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
04:05:51.156418 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
04:05:51.159260 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
04:05:51.161272 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
04:05:51.165223 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
04:05:51.166788 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
04:05:51.168516 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
04:05:51.169602 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
04:05:51.175701 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
04:05:51.179159 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
04:05:51.182444 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
04:05:51.184599 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
04:05:51.185932 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
04:05:51.187515 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
04:05:51.188844 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
04:05:51.190293 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
04:05:51.191431 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
04:05:51.196434 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
04:05:51.197610 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
04:05:51.199091 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
04:05:51.201292 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
04:05:51.203856 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
04:05:51.205595 [debug] [MainThread]: Parsing macros/sql/star.sql
04:05:51.209114 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
04:05:51.210801 [debug] [MainThread]: Parsing macros/sql/pivot.sql
04:05:51.215195 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
04:05:51.216962 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
04:05:51.219892 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
04:05:51.228706 [debug] [MainThread]: Parsing macros/sql/union.sql
04:05:51.239786 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
04:05:51.241660 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
04:05:51.248315 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
04:05:51.252684 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
04:05:51.256232 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
04:05:51.259976 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
04:05:51.267082 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
04:05:51.271382 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
04:05:51.277519 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
04:05:51.283536 [debug] [MainThread]: Parsing macros/sql/groupby.sql
04:05:51.284988 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
04:05:51.286789 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
04:05:51.289291 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
04:05:51.291066 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
04:05:51.294517 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
04:05:51.295744 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
04:05:51.297139 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
04:05:51.298405 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
04:05:51.299563 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
04:05:51.323173 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
04:05:51.325235 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
04:05:51.327476 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
04:05:51.329510 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
04:05:51.331061 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
04:05:51.334099 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
04:05:51.336704 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
04:05:51.338675 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
04:05:51.341198 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
04:05:51.349285 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
04:05:51.353818 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
04:05:51.356180 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
04:05:51.357516 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
04:05:51.358845 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
04:05:51.360347 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
04:05:51.363145 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
04:05:51.364851 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
04:05:51.779526 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
04:05:51.791569 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
04:05:51.794290 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
04:05:51.797271 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
04:05:51.799883 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
04:05:51.803171 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
04:05:51.805915 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
04:05:51.981358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0c397220>]}
04:05:51.991183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0c397700>]}
04:05:51.991586 [info ] [MainThread]: Found 7 models, 14 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 7 sources, 0 exposures, 0 metrics
04:05:51.991931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0c397220>]}
04:05:51.994085 [info ] [MainThread]: 
04:05:51.994773 [debug] [MainThread]: Acquiring new snowflake connection "master"
04:05:51.996583 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
04:05:52.011328 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
04:05:52.011613 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
04:05:52.011800 [debug] [ThreadPool]: Opening a new connection, currently in state init
04:05:52.602957 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.59 seconds
04:05:52.604774 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
04:05:52.711543 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
04:05:52.719571 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
04:05:52.719879 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
04:05:52.720051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
04:05:53.224491 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.5 seconds
04:05:53.226955 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
04:05:53.336704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0c3a3ee0>]}
04:05:53.337365 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
04:05:53.337775 [info ] [MainThread]: 
04:05:53.356003 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_champions
04:05:53.356487 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_items
04:05:53.357038 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_maps
04:05:53.357240 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_match_details
04:05:53.357656 [info ] [Thread-1  ]: 1 of 7 START view model PUBLIC.stg_champions ................................... [RUN]
04:05:53.358015 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_match_info
04:05:53.358598 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
04:05:53.359154 [info ] [Thread-2  ]: 2 of 7 START view model PUBLIC.stg_items ....................................... [RUN]
04:05:53.359567 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
04:05:53.360164 [info ] [Thread-3  ]: 3 of 7 START view model PUBLIC.stg_maps ........................................ [RUN]
04:05:53.360626 [info ] [Thread-4  ]: 4 of 7 START view model PUBLIC.stg_match_details ............................... [RUN]
04:05:53.361395 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
04:05:53.361723 [info ] [Thread-5  ]: 5 of 7 START view model PUBLIC.stg_match_info .................................. [RUN]
04:05:53.362118 [info ] [Thread-6  ]: 6 of 7 START view model PUBLIC.stg_runes_reforged .............................. [RUN]
04:05:53.363014 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
04:05:53.363520 [info ] [Thread-7  ]: 7 of 7 START view model PUBLIC.stg_summonerspells .............................. [RUN]
04:05:53.364455 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
04:05:53.365126 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
04:05:53.365546 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
04:05:53.366468 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
04:05:53.367327 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
04:05:53.367664 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_items
04:05:53.368412 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
04:05:53.368854 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
04:05:53.369194 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
04:05:53.369615 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_champions
04:05:53.369872 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
04:05:53.370141 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
04:05:53.370371 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_items
04:05:53.370642 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
04:05:53.370914 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_maps
04:05:53.371209 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_match_details
04:05:53.374499 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
04:05:53.375146 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_match_info
04:05:53.375636 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
04:05:53.378994 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
04:05:53.379697 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
04:05:53.383272 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
04:05:53.387954 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
04:05:53.391575 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
04:05:53.392235 [debug] [Thread-1  ]: finished collecting timing info
04:05:53.395299 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
04:05:53.395906 [debug] [Thread-2  ]: finished collecting timing info
04:05:53.399842 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
04:05:53.401434 [debug] [Thread-3  ]: finished collecting timing info
04:05:53.402605 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_champions
04:05:53.403004 [debug] [Thread-4  ]: finished collecting timing info
04:05:53.403532 [debug] [Thread-5  ]: finished collecting timing info
04:05:53.403927 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_items
04:05:53.404506 [debug] [Thread-6  ]: finished collecting timing info
04:05:53.404826 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_maps
04:05:53.410679 [debug] [Thread-7  ]: finished collecting timing info
04:05:53.443468 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
04:05:53.433789 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
04:05:53.434239 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
04:05:53.438132 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
04:05:53.438847 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
04:05:53.442956 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
04:05:53.426700 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
04:05:53.446796 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
04:05:53.450990 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
04:05:53.454216 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
04:05:53.457847 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
04:05:53.462014 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
04:05:53.464018 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
04:05:53.468547 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
04:05:53.470336 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
04:05:53.471399 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
04:05:53.472422 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY id
)

SELECT * FROM pivoted_items
  );
04:05:53.473499 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
04:05:53.482735 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
04:05:53.482945 [debug] [Thread-5  ]: Opening a new connection, currently in state init
04:05:53.475056 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
04:05:53.476977 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
04:05:53.477398 [debug] [Thread-2  ]: Opening a new connection, currently in state init
04:05:53.482395 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
04:05:53.475958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
04:05:53.473983 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
04:05:53.484153 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
04:05:53.486206 [debug] [Thread-7  ]: Opening a new connection, currently in state init
04:05:53.489806 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
04:05:53.493853 [debug] [Thread-3  ]: Opening a new connection, currently in state init
04:05:53.494857 [debug] [Thread-6  ]: Opening a new connection, currently in state init
04:05:53.498572 [debug] [Thread-4  ]: Opening a new connection, currently in state init
04:05:55.015230 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.52 seconds
04:05:55.046689 [debug] [Thread-6  ]: finished collecting timing info
04:05:55.053235 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.58 seconds
04:05:55.064833 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
04:05:55.110941 [debug] [Thread-2  ]: finished collecting timing info
04:05:55.122267 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_items: Close
04:05:55.299474 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e04ac9ca0>]}
04:05:55.306186 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e04ac8c70>]}
04:05:55.308559 [info ] [Thread-2  ]: 2 of 7 OK created view model PUBLIC.stg_items .................................. [[32mSUCCESS 1[0m in 1.94s]
04:05:55.309078 [info ] [Thread-6  ]: 6 of 7 OK created view model PUBLIC.stg_runes_reforged ......................... [[32mSUCCESS 1[0m in 1.93s]
04:05:55.311304 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_items
04:05:55.313973 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
04:05:55.688131 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.21 seconds
04:05:55.690007 [debug] [Thread-1  ]: finished collecting timing info
04:05:55.690272 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_champions: Close
04:05:55.724705 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.23 seconds
04:05:55.726509 [debug] [Thread-4  ]: finished collecting timing info
04:05:55.729078 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: Close
04:05:55.735417 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.25 seconds
04:05:55.737064 [debug] [Thread-5  ]: finished collecting timing info
04:05:55.737318 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: Close
04:05:55.778318 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.28 seconds
04:05:55.782443 [debug] [Thread-3  ]: finished collecting timing info
04:05:55.783272 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_maps: Close
04:05:55.804863 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e04ae3f40>]}
04:05:55.805446 [info ] [Thread-1  ]: 1 of 7 OK created view model PUBLIC.stg_champions .............................. [[32mSUCCESS 1[0m in 2.44s]
04:05:55.806116 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_champions
04:05:55.832123 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.35 seconds
04:05:55.833890 [debug] [Thread-7  ]: finished collecting timing info
04:05:55.834185 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
04:05:55.848739 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e09a6c280>]}
04:05:55.849487 [info ] [Thread-5  ]: 5 of 7 OK created view model PUBLIC.stg_match_info ............................. [[32mSUCCESS 1[0m in 2.48s]
04:05:55.850165 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
04:05:55.851202 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e04bcaee0>]}
04:05:55.852174 [info ] [Thread-4  ]: 4 of 7 OK created view model PUBLIC.stg_match_details .......................... [[32mSUCCESS 1[0m in 2.49s]
04:05:55.852784 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
04:05:55.884602 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e04acf070>]}
04:05:55.885109 [info ] [Thread-3  ]: 3 of 7 OK created view model PUBLIC.stg_maps ................................... [[32mSUCCESS 1[0m in 2.52s]
04:05:55.885639 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_maps
04:05:55.940452 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80e95c61-6fc7-4119-994f-5bf1d35aef5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e09a50100>]}
04:05:55.940942 [info ] [Thread-7  ]: 7 of 7 OK created view model PUBLIC.stg_summonerspells ......................... [[32mSUCCESS 1[0m in 2.57s]
04:05:55.941491 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
04:05:55.944426 [debug] [MainThread]: Acquiring new snowflake connection "master"
04:05:55.945063 [info ] [MainThread]: 
04:05:55.945472 [info ] [MainThread]: Finished running 7 view models in 3.95s.
04:05:55.945872 [debug] [MainThread]: Connection 'master' was properly closed.
04:05:55.946050 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
04:05:55.946285 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
04:05:55.946456 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
04:05:55.946619 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
04:05:55.946821 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
04:05:55.946987 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
04:05:55.947148 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
04:05:55.957401 [info ] [MainThread]: 
04:05:55.957839 [info ] [MainThread]: [32mCompleted successfully[0m
04:05:55.958197 [info ] [MainThread]: 
04:05:55.958516 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
04:05:55.959030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e0f90b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddb502040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddb5020d0>]}


============================== 2022-06-14 17:44:10.944034 | f1b20b94-d815-4243-8eb0-676b6285ee4c ==============================
17:44:10.944053 [info ] [MainThread]: Running with dbt=1.1.0
17:44:10.945331 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
17:44:10.945599 [debug] [MainThread]: Tracking: tracking
17:44:10.947065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efdfbd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efdfbd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efdfbd580>]}
17:44:10.948455 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0ysfni2n'
17:44:10.949052 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
17:44:11.311475 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
17:44:11.312309 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
17:44:11.628849 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
17:44:11.681712 [info ] [MainThread]: Installing dbt-labs/dbt_utils
17:44:12.286355 [info ] [MainThread]:   Installed from version 0.8.5
17:44:12.286836 [info ] [MainThread]:   Up to date!
17:44:12.287245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f1b20b94-d815-4243-8eb0-676b6285ee4c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efdfbd070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efdfbd670>]}
17:44:12.287837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f033f5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efdefac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1efdfbdfa0>]}


============================== 2022-06-14 17:44:16.565998 | c62844dc-7f9d-498d-8205-7a0155b18c9f ==============================
17:44:16.566035 [info ] [MainThread]: Running with dbt=1.1.0
17:44:16.566942 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:44:16.567482 [debug] [MainThread]: Tracking: tracking
17:44:16.567969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88450eb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88450eb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88450eb8b0>]}
17:44:16.617864 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
17:44:16.618860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c62844dc-7f9d-498d-8205-7a0155b18c9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f884514c340>]}
17:44:16.631534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88795613a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8879561220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88795611f0>]}


============================== 2022-06-14 17:50:35.240947 | e473fa04-05a5-42e4-bc37-af5b1241b7eb ==============================
17:50:35.240960 [info ] [MainThread]: Running with dbt=1.1.0
17:50:35.241417 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
17:50:35.241620 [debug] [MainThread]: Tracking: tracking
17:50:35.242774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e31d7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e31d7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e31d79a0>]}
17:50:35.243850 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2aum9hpt'
17:50:35.244252 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
17:50:35.472854 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
17:50:35.473544 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
17:50:35.636390 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
17:50:35.686266 [info ] [MainThread]: Installing dbt-labs/dbt_utils
17:50:36.264799 [info ] [MainThread]:   Installed from version 0.8.5
17:50:36.265191 [info ] [MainThread]:   Up to date!
17:50:36.265587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e473fa04-05a5-42e4-bc37-af5b1241b7eb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e31d7d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e32c17c0>]}
17:50:36.266144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e310da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e31fc6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e31e3bb0>]}


============================== 2022-06-14 17:55:58.884029 | 98f01b31-1b16-4fe4-b959-b7eba469831b ==============================
17:55:58.884042 [info ] [MainThread]: Running with dbt=1.1.0
17:55:58.884519 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
17:55:58.884774 [debug] [MainThread]: Tracking: tracking
17:55:58.886141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6f28b130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6f28b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6f28b250>]}
17:55:58.887528 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-nm0mi0b0'
17:55:58.888183 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
17:55:59.057762 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
17:55:59.059131 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
17:55:59.181511 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
17:55:59.232314 [info ] [MainThread]: Installing dbt-labs/dbt_utils
17:55:59.797611 [info ] [MainThread]:   Installed from version 0.8.5
17:55:59.798188 [info ] [MainThread]:   Up to date!
17:55:59.798736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '98f01b31-1b16-4fe4-b959-b7eba469831b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6f2b5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6f2b56d0>]}
17:55:59.799374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a744f32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6f1f0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a6f2b5b80>]}


============================== 2022-06-14 17:56:04.269866 | 049792db-4e48-41d8-85e8-4f26ffc27afc ==============================
17:56:04.269889 [info ] [MainThread]: Running with dbt=1.1.0
17:56:04.270461 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:56:04.270637 [debug] [MainThread]: Tracking: tracking
17:56:04.270966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b223517c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b22351820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b22351880>]}
17:56:04.303527 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
17:56:04.304321 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
17:56:04.304726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '049792db-4e48-41d8-85e8-4f26ffc27afc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b222b8f10>]}
17:56:04.311156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5675d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5675d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b5675d1f0>]}


============================== 2022-06-14 18:07:37.799225 | 4b83f43c-533f-49ad-9e60-13327ae59295 ==============================
18:07:37.799239 [info ] [MainThread]: Running with dbt=1.1.0
18:07:37.799718 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
18:07:37.799926 [debug] [MainThread]: Tracking: tracking
18:07:37.801001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6954fbd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6954fbd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6954fbda00>]}
18:07:37.801805 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-p0adsmil'
18:07:37.802211 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
18:07:38.163653 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
18:07:38.164316 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
18:07:38.478003 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
18:07:38.526889 [info ] [MainThread]: Installing dbt-labs/dbt_utils
18:07:39.084688 [info ] [MainThread]:   Installed from version 0.8.5
18:07:39.085109 [info ] [MainThread]:   Up to date!
18:07:39.085512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4b83f43c-533f-49ad-9e60-13327ae59295', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6954fab670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6954fab6d0>]}
18:07:39.086103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6957623f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6955026580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69550264c0>]}


============================== 2022-06-14 18:07:42.992940 | b422fa81-315c-4200-9ea4-3f4f7524b4cf ==============================
18:07:42.992966 [info ] [MainThread]: Running with dbt=1.1.0
18:07:42.993753 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:07:42.993985 [debug] [MainThread]: Tracking: tracking
18:07:42.994366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c80ee790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c80ee7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c80ee850>]}
18:07:43.066452 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:07:43.068630 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
18:07:43.071109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b422fa81-315c-4200-9ea4-3f4f7524b4cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96c804fee0>]}
18:07:43.084975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f7a5a400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f7a5a1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96f7a5a1c0>]}


============================== 2022-06-14 18:10:40.867319 | 197592bd-b3f1-46dd-9403-643ce4c34b16 ==============================
18:10:40.867333 [info ] [MainThread]: Running with dbt=1.1.0
18:10:40.867852 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
18:10:40.868052 [debug] [MainThread]: Tracking: tracking
18:10:40.869198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ae544940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ae5449d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ae544b50>]}
18:10:40.870187 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-o7ka7zle'
18:10:40.870709 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
18:10:41.251624 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
18:10:41.252537 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
18:10:41.565021 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
18:10:41.620282 [info ] [MainThread]: Installing dbt-labs/dbt_utils
18:10:42.187193 [info ] [MainThread]:   Installed from version 0.8.5
18:10:42.187738 [info ] [MainThread]:   Up to date!
18:10:42.188161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '197592bd-b3f1-46dd-9403-643ce4c34b16', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ae544cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ae415250>]}
18:10:42.188806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ae4a20a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ae532940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3ae5a36d0>]}


============================== 2022-06-14 18:10:46.290365 | 1c7f59af-a56f-4984-880d-215e858036b9 ==============================
18:10:46.290389 [info ] [MainThread]: Running with dbt=1.1.0
18:10:46.290958 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:10:46.325185 [debug] [MainThread]: Tracking: tracking
18:10:46.325780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b9e91a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b9e91a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b9e91a970>]}
18:10:46.358599 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
18:10:46.359203 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
18:10:46.359577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c7f59af-a56f-4984-880d-215e858036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b9e8ba5b0>]}
18:10:46.365170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bd2d223d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bd2d22250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5bd2d22190>]}


============================== 2022-06-14 23:41:18.538601 | 55befc79-d569-4452-9f29-32f3288ec556 ==============================
23:41:18.538617 [info ] [MainThread]: Running with dbt=1.1.0
23:41:18.539905 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
23:41:18.540149 [debug] [MainThread]: Tracking: tracking
23:41:18.541311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f50bb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f50bb640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f50bbeb0>]}
23:41:18.542344 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hsj2xdeq'
23:41:18.542822 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
23:41:18.984405 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
23:41:18.985133 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
23:41:19.308050 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
23:41:19.360411 [info ] [MainThread]: Installing dbt-labs/dbt_utils
23:41:19.967918 [info ] [MainThread]:   Installed from version 0.8.5
23:41:19.968425 [info ] [MainThread]:   Up to date!
23:41:19.968845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '55befc79-d569-4452-9f29-32f3288ec556', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f50a6a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f523d850>]}
23:41:19.969468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50fa4802e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f50b3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50f5147640>]}


============================== 2022-06-14 23:41:24.541344 | d1be7138-f2d4-4fd4-8174-1e94c568f256 ==============================
23:41:24.541365 [info ] [MainThread]: Running with dbt=1.1.0
23:41:24.542143 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:41:24.542374 [debug] [MainThread]: Tracking: tracking
23:41:24.542715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95f49c2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95f49c2970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95f49c29d0>]}
23:41:24.589228 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
23:41:24.589798 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
23:41:24.590244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd1be7138-f2d4-4fd4-8174-1e94c568f256', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95f4923280>]}
23:41:24.597955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9628dbc400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9628dbc1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9628dbc190>]}


============================== 2022-06-14 23:44:09.760578 | a3bd3692-7318-475d-8708-64e3a27bce23 ==============================
23:44:09.760603 [info ] [MainThread]: Running with dbt=1.1.0
23:44:09.761503 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:44:09.761753 [debug] [MainThread]: Tracking: tracking
23:44:09.762218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da0e63790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da0e637f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da0e63850>]}
23:44:09.802122 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
23:44:09.802750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a3bd3692-7318-475d-8708-64e3a27bce23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4da0e840a0>]}
23:44:09.809274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd52a8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd52a81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4dd52a8190>]}


============================== 2022-06-14 23:45:38.561782 | 4ddd9307-1d7f-4157-a9d4-bdd29a64a74a ==============================
23:45:38.561810 [info ] [MainThread]: Running with dbt=1.1.0
23:45:38.563462 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
23:45:38.563909 [debug] [MainThread]: Tracking: tracking
23:45:38.565321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b770a12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b770a1ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b770a1c70>]}
23:45:38.566325 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-c6dtrs6o'
23:45:38.566726 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
23:45:38.742078 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
23:45:38.743227 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
23:45:38.858380 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
23:45:38.920924 [info ] [MainThread]: Installing dbt-labs/dbt_utils
23:45:39.502206 [info ] [MainThread]:   Installed from version 0.8.5
23:45:39.502774 [info ] [MainThread]:   Up to date!
23:45:39.503208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4ddd9307-1d7f-4157-a9d4-bdd29a64a74a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b77083e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b77225880>]}
23:45:39.503869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7c4652e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b7708be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b77083e50>]}


============================== 2022-06-14 23:49:22.708058 | 12b525ad-5b66-4312-bb4e-ee7b2e0548d9 ==============================
23:49:22.708073 [info ] [MainThread]: Running with dbt=1.1.0
23:49:22.708568 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
23:49:22.708777 [debug] [MainThread]: Tracking: tracking
23:49:22.710044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb548fb130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb548fb460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb548fb250>]}
23:49:22.712131 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-by6sbqpa'
23:49:22.713155 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
23:49:22.930323 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
23:49:22.931036 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
23:49:23.051707 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
23:49:23.105994 [info ] [MainThread]: Installing dbt-labs/dbt_utils
23:49:23.693320 [info ] [MainThread]:   Installed from version 0.8.5
23:49:23.693741 [info ] [MainThread]:   Up to date!
23:49:23.694201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '12b525ad-5b66-4312-bb4e-ee7b2e0548d9', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb548fb2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb54926430>]}
23:49:23.694789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb59b642e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb547a0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb548fb070>]}


============================== 2022-06-14 23:49:28.007885 | bd735665-74f8-4478-96d5-662440e251d1 ==============================
23:49:28.007908 [info ] [MainThread]: Running with dbt=1.1.0
23:49:28.008518 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:49:28.008742 [debug] [MainThread]: Tracking: tracking
23:49:28.009154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21983ed970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21983ed9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21983eda30>]}
23:49:28.043777 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
23:49:28.044483 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
23:49:28.044923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd735665-74f8-4478-96d5-662440e251d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f219838b790>]}
23:49:28.050300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c87ce400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c87ce1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21c87ce1c0>]}


============================== 2022-06-14 23:51:27.770210 | 5549edf1-13d6-456e-96e5-cfed0c2cb8fd ==============================
23:51:27.770229 [info ] [MainThread]: Running with dbt=1.1.0
23:51:27.770818 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
23:51:27.771089 [debug] [MainThread]: Tracking: tracking
23:51:27.772476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1e167130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1e167460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1e167250>]}
23:51:27.774070 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-u8ao5m0y'
23:51:27.774640 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
23:51:27.945925 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
23:51:27.946662 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
23:51:28.060074 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
23:51:28.116078 [info ] [MainThread]: Installing dbt-labs/dbt_utils
23:51:28.681490 [info ] [MainThread]:   Installed from version 0.8.5
23:51:28.682070 [info ] [MainThread]:   Up to date!
23:51:28.682591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5549edf1-13d6-456e-96e5-cfed0c2cb8fd', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1e167ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1e191be0>]}
23:51:28.683219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c234b5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1e0a6a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c1e1675e0>]}


============================== 2022-06-14 23:51:33.094049 | 6260a334-91f0-477d-958e-4ed35c9f65a2 ==============================
23:51:33.094074 [info ] [MainThread]: Running with dbt=1.1.0
23:51:33.094802 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'dev', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:51:33.095161 [debug] [MainThread]: Tracking: tracking
23:51:33.095636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8942147c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa894214820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa894214880>]}
23:51:33.141018 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
23:51:33.141517 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
23:51:33.141907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6260a334-91f0-477d-958e-4ed35c9f65a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8941b7f10>]}
23:51:33.147585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8c46053d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8c4605250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8c4605190>]}


============================== 2022-06-14 23:53:31.767791 | ed405c17-908d-4a2d-bd5c-16946b97b497 ==============================
23:53:31.767806 [info ] [MainThread]: Running with dbt=1.1.0
23:53:31.768360 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
23:53:31.768618 [debug] [MainThread]: Tracking: tracking
23:53:31.769793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9d159040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9d159f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9d159c40>]}
23:53:31.770818 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-hkygqx3o'
23:53:31.771315 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
23:53:32.137192 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
23:53:32.137927 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
23:53:32.439106 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
23:53:32.490293 [info ] [MainThread]: Installing dbt-labs/dbt_utils
23:53:33.058378 [info ] [MainThread]:   Installed from version 0.8.5
23:53:33.058925 [info ] [MainThread]:   Up to date!
23:53:33.059308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ed405c17-908d-4a2d-bd5c-16946b97b497', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9d13ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9d2df760>]}
23:53:33.059870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ba251e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9d144b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b9d13ce20>]}


============================== 2022-06-14 23:53:37.258843 | 86e381e3-12a1-45b5-adb3-e15e917ec802 ==============================
23:53:37.258867 [info ] [MainThread]: Running with dbt=1.1.0
23:53:37.259518 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:53:37.259742 [debug] [MainThread]: Tracking: tracking
23:53:37.260130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb900ce8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb900ce910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb900ce970>]}
23:53:37.295679 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
23:53:37.296230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '86e381e3-12a1-45b5-adb3-e15e917ec802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb9002e520>]}
23:53:37.302284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc04c13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc04c1250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbc04c11f0>]}


============================== 2022-06-15 00:03:24.130605 | 26a87f0b-1608-4189-badd-0dfcf094b54b ==============================
00:03:24.130621 [info ] [MainThread]: Running with dbt=1.1.0
00:03:24.131094 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
00:03:24.131277 [debug] [MainThread]: Tracking: tracking
00:03:24.132307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0245ae910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0245ae9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0245aef70>]}
00:03:24.133214 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0ybanva9'
00:03:24.133636 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
00:03:24.513952 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
00:03:24.514780 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
00:03:24.826685 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
00:03:24.889105 [info ] [MainThread]: Installing dbt-labs/dbt_utils
00:03:25.471857 [info ] [MainThread]:   Installed from version 0.8.5
00:03:25.472304 [info ] [MainThread]:   Up to date!
00:03:25.472736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '26a87f0b-1608-4189-badd-0dfcf094b54b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0245ae730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa024751820>]}
00:03:25.473233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0245c66a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa0299922e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa02465c3d0>]}


============================== 2022-06-15 00:03:29.792800 | 698cc122-dce5-439a-b744-ea868db17750 ==============================
00:03:29.792825 [info ] [MainThread]: Running with dbt=1.1.0
00:03:29.793487 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:03:29.793738 [debug] [MainThread]: Tracking: tracking
00:03:29.794136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ae24d2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ae24d28e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ae24d2940>]}
00:03:29.830959 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
00:03:29.831512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '698cc122-dce5-439a-b744-ea868db17750', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ae24781f0>]}
00:03:29.837479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b168d8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b168d81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b168d81c0>]}


============================== 2022-06-15 00:05:05.047245 | 68cabb6b-4098-438c-bd13-af8d91513895 ==============================
00:05:05.047266 [info ] [MainThread]: Running with dbt=1.1.0
00:05:05.047781 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:05:05.047984 [debug] [MainThread]: Tracking: tracking
00:05:05.048331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f480e9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f480e99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f480e9a00>]}
00:05:05.084513 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
00:05:05.085460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '68cabb6b-4098-438c-bd13-af8d91513895', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f480e9df0>]}
00:05:05.138846 [debug] [MainThread]: Parsing macros/match_details.sql
00:05:05.139290 [debug] [MainThread]: Parsing macros/adapters.sql
00:05:05.185785 [debug] [MainThread]: Parsing macros/catalog.sql
00:05:05.188995 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
00:05:05.190846 [debug] [MainThread]: Parsing macros/materializations/merge.sql
00:05:05.195393 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
00:05:05.204695 [debug] [MainThread]: Parsing macros/materializations/table.sql
00:05:05.208720 [debug] [MainThread]: Parsing macros/materializations/view.sql
00:05:05.210832 [debug] [MainThread]: Parsing macros/materializations/seed.sql
00:05:05.218068 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:05:05.232645 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:05:05.243496 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:05:05.248406 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:05:05.251510 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:05:05.255051 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:05:05.257419 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:05:05.265191 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:05:05.268017 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:05:05.270818 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:05:05.272522 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:05:05.281086 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:05:05.287091 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:05:05.288043 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:05:05.289070 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:05:05.290081 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:05:05.291649 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:05:05.294630 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:05:05.298896 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:05:05.301244 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:05:05.303478 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:05:05.308621 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:05:05.325914 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:05:05.333691 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:05:05.336631 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:05:05.348553 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:05:05.367379 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:05:05.381550 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:05:05.398132 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:05:05.414962 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:05:05.427615 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:05:05.429475 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:05:05.434513 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:05:05.437721 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:05:05.439450 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:05:05.446828 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:05:05.449408 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:05:05.452515 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:05:05.460065 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:05:05.464835 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
00:05:05.473935 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
00:05:05.480139 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
00:05:05.481333 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
00:05:05.491323 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
00:05:05.493582 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
00:05:05.495432 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
00:05:05.496959 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
00:05:05.498808 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
00:05:05.504162 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
00:05:05.507209 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
00:05:05.512567 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
00:05:05.514457 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
00:05:05.516822 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
00:05:05.518470 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
00:05:05.526367 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
00:05:05.530501 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
00:05:05.533266 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
00:05:05.535799 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
00:05:05.537426 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
00:05:05.539353 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
00:05:05.541015 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
00:05:05.542887 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
00:05:05.545768 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
00:05:05.552541 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
00:05:05.553907 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
00:05:05.555581 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
00:05:05.557995 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
00:05:05.560996 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
00:05:05.562914 [debug] [MainThread]: Parsing macros/sql/star.sql
00:05:05.567635 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
00:05:05.569450 [debug] [MainThread]: Parsing macros/sql/pivot.sql
00:05:05.573912 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
00:05:05.575796 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
00:05:05.578905 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
00:05:05.587342 [debug] [MainThread]: Parsing macros/sql/union.sql
00:05:05.599198 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
00:05:05.601157 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
00:05:05.607836 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
00:05:05.613181 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
00:05:05.617003 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
00:05:05.620840 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
00:05:05.628558 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
00:05:05.633052 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
00:05:05.639624 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
00:05:05.646143 [debug] [MainThread]: Parsing macros/sql/groupby.sql
00:05:05.647816 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
00:05:05.649822 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
00:05:05.652305 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
00:05:05.653916 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
00:05:05.657791 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
00:05:05.659348 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
00:05:05.660718 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
00:05:05.662127 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
00:05:05.663375 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
00:05:05.689399 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
00:05:05.691734 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
00:05:05.694236 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
00:05:05.696608 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
00:05:05.698531 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
00:05:05.701949 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
00:05:05.704856 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
00:05:05.707172 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
00:05:05.710209 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
00:05:05.720985 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
00:05:05.725329 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
00:05:05.727956 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
00:05:05.729426 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
00:05:05.731022 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
00:05:05.732741 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
00:05:05.735907 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
00:05:05.737727 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
00:05:06.206346 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
00:05:06.224579 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
00:05:06.227984 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
00:05:06.231112 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
00:05:06.235491 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
00:05:06.240163 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
00:05:06.243102 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
00:05:06.246993 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_info.sql
00:05:06.256920 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_info.sql
00:05:06.258428 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_details.sql
00:05:06.264141 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_details.sql
00:05:06.423993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f76961af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f76961f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f76961700>]}


============================== 2022-06-15 00:08:22.816730 | e3b3f80c-73af-4a86-a9fa-923b9ab121af ==============================
00:08:22.816757 [info ] [MainThread]: Running with dbt=1.1.0
00:08:22.817397 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:08:22.817683 [debug] [MainThread]: Tracking: tracking
00:08:22.818136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d1e0b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d1e0b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d1e0b910>]}
00:08:22.860804 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
00:08:22.861537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d1e321f0>]}
00:08:22.892661 [debug] [MainThread]: Parsing macros/match_details.sql
00:08:22.893159 [debug] [MainThread]: Parsing macros/adapters.sql
00:08:22.939034 [debug] [MainThread]: Parsing macros/catalog.sql
00:08:22.941287 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
00:08:22.942695 [debug] [MainThread]: Parsing macros/materializations/merge.sql
00:08:22.948181 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
00:08:22.958801 [debug] [MainThread]: Parsing macros/materializations/table.sql
00:08:22.962820 [debug] [MainThread]: Parsing macros/materializations/view.sql
00:08:22.964595 [debug] [MainThread]: Parsing macros/materializations/seed.sql
00:08:22.970650 [debug] [MainThread]: Parsing macros/adapters/columns.sql
00:08:22.982172 [debug] [MainThread]: Parsing macros/adapters/relation.sql
00:08:22.994583 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
00:08:23.002275 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
00:08:23.006341 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
00:08:23.010338 [debug] [MainThread]: Parsing macros/adapters/schema.sql
00:08:23.013097 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
00:08:23.021582 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
00:08:23.025023 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
00:08:23.027449 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
00:08:23.029660 [debug] [MainThread]: Parsing macros/etc/datetime.sql
00:08:23.038930 [debug] [MainThread]: Parsing macros/etc/statement.sql
00:08:23.046250 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
00:08:23.047298 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
00:08:23.048443 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
00:08:23.049838 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
00:08:23.051606 [debug] [MainThread]: Parsing macros/materializations/configs.sql
00:08:23.054472 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
00:08:23.059443 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
00:08:23.061591 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
00:08:23.063905 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
00:08:23.069225 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
00:08:23.088612 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
00:08:23.096291 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
00:08:23.098418 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
00:08:23.109993 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
00:08:23.130201 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
00:08:23.145099 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
00:08:23.162860 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
00:08:23.181525 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
00:08:23.194140 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
00:08:23.196090 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
00:08:23.200911 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
00:08:23.204086 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
00:08:23.205711 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
00:08:23.215482 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
00:08:23.218699 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
00:08:23.222207 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
00:08:23.230598 [debug] [MainThread]: Parsing tests/generic/builtin.sql
00:08:23.234093 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
00:08:23.244192 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
00:08:23.251279 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
00:08:23.253031 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
00:08:23.263723 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
00:08:23.265966 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
00:08:23.267702 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
00:08:23.269178 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
00:08:23.270979 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
00:08:23.274191 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
00:08:23.276164 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
00:08:23.280084 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
00:08:23.281589 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
00:08:23.283382 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
00:08:23.284533 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
00:08:23.292246 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
00:08:23.295807 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
00:08:23.298126 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
00:08:23.300390 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
00:08:23.301876 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
00:08:23.303781 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
00:08:23.305281 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
00:08:23.307057 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
00:08:23.308370 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
00:08:23.313725 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
00:08:23.314955 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
00:08:23.316438 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
00:08:23.319036 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
00:08:23.322012 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
00:08:23.323947 [debug] [MainThread]: Parsing macros/sql/star.sql
00:08:23.327711 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
00:08:23.329575 [debug] [MainThread]: Parsing macros/sql/pivot.sql
00:08:23.334864 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
00:08:23.337018 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
00:08:23.340123 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
00:08:23.348943 [debug] [MainThread]: Parsing macros/sql/union.sql
00:08:23.362689 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
00:08:23.365048 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
00:08:23.371307 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
00:08:23.376632 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
00:08:23.381144 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
00:08:23.385438 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
00:08:23.393276 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
00:08:23.398102 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
00:08:23.404662 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
00:08:23.411101 [debug] [MainThread]: Parsing macros/sql/groupby.sql
00:08:23.413342 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
00:08:23.415269 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
00:08:23.419340 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
00:08:23.423562 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
00:08:23.428166 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
00:08:23.429751 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
00:08:23.431464 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
00:08:23.433215 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
00:08:23.434833 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
00:08:23.461139 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
00:08:23.463400 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
00:08:23.466222 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
00:08:23.468630 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
00:08:23.470297 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
00:08:23.473674 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
00:08:23.476623 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
00:08:23.478677 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
00:08:23.481565 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
00:08:23.490337 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
00:08:23.494576 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
00:08:23.497073 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
00:08:23.498576 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
00:08:23.500148 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
00:08:23.502159 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
00:08:23.505380 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
00:08:23.507438 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
00:08:24.068065 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_maps.sql
00:08:24.094761 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
00:08:24.101049 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_runes_reforged.sql
00:08:24.106547 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_champions.sql
00:08:24.110075 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_summonerspells.sql
00:08:24.116638 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
00:08:24.121389 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
00:08:24.129318 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_info.sql
00:08:24.143978 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_info.sql
00:08:24.146577 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_details.sql
00:08:24.156893 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_details.sql
00:08:24.477193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6606323a30>]}
00:08:24.599146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d211ea00>]}
00:08:24.600439 [info ] [MainThread]: Found 9 models, 18 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
00:08:24.601927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66062810d0>]}
00:08:24.608460 [info ] [MainThread]: 
00:08:24.609932 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:08:24.613015 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
00:08:24.633458 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
00:08:24.634287 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
00:08:24.634896 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:08:25.551304 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.92 seconds
00:08:25.553460 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
00:08:25.661938 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
00:08:25.672515 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
00:08:25.672824 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
00:08:25.673027 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:08:26.201044 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.53 seconds
00:08:26.203966 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
00:08:26.319976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d21438e0>]}
00:08:26.321818 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:08:26.323136 [info ] [MainThread]: 
00:08:26.359462 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_match_details
00:08:26.360029 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_match_info
00:08:26.360652 [info ] [Thread-1  ]: 1 of 9 START incremental model PUBLIC.final_match_details ...................... [RUN]
00:08:26.361146 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_champions
00:08:26.361901 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_items
00:08:26.362373 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_maps
00:08:26.362993 [info ] [Thread-2  ]: 2 of 9 START incremental model PUBLIC.final_match_info ......................... [RUN]
00:08:26.363456 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_match_details
00:08:26.364077 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_match_info
00:08:26.364495 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
00:08:26.365235 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
00:08:26.366041 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
00:08:26.366608 [info ] [Thread-3  ]: 3 of 9 START view model PUBLIC.stg_champions ................................... [RUN]
00:08:26.367236 [info ] [Thread-4  ]: 4 of 9 START view model PUBLIC.stg_items ....................................... [RUN]
00:08:26.367690 [info ] [Thread-5  ]: 5 of 9 START view model PUBLIC.stg_maps ........................................ [RUN]
00:08:26.368731 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
00:08:26.369364 [info ] [Thread-6  ]: 6 of 9 START view model PUBLIC.stg_match_details ............................... [RUN]
00:08:26.370092 [info ] [Thread-7  ]: 7 of 9 START view model PUBLIC.stg_match_info .................................. [RUN]
00:08:26.370829 [info ] [Thread-8  ]: 8 of 9 START view model PUBLIC.stg_runes_reforged .............................. [RUN]
00:08:26.371332 [info ] [Thread-9  ]: 9 of 9 START view model PUBLIC.stg_summonerspells .............................. [RUN]
00:08:26.371694 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
00:08:26.373024 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
00:08:26.374132 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
00:08:26.375564 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
00:08:26.377907 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
00:08:26.380095 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
00:08:26.381637 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
00:08:26.383683 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
00:08:26.386678 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
00:08:26.387408 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_match_details
00:08:26.388193 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
00:08:26.388862 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_items
00:08:26.389602 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
00:08:26.390222 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_match_info
00:08:26.390771 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
00:08:26.391653 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
00:08:26.392845 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
00:08:26.393913 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
00:08:26.412515 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_champions
00:08:26.412267 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
00:08:26.413728 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_items
00:08:26.414373 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_maps
00:08:26.420561 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_match_details
00:08:26.425545 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
00:08:26.426112 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_match_info
00:08:26.426801 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
00:08:26.427530 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
00:08:26.435829 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
00:08:26.444567 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
00:08:26.457387 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
00:08:26.460048 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
00:08:26.462019 [debug] [Thread-1  ]: finished collecting timing info
00:08:26.470403 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
00:08:26.470914 [debug] [Thread-2  ]: finished collecting timing info
00:08:26.477177 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
00:08:26.487123 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
00:08:26.489989 [debug] [Thread-3  ]: finished collecting timing info
00:08:26.490412 [debug] [Thread-5  ]: finished collecting timing info
00:08:26.491061 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_match_details
00:08:26.491472 [debug] [Thread-4  ]: finished collecting timing info
00:08:26.492084 [debug] [Thread-6  ]: finished collecting timing info
00:08:26.492771 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_match_info
00:08:26.494564 [debug] [Thread-8  ]: finished collecting timing info
00:08:26.495311 [debug] [Thread-7  ]: finished collecting timing info
00:08:26.495690 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_champions
00:08:26.496008 [debug] [Thread-9  ]: finished collecting timing info
00:08:26.496381 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_maps
00:08:26.507768 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_items
00:08:26.524187 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
00:08:26.550570 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
00:08:26.566228 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
00:08:26.596405 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
00:08:26.611804 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
00:08:26.612603 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
00:08:26.645835 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
00:08:26.647008 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
00:08:26.655322 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
00:08:26.663135 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
00:08:26.667220 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
00:08:26.674326 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
00:08:26.678999 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
00:08:26.683989 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
00:08:26.685679 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
00:08:26.688618 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
00:08:26.689872 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
00:08:26.693157 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
00:08:26.699592 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
00:08:26.701064 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
)
      );
00:08:26.702478 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
00:08:26.703163 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
)
      );
00:08:26.704330 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
00:08:26.705530 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
00:08:26.706062 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
00:08:26.706567 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
00:08:26.706967 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY id
)

SELECT * FROM pivoted_items
  );
00:08:26.707278 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
00:08:26.707559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:08:26.707835 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
00:08:26.708201 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
00:08:26.708522 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
00:08:26.709130 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
00:08:26.709523 [debug] [Thread-3  ]: Opening a new connection, currently in state init
00:08:26.709797 [debug] [Thread-5  ]: Opening a new connection, currently in state init
00:08:26.710263 [debug] [Thread-4  ]: Opening a new connection, currently in state init
00:08:26.710637 [debug] [Thread-6  ]: Opening a new connection, currently in state init
00:08:26.713781 [debug] [Thread-8  ]: Opening a new connection, currently in state init
00:08:26.718703 [debug] [Thread-9  ]: Opening a new connection, currently in state init
00:08:26.719992 [debug] [Thread-7  ]: Opening a new connection, currently in state init
00:08:29.184715 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a4f3c8-0000-f89b-0000-d96900053012
00:08:29.192286 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 6 unexpected ')'.
00:08:29.195071 [debug] [Thread-2  ]: finished collecting timing info
00:08:29.196254 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_match_info: Close
00:08:29.378392 [debug] [Thread-2  ]: Database Error in model final_match_info (models/warehouse/final_match_info.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 6 unexpected ')'.
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_info.sql
00:08:29.381505 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65fb506910>]}
00:08:29.382621 [error] [Thread-2  ]: 2 of 9 ERROR creating incremental model PUBLIC.final_match_info ................ [[31mERROR[0m in 3.01s]
00:08:29.385233 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_match_info
00:08:30.201299 [debug] [Thread-1  ]: Snowflake adapter: Snowflake query id: 01a4f3c8-0000-f89b-0000-d96900053016
00:08:30.201656 [debug] [Thread-1  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 120 at position 6 unexpected ')'.
00:08:30.202088 [debug] [Thread-1  ]: finished collecting timing info
00:08:30.202500 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_match_details: Close
00:08:30.361252 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.64 seconds
00:08:30.371351 [debug] [Thread-9  ]: finished collecting timing info
00:08:30.371838 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
00:08:30.376224 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.66 seconds
00:08:30.378928 [debug] [Thread-8  ]: finished collecting timing info
00:08:30.380145 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
00:08:30.381538 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.67 seconds
00:08:30.386992 [debug] [Thread-5  ]: finished collecting timing info
00:08:30.387743 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_maps: Close
00:08:30.400453 [debug] [Thread-1  ]: Database Error in model final_match_details (models/warehouse/final_match_details.sql)
  001003 (42000): SQL compilation error:
  syntax error line 120 at position 6 unexpected ')'.
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_details.sql
00:08:30.401074 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65fb568b50>]}
00:08:30.401573 [error] [Thread-1  ]: 1 of 9 ERROR creating incremental model PUBLIC.final_match_details ............. [[31mERROR[0m in 4.04s]
00:08:30.402118 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_match_details
00:08:30.407716 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.7 seconds
00:08:30.410913 [debug] [Thread-3  ]: finished collecting timing info
00:08:30.411646 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_champions: Close
00:08:30.415785 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.7 seconds
00:08:30.419213 [debug] [Thread-7  ]: finished collecting timing info
00:08:30.422200 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_match_info: Close
00:08:30.461090 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.75 seconds
00:08:30.464154 [debug] [Thread-6  ]: finished collecting timing info
00:08:30.464687 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_details: Close
00:08:30.472943 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.76 seconds
00:08:30.475281 [debug] [Thread-4  ]: finished collecting timing info
00:08:30.475686 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_items: Close
00:08:30.514645 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65fb4dad00>]}
00:08:30.515836 [info ] [Thread-9  ]: 9 of 9 OK created view model PUBLIC.stg_summonerspells ......................... [[32mSUCCESS 1[0m in 4.13s]
00:08:30.518580 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
00:08:30.531569 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65fb49f4c0>]}
00:08:30.532567 [info ] [Thread-8  ]: 8 of 9 OK created view model PUBLIC.stg_runes_reforged ......................... [[32mSUCCESS 1[0m in 4.15s]
00:08:30.534755 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
00:08:30.538331 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65fb49f430>]}
00:08:30.541137 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f660045a400>]}
00:08:30.542046 [info ] [Thread-7  ]: 7 of 9 OK created view model PUBLIC.stg_match_info ............................. [[32mSUCCESS 1[0m in 4.16s]
00:08:30.542979 [info ] [Thread-5  ]: 5 of 9 OK created view model PUBLIC.stg_maps ................................... [[32mSUCCESS 1[0m in 4.17s]
00:08:30.544302 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66003cd550>]}
00:08:30.545462 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
00:08:30.546693 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_maps
00:08:30.547742 [info ] [Thread-3  ]: 3 of 9 OK created view model PUBLIC.stg_champions .............................. [[32mSUCCESS 1[0m in 4.17s]
00:08:30.549632 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_champions
00:08:30.576816 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65fb4aa130>]}
00:08:30.577702 [info ] [Thread-6  ]: 6 of 9 OK created view model PUBLIC.stg_match_details .......................... [[32mSUCCESS 1[0m in 4.20s]
00:08:30.578986 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
00:08:30.582590 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3b3f80c-73af-4a86-a9fa-923b9ab121af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66003ca880>]}
00:08:30.583143 [info ] [Thread-4  ]: 4 of 9 OK created view model PUBLIC.stg_items .................................. [[32mSUCCESS 1[0m in 4.21s]
00:08:30.583963 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_items
00:08:30.588526 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:08:30.589695 [info ] [MainThread]: 
00:08:30.590462 [info ] [MainThread]: Finished running 2 incremental models, 7 view models in 5.98s.
00:08:30.592050 [debug] [MainThread]: Connection 'master' was properly closed.
00:08:30.593633 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
00:08:30.594131 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
00:08:30.594649 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
00:08:30.594931 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
00:08:30.595099 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
00:08:30.595324 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
00:08:30.595489 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
00:08:30.595652 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
00:08:30.596036 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
00:08:30.616663 [info ] [MainThread]: 
00:08:30.617220 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
00:08:30.617673 [info ] [MainThread]: 
00:08:30.618570 [error] [MainThread]: [33mDatabase Error in model final_match_info (models/warehouse/final_match_info.sql)[0m
00:08:30.619963 [error] [MainThread]:   001003 (42000): SQL compilation error:
00:08:30.620876 [error] [MainThread]:   syntax error line 26 at position 6 unexpected ')'.
00:08:30.621608 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_info.sql
00:08:30.622473 [info ] [MainThread]: 
00:08:30.623189 [error] [MainThread]: [33mDatabase Error in model final_match_details (models/warehouse/final_match_details.sql)[0m
00:08:30.623922 [error] [MainThread]:   001003 (42000): SQL compilation error:
00:08:30.624646 [error] [MainThread]:   syntax error line 120 at position 6 unexpected ')'.
00:08:30.625224 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_details.sql
00:08:30.625939 [info ] [MainThread]: 
00:08:30.627000 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
00:08:30.628132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66053f57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65d1e23040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6602d4bcd0>]}


============================== 2022-06-15 00:10:28.989818 | 84a788f2-eb5b-4027-8dfc-4fb31b53a007 ==============================
00:10:28.989844 [info ] [MainThread]: Running with dbt=1.1.0
00:10:28.990385 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:10:28.990613 [debug] [MainThread]: Tracking: tracking
00:10:28.990939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f983c57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f983c5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f983c58b0>]}
00:10:29.048722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
00:10:29.049700 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_match_details.sql
00:10:29.050221 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_match_info.sql
00:10:29.064883 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_details.sql
00:10:29.085510 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_details.sql
00:10:29.087042 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_info.sql
00:10:29.092318 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_info.sql
00:10:29.144691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc86fc610>]}
00:10:29.158011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc8788d30>]}
00:10:29.158505 [info ] [MainThread]: Found 9 models, 18 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
00:10:29.158884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc8773460>]}
00:10:29.161584 [info ] [MainThread]: 
00:10:29.162379 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:10:29.164026 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
00:10:29.178762 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
00:10:29.179041 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
00:10:29.179214 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:10:29.990734 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.81 seconds
00:10:29.992561 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
00:10:30.099826 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
00:10:30.108471 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
00:10:30.108753 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
00:10:30.108953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:10:30.654093 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.55 seconds
00:10:30.656258 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
00:10:30.770894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f98358340>]}
00:10:30.771850 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:10:30.772299 [info ] [MainThread]: 
00:10:30.791420 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_match_details
00:10:30.791966 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_match_info
00:10:30.792329 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_champions
00:10:30.792817 [info ] [Thread-1  ]: 1 of 9 START incremental model PUBLIC.final_match_details ...................... [RUN]
00:10:30.793074 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_items
00:10:30.793394 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_maps
00:10:30.793698 [info ] [Thread-2  ]: 2 of 9 START incremental model PUBLIC.final_match_info ......................... [RUN]
00:10:30.794001 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_match_details
00:10:30.794344 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_match_info
00:10:30.794696 [info ] [Thread-3  ]: 3 of 9 START view model PUBLIC.stg_champions ................................... [RUN]
00:10:30.795132 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
00:10:30.795578 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
00:10:30.796687 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
00:10:30.797315 [info ] [Thread-4  ]: 4 of 9 START view model PUBLIC.stg_items ....................................... [RUN]
00:10:30.797761 [info ] [Thread-5  ]: 5 of 9 START view model PUBLIC.stg_maps ........................................ [RUN]
00:10:30.798592 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
00:10:30.799022 [info ] [Thread-6  ]: 6 of 9 START view model PUBLIC.stg_match_details ............................... [RUN]
00:10:30.799460 [info ] [Thread-7  ]: 7 of 9 START view model PUBLIC.stg_match_info .................................. [RUN]
00:10:30.800149 [info ] [Thread-8  ]: 8 of 9 START view model PUBLIC.stg_runes_reforged .............................. [RUN]
00:10:30.800677 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
00:10:30.801227 [info ] [Thread-9  ]: 9 of 9 START view model PUBLIC.stg_summonerspells .............................. [RUN]
00:10:30.801817 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
00:10:30.802796 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
00:10:30.803589 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
00:10:30.804062 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
00:10:30.804951 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
00:10:30.805735 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
00:10:30.806650 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
00:10:30.807183 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
00:10:30.808287 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
00:10:30.808689 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_match_details
00:10:30.809198 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_items
00:10:30.809640 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
00:10:30.810027 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_match_info
00:10:30.810339 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
00:10:30.810725 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
00:10:30.811077 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
00:10:30.811380 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_champions
00:10:30.811710 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
00:10:30.816952 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
00:10:30.817758 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_items
00:10:30.818101 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_maps
00:10:30.822235 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
00:10:30.822939 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_match_details
00:10:30.823678 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_match_info
00:10:30.824032 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
00:10:30.827198 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
00:10:30.827552 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
00:10:30.832330 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
00:10:30.832851 [debug] [Thread-1  ]: finished collecting timing info
00:10:30.836134 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
00:10:30.840980 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
00:10:30.841283 [debug] [Thread-2  ]: finished collecting timing info
00:10:30.844900 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
00:10:30.905761 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
00:10:30.909068 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
00:10:30.909880 [debug] [Thread-3  ]: finished collecting timing info
00:10:30.910338 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_match_details
00:10:30.911655 [debug] [Thread-4  ]: finished collecting timing info
00:10:30.912270 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_match_info
00:10:30.912753 [debug] [Thread-6  ]: finished collecting timing info
00:10:30.912961 [debug] [Thread-5  ]: finished collecting timing info
00:10:30.914346 [debug] [Thread-8  ]: finished collecting timing info
00:10:30.914714 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_champions
00:10:30.915053 [debug] [Thread-7  ]: finished collecting timing info
00:10:30.926363 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_items
00:10:30.926968 [debug] [Thread-9  ]: finished collecting timing info
00:10:30.958217 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
00:10:30.984438 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_maps
00:10:30.986202 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
00:10:30.989572 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
00:10:30.990081 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
00:10:31.001426 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
00:10:31.013047 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
00:10:31.016401 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
00:10:31.016796 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
00:10:31.020716 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
00:10:31.024885 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
00:10:31.029134 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
00:10:31.030549 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
00:10:31.034201 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
00:10:31.037669 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
00:10:31.040136 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
00:10:31.043824 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
00:10:31.047319 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
00:10:31.053704 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
00:10:31.055210 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
00:10:31.055493 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
)

SELECT * FROM final_match_info
      );
00:10:31.056674 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
00:10:31.057371 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
)

SELECT * FROM final_match_details
      );
00:10:31.058148 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
00:10:31.059701 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
00:10:31.060136 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY id
)

SELECT * FROM pivoted_items
  );
00:10:31.061247 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
00:10:31.061637 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
00:10:31.061960 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
00:10:31.062287 [debug] [Thread-2  ]: Opening a new connection, currently in state init
00:10:31.062553 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
00:10:31.062956 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:10:31.063370 [debug] [Thread-3  ]: Opening a new connection, currently in state init
00:10:31.063842 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
00:10:31.064264 [debug] [Thread-4  ]: Opening a new connection, currently in state init
00:10:31.064550 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
00:10:31.064829 [debug] [Thread-6  ]: Opening a new connection, currently in state init
00:10:31.065173 [debug] [Thread-5  ]: Opening a new connection, currently in state init
00:10:31.068223 [debug] [Thread-8  ]: Opening a new connection, currently in state init
00:10:31.075358 [debug] [Thread-7  ]: Opening a new connection, currently in state init
00:10:31.078197 [debug] [Thread-9  ]: Opening a new connection, currently in state init
00:10:32.783905 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.72 seconds
00:10:32.794441 [debug] [Thread-3  ]: finished collecting timing info
00:10:32.798338 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_champions: Close
00:10:32.929599 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc7f77250>]}
00:10:32.931565 [info ] [Thread-3  ]: 3 of 9 OK created view model PUBLIC.stg_champions .............................. [[32mSUCCESS 1[0m in 2.13s]
00:10:32.933032 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_champions
00:10:33.864931 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.8 seconds
00:10:33.866890 [debug] [Thread-4  ]: finished collecting timing info
00:10:33.867446 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_items: Close
00:10:33.997246 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc7f772b0>]}
00:10:33.997979 [info ] [Thread-4  ]: 4 of 9 OK created view model PUBLIC.stg_items .................................. [[32mSUCCESS 1[0m in 3.19s]
00:10:33.999056 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_items
00:10:34.092767 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.03 seconds
00:10:34.099079 [debug] [Thread-2  ]: finished collecting timing info
00:10:34.099627 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_match_info: Close
00:10:34.193301 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.13 seconds
00:10:34.195112 [debug] [Thread-1  ]: finished collecting timing info
00:10:34.195442 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_match_details: Close
00:10:34.222260 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4f982dbe80>]}
00:10:34.222801 [info ] [Thread-2  ]: 2 of 9 OK created incremental model PUBLIC.final_match_info .................... [[32mSUCCESS 1[0m in 3.42s]
00:10:34.223348 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_match_info
00:10:34.310140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc7f7e7f0>]}
00:10:34.310714 [info ] [Thread-1  ]: 1 of 9 OK created incremental model PUBLIC.final_match_details ................. [[32mSUCCESS 1[0m in 3.51s]
00:10:34.311325 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_match_details
00:10:34.338949 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.26 seconds
00:10:34.340965 [debug] [Thread-7  ]: finished collecting timing info
00:10:34.341343 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_match_info: Close
00:10:34.350001 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.28 seconds
00:10:34.352141 [debug] [Thread-5  ]: finished collecting timing info
00:10:34.352492 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_maps: Close
00:10:34.434220 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.37 seconds
00:10:34.436497 [debug] [Thread-6  ]: finished collecting timing info
00:10:34.437467 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_details: Close
00:10:34.438606 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.36 seconds
00:10:34.441497 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.37 seconds
00:10:34.443251 [debug] [Thread-9  ]: finished collecting timing info
00:10:34.445830 [debug] [Thread-8  ]: finished collecting timing info
00:10:34.446349 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
00:10:34.447456 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
00:10:34.449158 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc86afca0>]}
00:10:34.454167 [info ] [Thread-7  ]: 7 of 9 OK created view model PUBLIC.stg_match_info ............................. [[32mSUCCESS 1[0m in 3.64s]
00:10:34.455915 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
00:10:34.484865 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc86af820>]}
00:10:34.485927 [info ] [Thread-5  ]: 5 of 9 OK created view model PUBLIC.stg_maps ................................... [[32mSUCCESS 1[0m in 3.68s]
00:10:34.488539 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_maps
00:10:34.555581 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc86afc70>]}
00:10:34.556665 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc806e640>]}
00:10:34.557243 [info ] [Thread-8  ]: 8 of 9 OK created view model PUBLIC.stg_runes_reforged ......................... [[32mSUCCESS 1[0m in 3.75s]
00:10:34.557962 [info ] [Thread-9  ]: 9 of 9 OK created view model PUBLIC.stg_summonerspells ......................... [[32mSUCCESS 1[0m in 3.75s]
00:10:34.559850 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
00:10:34.561199 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
00:10:34.562472 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84a788f2-eb5b-4027-8dfc-4fb31b53a007', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc86af5b0>]}
00:10:34.563690 [info ] [Thread-6  ]: 6 of 9 OK created view model PUBLIC.stg_match_details .......................... [[32mSUCCESS 1[0m in 3.76s]
00:10:34.564392 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
00:10:34.567824 [debug] [MainThread]: Acquiring new snowflake connection "master"
00:10:34.568538 [info ] [MainThread]: 
00:10:34.569117 [info ] [MainThread]: Finished running 7 view models, 2 incremental models in 5.41s.
00:10:34.569676 [debug] [MainThread]: Connection 'master' was properly closed.
00:10:34.569965 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
00:10:34.570315 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
00:10:34.570555 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
00:10:34.570912 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
00:10:34.571118 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
00:10:34.571372 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
00:10:34.571560 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
00:10:34.571741 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
00:10:34.572003 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
00:10:34.585527 [info ] [MainThread]: 
00:10:34.586083 [info ] [MainThread]: [32mCompleted successfully[0m
00:10:34.586835 [info ] [MainThread]: 
00:10:34.587542 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
00:10:34.588610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc7f72f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc8773430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4fc87733d0>]}


============================== 2022-06-15 17:56:38.867966 | fbf8fcc5-7beb-407a-ba92-8510f464e46a ==============================
17:56:38.867981 [info ] [MainThread]: Running with dbt=1.1.0
17:56:38.869992 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
17:56:38.870166 [debug] [MainThread]: Tracking: tracking
17:56:38.871189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155efb1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155efb1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155efb1d90>]}
17:56:38.871900 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-07gpbgje'
17:56:38.872165 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
17:56:39.151158 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
17:56:39.151990 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
17:56:39.320906 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
17:56:39.372582 [info ] [MainThread]: Installing dbt-labs/dbt_utils
17:56:39.954522 [info ] [MainThread]:   Installed from version 0.8.5
17:56:39.954912 [info ] [MainThread]:   Up to date!
17:56:39.955240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fbf8fcc5-7beb-407a-ba92-8510f464e46a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155efb1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155f136580>]}
17:56:39.955701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15643752e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155ef94cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f155ef9b640>]}


============================== 2022-06-15 17:56:43.729197 | f7487fb1-258a-4ff5-aed6-5d20e1b76278 ==============================
17:56:43.729224 [info ] [MainThread]: Running with dbt=1.1.0
17:56:43.729872 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:56:43.730049 [debug] [MainThread]: Tracking: tracking
17:56:43.730338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a00eb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a00eb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99a00eb880>]}
17:56:43.821919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 2 files changed.
17:56:43.822387 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_maps.sql
17:56:43.822616 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_champions.sql
17:56:43.822791 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_runes_reforged.sql
17:56:43.822970 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_summonerspells.sql
17:56:43.823189 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_items.sql
17:56:43.823664 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/warehouse/schema.yml
17:56:43.823937 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
17:56:43.840137 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_maps.sql
17:56:43.856418 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_champions.sql
17:56:43.859646 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_runes_reforged.sql
17:56:43.863076 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_summonerspells.sql
17:56:43.866578 [debug] [MainThread]: 1603: static parser failed on warehouse/final_items.sql
17:56:43.871275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d01ba100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d018c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99d018cb20>]}


============================== 2022-06-15 17:58:54.939585 | 7c251d3b-4c9f-49e0-9c1d-95aeed8d8646 ==============================
17:58:54.939608 [info ] [MainThread]: Running with dbt=1.1.0
17:58:54.940406 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
17:58:54.940714 [debug] [MainThread]: Tracking: tracking
17:58:54.942221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975a1fcf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975a1fc730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975a1fc8b0>]}
17:58:54.943258 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-avlmvcwp'
17:58:54.943706 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
17:58:55.170093 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
17:58:55.171999 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
17:58:55.369401 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
17:58:55.437437 [info ] [MainThread]: Installing dbt-labs/dbt_utils
17:58:56.040365 [info ] [MainThread]:   Installed from version 0.8.5
17:58:56.040843 [info ] [MainThread]:   Up to date!
17:58:56.041271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7c251d3b-4c9f-49e0-9c1d-95aeed8d8646', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975a1fce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975a39e8b0>]}
17:58:56.041959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975f7add30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975a218f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f975a204880>]}


============================== 2022-06-15 17:59:00.864904 | 08d39b4f-c76f-4aec-90e0-21e29287c286 ==============================
17:59:00.864932 [info ] [MainThread]: Running with dbt=1.1.0
17:59:00.865845 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:59:00.866217 [debug] [MainThread]: Tracking: tracking
17:59:00.866792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fface77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fface7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fface7880>]}
17:59:00.929931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 5 files added, 2 files changed.
17:59:00.930615 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_summonerspells.sql
17:59:00.930974 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_maps.sql
17:59:00.931256 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_items.sql
17:59:00.931534 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_runes_reforged.sql
17:59:00.931890 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_champions.sql
17:59:00.932494 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/warehouse/schema.yml
17:59:00.933006 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
17:59:00.950647 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_summonerspells.sql
17:59:00.965340 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_maps.sql
17:59:00.968492 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_items.sql
17:59:00.973894 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_runes_reforged.sql
17:59:00.977048 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_champions.sql
17:59:00.980968 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
17:59:01.067353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7029776700>]}
17:59:01.082274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702f1042e0>]}
17:59:01.082715 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
17:59:01.083068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702f104430>]}
17:59:01.085924 [info ] [MainThread]: 
17:59:01.086564 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:59:01.088742 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
17:59:01.104789 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
17:59:01.105155 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
17:59:01.105550 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:59:02.120151 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.01 seconds
17:59:02.122274 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
17:59:02.309523 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
17:59:02.320928 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
17:59:02.321449 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
17:59:02.321782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:59:03.055653 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 0.73 seconds
17:59:03.058506 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
17:59:03.167317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffac7b430>]}
17:59:03.167955 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:59:03.168358 [info ] [MainThread]: 
17:59:03.187733 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
17:59:03.188113 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
17:59:03.188464 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
17:59:03.188740 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
17:59:03.189032 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
17:59:03.189377 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
17:59:03.189759 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
17:59:03.190072 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
17:59:03.190560 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
17:59:03.191317 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
17:59:03.191611 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
17:59:03.192000 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
17:59:03.192507 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
17:59:03.193093 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
17:59:03.193519 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
17:59:03.194634 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
17:59:03.195013 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
17:59:03.195372 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
17:59:03.195877 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
17:59:03.196443 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
17:59:03.197055 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
17:59:03.198072 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
17:59:03.198525 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
17:59:03.198866 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
17:59:03.199790 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
17:59:03.200119 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
17:59:03.201170 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
17:59:03.202075 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
17:59:03.202849 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
17:59:03.203216 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
17:59:03.204015 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
17:59:03.204286 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
17:59:03.204949 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
17:59:03.205562 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
17:59:03.205789 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
17:59:03.206360 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
17:59:03.206897 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
17:59:03.207419 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
17:59:03.207694 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
17:59:03.211034 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
17:59:03.211603 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
17:59:03.212182 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
17:59:03.212758 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
17:59:03.213009 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
17:59:03.213353 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
17:59:03.216797 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
17:59:03.217380 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
17:59:03.217955 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
17:59:03.218282 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
17:59:03.218746 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
17:59:03.219106 [debug] [Thread-1  ]: finished collecting timing info
17:59:03.222395 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
17:59:03.222783 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
17:59:03.223126 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
17:59:03.235908 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
17:59:03.240572 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
17:59:03.241230 [debug] [Thread-2  ]: finished collecting timing info
17:59:03.245453 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
17:59:03.321025 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
17:59:03.324843 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
17:59:03.325426 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
17:59:03.329091 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
17:59:03.329654 [debug] [Thread-3  ]: finished collecting timing info
17:59:03.332898 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
17:59:03.334324 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
17:59:03.335098 [debug] [Thread-5  ]: finished collecting timing info
17:59:03.335474 [debug] [Thread-4  ]: finished collecting timing info
17:59:03.336822 [debug] [Thread-6  ]: finished collecting timing info
17:59:03.337380 [debug] [Thread-7  ]: finished collecting timing info
17:59:03.348400 [debug] [Thread-8  ]: finished collecting timing info
17:59:03.354189 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
17:59:03.369541 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
17:59:03.370005 [debug] [Thread-9  ]: finished collecting timing info
17:59:03.374783 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
17:59:03.375239 [debug] [Thread-10 ]: finished collecting timing info
17:59:03.375562 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
17:59:03.375890 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
17:59:03.376195 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
17:59:03.376500 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
17:59:03.376796 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
17:59:03.380371 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
17:59:03.381459 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
17:59:03.382974 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
17:59:03.383469 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
17:59:03.387780 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
17:59:03.433600 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
17:59:03.440247 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
17:59:03.446066 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
17:59:03.450776 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
17:59:03.473993 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
17:59:03.478449 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
17:59:03.479767 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
17:59:03.480039 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
17:59:03.483308 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
17:59:03.483772 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        stat_name,
        stat_value,
        map_id,
        map_exists,
        '11',
        '12',
        '21',
        '22',
        FlatHPPoolMod,
        rFlatHPModPerLevel,
        FlatMPPoolMod,
        rFlatMPModPerLevel,
        PercentHPPoolMod,
        PercentMPPoolMod,
        FlatHPRegenMod,
        rFlatHPRegenModPerLevel,
        PercentHPRegenMod,
        FlatMPRegenMod,
        rFlatMPRegenModPerLevel,
        PercentMPRegenMod,
        FlatArmorMod,
        rFlatArmorModPerLevel,
        PercentArmorMod,
        rFlatArmorPenetrationMod,
        rFlatArmorPenetrationModPerLevel,
        rPercentArmorPenetrationMod,
        rPercentArmorPenetrationModPerLevel,
        FlatPhysicalDamageMod,
        rFlatPhysicalDamageModPerLevel,
        PercentPhysicalDamageMod,
        FlatMagicDamageMod,
        rFlatMagicDamageModPerLevel,
        PercentMagicDamageMod,
        FlatMovementSpeedMod,
        rFlatMovementSpeedModPerLevel,
        PercentMovementSpeedMod,
        rPercentMovementSpeedModPerLevel,
        FlatAttackSpeedMod,
        PercentAttackSpeedMod,
        rPercentAttackSpeedModPerLevel,
        rFlatDodgeMod,
        rFlatDodgeModPerLevel,
        PercentDodgeMod,
        FlatCritChanceMod,
        rFlatCritChanceModPerLevel,
        PercentCritChanceMod,
        FlatCritDamageMod,
        rFlatCritDamageModPerLevel,
        PercentCritDamageMod,
        FlatBlockMod,
        PercentBlockMod,
        FlatSpellBlockMod,
        rFlatSpellBlockModPerLevel,
        PercentSpellBlockMod,
        FlatEXPBonus,
        PercentEXPBonus,
        rPercentCooldownMod,
        rPercentCooldownModPerLevel,
        rFlatTimeDeadMod,
        rFlatTimeDeadModPerLevel,
        rPercentTimeDeadMod,
        rPercentTimeDeadModPerLevel,
        rFlatGoldPer10Mod,
        rFlatMagicPenetrationMod,
        rFlatMagicPenetrationModPerLevel,
        rPercentMagicPenetrationMod,
        rPercentMagicPenetrationModPerLevel,
        FlatEnergyRegenMod,
        rFlatEnergyRegenModPerLevel,
        FlatEnergyPoolMod,
        rFlatEnergyModPerLevel,
        PercentLifeStealMod,
        PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
17:59:03.485633 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
17:59:03.486129 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE match_id > (SELECT max(match_id) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
17:59:03.486723 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE match_id > (SELECT max(match_id) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
17:59:03.488853 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
17:59:03.489484 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
      );
17:59:03.491572 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
17:59:03.494201 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
17:59:03.494750 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:59:03.495899 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:59:03.497250 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
17:59:03.497715 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
17:59:03.498070 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:59:03.498478 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:59:03.499129 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
17:59:03.499625 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:59:03.500010 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
17:59:03.500423 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY id
)

SELECT * FROM pivoted_items
  );
17:59:03.502777 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
17:59:03.508035 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:59:03.521192 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:59:03.527201 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:59:03.528777 [debug] [Thread-9  ]: Opening a new connection, currently in state init
17:59:03.529615 [debug] [Thread-10 ]: Opening a new connection, currently in state init
17:59:06.870922 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a4f7f7-0000-fa00-0000-d969000520ba
17:59:06.871301 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 120 at position 12
invalid identifier 'MATCH_ID'
17:59:06.873156 [debug] [Thread-4  ]: finished collecting timing info
17:59:06.874022 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
17:59:06.953300 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a4f7f7-0000-f89b-0000-d969000530b2
17:59:06.954416 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 16 at position 8
invalid identifier 'STAT_NAME'
17:59:06.956019 [debug] [Thread-2  ]: finished collecting timing info
17:59:06.956485 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
17:59:07.023285 [debug] [Thread-4  ]: Database Error in model final_match_details (models/warehouse/final_match_details.sql)
  000904 (42000): SQL compilation error: error line 120 at position 12
  invalid identifier 'MATCH_ID'
17:59:07.025236 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70241dbe50>]}
17:59:07.026911 [error] [Thread-4  ]: 4 of 14 ERROR creating incremental model PUBLIC.final_match_details ............ [[31mERROR[0m in 3.83s]
17:59:07.029477 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
17:59:07.030714 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_match_details
17:59:07.031816 [info ] [Thread-4  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
17:59:07.032881 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
17:59:07.033208 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
17:59:07.033802 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_match_details
17:59:07.040140 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
17:59:07.041551 [debug] [Thread-4  ]: finished collecting timing info
17:59:07.042075 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
17:59:07.046086 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
17:59:07.052021 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
17:59:07.052681 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
17:59:07.053102 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
17:59:07.125253 [debug] [Thread-2  ]: Database Error in model final_items (models/warehouse/final_items.sql)
  000904 (42000): SQL compilation error: error line 16 at position 8
  invalid identifier 'STAT_NAME'
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
17:59:07.125816 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70242070d0>]}
17:59:07.126341 [error] [Thread-2  ]: 2 of 14 ERROR creating table model PUBLIC.final_items .......................... [[31mERROR[0m in 3.93s]
17:59:07.126958 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
17:59:07.127367 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_match_info
17:59:07.128049 [info ] [Thread-2  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
17:59:07.128712 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
17:59:07.129000 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
17:59:07.129213 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_match_info
17:59:07.132812 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
17:59:07.133406 [debug] [Thread-2  ]: finished collecting timing info
17:59:07.133762 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
17:59:07.137087 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
17:59:07.140194 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
17:59:07.140659 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
17:59:07.141004 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:59:07.351392 [debug] [Thread-3  ]: Snowflake adapter: Snowflake query id: 01a4f7f7-0000-fa00-0000-d969000520ca
17:59:07.356963 [debug] [Thread-3  ]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'STG_DATADRAGON_MAPS' does not exist or not authorized.
17:59:07.358046 [debug] [Thread-3  ]: finished collecting timing info
17:59:07.369926 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
17:59:07.370577 [debug] [Thread-9  ]: Snowflake adapter: Snowflake query id: 01a4f7f7-0000-fa00-0000-d969000520c6
17:59:07.376982 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.85 seconds
17:59:07.382928 [debug] [Thread-9  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 126 at position 9
invalid identifier 'ID'
17:59:07.404870 [debug] [Thread-8  ]: finished collecting timing info
17:59:07.411858 [debug] [Thread-9  ]: finished collecting timing info
17:59:07.424864 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
17:59:07.426026 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.9 seconds
17:59:07.427220 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
17:59:07.427753 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a4f7f7-0000-f89b-0000-d969000530ba
17:59:07.433176 [debug] [Thread-10 ]: finished collecting timing info
17:59:07.442284 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 26 at position 12
invalid identifier 'MATCH_ID'
17:59:07.446679 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
17:59:07.448407 [debug] [Thread-5  ]: finished collecting timing info
17:59:07.454099 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
17:59:07.605067 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70220b87c0>]}
17:59:07.611393 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 4.40s]
17:59:07.623831 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
17:59:07.624787 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
17:59:07.625573 [info ] [Thread-10 ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
17:59:07.637490 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
17:59:07.645606 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
17:59:07.652090 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
17:59:07.667144 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
17:59:07.680860 [debug] [Thread-5  ]: Database Error in model final_match_info (models/warehouse/final_match_info.sql)
  000904 (42000): SQL compilation error: error line 26 at position 12
  invalid identifier 'MATCH_ID'
17:59:07.689577 [debug] [Thread-9  ]: Database Error in model stg_items (models/staging_datadragon/stg_items.sql)
  000904 (42000): SQL compilation error: error line 126 at position 9
  invalid identifier 'ID'
  compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_items.sql
17:59:07.690348 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70242079a0>]}
17:59:07.691120 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70220b8d30>]}
17:59:07.692420 [debug] [Thread-10 ]: finished collecting timing info
17:59:07.693085 [debug] [Thread-3  ]: Database Error in model final_maps (models/warehouse/final_maps.sql)
  002003 (42S02): SQL compilation error:
  Object 'STG_DATADRAGON_MAPS' does not exist or not authorized.
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_maps.sql
17:59:07.693998 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7024207d00>]}
17:59:07.701446 [error] [Thread-5  ]: 5 of 14 ERROR creating incremental model PUBLIC.final_match_info ............... [[31mERROR[0m in 4.49s]
17:59:07.702900 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 4.49s]
17:59:07.703671 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
17:59:07.704329 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70241ee430>]}
17:59:07.705597 [error] [Thread-9  ]: 9 of 14 ERROR creating view model PUBLIC.stg_items ............................. [[31mERROR[0m in 4.49s]
17:59:07.706925 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
17:59:07.708239 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
17:59:07.712247 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
17:59:07.714682 [error] [Thread-3  ]: 3 of 14 ERROR creating table model PUBLIC.final_maps ........................... [[31mERROR[0m in 4.51s]
17:59:07.716751 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
17:59:07.717284 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
17:59:07.720124 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
17:59:07.722469 [info ] [Thread-5  ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
17:59:07.725366 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
17:59:07.726461 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
17:59:07.726885 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
17:59:07.727526 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
17:59:07.728515 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
17:59:07.729621 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
17:59:07.734466 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
17:59:07.738366 [debug] [Thread-5  ]: finished collecting timing info
17:59:07.738914 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
17:59:07.749865 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
17:59:07.753605 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
17:59:07.754237 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
17:59:07.755044 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
17:59:07.869655 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.37 seconds
17:59:07.876773 [debug] [Thread-1  ]: finished collecting timing info
17:59:07.877819 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
17:59:07.888000 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 4.37 seconds
17:59:07.891520 [debug] [Thread-7  ]: finished collecting timing info
17:59:07.892505 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
17:59:08.082404 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffac10df0>]}
17:59:08.088830 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 4.89s]
17:59:08.102539 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
17:59:08.136667 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70220b7dc0>]}
17:59:08.138908 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 4.93s]
17:59:08.142581 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
17:59:08.342068 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.2 seconds
17:59:08.355158 [debug] [Thread-2  ]: finished collecting timing info
17:59:08.360082 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_info: Close
17:59:08.588956 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702216b2b0>]}
17:59:08.589673 [info ] [Thread-2  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.46s]
17:59:08.590357 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
17:59:08.704388 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 5.2 seconds
17:59:08.706810 [debug] [Thread-6  ]: finished collecting timing info
17:59:08.707207 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
17:59:08.741082 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.69 seconds
17:59:08.744957 [debug] [Thread-4  ]: finished collecting timing info
17:59:08.745466 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_details: Close
17:59:08.830129 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70220b7b20>]}
17:59:08.830763 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.63s]
17:59:08.831462 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
17:59:08.888675 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7022031730>]}
17:59:08.889394 [info ] [Thread-4  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 1.86s]
17:59:08.890274 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
17:59:08.939764 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.21 seconds
17:59:08.941728 [debug] [Thread-10 ]: finished collecting timing info
17:59:08.942055 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
17:59:09.002663 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.25 seconds
17:59:09.004764 [debug] [Thread-5  ]: finished collecting timing info
17:59:09.005104 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
17:59:09.108670 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7021fb4a00>]}
17:59:09.109271 [info ] [Thread-10 ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.47s]
17:59:09.109936 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
17:59:09.161715 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08d39b4f-c76f-4aec-90e0-21e29287c286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7022031dc0>]}
17:59:09.162298 [info ] [Thread-5  ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.44s]
17:59:09.163032 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
17:59:09.166262 [debug] [MainThread]: Acquiring new snowflake connection "master"
17:59:09.167022 [info ] [MainThread]: 
17:59:09.167539 [info ] [MainThread]: Finished running 2 incremental models, 5 table models, 7 view models in 8.08s.
17:59:09.167975 [debug] [MainThread]: Connection 'master' was properly closed.
17:59:09.168169 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_champions' was properly closed.
17:59:09.168381 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
17:59:09.168581 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_maps' was properly closed.
17:59:09.168773 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
17:59:09.169046 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
17:59:09.169265 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
17:59:09.169521 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
17:59:09.169741 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
17:59:09.169984 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
17:59:09.170234 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
17:59:09.183971 [info ] [MainThread]: 
17:59:09.184519 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
17:59:09.184926 [info ] [MainThread]: 
17:59:09.185234 [error] [MainThread]: [33mDatabase Error in model final_match_details (models/warehouse/final_match_details.sql)[0m
17:59:09.185590 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 120 at position 12
17:59:09.185940 [error] [MainThread]:   invalid identifier 'MATCH_ID'
17:59:09.186594 [info ] [MainThread]: 
17:59:09.187105 [error] [MainThread]: [33mDatabase Error in model final_items (models/warehouse/final_items.sql)[0m
17:59:09.187795 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 16 at position 8
17:59:09.188195 [error] [MainThread]:   invalid identifier 'STAT_NAME'
17:59:09.188560 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
17:59:09.188962 [info ] [MainThread]: 
17:59:09.189371 [error] [MainThread]: [33mDatabase Error in model final_match_info (models/warehouse/final_match_info.sql)[0m
17:59:09.189725 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 26 at position 12
17:59:09.190098 [error] [MainThread]:   invalid identifier 'MATCH_ID'
17:59:09.190410 [info ] [MainThread]: 
17:59:09.190911 [error] [MainThread]: [33mDatabase Error in model stg_items (models/staging_datadragon/stg_items.sql)[0m
17:59:09.191214 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 126 at position 9
17:59:09.191546 [error] [MainThread]:   invalid identifier 'ID'
17:59:09.192285 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_items.sql
17:59:09.192758 [info ] [MainThread]: 
17:59:09.193579 [error] [MainThread]: [33mDatabase Error in model final_maps (models/warehouse/final_maps.sql)[0m
17:59:09.193994 [error] [MainThread]:   002003 (42S02): SQL compilation error:
17:59:09.194399 [error] [MainThread]:   Object 'STG_DATADRAGON_MAPS' does not exist or not authorized.
17:59:09.194956 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_maps.sql
17:59:09.195405 [info ] [MainThread]: 
17:59:09.195780 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=5 SKIP=0 TOTAL=14
17:59:09.196280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70220f1b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702f09dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f702477c280>]}


============================== 2022-06-15 18:08:36.019020 | 91ea5511-b4ff-42e9-835a-159c8ab92507 ==============================
18:08:36.019038 [info ] [MainThread]: Running with dbt=1.1.0
18:08:36.019827 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
18:08:36.020115 [debug] [MainThread]: Tracking: tracking
18:08:36.021609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200c2611c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200c261d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200c261dc0>]}
18:08:36.023190 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-opm88za8'
18:08:36.023810 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
18:08:36.200434 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
18:08:36.201290 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
18:08:36.311347 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
18:08:36.369449 [info ] [MainThread]: Installing dbt-labs/dbt_utils
18:08:36.943877 [info ] [MainThread]:   Installed from version 0.8.5
18:08:36.944491 [info ] [MainThread]:   Up to date!
18:08:36.944851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '91ea5511-b4ff-42e9-835a-159c8ab92507', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200c2612b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200c3e6130>]}
18:08:36.945428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20116252e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200c24b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f200c24b6d0>]}


============================== 2022-06-15 18:08:41.391068 | bdd3079d-999b-464a-bcc8-c14807ceb3b4 ==============================
18:08:41.391093 [info ] [MainThread]: Running with dbt=1.1.0
18:08:41.393081 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:08:41.393391 [debug] [MainThread]: Tracking: tracking
18:08:41.393846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a02f64880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a02f648e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a02f64940>]}
18:08:41.462863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
18:08:41.463807 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
18:08:41.464328 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_match_info.sql
18:08:41.464724 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_maps.sql
18:08:41.465089 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_items.sql
18:08:41.465415 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_match_details.sql
18:08:41.483914 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
18:08:41.500978 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_info.sql
18:08:41.511081 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_info.sql
18:08:41.512443 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_maps.sql
18:08:41.515587 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_items.sql
18:08:41.519130 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_details.sql
18:08:41.525178 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_details.sql
18:08:41.599294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a33e00cd0>]}
18:08:41.616989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a33e032b0>]}
18:08:41.617726 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
18:08:41.618605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a372b99d0>]}
18:08:41.622522 [info ] [MainThread]: 
18:08:41.623369 [debug] [MainThread]: Acquiring new snowflake connection "master"
18:08:41.625241 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
18:08:41.639963 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
18:08:41.640279 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
18:08:41.640469 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:08:42.483888 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.84 seconds
18:08:42.486316 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
18:08:42.631359 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
18:08:42.640030 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
18:08:42.640329 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
18:08:42.640556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:08:43.350100 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 0.71 seconds
18:08:43.353420 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
18:08:43.568228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a02ecb7c0>]}
18:08:43.569028 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:08:43.569522 [info ] [MainThread]: 
18:08:43.587337 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
18:08:43.587695 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
18:08:43.588103 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
18:08:43.588511 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
18:08:43.588880 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
18:08:43.589282 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
18:08:43.589751 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
18:08:43.589997 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
18:08:43.590256 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
18:08:43.590544 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
18:08:43.590886 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
18:08:43.591140 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
18:08:43.591494 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
18:08:43.592214 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
18:08:43.592557 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
18:08:43.593046 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
18:08:43.594187 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
18:08:43.594708 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
18:08:43.595246 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
18:08:43.595785 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
18:08:43.596544 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
18:08:43.596979 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
18:08:43.597402 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
18:08:43.597799 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
18:08:43.598536 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:08:43.599505 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:08:43.599918 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
18:08:43.601447 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
18:08:43.603564 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
18:08:43.604784 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
18:08:43.605030 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
18:08:43.605876 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
18:08:43.606471 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
18:08:43.606769 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
18:08:43.607072 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
18:08:43.607411 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
18:08:43.607812 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
18:08:43.608139 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
18:08:43.608432 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
18:08:43.608683 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
18:08:43.609135 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
18:08:43.609560 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
18:08:43.609940 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
18:08:43.613108 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
18:08:43.613689 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
18:08:43.614055 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
18:08:43.618230 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
18:08:43.618727 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
18:08:43.619154 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
18:08:43.619508 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
18:08:43.623070 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
18:08:43.623492 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
18:08:43.623946 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
18:08:43.634221 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
18:08:43.699126 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
18:08:43.699409 [debug] [Thread-1  ]: finished collecting timing info
18:08:43.703228 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
18:08:43.707258 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
18:08:43.707856 [debug] [Thread-2  ]: finished collecting timing info
18:08:43.711375 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
18:08:43.715944 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
18:08:43.719708 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
18:08:43.720022 [debug] [Thread-3  ]: finished collecting timing info
18:08:43.725142 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
18:08:43.721576 [debug] [Thread-4  ]: finished collecting timing info
18:08:43.722284 [debug] [Thread-5  ]: finished collecting timing info
18:08:43.722840 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
18:08:43.723479 [debug] [Thread-6  ]: finished collecting timing info
18:08:43.723776 [debug] [Thread-7  ]: finished collecting timing info
18:08:43.720981 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
18:08:43.725512 [debug] [Thread-8  ]: finished collecting timing info
18:08:43.737277 [debug] [Thread-10 ]: finished collecting timing info
18:08:43.747875 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
18:08:43.757763 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
18:08:43.758667 [debug] [Thread-9  ]: finished collecting timing info
18:08:43.759175 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
18:08:43.763434 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
18:08:43.764037 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
18:08:43.764463 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
18:08:43.768847 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
18:08:43.769478 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
18:08:43.769885 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
18:08:43.791738 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
18:08:43.798233 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
18:08:43.811989 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:08:43.812549 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:08:43.816428 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
18:08:43.820017 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
18:08:43.823104 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
18:08:43.862361 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
18:08:43.869237 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
18:08:43.869987 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
18:08:43.874470 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
18:08:43.874958 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
18:08:43.875277 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
18:08:43.875561 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
18:08:43.877545 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
18:08:43.877858 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        '11',
        '12',
        '21',
        '22',
        FlatHPPoolMod,
        rFlatHPModPerLevel,
        FlatMPPoolMod,
        rFlatMPModPerLevel,
        PercentHPPoolMod,
        PercentMPPoolMod,
        FlatHPRegenMod,
        rFlatHPRegenModPerLevel,
        PercentHPRegenMod,
        FlatMPRegenMod,
        rFlatMPRegenModPerLevel,
        PercentMPRegenMod,
        FlatArmorMod,
        rFlatArmorModPerLevel,
        PercentArmorMod,
        rFlatArmorPenetrationMod,
        rFlatArmorPenetrationModPerLevel,
        rPercentArmorPenetrationMod,
        rPercentArmorPenetrationModPerLevel,
        FlatPhysicalDamageMod,
        rFlatPhysicalDamageModPerLevel,
        PercentPhysicalDamageMod,
        FlatMagicDamageMod,
        rFlatMagicDamageModPerLevel,
        PercentMagicDamageMod,
        FlatMovementSpeedMod,
        rFlatMovementSpeedModPerLevel,
        PercentMovementSpeedMod,
        rPercentMovementSpeedModPerLevel,
        FlatAttackSpeedMod,
        PercentAttackSpeedMod,
        rPercentAttackSpeedModPerLevel,
        rFlatDodgeMod,
        rFlatDodgeModPerLevel,
        PercentDodgeMod,
        FlatCritChanceMod,
        rFlatCritChanceModPerLevel,
        PercentCritChanceMod,
        FlatCritDamageMod,
        rFlatCritDamageModPerLevel,
        PercentCritDamageMod,
        FlatBlockMod,
        PercentBlockMod,
        FlatSpellBlockMod,
        rFlatSpellBlockModPerLevel,
        PercentSpellBlockMod,
        FlatEXPBonus,
        PercentEXPBonus,
        rPercentCooldownMod,
        rPercentCooldownModPerLevel,
        rFlatTimeDeadMod,
        rFlatTimeDeadModPerLevel,
        rPercentTimeDeadMod,
        rPercentTimeDeadModPerLevel,
        rFlatGoldPer10Mod,
        rFlatMagicPenetrationMod,
        rFlatMagicPenetrationModPerLevel,
        rPercentMagicPenetrationMod,
        rPercentMagicPenetrationModPerLevel,
        FlatEnergyRegenMod,
        rFlatEnergyRegenModPerLevel,
        FlatEnergyPoolMod,
        rFlatEnergyModPerLevel,
        PercentLifeStealMod,
        PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
18:08:43.878883 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
18:08:43.879213 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
18:08:43.881026 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
18:08:43.881859 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:08:43.884417 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
18:08:43.886850 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
18:08:43.887375 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:08:43.887830 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:08:43.888205 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
18:08:43.888552 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:08:43.888894 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
18:08:43.889215 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:43.889492 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
18:08:43.890859 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY item_id
)

SELECT * FROM pivoted_items
  );
18:08:43.895311 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
18:08:43.905459 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:08:43.911334 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:08:43.914535 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:08:43.918157 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:08:43.919104 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:08:47.207128 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.32 seconds
18:08:47.221267 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:08:47.222197 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
18:08:47.350087 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.13 seconds
18:08:47.370287 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:08:47.381861 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
18:08:47.396939 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.48 seconds
18:08:47.406796 [debug] [Thread-10 ]: finished collecting timing info
18:08:47.408202 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
18:08:47.503537 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.12 seconds
18:08:47.519202 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:08:47.519489 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
18:08:47.542949 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c480f70>]}
18:08:47.543522 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 3.94s]
18:08:47.544189 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
18:08:47.544470 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_match_details
18:08:47.544894 [info ] [Thread-10 ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
18:08:47.545450 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
18:08:47.545674 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
18:08:47.545863 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_match_details
18:08:47.549280 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
18:08:47.549765 [debug] [Thread-10 ]: finished collecting timing info
18:08:47.550004 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_match_details
18:08:47.552968 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
18:08:47.558371 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
18:08:47.558658 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
18:08:47.558862 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
18:08:47.599943 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.72 seconds
18:08:47.605805 [debug] [Thread-3  ]: finished collecting timing info
18:08:47.606514 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
18:08:47.611657 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.09 seconds
18:08:47.651233 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
18:08:47.661336 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:08:47.661757 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
18:08:47.744982 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c476e80>]}
18:08:47.745558 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 4.15s]
18:08:47.756863 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
18:08:47.763011 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_match_info
18:08:47.786358 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.12 seconds
18:08:47.804496 [info ] [Thread-3  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
18:08:47.820360 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.9 seconds
18:08:47.836346 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:08:47.864975 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
18:08:47.873368 [debug] [Thread-9  ]: finished collecting timing info
18:08:47.881616 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.match_id = DBT_INTERNAL_DEST.match_id
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
18:08:47.884314 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
18:08:47.885501 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
18:08:47.888330 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_match_info
18:08:47.894392 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.98 seconds
18:08:47.898193 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
18:08:47.902433 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a4f800-0000-fa00-0000-d9690005212a
18:08:47.904821 [debug] [Thread-8  ]: finished collecting timing info
18:08:47.907016 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 8
invalid identifier 'FLATHPPOOLMOD'
18:08:47.907717 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
18:08:47.908201 [debug] [Thread-3  ]: finished collecting timing info
18:08:47.908956 [debug] [Thread-2  ]: finished collecting timing info
18:08:47.911703 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
18:08:47.913371 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
18:08:47.917845 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
18:08:47.923501 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
18:08:47.924453 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
18:08:47.924936 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
18:08:48.005342 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a4f800-0000-f89b-0000-d96900053132
18:08:48.005649 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 16
invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
18:08:48.006008 [debug] [Thread-4  ]: finished collecting timing info
18:08:48.006225 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
18:08:48.021575 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c476e50>]}
18:08:48.022104 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 4.42s]
18:08:48.022654 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
18:08:48.022970 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
18:08:48.023466 [info ] [Thread-8  ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
18:08:48.024055 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
18:08:48.024238 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
18:08:48.024456 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
18:08:48.027858 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
18:08:48.028411 [debug] [Thread-8  ]: finished collecting timing info
18:08:48.028617 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
18:08:48.033450 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
18:08:48.034922 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
18:08:48.035224 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
18:08:48.035460 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
18:08:48.041640 [debug] [Thread-2  ]: Database Error in model final_items (models/warehouse/final_items.sql)
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'FLATHPPOOLMOD'
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
18:08:48.042337 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c5cacd0>]}
18:08:48.042874 [error] [Thread-2  ]: 2 of 14 ERROR creating table model PUBLIC.final_items .......................... [[31mERROR[0m in 4.45s]
18:08:48.043529 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
18:08:48.043854 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
18:08:48.044373 [info ] [Thread-2  ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
18:08:48.045088 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
18:08:48.045679 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
18:08:48.048706 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
18:08:48.052562 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
18:08:48.054558 [debug] [Thread-2  ]: finished collecting timing info
18:08:48.055013 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
18:08:48.058252 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
18:08:48.059516 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c480e80>]}
18:08:48.060592 [info ] [Thread-9  ]: 9 of 14 OK created view model PUBLIC.stg_items ................................. [[32mSUCCESS 1[0m in 4.45s]
18:08:48.061876 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
18:08:48.062314 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
18:08:48.062546 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
18:08:48.063576 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:08:48.126766 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 4.24 seconds
18:08:48.134004 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:08:48.139827 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
18:08:48.169861 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.28 seconds
18:08:48.178841 [debug] [Thread-1  ]: finished collecting timing info
18:08:48.179343 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
18:08:48.261531 [debug] [Thread-4  ]: Database Error in model final_match_details (models/warehouse/final_match_details.sql)
  000904 (42000): SQL compilation error: error line 4 at position 16
  invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_details.sql
18:08:48.268098 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c5c3730>]}
18:08:48.269411 [error] [Thread-4  ]: 4 of 14 ERROR creating incremental model PUBLIC.final_match_details ............ [[31mERROR[0m in 4.67s]
18:08:48.272353 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
18:08:48.273360 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.13 seconds
18:08:48.278315 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:08:48.278730 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
18:08:48.395642 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.12 seconds
18:08:48.401823 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c476370>]}
18:08:48.412196 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:08:48.436007 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 4.81s]
18:08:48.458328 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
18:08:48.482478 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
18:08:48.541704 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 4.64 seconds
18:08:48.565628 [debug] [Thread-6  ]: finished collecting timing info
18:08:48.592791 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
18:08:48.708616 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.15 seconds
18:08:48.709446 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.21 seconds
18:08:48.718751 [debug] [Thread-10 ]: finished collecting timing info
18:08:48.722998 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
18:08:48.724419 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_match_details: Close
18:08:48.733717 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:08:48.734166 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
18:08:48.759040 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c476a30>]}
18:08:48.760562 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.16s]
18:08:48.761887 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
18:08:48.799903 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.87 seconds
18:08:48.802106 [debug] [Thread-3  ]: finished collecting timing info
18:08:48.802484 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_info: Close
18:08:48.859838 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.13 seconds
18:08:48.860328 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:08:48.860566 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.match_id = DBT_INTERNAL_DEST.match_id
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
18:08:48.994940 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a005e6f10>]}
18:08:48.995647 [info ] [Thread-3  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.13s]
18:08:48.999590 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
18:08:49.020198 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 5.11 seconds
18:08:49.021885 [debug] [Thread-7  ]: finished collecting timing info
18:08:49.022191 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
18:08:49.028300 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c4801f0>]}
18:08:49.028824 [info ] [Thread-10 ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 1.48s]
18:08:49.029523 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_match_details
18:08:49.125262 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a4f800-0000-f89b-0000-d96900053146
18:08:49.125774 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 16
invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
18:08:49.126409 [debug] [Thread-5  ]: finished collecting timing info
18:08:49.126744 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
18:08:49.141284 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c480ac0>]}
18:08:49.141813 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 5.54s]
18:08:49.142346 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
18:08:49.207915 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.14 seconds
18:08:49.209807 [debug] [Thread-2  ]: finished collecting timing info
18:08:49.210101 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
18:08:49.313787 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.28 seconds
18:08:49.315551 [debug] [Thread-8  ]: finished collecting timing info
18:08:49.315863 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
18:08:49.320446 [debug] [Thread-5  ]: Database Error in model final_match_info (models/warehouse/final_match_info.sql)
  000904 (42000): SQL compilation error: error line 4 at position 16
  invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_info.sql
18:08:49.320950 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c58cfd0>]}
18:08:49.321402 [error] [Thread-5  ]: 5 of 14 ERROR creating incremental model PUBLIC.final_match_info ............... [[31mERROR[0m in 5.72s]
18:08:49.321953 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
18:08:49.326953 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a2c58cdf0>]}
18:08:49.327659 [info ] [Thread-2  ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.28s]
18:08:49.328241 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
18:08:49.439916 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdd3079d-999b-464a-bcc8-c14807ceb3b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a00644df0>]}
18:08:49.440624 [info ] [Thread-8  ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.42s]
18:08:49.441218 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
18:08:49.444533 [debug] [MainThread]: Acquiring new snowflake connection "master"
18:08:49.445077 [info ] [MainThread]: 
18:08:49.445428 [info ] [MainThread]: Finished running 7 view models, 5 table models, 2 incremental models in 7.82s.
18:08:49.445798 [debug] [MainThread]: Connection 'master' was properly closed.
18:08:49.445966 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_champions' was properly closed.
18:08:49.446185 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
18:08:49.446351 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
18:08:49.446516 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
18:08:49.446738 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
18:08:49.446904 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
18:08:49.447068 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
18:08:49.447282 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
18:08:49.447450 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
18:08:49.447618 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
18:08:49.458916 [info ] [MainThread]: 
18:08:49.459462 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:08:49.459811 [info ] [MainThread]: 
18:08:49.460161 [error] [MainThread]: [33mDatabase Error in model final_items (models/warehouse/final_items.sql)[0m
18:08:49.460482 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 20 at position 8
18:08:49.460828 [error] [MainThread]:   invalid identifier 'FLATHPPOOLMOD'
18:08:49.461126 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
18:08:49.461455 [info ] [MainThread]: 
18:08:49.461766 [error] [MainThread]: [33mDatabase Error in model final_match_details (models/warehouse/final_match_details.sql)[0m
18:08:49.462033 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 4 at position 16
18:08:49.462449 [error] [MainThread]:   invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
18:08:49.462730 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_details.sql
18:08:49.463193 [info ] [MainThread]: 
18:08:49.463594 [error] [MainThread]: [33mDatabase Error in model final_match_info (models/warehouse/final_match_info.sql)[0m
18:08:49.463920 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 4 at position 16
18:08:49.464317 [error] [MainThread]:   invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
18:08:49.464669 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_info.sql
18:08:49.465022 [info ] [MainThread]: 
18:08:49.465375 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=3 SKIP=0 TOTAL=14
18:08:49.465844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a372b9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a372b9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a372b9f70>]}


============================== 2022-06-15 18:15:23.992840 | d9f06eb2-3887-4854-8ef2-0503c069c13e ==============================
18:15:23.992869 [info ] [MainThread]: Running with dbt=1.1.0
18:15:23.993757 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
18:15:23.994010 [debug] [MainThread]: Tracking: tracking
18:15:23.995759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d97b7e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d97b7ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d97b7ebb0>]}
18:15:24.001896 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-8wqsbptf'
18:15:24.002538 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
18:15:24.390182 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
18:15:24.391913 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
18:15:24.710671 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
18:15:24.797283 [info ] [MainThread]: Installing dbt-labs/dbt_utils
18:15:25.378231 [info ] [MainThread]:   Installed from version 0.8.5
18:15:25.378919 [info ] [MainThread]:   Up to date!
18:15:25.379461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd9f06eb2-3887-4854-8ef2-0503c069c13e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d97b59e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d97c427c0>]}
18:15:25.380143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d97a94700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d97b62b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8d97b59e20>]}


============================== 2022-06-15 18:15:30.021679 | d2102600-365b-47b8-a799-70c5554b0e77 ==============================
18:15:30.021701 [info ] [MainThread]: Running with dbt=1.1.0
18:15:30.022582 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:15:30.022980 [debug] [MainThread]: Tracking: tracking
18:15:30.023478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5c942730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5c942760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5c9427c0>]}
18:15:30.095261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:15:30.096613 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/warehouse/schema.yml
18:15:30.115081 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_info.sql
18:15:30.147575 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_info.sql
18:15:30.149293 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_details.sql
18:15:30.158010 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_details.sql
18:15:30.218855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90c509d0>]}
18:15:30.235260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90d0b760>]}
18:15:30.235806 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
18:15:30.236293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90d11760>]}
18:15:30.239689 [info ] [MainThread]: 
18:15:30.240622 [debug] [MainThread]: Acquiring new snowflake connection "master"
18:15:30.242588 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
18:15:30.263190 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
18:15:30.263667 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
18:15:30.263857 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:15:31.167346 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.9 seconds
18:15:31.169360 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
18:15:31.306559 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
18:15:31.317778 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
18:15:31.318083 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
18:15:31.318269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:15:32.043917 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.73 seconds
18:15:32.046375 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
18:15:32.166806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90d0beb0>]}
18:15:32.167596 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:15:32.168045 [info ] [MainThread]: 
18:15:32.186159 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
18:15:32.186679 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
18:15:32.187308 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
18:15:32.187753 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
18:15:32.188352 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
18:15:32.188888 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
18:15:32.189197 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
18:15:32.189538 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
18:15:32.190231 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
18:15:32.191070 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
18:15:32.191403 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
18:15:32.191770 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
18:15:32.192038 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
18:15:32.192410 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
18:15:32.192768 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
18:15:32.193659 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
18:15:32.194058 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
18:15:32.194611 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
18:15:32.194983 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
18:15:32.195264 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
18:15:32.195664 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
18:15:32.196530 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
18:15:32.196855 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
18:15:32.197332 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
18:15:32.198093 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:15:32.198396 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
18:15:32.199225 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:15:32.199937 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
18:15:32.200708 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
18:15:32.201026 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
18:15:32.201762 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
18:15:32.202018 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
18:15:32.202620 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
18:15:32.203518 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
18:15:32.203857 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
18:15:32.204272 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
18:15:32.204562 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
18:15:32.204832 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
18:15:32.205078 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
18:15:32.208196 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
18:15:32.208878 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
18:15:32.209488 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
18:15:32.209940 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
18:15:32.210340 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
18:15:32.210748 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
18:15:32.214087 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
18:15:32.214706 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
18:15:32.215314 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
18:15:32.215686 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
18:15:32.216467 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
18:15:32.220395 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
18:15:32.221093 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
18:15:32.221527 [debug] [Thread-1  ]: finished collecting timing info
18:15:32.222047 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
18:15:32.230142 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
18:15:32.235148 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
18:15:32.240425 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
18:15:32.240927 [debug] [Thread-2  ]: finished collecting timing info
18:15:32.302565 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
18:15:32.306343 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
18:15:32.310894 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
18:15:32.311427 [debug] [Thread-3  ]: finished collecting timing info
18:15:32.311728 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
18:15:32.315152 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
18:15:32.317221 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
18:15:32.317698 [debug] [Thread-5  ]: finished collecting timing info
18:15:32.317937 [debug] [Thread-6  ]: finished collecting timing info
18:15:32.318240 [debug] [Thread-4  ]: finished collecting timing info
18:15:32.319508 [debug] [Thread-8  ]: finished collecting timing info
18:15:32.319989 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
18:15:32.331285 [debug] [Thread-9  ]: finished collecting timing info
18:15:32.331744 [debug] [Thread-7  ]: finished collecting timing info
18:15:32.365106 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
18:15:32.366088 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
18:15:32.368194 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
18:15:32.368560 [debug] [Thread-10 ]: finished collecting timing info
18:15:32.369031 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
18:15:32.369600 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
18:15:32.370141 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
18:15:32.373336 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
18:15:32.373775 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
18:15:32.374272 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
18:15:32.394224 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
18:15:32.408931 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:15:32.409412 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
18:15:32.412852 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
18:15:32.419693 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
18:15:32.421630 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:15:32.459893 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
18:15:32.460600 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
18:15:32.464809 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
18:15:32.465563 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
18:15:32.466068 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        '11',
        '12',
        '21',
        '22',
        FlatHPPoolMod,
        rFlatHPModPerLevel,
        FlatMPPoolMod,
        rFlatMPModPerLevel,
        PercentHPPoolMod,
        PercentMPPoolMod,
        FlatHPRegenMod,
        rFlatHPRegenModPerLevel,
        PercentHPRegenMod,
        FlatMPRegenMod,
        rFlatMPRegenModPerLevel,
        PercentMPRegenMod,
        FlatArmorMod,
        rFlatArmorModPerLevel,
        PercentArmorMod,
        rFlatArmorPenetrationMod,
        rFlatArmorPenetrationModPerLevel,
        rPercentArmorPenetrationMod,
        rPercentArmorPenetrationModPerLevel,
        FlatPhysicalDamageMod,
        rFlatPhysicalDamageModPerLevel,
        PercentPhysicalDamageMod,
        FlatMagicDamageMod,
        rFlatMagicDamageModPerLevel,
        PercentMagicDamageMod,
        FlatMovementSpeedMod,
        rFlatMovementSpeedModPerLevel,
        PercentMovementSpeedMod,
        rPercentMovementSpeedModPerLevel,
        FlatAttackSpeedMod,
        PercentAttackSpeedMod,
        rPercentAttackSpeedModPerLevel,
        rFlatDodgeMod,
        rFlatDodgeModPerLevel,
        PercentDodgeMod,
        FlatCritChanceMod,
        rFlatCritChanceModPerLevel,
        PercentCritChanceMod,
        FlatCritDamageMod,
        rFlatCritDamageModPerLevel,
        PercentCritDamageMod,
        FlatBlockMod,
        PercentBlockMod,
        FlatSpellBlockMod,
        rFlatSpellBlockModPerLevel,
        PercentSpellBlockMod,
        FlatEXPBonus,
        PercentEXPBonus,
        rPercentCooldownMod,
        rPercentCooldownModPerLevel,
        rFlatTimeDeadMod,
        rFlatTimeDeadModPerLevel,
        rPercentTimeDeadMod,
        rPercentTimeDeadModPerLevel,
        rFlatGoldPer10Mod,
        rFlatMagicPenetrationMod,
        rFlatMagicPenetrationModPerLevel,
        rPercentMagicPenetrationMod,
        rPercentMagicPenetrationModPerLevel,
        FlatEnergyRegenMod,
        rFlatEnergyRegenModPerLevel,
        FlatEnergyPoolMod,
        rFlatEnergyModPerLevel,
        PercentLifeStealMod,
        PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
18:15:32.466681 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
18:15:32.469997 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
18:15:32.470804 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
18:15:32.471577 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
18:15:32.472318 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
18:15:32.476412 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
18:15:32.476996 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
18:15:32.479128 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
18:15:32.479499 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:15:32.480344 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
18:15:32.480675 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:15:32.481342 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:15:32.481969 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:15:32.483183 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
18:15:32.483544 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
18:15:32.483907 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY item_id
)

SELECT * FROM pivoted_items
  );
18:15:32.484214 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:15:32.484559 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
18:15:32.486368 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
18:15:32.501373 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
18:15:32.503555 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:15:32.503988 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:15:32.505918 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:15:32.508541 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:15:32.509400 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:15:34.060387 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.58 seconds
18:15:34.080615 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:15:34.082251 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
18:15:34.250266 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.17 seconds
18:15:34.255795 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:15:34.259136 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
18:15:34.344833 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.08 seconds
18:15:34.356019 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:15:34.357270 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
18:15:34.484903 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.12 seconds
18:15:34.517345 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
18:15:34.534519 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:15:34.545934 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
18:15:34.667659 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.12 seconds
18:15:34.668424 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:15:34.669803 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.match_id = DBT_INTERNAL_DEST.match_id
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
18:15:34.816036 [debug] [Thread-5  ]: Snowflake adapter: Snowflake query id: 01a4f807-0000-f89b-0000-d96900053166
18:15:34.817404 [debug] [Thread-5  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 16
invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
18:15:34.817975 [debug] [Thread-5  ]: finished collecting timing info
18:15:34.819082 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
18:15:35.025430 [debug] [Thread-5  ]: Database Error in model final_match_info (models/warehouse/final_match_info.sql)
  000904 (42000): SQL compilation error: error line 4 at position 16
  invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_info.sql
18:15:35.026977 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8fffc820>]}
18:15:35.028437 [error] [Thread-5  ]: 5 of 14 ERROR creating incremental model PUBLIC.final_match_info ............... [[31mERROR[0m in 2.83s]
18:15:35.032889 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
18:15:35.033643 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_match_details
18:15:35.037287 [info ] [Thread-5  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
18:15:35.041825 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
18:15:35.042723 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
18:15:35.046121 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_match_details
18:15:35.050417 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
18:15:35.064356 [debug] [Thread-5  ]: finished collecting timing info
18:15:35.064953 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
18:15:35.072715 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
18:15:35.096261 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
18:15:35.096709 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
18:15:35.107214 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
18:15:35.684293 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.2 seconds
18:15:35.688279 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:15:35.690735 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
18:15:35.823569 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.13 seconds
18:15:35.838154 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:15:35.840071 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
18:15:35.930994 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.09 seconds
18:15:35.946565 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:15:35.947286 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
18:15:36.032197 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.08 seconds
18:15:36.046859 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
18:15:36.061209 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:15:36.061702 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
18:15:36.165325 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.1 seconds
18:15:36.166742 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:15:36.167394 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.match_id = DBT_INTERNAL_DEST.match_id
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
18:15:36.266781 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.76 seconds
18:15:36.275859 [debug] [Thread-9  ]: finished collecting timing info
18:15:36.276631 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
18:15:36.292238 [debug] [Thread-4  ]: Snowflake adapter: Snowflake query id: 01a4f807-0000-fa00-0000-d96900052152
18:15:36.293007 [debug] [Thread-4  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 4 at position 16
invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
18:15:36.294062 [debug] [Thread-4  ]: finished collecting timing info
18:15:36.295385 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
18:15:36.401241 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.92 seconds
18:15:36.407595 [debug] [Thread-1  ]: finished collecting timing info
18:15:36.408087 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
18:15:36.461899 [debug] [Thread-4  ]: Database Error in model final_match_details (models/warehouse/final_match_details.sql)
  000904 (42000): SQL compilation error: error line 4 at position 16
  invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_details.sql
18:15:36.463930 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8fff1d60>]}
18:15:36.467616 [error] [Thread-4  ]: 4 of 14 ERROR creating incremental model PUBLIC.final_match_details ............ [[31mERROR[0m in 4.27s]
18:15:36.471499 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
18:15:36.472322 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.stg_match_info
18:15:36.473190 [info ] [Thread-4  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
18:15:36.475059 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
18:15:36.475798 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
18:15:36.476295 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.stg_match_info
18:15:36.480216 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
18:15:36.481391 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c904a1b80>]}
18:15:36.482232 [info ] [Thread-9  ]: 9 of 14 OK created view model PUBLIC.stg_items ................................. [[32mSUCCESS 1[0m in 4.28s]
18:15:36.482776 [debug] [Thread-4  ]: finished collecting timing info
18:15:36.483812 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
18:15:36.484255 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
18:15:36.484834 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
18:15:36.489036 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
18:15:36.489640 [info ] [Thread-9  ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
18:15:36.490780 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
18:15:36.491107 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
18:15:36.492345 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
18:15:36.492596 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
18:15:36.492933 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
18:15:36.495840 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
18:15:36.496168 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
18:15:36.501305 [debug] [Thread-9  ]: finished collecting timing info
18:15:36.501672 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
18:15:36.506197 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
18:15:36.507675 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
18:15:36.507942 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
18:15:36.508118 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
18:15:36.515508 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8ff498e0>]}
18:15:36.516025 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 4.32s]
18:15:36.516598 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
18:15:36.516908 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
18:15:36.517432 [info ] [Thread-1  ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
18:15:36.518089 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
18:15:36.518321 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
18:15:36.518572 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
18:15:36.521846 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
18:15:36.523673 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a4f807-0000-fa00-0000-d96900052156
18:15:36.524338 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 8
invalid identifier 'ID'
18:15:36.524634 [debug] [Thread-1  ]: finished collecting timing info
18:15:36.525004 [debug] [Thread-2  ]: finished collecting timing info
18:15:36.525272 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
18:15:36.525593 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
18:15:36.529656 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
18:15:36.534670 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
18:15:36.535511 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
18:15:36.535894 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:15:36.631869 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 4.12 seconds
18:15:36.633716 [debug] [Thread-10 ]: finished collecting timing info
18:15:36.634348 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
18:15:36.668249 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.16 seconds
18:15:36.676390 [debug] [Thread-8  ]: finished collecting timing info
18:15:36.676782 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
18:15:36.683094 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.58 seconds
18:15:36.721537 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.24 seconds
18:15:36.728831 [debug] [Thread-5  ]: finished collecting timing info
18:15:36.759198 [debug] [Thread-2  ]: Database Error in model final_items (models/warehouse/final_items.sql)
  000904 (42000): SQL compilation error: error line 9 at position 8
  invalid identifier 'ID'
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
18:15:36.827127 [debug] [Thread-3  ]: finished collecting timing info
18:15:36.851238 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_details: Close
18:15:36.866200 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c904a1d90>]}
18:15:36.883386 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8fe517c0>]}
18:15:36.935810 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
18:15:36.974703 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c904a1910>]}
18:15:37.011396 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 4.66s]
18:15:37.017620 [error] [Thread-2  ]: 2 of 14 ERROR creating table model PUBLIC.final_items .......................... [[31mERROR[0m in 4.69s]
18:15:37.054910 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 4.55 seconds
18:15:37.090318 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 4.77s]
18:15:37.130388 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
18:15:37.177045 [debug] [Thread-6  ]: finished collecting timing info
18:15:37.197776 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
18:15:37.198708 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 4.69 seconds
18:15:37.202411 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
18:15:37.224180 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
18:15:37.235928 [debug] [Thread-7  ]: finished collecting timing info
18:15:37.252207 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8feb80a0>]}
18:15:37.256227 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
18:15:37.258459 [info ] [Thread-5  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 2.21s]
18:15:37.261443 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
18:15:37.293773 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8ff49b20>]}
18:15:37.295276 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 5.10s]
18:15:37.298656 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
18:15:37.378955 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c904a11f0>]}
18:15:37.380184 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.18s]
18:15:37.382386 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
18:15:37.390535 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90c0f100>]}
18:15:37.391455 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 5.19s]
18:15:37.393198 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
18:15:37.792799 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 1.28 seconds
18:15:37.794943 [debug] [Thread-9  ]: finished collecting timing info
18:15:37.795872 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
18:15:37.797044 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.26 seconds
18:15:37.802164 [debug] [Thread-1  ]: finished collecting timing info
18:15:37.803219 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
18:15:37.900183 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 1.4 seconds
18:15:37.902798 [debug] [Thread-4  ]: finished collecting timing info
18:15:37.903405 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.stg_match_info: Close
18:15:37.913180 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5c728c10>]}
18:15:37.914022 [info ] [Thread-9  ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.42s]
18:15:37.915175 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
18:15:37.923822 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c5c7293a0>]}
18:15:37.924872 [info ] [Thread-1  ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.41s]
18:15:37.926108 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
18:15:38.027068 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2102600-365b-47b8-a799-70c5554b0e77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c8ff64f70>]}
18:15:38.027892 [info ] [Thread-4  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.55s]
18:15:38.029115 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
18:15:38.034042 [debug] [MainThread]: Acquiring new snowflake connection "master"
18:15:38.035650 [info ] [MainThread]: 
18:15:38.036900 [info ] [MainThread]: Finished running 2 incremental models, 7 view models, 5 table models in 7.79s.
18:15:38.037877 [debug] [MainThread]: Connection 'master' was properly closed.
18:15:38.038311 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
18:15:38.038628 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_items' was properly closed.
18:15:38.038984 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_maps' was properly closed.
18:15:38.039321 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
18:15:38.039753 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
18:15:38.040332 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
18:15:38.040785 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
18:15:38.041291 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
18:15:38.041694 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
18:15:38.042109 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
18:15:38.066954 [info ] [MainThread]: 
18:15:38.068174 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:15:38.069672 [info ] [MainThread]: 
18:15:38.070606 [error] [MainThread]: [33mDatabase Error in model final_match_info (models/warehouse/final_match_info.sql)[0m
18:15:38.071628 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 4 at position 16
18:15:38.072330 [error] [MainThread]:   invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
18:15:38.072878 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_info.sql
18:15:38.073924 [info ] [MainThread]: 
18:15:38.075117 [error] [MainThread]: [33mDatabase Error in model final_match_details (models/warehouse/final_match_details.sql)[0m
18:15:38.076423 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 4 at position 16
18:15:38.077694 [error] [MainThread]:   invalid identifier 'DBT_INTERNAL_SOURCE.MATCH_ID'
18:15:38.078375 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_match_details.sql
18:15:38.078919 [info ] [MainThread]: 
18:15:38.079478 [error] [MainThread]: [33mDatabase Error in model final_items (models/warehouse/final_items.sql)[0m
18:15:38.080590 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 9 at position 8
18:15:38.081788 [error] [MainThread]:   invalid identifier 'ID'
18:15:38.082603 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
18:15:38.083687 [info ] [MainThread]: 
18:15:38.084402 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=3 SKIP=0 TOTAL=14
18:15:38.086378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90d11730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90d11880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90d118e0>]}


============================== 2022-06-15 18:22:46.572128 | febdf31f-b894-438c-bee5-a45a4c2cdaa7 ==============================
18:22:46.572158 [info ] [MainThread]: Running with dbt=1.1.0
18:22:46.573481 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
18:22:46.574066 [debug] [MainThread]: Tracking: tracking
18:22:46.575819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9e4347340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9e4347190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9e4347d00>]}
18:22:46.577076 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-um5zzocw'
18:22:46.577861 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
18:22:46.841584 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
18:22:46.842990 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
18:22:46.968569 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
18:22:47.065534 [info ] [MainThread]: Installing dbt-labs/dbt_utils
18:22:47.673056 [info ] [MainThread]:   Installed from version 0.8.5
18:22:47.673844 [info ] [MainThread]:   Up to date!
18:22:47.674356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'febdf31f-b894-438c-bee5-a45a4c2cdaa7', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9e4332a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9e44c9880>]}
18:22:47.675019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9e970c2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9e43d3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9e4347460>]}


============================== 2022-06-15 18:22:52.755282 | 65794395-52ec-4ca8-85ce-b84b6e913edc ==============================
18:22:52.755313 [info ] [MainThread]: Running with dbt=1.1.0
18:22:52.756321 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:22:52.756650 [debug] [MainThread]: Tracking: tracking
18:22:52.757035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff3af628b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff3af62910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff3af62970>]}
18:22:52.844661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
18:22:52.846157 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_match_details.sql
18:22:52.846948 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_items.sql
18:22:52.847712 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_match_info.sql
18:22:52.876223 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_details.sql
18:22:52.903815 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_details.sql
18:22:52.909012 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_items.sql
18:22:52.913563 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_info.sql
18:22:52.920974 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_info.sql
18:22:53.014439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6f27b820>]}
18:22:53.031937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6f336eb0>]}
18:22:53.032581 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
18:22:53.033348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6f279820>]}
18:22:53.037042 [info ] [MainThread]: 
18:22:53.037852 [debug] [MainThread]: Acquiring new snowflake connection "master"
18:22:53.040857 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
18:22:53.058328 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
18:22:53.058697 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
18:22:53.058906 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:22:53.934329 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.88 seconds
18:22:53.938544 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
18:22:54.062736 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
18:22:54.072382 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
18:22:54.072775 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
18:22:54.073003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:22:54.613618 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.54 seconds
18:22:54.616310 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
18:22:54.793885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff3af05df0>]}
18:22:54.794744 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:22:54.795228 [info ] [MainThread]: 
18:22:54.814762 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
18:22:54.815155 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
18:22:54.815497 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
18:22:54.815733 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
18:22:54.816058 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
18:22:54.816430 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
18:22:54.816793 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
18:22:54.817440 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
18:22:54.818287 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
18:22:54.818666 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
18:22:54.819335 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
18:22:54.819851 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
18:22:54.820421 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
18:22:54.820873 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
18:22:54.821263 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
18:22:54.822351 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
18:22:54.822861 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
18:22:54.823300 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
18:22:54.823591 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
18:22:54.824681 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
18:22:54.826192 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
18:22:54.826726 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
18:22:54.827163 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
18:22:54.827856 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:22:54.828230 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
18:22:54.828496 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
18:22:54.829315 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:22:54.830002 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
18:22:54.830273 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
18:22:54.831053 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
18:22:54.831703 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
18:22:54.832895 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
18:22:54.833631 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
18:22:54.834127 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
18:22:54.834905 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
18:22:54.835216 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
18:22:54.835583 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
18:22:54.835900 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
18:22:54.840087 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
18:22:54.840669 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
18:22:54.841200 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
18:22:54.841555 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
18:22:54.841972 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
18:22:54.842444 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
18:22:54.842946 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
18:22:54.846799 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
18:22:54.847320 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
18:22:54.847764 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
18:22:54.848250 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
18:22:54.851449 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
18:22:54.852665 [debug] [Thread-1  ]: finished collecting timing info
18:22:54.853424 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
18:22:54.854092 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
18:22:54.862831 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
18:22:54.863145 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
18:22:54.869964 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
18:22:54.944040 [debug] [Thread-2  ]: finished collecting timing info
18:22:54.948315 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
18:22:54.952059 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
18:22:54.953042 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
18:22:54.953694 [debug] [Thread-3  ]: finished collecting timing info
18:22:54.958062 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
18:22:54.961547 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
18:22:54.965565 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
18:22:54.966429 [debug] [Thread-4  ]: finished collecting timing info
18:22:54.966857 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
18:22:54.967201 [debug] [Thread-5  ]: finished collecting timing info
18:22:54.973382 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
18:22:54.989806 [debug] [Thread-6  ]: finished collecting timing info
18:22:55.010404 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
18:22:55.012013 [debug] [Thread-7  ]: finished collecting timing info
18:22:55.013086 [debug] [Thread-8  ]: finished collecting timing info
18:22:55.013637 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
18:22:55.014437 [debug] [Thread-10 ]: finished collecting timing info
18:22:55.017862 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
18:22:55.018151 [debug] [Thread-9  ]: finished collecting timing info
18:22:55.018645 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
18:22:55.023816 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
18:22:55.024352 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
18:22:55.025014 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
18:22:55.025698 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
18:22:55.027291 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
18:22:55.038427 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
18:22:55.064558 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:22:55.064996 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
18:22:55.070170 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:22:55.074449 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
18:22:55.079040 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
18:22:55.080034 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
18:22:55.083626 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
18:22:55.094669 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
18:22:55.108038 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
18:22:55.113891 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
18:22:55.114169 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
18:22:55.117685 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
18:22:55.118278 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
18:22:55.118717 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        '11',
        '12',
        '21',
        '22',
        FlatHPPoolMod,
        rFlatHPModPerLevel,
        FlatMPPoolMod,
        rFlatMPModPerLevel,
        PercentHPPoolMod,
        PercentMPPoolMod,
        FlatHPRegenMod,
        rFlatHPRegenModPerLevel,
        PercentHPRegenMod,
        FlatMPRegenMod,
        rFlatMPRegenModPerLevel,
        PercentMPRegenMod,
        FlatArmorMod,
        rFlatArmorModPerLevel,
        PercentArmorMod,
        rFlatArmorPenetrationMod,
        rFlatArmorPenetrationModPerLevel,
        rPercentArmorPenetrationMod,
        rPercentArmorPenetrationModPerLevel,
        FlatPhysicalDamageMod,
        rFlatPhysicalDamageModPerLevel,
        PercentPhysicalDamageMod,
        FlatMagicDamageMod,
        rFlatMagicDamageModPerLevel,
        PercentMagicDamageMod,
        FlatMovementSpeedMod,
        rFlatMovementSpeedModPerLevel,
        PercentMovementSpeedMod,
        rPercentMovementSpeedModPerLevel,
        FlatAttackSpeedMod,
        PercentAttackSpeedMod,
        rPercentAttackSpeedModPerLevel,
        rFlatDodgeMod,
        rFlatDodgeModPerLevel,
        PercentDodgeMod,
        FlatCritChanceMod,
        rFlatCritChanceModPerLevel,
        PercentCritChanceMod,
        FlatCritDamageMod,
        rFlatCritDamageModPerLevel,
        PercentCritDamageMod,
        FlatBlockMod,
        PercentBlockMod,
        FlatSpellBlockMod,
        rFlatSpellBlockModPerLevel,
        PercentSpellBlockMod,
        FlatEXPBonus,
        PercentEXPBonus,
        rPercentCooldownMod,
        rPercentCooldownModPerLevel,
        rFlatTimeDeadMod,
        rFlatTimeDeadModPerLevel,
        rPercentTimeDeadMod,
        rPercentTimeDeadModPerLevel,
        rFlatGoldPer10Mod,
        rFlatMagicPenetrationMod,
        rFlatMagicPenetrationModPerLevel,
        rPercentMagicPenetrationMod,
        rPercentMagicPenetrationModPerLevel,
        FlatEnergyRegenMod,
        rFlatEnergyRegenModPerLevel,
        FlatEnergyPoolMod,
        rFlatEnergyModPerLevel,
        PercentLifeStealMod,
        PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
18:22:55.119857 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
18:22:55.121346 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
18:22:55.121653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:22:55.122455 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
18:22:55.124982 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:22:55.127862 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
18:22:55.128633 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:22:55.129690 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
18:22:55.130221 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:22:55.133198 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
18:22:55.133573 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:22:55.133984 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
18:22:55.139091 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
18:22:55.141458 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
18:22:55.146893 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
18:22:55.155365 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY item_id
)

SELECT * FROM pivoted_items
  );
18:22:55.161177 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:22:55.161813 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:22:55.162785 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:22:55.163306 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:22:55.163912 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:22:58.100857 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.97 seconds
18:22:58.128013 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:22:58.131245 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
18:22:58.242673 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.11 seconds
18:22:58.250733 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:22:58.252441 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
18:22:58.359170 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.11 seconds
18:22:58.381827 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:22:58.382509 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
18:22:58.464292 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.08 seconds
18:22:58.501384 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
18:22:58.506464 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:22:58.507314 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
18:22:58.638049 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.13 seconds
18:22:58.639368 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:22:58.640492 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
18:22:59.047272 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.41 seconds
18:22:59.058463 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
18:22:59.059616 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
18:22:59.226099 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.17 seconds
18:22:59.243429 [debug] [Thread-5  ]: finished collecting timing info
18:22:59.244177 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
18:22:59.354009 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff694795b0>]}
18:22:59.355146 [info ] [Thread-5  ]: 5 of 14 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 4.52s]
18:22:59.357172 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
18:22:59.357979 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_match_details
18:22:59.358755 [info ] [Thread-5  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
18:22:59.359590 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
18:22:59.360028 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
18:22:59.360415 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_match_details
18:22:59.365166 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
18:22:59.365672 [debug] [Thread-5  ]: finished collecting timing info
18:22:59.365948 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
18:22:59.370067 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
18:22:59.376280 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
18:22:59.376593 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
18:22:59.376841 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
18:22:59.613392 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 4.45 seconds
18:22:59.619409 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 4.46 seconds
18:22:59.621802 [debug] [Thread-9  ]: finished collecting timing info
18:22:59.637835 [debug] [Thread-10 ]: finished collecting timing info
18:22:59.663204 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
18:22:59.679753 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
18:22:59.745423 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.58 seconds
18:22:59.749328 [debug] [Thread-8  ]: finished collecting timing info
18:22:59.750353 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.62 seconds
18:22:59.753315 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
18:22:59.755006 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 4.59 seconds
18:22:59.758050 [debug] [Thread-3  ]: finished collecting timing info
18:22:59.761773 [debug] [Thread-6  ]: finished collecting timing info
18:22:59.769119 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
18:22:59.772637 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
18:22:59.797726 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a4f80f-0000-f89b-0000-d969000531ae
18:22:59.798496 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 20 at position 8
invalid identifier 'FLATHPPOOLMOD'
18:22:59.799412 [debug] [Thread-2  ]: finished collecting timing info
18:22:59.800941 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
18:22:59.893791 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff69479820>]}
18:22:59.896020 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff69479f40>]}
18:22:59.896929 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.06s]
18:22:59.898986 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff69480430>]}
18:22:59.899810 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 5.06s]
18:22:59.901567 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
18:22:59.903063 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff69479d60>]}
18:22:59.903858 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 5.06s]
18:22:59.905357 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff69480cd0>]}
18:22:59.906006 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
18:22:59.906677 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_match_info
18:22:59.907577 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 5.08s]
18:22:59.908812 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
18:22:59.909591 [info ] [Thread-9  ]: 9 of 14 OK created view model PUBLIC.stg_items ................................. [[32mSUCCESS 1[0m in 5.07s]
18:22:59.910148 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
18:22:59.910752 [info ] [Thread-6  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
18:22:59.911562 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
18:22:59.911901 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
18:22:59.912814 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
18:22:59.913128 [info ] [Thread-8  ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
18:22:59.913832 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
18:22:59.914419 [info ] [Thread-10 ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
18:22:59.915990 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
18:22:59.916577 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
18:22:59.917717 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
18:22:59.918135 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
18:22:59.918545 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_match_info
18:22:59.918936 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
18:22:59.919346 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
18:22:59.925517 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
18:22:59.925993 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
18:22:59.929886 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
18:22:59.935030 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
18:22:59.936165 [debug] [Thread-6  ]: finished collecting timing info
18:22:59.937851 [debug] [Thread-2  ]: Database Error in model final_items (models/warehouse/final_items.sql)
  000904 (42000): SQL compilation error: error line 20 at position 8
  invalid identifier 'FLATHPPOOLMOD'
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
18:22:59.939016 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
18:22:59.939416 [debug] [Thread-8  ]: finished collecting timing info
18:22:59.939764 [debug] [Thread-10 ]: finished collecting timing info
18:22:59.940292 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff645e5df0>]}
18:22:59.947386 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
18:22:59.947724 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
18:22:59.948750 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
18:22:59.950449 [error] [Thread-2  ]: 2 of 14 ERROR creating table model PUBLIC.final_items .......................... [[31mERROR[0m in 5.12s]
18:22:59.956951 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
18:22:59.962092 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
18:22:59.964383 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
18:22:59.964997 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
18:22:59.966497 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
18:22:59.967625 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
18:22:59.968723 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
18:22:59.969493 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
18:22:59.970112 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
18:22:59.970463 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
18:22:59.975290 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
18:22:59.976290 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
18:23:00.402555 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.03 seconds
18:23:00.427032 [debug] [Thread-5  ]: finished collecting timing info
18:23:00.438764 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.31 seconds
18:23:00.439825 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.32 seconds
18:23:00.445611 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_details: Close
18:23:00.528017 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:23:00.559971 [debug] [Thread-1  ]: finished collecting timing info
18:23:00.605057 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
18:23:00.609014 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
18:23:00.774015 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff644ebee0>]}
18:23:00.775093 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 5.96s]
18:23:00.777375 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 5.62 seconds
18:23:00.778182 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
18:23:00.781202 [debug] [Thread-7  ]: finished collecting timing info
18:23:00.783898 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
18:23:00.793649 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.17 seconds
18:23:00.814473 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:23:00.814860 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
18:23:00.821058 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff69479430>]}
18:23:00.822295 [info ] [Thread-5  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 1.46s]
18:23:00.823975 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
18:23:00.911395 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.1 seconds
18:23:00.925280 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:23:00.925924 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
18:23:00.933840 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff69479d30>]}
18:23:00.934522 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 6.10s]
18:23:00.937000 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
18:23:01.065251 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.14 seconds
18:23:01.082739 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
18:23:01.089909 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:23:01.090310 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
18:23:01.182067 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.09 seconds
18:23:01.182790 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:23:01.183198 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
18:23:01.220661 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.25 seconds
18:23:01.222964 [debug] [Thread-6  ]: finished collecting timing info
18:23:01.223412 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_info: Close
18:23:01.338179 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.36 seconds
18:23:01.342534 [debug] [Thread-8  ]: finished collecting timing info
18:23:01.344049 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
18:23:01.348076 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.37 seconds
18:23:01.354018 [debug] [Thread-10 ]: finished collecting timing info
18:23:01.355718 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
18:23:01.360845 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff644f37c0>]}
18:23:01.361894 [info ] [Thread-6  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.45s]
18:23:01.363962 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
18:23:01.472472 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff645b10d0>]}
18:23:01.474210 [info ] [Thread-8  ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.56s]
18:23:01.477523 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
18:23:01.480034 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff644ead00>]}
18:23:01.480812 [info ] [Thread-10 ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.56s]
18:23:01.481521 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
18:23:02.280795 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.1 seconds
18:23:02.281166 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
18:23:02.281380 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
18:23:02.515491 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.23 seconds
18:23:02.517676 [debug] [Thread-4  ]: finished collecting timing info
18:23:02.518113 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
18:23:02.709733 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65794395-52ec-4ca8-85ce-b84b6e913edc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff645d2e20>]}
18:23:02.710321 [info ] [Thread-4  ]: 4 of 14 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 7.88s]
18:23:02.711077 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
18:23:02.714007 [debug] [MainThread]: Acquiring new snowflake connection "master"
18:23:02.714851 [info ] [MainThread]: 
18:23:02.715557 [info ] [MainThread]: Finished running 2 incremental models, 5 table models, 7 view models in 9.68s.
18:23:02.715963 [debug] [MainThread]: Connection 'master' was properly closed.
18:23:02.716193 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_champions' was properly closed.
18:23:02.716415 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_items' was properly closed.
18:23:02.716680 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_maps' was properly closed.
18:23:02.716891 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
18:23:02.717107 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
18:23:02.717300 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
18:23:02.717499 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
18:23:02.717750 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
18:23:02.717946 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
18:23:02.718161 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
18:23:02.731999 [info ] [MainThread]: 
18:23:02.732427 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:23:02.732763 [info ] [MainThread]: 
18:23:02.733042 [error] [MainThread]: [33mDatabase Error in model final_items (models/warehouse/final_items.sql)[0m
18:23:02.733388 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 20 at position 8
18:23:02.733706 [error] [MainThread]:   invalid identifier 'FLATHPPOOLMOD'
18:23:02.734114 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
18:23:02.734488 [info ] [MainThread]: 
18:23:02.734863 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
18:23:02.735313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6f2a70d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6f2a7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff6f2a7040>]}


============================== 2022-06-15 19:38:58.463612 | da5dbaf8-2f85-42c3-a7c1-d55760f92849 ==============================
19:38:58.463633 [info ] [MainThread]: Running with dbt=1.1.0
19:38:58.464211 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
19:38:58.464436 [debug] [MainThread]: Tracking: tracking
19:38:58.465669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb59d5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb59d5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb59d5d60>]}
19:38:58.466511 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-s1w_t4xh'
19:38:58.466871 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
19:38:58.847352 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
19:38:58.848036 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
19:38:59.161635 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
19:38:59.218773 [info ] [MainThread]: Installing dbt-labs/dbt_utils
19:38:59.820902 [info ] [MainThread]:   Installed from version 0.8.5
19:38:59.821347 [info ] [MainThread]:   Up to date!
19:38:59.821814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'da5dbaf8-2f85-42c3-a7c1-d55760f92849', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb59b98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb5b5b460>]}
19:38:59.822346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cbad9a2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb59d5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cb59d5df0>]}


============================== 2022-06-15 19:39:05.044624 | 227f1179-a9fe-431f-869b-b7bac6f92aea ==============================
19:39:05.044649 [info ] [MainThread]: Running with dbt=1.1.0
19:39:05.045214 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:39:05.045408 [debug] [MainThread]: Tracking: tracking
19:39:05.045744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054c8a6760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054c8a67c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054c8a6820>]}
19:39:05.110434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:39:05.111111 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_items.sql
19:39:05.129252 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_items.sql
19:39:05.195245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d32e0d0>]}
19:39:05.211315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0580c8b310>]}
19:39:05.211907 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
19:39:05.212634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057d329eb0>]}
19:39:05.216308 [info ] [MainThread]: 
19:39:05.217029 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:39:05.219073 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
19:39:05.236196 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
19:39:05.236514 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
19:39:05.236760 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:39:06.216073 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.98 seconds
19:39:06.219173 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
19:39:06.371871 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
19:39:06.381518 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
19:39:06.381976 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
19:39:06.382231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:39:07.142053 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.76 seconds
19:39:07.144826 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
19:39:07.267123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f054c803550>]}
19:39:07.267841 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:39:07.268285 [info ] [MainThread]: 
19:39:07.288139 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
19:39:07.288550 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
19:39:07.289121 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
19:39:07.289416 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
19:39:07.289801 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
19:39:07.290284 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
19:39:07.290697 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
19:39:07.291135 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
19:39:07.291467 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
19:39:07.291849 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
19:39:07.292832 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
19:39:07.293560 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
19:39:07.293931 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
19:39:07.294285 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
19:39:07.294775 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
19:39:07.295257 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
19:39:07.295992 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
19:39:07.296944 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
19:39:07.297417 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
19:39:07.297874 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
19:39:07.298418 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
19:39:07.298818 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
19:39:07.299214 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
19:39:07.300085 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
19:39:07.300812 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:39:07.301509 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:39:07.302236 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
19:39:07.302513 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
19:39:07.303217 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
19:39:07.304442 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
19:39:07.305178 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
19:39:07.305448 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
19:39:07.306203 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
19:39:07.306488 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
19:39:07.306807 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
19:39:07.307089 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
19:39:07.307355 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
19:39:07.307608 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
19:39:07.307851 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
19:39:07.308232 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
19:39:07.310761 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
19:39:07.314079 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
19:39:07.314600 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
19:39:07.315015 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
19:39:07.315282 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
19:39:07.315538 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
19:39:07.315780 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
19:39:07.319736 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
19:39:07.320176 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
19:39:07.320649 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
19:39:07.321060 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
19:39:07.321740 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
19:39:07.325316 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
19:39:07.325600 [debug] [Thread-1  ]: finished collecting timing info
19:39:07.343824 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
19:39:07.346544 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
19:39:07.350152 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
19:39:07.354189 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
19:39:07.354490 [debug] [Thread-2  ]: finished collecting timing info
19:39:07.359046 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
19:39:07.449305 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
19:39:07.454667 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
19:39:07.455420 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
19:39:07.456583 [debug] [Thread-3  ]: finished collecting timing info
19:39:07.458225 [debug] [Thread-4  ]: finished collecting timing info
19:39:07.459541 [debug] [Thread-5  ]: finished collecting timing info
19:39:07.460546 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
19:39:07.461108 [debug] [Thread-7  ]: finished collecting timing info
19:39:07.461522 [debug] [Thread-6  ]: finished collecting timing info
19:39:07.463106 [debug] [Thread-8  ]: finished collecting timing info
19:39:07.469682 [debug] [Thread-10 ]: finished collecting timing info
19:39:07.470649 [debug] [Thread-9  ]: finished collecting timing info
19:39:07.481061 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
19:39:07.496829 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
19:39:07.508591 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
19:39:07.509302 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
19:39:07.514356 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
19:39:07.515006 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
19:39:07.515668 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
19:39:07.516088 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
19:39:07.516594 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
19:39:07.517148 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
19:39:07.523998 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
19:39:07.596407 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:39:07.599375 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:39:07.601016 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
19:39:07.605738 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
19:39:07.610428 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
19:39:07.614828 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
19:39:07.657329 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
19:39:07.659616 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
19:39:07.666369 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
19:39:07.667079 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
19:39:07.667778 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
19:39:07.669233 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
19:39:07.669608 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
19:39:07.670802 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        '11' as 'Summoners Rift',
        '12' as 'Howling Abyss',
        '21' as 'Nexus Blitz',
        '22' as 'Teamfight Tactics',
        'FlatHPPoolMod' as FlatHPPoolMod,
        'rFlatHPModPerLevel' as rFlatHPModPerLevel,
        'FlatMPPoolMod' as FlatMPPoolMod,
        'rFlatMPModPerLevel' as rFlatMPModPerLevel,
        'PercentHPPoolMod' as PercentHPPoolMod,
        'PercentMPPoolMod' as PercentMPPoolMod,
        'FlatHPRegenMod' as FlatHPRegenMod,
        'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
        'PercentHPRegenMod' as PercentHPRegenMod,
        'FlatMPRegenMod' as FlatMPRegenMod,
        'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
        'PercentMPRegenMod' as PercentMPRegenMod,
        'FlatArmorMod' as FlatArmorMod,
        'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
        'PercentArmorMod' as PercentArmorMod,
        'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
        'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
        'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
        'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
        'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
        'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
        'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
        'FlatMagicDamageMod' as FlatMagicDamageMod,
        'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
        'PercentMagicDamageMod' as PercentMagicDamageMod,
        'FlatMovementSpeedMod' as FlatMovementSpeedMod,
        'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
        'PercentMovementSpeedMod' as PercentMovementSpeedMod,
        'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
        'FlatAttackSpeedMod' as FlatAttackSpeedMod,
        'PercentAttackSpeedMod' as PercentAttackSpeedMod,
        'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
        'rFlatDodgeMod' as rFlatDodgeMod,
        'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
        'PercentDodgeMod' as PercentDodgeMod,
        'FlatCritChanceMod' as FlatCritChanceMod,
        'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
        'PercentCritChanceMod' as PercentCritChanceMod,
        'FlatCritDamageMod' as FlatCritDamageMod,
        'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
        'PercentCritDamageMod' as PercentCritDamageMod,
        'FlatBlockMod' as FlatBlockMod,
        'PercentBlockMod' as PercentBlockMod,
        'FlatSpellBlockMod' as FlatSpellBlockMod,
        'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
        'PercentSpellBlockMod' as PercentSpellBlockMod,
        'FlatEXPBonus' as FlatEXPBonus,
        'PercentEXPBonus' as PercentEXPBonus,
        'rPercentCooldownMod' as rPercentCooldownMod,
        'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
        'rFlatTimeDeadMod' as rFlatTimeDeadMod,
        'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
        'rPercentTimeDeadMod' as rPercentTimeDeadMod,
        'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
        'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
        'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
        'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
        'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
        'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
        'FlatEnergyRegenMod' as FlatEnergyRegenMod,
        'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
        'FlatEnergyPoolMod' as FlatEnergyPoolMod,
        'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
        'PercentLifeStealMod' as PercentLifeStealMod,
        'PercentSpellVampMod' as PercentSpellVampMod,
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
19:39:07.672618 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
19:39:07.673994 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
19:39:07.677499 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
19:39:07.678180 [debug] [Thread-5  ]: Opening a new connection, currently in state init
19:39:07.679608 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
19:39:07.682873 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
19:39:07.683295 [debug] [Thread-4  ]: Opening a new connection, currently in state init
19:39:07.683897 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
19:39:07.684289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:39:07.684843 [debug] [Thread-2  ]: Opening a new connection, currently in state init
19:39:07.685432 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
19:39:07.685797 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
19:39:07.686276 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
19:39:07.687997 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
19:39:07.691113 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY item_id
)

SELECT * FROM pivoted_items
  );
19:39:07.696151 [debug] [Thread-3  ]: Opening a new connection, currently in state init
19:39:07.715563 [debug] [Thread-7  ]: Opening a new connection, currently in state init
19:39:07.716813 [debug] [Thread-6  ]: Opening a new connection, currently in state init
19:39:07.718186 [debug] [Thread-8  ]: Opening a new connection, currently in state init
19:39:07.718859 [debug] [Thread-10 ]: Opening a new connection, currently in state init
19:39:07.719498 [debug] [Thread-9  ]: Opening a new connection, currently in state init
19:39:11.362543 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.67 seconds
19:39:11.376256 [debug] [Thread-3  ]: finished collecting timing info
19:39:11.377397 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
19:39:11.543248 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c746a0>]}
19:39:11.543890 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.86 seconds
19:39:11.544710 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 4.24s]
19:39:11.553596 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
19:39:11.555149 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_match_details
19:39:11.556485 [info ] [Thread-3  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
19:39:11.558247 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
19:39:11.564525 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
19:39:11.568852 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:39:11.569253 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_match_details
19:39:11.570573 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
19:39:11.575445 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
19:39:11.582892 [debug] [Thread-3  ]: finished collecting timing info
19:39:11.583621 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
19:39:11.588254 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
19:39:11.594940 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
19:39:11.595633 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
19:39:11.596010 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:39:11.677420 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.1 seconds
19:39:11.690014 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:39:11.690352 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
19:39:11.714494 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.0 seconds
19:39:11.717336 [debug] [Thread-8  ]: finished collecting timing info
19:39:11.718346 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
19:39:11.723568 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a4f85b-0000-f89b-0000-d969000531d2
19:39:11.723888 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 16 unexpected ''Summoners Rift''.
syntax error line 17 at position 16 unexpected ''Howling Abyss''.
syntax error line 18 at position 16 unexpected ''Nexus Blitz''.
syntax error line 19 at position 16 unexpected ''Teamfight Tactics''.
syntax error line 85 at position 4 unexpected 'FROM'.
19:39:11.724282 [debug] [Thread-2  ]: finished collecting timing info
19:39:11.724533 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
19:39:11.889359 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 4.17 seconds
19:39:11.896915 [debug] [Thread-10 ]: finished collecting timing info
19:39:11.904254 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
19:39:11.911259 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 4.19 seconds
19:39:11.913237 [debug] [Thread-9  ]: finished collecting timing info
19:39:11.913957 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
19:39:11.923259 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.23 seconds
19:39:11.940717 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:39:11.941053 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
19:39:11.991419 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c78df0>]}
19:39:11.992331 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 4.69s]
19:39:11.999183 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
19:39:12.000301 [debug] [Thread-2  ]: Database Error in model final_items (models/warehouse/final_items.sql)
  001003 (42000): SQL compilation error:
  syntax error line 16 at position 16 unexpected ''Summoners Rift''.
  syntax error line 17 at position 16 unexpected ''Howling Abyss''.
  syntax error line 18 at position 16 unexpected ''Nexus Blitz''.
  syntax error line 19 at position 16 unexpected ''Teamfight Tactics''.
  syntax error line 85 at position 4 unexpected 'FROM'.
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
19:39:12.001099 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_match_info
19:39:12.002264 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0577d95b50>]}
19:39:12.002889 [info ] [Thread-8  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
19:39:12.003581 [error] [Thread-2  ]: 2 of 14 ERROR creating table model PUBLIC.final_items .......................... [[31mERROR[0m in 4.71s]
19:39:12.004717 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
19:39:12.006155 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
19:39:12.006722 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_match_info
19:39:12.010658 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
19:39:12.011316 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
19:39:12.013392 [debug] [Thread-8  ]: finished collecting timing info
19:39:12.013940 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
19:39:12.016023 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
19:39:12.017091 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 4.34 seconds
19:39:12.017835 [info ] [Thread-2  ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
19:39:12.022048 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
19:39:12.026107 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:39:12.030133 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.09 seconds
19:39:12.031381 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
19:39:12.032340 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c78ac0>]}
19:39:12.033331 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
19:39:12.035134 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
19:39:12.057763 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
19:39:12.075731 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 4.73s]
19:39:12.083968 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
19:39:12.085159 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c8b4f0>]}
19:39:12.086891 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
19:39:12.090782 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
19:39:12.093733 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
19:39:12.095374 [info ] [Thread-9  ]: 9 of 14 OK created view model PUBLIC.stg_items ................................. [[32mSUCCESS 1[0m in 4.78s]
19:39:12.101710 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
19:39:12.105258 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:39:12.110184 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
19:39:12.111638 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
19:39:12.113170 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
19:39:12.114678 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
19:39:12.117826 [info ] [Thread-10 ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
19:39:12.118311 [debug] [Thread-2  ]: finished collecting timing info
19:39:12.123454 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
19:39:12.123923 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
19:39:12.124604 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
19:39:12.130159 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
19:39:12.130781 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
19:39:12.134621 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
19:39:12.136604 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
19:39:12.137223 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
19:39:12.137763 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:39:12.139070 [debug] [Thread-10 ]: finished collecting timing info
19:39:12.141112 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
19:39:12.146979 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
19:39:12.148472 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
19:39:12.148808 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
19:39:12.148993 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
19:39:12.191070 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.11 seconds
19:39:12.195911 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:39:12.196310 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
19:39:12.222497 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.1 seconds
19:39:12.223204 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:39:12.223532 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
19:39:12.321793 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.12 seconds
19:39:12.327854 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 4.61 seconds
19:39:12.338853 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:39:12.357703 [debug] [Thread-6  ]: finished collecting timing info
19:39:12.426381 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
19:39:12.480957 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
19:39:12.491653 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.9 seconds
19:39:12.546422 [debug] [Thread-3  ]: finished collecting timing info
19:39:12.574018 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_details: Close
19:39:12.581053 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.9 seconds
19:39:12.588354 [debug] [Thread-1  ]: finished collecting timing info
19:39:12.599696 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
19:39:12.717533 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.19 seconds
19:39:12.727704 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
19:39:12.789731 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 5.07 seconds
19:39:12.791832 [debug] [Thread-7  ]: finished collecting timing info
19:39:12.799392 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:39:12.813853 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
19:39:12.830898 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c74d90>]}
19:39:12.838961 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
19:39:12.854788 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.53s]
19:39:12.894053 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
19:39:12.897924 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c74460>]}
19:39:12.899735 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 5.60s]
19:39:12.903930 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
19:39:12.923499 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c732e0>]}
19:39:12.925956 [info ] [Thread-3  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 1.37s]
19:39:12.927570 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
19:39:12.977007 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c74fa0>]}
19:39:12.979637 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 5.67s]
19:39:12.981006 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
19:39:13.000342 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.12 seconds
19:39:13.001094 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:39:13.002293 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
19:39:13.166345 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.94 seconds
19:39:13.166701 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:39:13.166897 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
19:39:13.322222 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.22 seconds
19:39:13.324205 [debug] [Thread-8  ]: finished collecting timing info
19:39:13.324565 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_match_info: Close
19:39:13.328489 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.16 seconds
19:39:13.330420 [debug] [Thread-4  ]: finished collecting timing info
19:39:13.331186 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
19:39:13.337856 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.34 seconds
19:39:13.338197 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:39:13.338384 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
19:39:13.364776 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.22 seconds
19:39:13.366570 [debug] [Thread-10 ]: finished collecting timing info
19:39:13.366990 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
19:39:13.412288 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.27 seconds
19:39:13.414326 [debug] [Thread-2  ]: finished collecting timing info
19:39:13.414631 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
19:39:13.446459 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c2bac0>]}
19:39:13.447033 [info ] [Thread-8  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.44s]
19:39:13.447759 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
19:39:13.464337 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c9bf10>]}
19:39:13.465783 [info ] [Thread-4  ]: 4 of 14 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 6.16s]
19:39:13.467753 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
19:39:13.475940 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575c36b80>]}
19:39:13.476491 [info ] [Thread-10 ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.35s]
19:39:13.477087 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
19:39:13.522616 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.18 seconds
19:39:13.524571 [debug] [Thread-5  ]: finished collecting timing info
19:39:13.524894 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
19:39:13.530817 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575d05700>]}
19:39:13.531342 [info ] [Thread-2  ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.50s]
19:39:13.531908 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
19:39:13.633280 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '227f1179-a9fe-431f-869b-b7bac6f92aea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0575cda370>]}
19:39:13.633895 [info ] [Thread-5  ]: 5 of 14 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 6.33s]
19:39:13.634486 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
19:39:13.637179 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:39:13.637747 [info ] [MainThread]: 
19:39:13.638241 [info ] [MainThread]: Finished running 5 table models, 7 view models, 2 incremental models in 8.42s.
19:39:13.638693 [debug] [MainThread]: Connection 'master' was properly closed.
19:39:13.638851 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_champions' was properly closed.
19:39:13.639005 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
19:39:13.639223 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
19:39:13.639402 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
19:39:13.639605 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
19:39:13.639784 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
19:39:13.639978 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
19:39:13.640189 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
19:39:13.640362 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
19:39:13.640543 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
19:39:13.653932 [info ] [MainThread]: 
19:39:13.654383 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:39:13.654789 [info ] [MainThread]: 
19:39:13.655153 [error] [MainThread]: [33mDatabase Error in model final_items (models/warehouse/final_items.sql)[0m
19:39:13.655516 [error] [MainThread]:   001003 (42000): SQL compilation error:
19:39:13.655910 [error] [MainThread]:   syntax error line 16 at position 16 unexpected ''Summoners Rift''.
19:39:13.656329 [error] [MainThread]:   syntax error line 17 at position 16 unexpected ''Howling Abyss''.
19:39:13.656651 [error] [MainThread]:   syntax error line 18 at position 16 unexpected ''Nexus Blitz''.
19:39:13.657093 [error] [MainThread]:   syntax error line 19 at position 16 unexpected ''Teamfight Tactics''.
19:39:13.657460 [error] [MainThread]:   syntax error line 85 at position 4 unexpected 'FROM'.
19:39:13.657833 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
19:39:13.658305 [info ] [MainThread]: 
19:39:13.658769 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
19:39:13.659387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f057832c670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0578324940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0578324be0>]}


============================== 2022-06-15 19:41:37.029323 | 187208a1-52d6-41a5-a88f-aa0766ba6ac6 ==============================
19:41:37.029341 [info ] [MainThread]: Running with dbt=1.1.0
19:41:37.029886 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
19:41:37.030070 [debug] [MainThread]: Tracking: tracking
19:41:37.031139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f6b56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f6b5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f6b5e80>]}
19:41:37.031929 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-z9ukbqmo'
19:41:37.032382 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
19:41:37.192496 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
19:41:37.193647 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
19:41:37.313269 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
19:41:37.366103 [info ] [MainThread]: Installing dbt-labs/dbt_utils
19:41:37.975888 [info ] [MainThread]:   Installed from version 0.8.5
19:41:37.976500 [info ] [MainThread]:   Up to date!
19:41:37.977076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '187208a1-52d6-41a5-a88f-aa0766ba6ac6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f6adca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f6ad610>]}
19:41:37.978027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8664a792e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f69f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865f6ada60>]}


============================== 2022-06-15 19:41:42.855955 | c7d57ff6-1242-4808-b3f1-b64c73389ca3 ==============================
19:41:42.855979 [info ] [MainThread]: Running with dbt=1.1.0
19:41:42.856606 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:41:42.856823 [debug] [MainThread]: Tracking: tracking
19:41:42.857153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a70080730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a70080790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a700807f0>]}
19:41:42.924856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:41:42.925991 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_items.sql
19:41:42.946188 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_items.sql
19:41:43.013776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a99a820a0>]}
19:41:43.029304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a9f3dc730>]}
19:41:43.029946 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
19:41:43.030716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a99a7de80>]}
19:41:43.034758 [info ] [MainThread]: 
19:41:43.035586 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:41:43.037440 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
19:41:43.054655 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
19:41:43.054999 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
19:41:43.055227 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:41:44.184878 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.13 seconds
19:41:44.186770 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
19:41:44.314354 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
19:41:44.323377 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
19:41:44.323652 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
19:41:44.323879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:41:44.930231 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.61 seconds
19:41:44.934321 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
19:41:45.078147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6af43520>]}
19:41:45.078855 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:41:45.079326 [info ] [MainThread]: 
19:41:45.158830 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
19:41:45.159322 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
19:41:45.159917 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
19:41:45.160251 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
19:41:45.160597 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
19:41:45.160939 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
19:41:45.161267 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
19:41:45.161779 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
19:41:45.162245 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
19:41:45.162820 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
19:41:45.163103 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
19:41:45.163494 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
19:41:45.163805 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
19:41:45.164140 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
19:41:45.164446 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
19:41:45.165287 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
19:41:45.166135 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
19:41:45.167393 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
19:41:45.168218 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
19:41:45.168766 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
19:41:45.169263 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
19:41:45.170202 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
19:41:45.170835 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
19:41:45.171281 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
19:41:45.172684 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:41:45.173414 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
19:41:45.174350 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:41:45.175331 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
19:41:45.176218 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
19:41:45.176612 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
19:41:45.177672 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
19:41:45.178483 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
19:41:45.178882 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
19:41:45.180103 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
19:41:45.180533 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
19:41:45.181262 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
19:41:45.181803 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
19:41:45.182541 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
19:41:45.183196 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
19:41:45.192329 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
19:41:45.192685 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
19:41:45.193138 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
19:41:45.193571 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
19:41:45.194054 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
19:41:45.194422 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
19:41:45.198305 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
19:41:45.198854 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
19:41:45.199385 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
19:41:45.199732 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
19:41:45.200248 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
19:41:45.200791 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
19:41:45.201376 [debug] [Thread-1  ]: finished collecting timing info
19:41:45.204859 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
19:41:45.205328 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
19:41:45.220501 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
19:41:45.227021 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
19:41:45.230807 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
19:41:45.231379 [debug] [Thread-2  ]: finished collecting timing info
19:41:45.235807 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
19:41:45.239723 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
19:41:45.320222 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
19:41:45.320789 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
19:41:45.324714 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
19:41:45.326219 [debug] [Thread-3  ]: finished collecting timing info
19:41:45.327106 [debug] [Thread-5  ]: finished collecting timing info
19:41:45.327953 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
19:41:45.328405 [debug] [Thread-4  ]: finished collecting timing info
19:41:45.328923 [debug] [Thread-6  ]: finished collecting timing info
19:41:45.329911 [debug] [Thread-7  ]: finished collecting timing info
19:41:45.335440 [debug] [Thread-8  ]: finished collecting timing info
19:41:45.346677 [debug] [Thread-9  ]: finished collecting timing info
19:41:45.353348 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
19:41:45.363662 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
19:41:45.365733 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
19:41:45.366149 [debug] [Thread-10 ]: finished collecting timing info
19:41:45.370591 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
19:41:45.371029 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
19:41:45.371415 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
19:41:45.371743 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
19:41:45.372079 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
19:41:45.372369 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
19:41:45.377772 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
19:41:45.400401 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
19:41:45.413104 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:41:45.414475 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
19:41:45.424037 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:41:45.427481 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
19:41:45.431438 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
19:41:45.434959 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
19:41:45.474834 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
19:41:45.478028 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
19:41:45.482379 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
19:41:45.483800 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
19:41:45.484331 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
19:41:45.484878 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
19:41:45.485210 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
19:41:45.486128 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        '11' as SummonersRift,
        '12' as HowlingAbyss',
        '21' as NexusBlitz,
        '22' as TeamfightTactics,
        'FlatHPPoolMod' as FlatHPPoolMod,
        'rFlatHPModPerLevel' as rFlatHPModPerLevel,
        'FlatMPPoolMod' as FlatMPPoolMod,
        'rFlatMPModPerLevel' as rFlatMPModPerLevel,
        'PercentHPPoolMod' as PercentHPPoolMod,
        'PercentMPPoolMod' as PercentMPPoolMod,
        'FlatHPRegenMod' as FlatHPRegenMod,
        'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
        'PercentHPRegenMod' as PercentHPRegenMod,
        'FlatMPRegenMod' as FlatMPRegenMod,
        'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
        'PercentMPRegenMod' as PercentMPRegenMod,
        'FlatArmorMod' as FlatArmorMod,
        'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
        'PercentArmorMod' as PercentArmorMod,
        'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
        'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
        'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
        'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
        'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
        'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
        'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
        'FlatMagicDamageMod' as FlatMagicDamageMod,
        'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
        'PercentMagicDamageMod' as PercentMagicDamageMod,
        'FlatMovementSpeedMod' as FlatMovementSpeedMod,
        'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
        'PercentMovementSpeedMod' as PercentMovementSpeedMod,
        'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
        'FlatAttackSpeedMod' as FlatAttackSpeedMod,
        'PercentAttackSpeedMod' as PercentAttackSpeedMod,
        'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
        'rFlatDodgeMod' as rFlatDodgeMod,
        'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
        'PercentDodgeMod' as PercentDodgeMod,
        'FlatCritChanceMod' as FlatCritChanceMod,
        'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
        'PercentCritChanceMod' as PercentCritChanceMod,
        'FlatCritDamageMod' as FlatCritDamageMod,
        'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
        'PercentCritDamageMod' as PercentCritDamageMod,
        'FlatBlockMod' as FlatBlockMod,
        'PercentBlockMod' as PercentBlockMod,
        'FlatSpellBlockMod' as FlatSpellBlockMod,
        'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
        'PercentSpellBlockMod' as PercentSpellBlockMod,
        'FlatEXPBonus' as FlatEXPBonus,
        'PercentEXPBonus' as PercentEXPBonus,
        'rPercentCooldownMod' as rPercentCooldownMod,
        'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
        'rFlatTimeDeadMod' as rFlatTimeDeadMod,
        'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
        'rPercentTimeDeadMod' as rPercentTimeDeadMod,
        'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
        'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
        'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
        'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
        'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
        'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
        'FlatEnergyRegenMod' as FlatEnergyRegenMod,
        'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
        'FlatEnergyPoolMod' as FlatEnergyPoolMod,
        'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
        'PercentLifeStealMod' as PercentLifeStealMod,
        'PercentSpellVampMod' as PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
19:41:45.488025 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
19:41:45.488992 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
19:41:45.493172 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
19:41:45.495552 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
19:41:45.495868 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
19:41:45.496747 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
19:41:45.497082 [debug] [Thread-5  ]: Opening a new connection, currently in state init
19:41:45.497610 [debug] [Thread-1  ]: Opening a new connection, currently in state init
19:41:45.497935 [debug] [Thread-4  ]: Opening a new connection, currently in state init
19:41:45.498223 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:41:45.498616 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
19:41:45.499044 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
19:41:45.500035 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY item_id
)

SELECT * FROM pivoted_items
  );
19:41:45.500933 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
19:41:45.501570 [debug] [Thread-3  ]: Opening a new connection, currently in state init
19:41:45.502084 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
19:41:45.519508 [debug] [Thread-6  ]: Opening a new connection, currently in state init
19:41:45.521407 [debug] [Thread-7  ]: Opening a new connection, currently in state init
19:41:45.521847 [debug] [Thread-9  ]: Opening a new connection, currently in state init
19:41:45.522304 [debug] [Thread-8  ]: Opening a new connection, currently in state init
19:41:45.528537 [debug] [Thread-10 ]: Opening a new connection, currently in state init
19:41:49.158855 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.66 seconds
19:41:49.176829 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:41:49.178032 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
19:41:49.293465 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.11 seconds
19:41:49.305117 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:41:49.306766 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
19:41:49.311506 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a4f85d-0000-f89b-0000-d96900053202
19:41:49.311822 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 17 at position 28 unexpected '',
        ''.
parse error line 90 at position 8 near '<EOF>'.
syntax error line 88 at position 0 unexpected 'SELECT'.
19:41:49.312290 [debug] [Thread-2  ]: finished collecting timing info
19:41:49.312840 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
19:41:49.440662 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.91 seconds
19:41:49.448584 [debug] [Thread-10 ]: finished collecting timing info
19:41:49.448944 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
19:41:49.503652 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.98 seconds
19:41:49.505480 [debug] [Thread-9  ]: finished collecting timing info
19:41:49.505847 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
19:41:49.551856 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.24 seconds
19:41:49.571706 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:41:49.572375 [debug] [Thread-2  ]: Database Error in model final_items (models/warehouse/final_items.sql)
  001003 (42000): SQL compilation error:
  syntax error line 17 at position 28 unexpected '',
          ''.
  parse error line 90 at position 8 near '<EOF>'.
  syntax error line 88 at position 0 unexpected 'SELECT'.
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
19:41:49.572776 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
19:41:49.576720 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a923cb340>]}
19:41:49.577564 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a944f6d30>]}
19:41:49.579205 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 4.40s]
19:41:49.581535 [error] [Thread-2  ]: 2 of 14 ERROR creating table model PUBLIC.final_items .......................... [[31mERROR[0m in 4.41s]
19:41:49.583246 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
19:41:49.585853 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
19:41:49.586803 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_match_details
19:41:49.587797 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_match_info
19:41:49.588452 [info ] [Thread-10 ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
19:41:49.588833 [info ] [Thread-2  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
19:41:49.589516 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
19:41:49.590212 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
19:41:49.590595 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
19:41:49.590985 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
19:41:49.591482 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_match_details
19:41:49.592033 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_match_info
19:41:49.596587 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
19:41:49.600062 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
19:41:49.600848 [debug] [Thread-2  ]: finished collecting timing info
19:41:49.601147 [debug] [Thread-10 ]: finished collecting timing info
19:41:49.601414 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
19:41:49.601680 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_match_details
19:41:49.606539 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
19:41:49.610234 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
19:41:49.612931 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
19:41:49.613266 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
19:41:49.618720 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:41:49.619275 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
19:41:49.622264 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
19:41:49.623054 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
19:41:49.649631 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a923cb4f0>]}
19:41:49.650172 [info ] [Thread-9  ]: 9 of 14 OK created view model PUBLIC.stg_items ................................. [[32mSUCCESS 1[0m in 4.47s]
19:41:49.650786 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
19:41:49.651133 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
19:41:49.651738 [info ] [Thread-9  ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
19:41:49.652440 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
19:41:49.652745 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
19:41:49.653008 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
19:41:49.656272 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
19:41:49.657165 [debug] [Thread-9  ]: finished collecting timing info
19:41:49.657581 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
19:41:49.661878 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
19:41:49.663962 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
19:41:49.664458 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
19:41:49.664715 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
19:41:49.677255 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.15 seconds
19:41:49.679014 [debug] [Thread-8  ]: finished collecting timing info
19:41:49.679284 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
19:41:49.690700 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.11 seconds
19:41:49.737062 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
19:41:49.749846 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:41:49.751455 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
19:41:49.789057 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 4.29 seconds
19:41:49.810008 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:41:49.811110 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 4.29 seconds
19:41:49.817954 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
19:41:49.845035 [debug] [Thread-6  ]: finished collecting timing info
19:41:49.855586 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a923cbeb0>]}
19:41:49.896095 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
19:41:49.950767 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 4.68s]
19:41:49.988768 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.24 seconds
19:41:49.991260 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
19:41:49.995566 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:41:50.004872 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
19:41:50.010123 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.14 seconds
19:41:50.011411 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
19:41:50.021605 [info ] [Thread-8  ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
19:41:50.031849 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:41:50.038821 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
19:41:50.049239 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
19:41:50.055180 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
19:41:50.076950 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
19:41:50.080482 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
19:41:50.087593 [debug] [Thread-8  ]: finished collecting timing info
19:41:50.091155 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
19:41:50.095448 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
19:41:50.099549 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
19:41:50.100827 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
19:41:50.101940 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
19:41:50.151529 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a923bcdc0>]}
19:41:50.153194 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 4.98s]
19:41:50.155915 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
19:41:50.180912 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.11 seconds
19:41:50.188687 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:41:50.189722 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
19:41:50.324997 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.13 seconds
19:41:50.332921 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
19:41:50.349170 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.85 seconds
19:41:50.351685 [debug] [Thread-1  ]: finished collecting timing info
19:41:50.352251 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
19:41:50.353004 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 4.83 seconds
19:41:50.354822 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:41:50.362239 [debug] [Thread-7  ]: finished collecting timing info
19:41:50.363148 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
19:41:50.366084 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
19:41:50.394568 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 4.89 seconds
19:41:50.398441 [debug] [Thread-3  ]: finished collecting timing info
19:41:50.398951 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
19:41:50.528854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a94ae05b0>]}
19:41:50.530535 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 5.37s]
19:41:50.532281 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
19:41:50.558048 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a923bc730>]}
19:41:50.559797 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 5.39s]
19:41:50.564509 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
19:41:50.584272 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.21 seconds
19:41:50.585182 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:41:50.586959 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
19:41:50.610088 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a923cbd60>]}
19:41:50.614831 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 5.43s]
19:41:50.616552 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
19:41:50.989607 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.39 seconds
19:41:50.990786 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:41:50.991127 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
19:41:51.166504 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.13 seconds
19:41:51.167469 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:41:51.168581 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
19:41:51.174783 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.18 seconds
19:41:51.176911 [debug] [Thread-5  ]: finished collecting timing info
19:41:51.177221 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
19:41:51.276206 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.66 seconds
19:41:51.278343 [debug] [Thread-2  ]: finished collecting timing info
19:41:51.278649 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_info: Close
19:41:51.312778 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a923d6760>]}
19:41:51.313471 [info ] [Thread-5  ]: 5 of 14 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 6.14s]
19:41:51.314573 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
19:41:51.320509 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.22 seconds
19:41:51.322336 [debug] [Thread-8  ]: finished collecting timing info
19:41:51.322755 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
19:41:51.326527 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.7 seconds
19:41:51.329141 [debug] [Thread-10 ]: finished collecting timing info
19:41:51.330848 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_match_details: Close
19:41:51.338368 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.17 seconds
19:41:51.340578 [debug] [Thread-4  ]: finished collecting timing info
19:41:51.341161 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
19:41:51.370231 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 1.71 seconds
19:41:51.372602 [debug] [Thread-9  ]: finished collecting timing info
19:41:51.373422 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
19:41:51.422023 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a9232d5b0>]}
19:41:51.423152 [info ] [Thread-2  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.83s]
19:41:51.424807 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
19:41:51.431444 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a923cb2b0>]}
19:41:51.432207 [info ] [Thread-8  ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.39s]
19:41:51.433026 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
19:41:51.451401 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a923cb7f0>]}
19:41:51.452041 [info ] [Thread-10 ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 1.86s]
19:41:51.452655 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_match_details
19:41:51.462554 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a944d99a0>]}
19:41:51.463168 [info ] [Thread-4  ]: 4 of 14 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 6.29s]
19:41:51.463784 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
19:41:51.478830 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7d57ff6-1242-4808-b3f1-b64c73389ca3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a922719a0>]}
19:41:51.479553 [info ] [Thread-9  ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.83s]
19:41:51.480461 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
19:41:51.483383 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:41:51.484152 [info ] [MainThread]: 
19:41:51.484628 [info ] [MainThread]: Finished running 7 view models, 5 table models, 2 incremental models in 8.45s.
19:41:51.485113 [debug] [MainThread]: Connection 'master' was properly closed.
19:41:51.485348 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
19:41:51.485522 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_champions' was properly closed.
19:41:51.485874 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_maps' was properly closed.
19:41:51.486337 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
19:41:51.486758 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
19:41:51.487059 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
19:41:51.487296 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
19:41:51.487546 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
19:41:51.487733 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
19:41:51.487971 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
19:41:51.504808 [info ] [MainThread]: 
19:41:51.505282 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
19:41:51.505614 [info ] [MainThread]: 
19:41:51.505977 [error] [MainThread]: [33mDatabase Error in model final_items (models/warehouse/final_items.sql)[0m
19:41:51.506340 [error] [MainThread]:   001003 (42000): SQL compilation error:
19:41:51.506920 [error] [MainThread]:   syntax error line 17 at position 28 unexpected '',
19:41:51.507306 [error] [MainThread]:           ''.
19:41:51.507655 [error] [MainThread]:   parse error line 90 at position 8 near '<EOF>'.
19:41:51.507996 [error] [MainThread]:   syntax error line 88 at position 0 unexpected 'SELECT'.
19:41:51.508449 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
19:41:51.508806 [info ] [MainThread]: 
19:41:51.509197 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
19:41:51.509654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a923363d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a94588b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a945886d0>]}


============================== 2022-06-15 19:42:51.906242 | f0964ba7-53c6-4a87-ace1-e13dbcfa3ec5 ==============================
19:42:51.906258 [info ] [MainThread]: Running with dbt=1.1.0
19:42:51.906730 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
19:42:51.906947 [debug] [MainThread]: Tracking: tracking
19:42:51.908097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ddd2a340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ddd2aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ddd2ac70>]}
19:42:51.908849 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ko89peko'
19:42:51.909185 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
19:42:52.135647 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
19:42:52.136385 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
19:42:52.302527 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
19:42:52.358179 [info ] [MainThread]: Installing dbt-labs/dbt_utils
19:42:52.944417 [info ] [MainThread]:   Installed from version 0.8.5
19:42:52.944854 [info ] [MainThread]:   Up to date!
19:42:52.945264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f0964ba7-53c6-4a87-ace1-e13dbcfa3ec5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ddd2a6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ddeaf8b0>]}
19:42:52.945848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61e31d5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61dde84e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61ddd2aca0>]}


============================== 2022-06-15 19:42:57.432360 | ec428d2b-a319-461f-81ab-6a8943cf1649 ==============================
19:42:57.432388 [info ] [MainThread]: Running with dbt=1.1.0
19:42:57.433400 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:42:57.433768 [debug] [MainThread]: Tracking: tracking
19:42:57.434367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a40f68e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a40f6940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a40f69a0>]}
19:42:57.525819 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:42:57.526734 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_items.sql
19:42:57.548712 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_items.sql
19:42:57.625853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2cfae2460>]}
19:42:57.645316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2d30447f0>]}
19:42:57.646294 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
19:42:57.647178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2d30448b0>]}
19:42:57.652484 [info ] [MainThread]: 
19:42:57.653400 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:42:57.655453 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
19:42:57.676604 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
19:42:57.677090 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
19:42:57.677440 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:42:58.503217 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.83 seconds
19:42:58.507475 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
19:42:58.625460 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
19:42:58.637814 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
19:42:58.638307 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
19:42:58.638616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:42:59.144008 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 0.51 seconds
19:42:59.146278 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
19:42:59.254885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a4055670>]}
19:42:59.255611 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:42:59.256112 [info ] [MainThread]: 
19:42:59.274041 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
19:42:59.274401 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
19:42:59.274810 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
19:42:59.275066 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
19:42:59.275403 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
19:42:59.275917 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
19:42:59.276239 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
19:42:59.276629 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
19:42:59.276880 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
19:42:59.277552 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
19:42:59.277952 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
19:42:59.278564 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
19:42:59.278864 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
19:42:59.279292 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
19:42:59.279777 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
19:42:59.280936 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
19:42:59.281659 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
19:42:59.282283 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
19:42:59.282921 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
19:42:59.283458 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
19:42:59.283989 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
19:42:59.284447 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
19:42:59.284914 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
19:42:59.285730 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
19:42:59.286540 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:42:59.286867 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
19:42:59.287950 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:42:59.288907 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
19:42:59.289727 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
19:42:59.290685 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
19:42:59.291616 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
19:42:59.291872 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
19:42:59.294732 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
19:42:59.295148 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
19:42:59.295539 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
19:42:59.295922 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
19:42:59.296357 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
19:42:59.296753 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
19:42:59.297094 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
19:42:59.297401 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
19:42:59.297741 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
19:42:59.300916 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
19:42:59.301528 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
19:42:59.302098 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
19:42:59.302599 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
19:42:59.306493 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
19:42:59.306920 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
19:42:59.307290 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
19:42:59.307575 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
19:42:59.307956 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
19:42:59.308547 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
19:42:59.309054 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
19:42:59.312276 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
19:42:59.312702 [debug] [Thread-1  ]: finished collecting timing info
19:42:59.325664 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
19:42:59.330911 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
19:42:59.331449 [debug] [Thread-2  ]: finished collecting timing info
19:42:59.335188 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
19:42:59.338598 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
19:42:59.341598 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
19:42:59.403513 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
19:42:59.407209 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
19:42:59.407857 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
19:42:59.408960 [debug] [Thread-3  ]: finished collecting timing info
19:42:59.410627 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
19:42:59.412105 [debug] [Thread-5  ]: finished collecting timing info
19:42:59.412764 [debug] [Thread-4  ]: finished collecting timing info
19:42:59.416377 [debug] [Thread-6  ]: finished collecting timing info
19:42:59.417344 [debug] [Thread-8  ]: finished collecting timing info
19:42:59.418409 [debug] [Thread-7  ]: finished collecting timing info
19:42:59.425721 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
19:42:59.441580 [debug] [Thread-9  ]: finished collecting timing info
19:42:59.442332 [debug] [Thread-10 ]: finished collecting timing info
19:42:59.464622 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
19:42:59.464972 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
19:42:59.467197 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
19:42:59.467753 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
19:42:59.468849 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
19:42:59.469405 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
19:42:59.469860 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
19:42:59.472602 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
19:42:59.473127 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
19:42:59.473893 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
19:42:59.504806 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
19:42:59.517853 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
19:42:59.528053 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:42:59.532483 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
19:42:59.539996 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:42:59.557157 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
19:42:59.560530 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
19:42:59.564428 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
19:42:59.568458 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
19:42:59.570035 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
19:42:59.570897 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
19:42:59.572066 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
19:42:59.572418 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
19:42:59.572992 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        '11' as SummonersRift,
        '12' as HowlingAbyss,
        '21' as NexusBlitz,
        '22' as TeamfightTactics,
        'FlatHPPoolMod' as FlatHPPoolMod,
        'rFlatHPModPerLevel' as rFlatHPModPerLevel,
        'FlatMPPoolMod' as FlatMPPoolMod,
        'rFlatMPModPerLevel' as rFlatMPModPerLevel,
        'PercentHPPoolMod' as PercentHPPoolMod,
        'PercentMPPoolMod' as PercentMPPoolMod,
        'FlatHPRegenMod' as FlatHPRegenMod,
        'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
        'PercentHPRegenMod' as PercentHPRegenMod,
        'FlatMPRegenMod' as FlatMPRegenMod,
        'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
        'PercentMPRegenMod' as PercentMPRegenMod,
        'FlatArmorMod' as FlatArmorMod,
        'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
        'PercentArmorMod' as PercentArmorMod,
        'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
        'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
        'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
        'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
        'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
        'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
        'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
        'FlatMagicDamageMod' as FlatMagicDamageMod,
        'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
        'PercentMagicDamageMod' as PercentMagicDamageMod,
        'FlatMovementSpeedMod' as FlatMovementSpeedMod,
        'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
        'PercentMovementSpeedMod' as PercentMovementSpeedMod,
        'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
        'FlatAttackSpeedMod' as FlatAttackSpeedMod,
        'PercentAttackSpeedMod' as PercentAttackSpeedMod,
        'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
        'rFlatDodgeMod' as rFlatDodgeMod,
        'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
        'PercentDodgeMod' as PercentDodgeMod,
        'FlatCritChanceMod' as FlatCritChanceMod,
        'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
        'PercentCritChanceMod' as PercentCritChanceMod,
        'FlatCritDamageMod' as FlatCritDamageMod,
        'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
        'PercentCritDamageMod' as PercentCritDamageMod,
        'FlatBlockMod' as FlatBlockMod,
        'PercentBlockMod' as PercentBlockMod,
        'FlatSpellBlockMod' as FlatSpellBlockMod,
        'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
        'PercentSpellBlockMod' as PercentSpellBlockMod,
        'FlatEXPBonus' as FlatEXPBonus,
        'PercentEXPBonus' as PercentEXPBonus,
        'rPercentCooldownMod' as rPercentCooldownMod,
        'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
        'rFlatTimeDeadMod' as rFlatTimeDeadMod,
        'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
        'rPercentTimeDeadMod' as rPercentTimeDeadMod,
        'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
        'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
        'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
        'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
        'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
        'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
        'FlatEnergyRegenMod' as FlatEnergyRegenMod,
        'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
        'FlatEnergyPoolMod' as FlatEnergyPoolMod,
        'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
        'PercentLifeStealMod' as PercentLifeStealMod,
        'PercentSpellVampMod' as PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
19:42:59.573596 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
19:42:59.576773 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
19:42:59.579073 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
19:42:59.582876 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
19:42:59.583271 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
19:42:59.583667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:42:59.584447 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
19:42:59.585009 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
19:42:59.585609 [debug] [Thread-5  ]: Opening a new connection, currently in state init
19:42:59.585930 [debug] [Thread-2  ]: Opening a new connection, currently in state init
19:42:59.586417 [debug] [Thread-4  ]: Opening a new connection, currently in state init
19:42:59.586828 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
19:42:59.587199 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
19:42:59.587536 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
SELECT
  *
FROM pivot_source
pivot(max(map_exists) for map_id in ('11','12','21','22'))
pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY item_id
)

SELECT * FROM pivoted_items
  );
19:42:59.587873 [debug] [Thread-3  ]: Opening a new connection, currently in state init
19:42:59.591844 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
19:42:59.592400 [debug] [Thread-6  ]: Opening a new connection, currently in state init
19:42:59.602034 [debug] [Thread-7  ]: Opening a new connection, currently in state init
19:42:59.605660 [debug] [Thread-8  ]: Opening a new connection, currently in state init
19:42:59.606304 [debug] [Thread-9  ]: Opening a new connection, currently in state init
19:42:59.610796 [debug] [Thread-10 ]: Opening a new connection, currently in state init
19:43:02.646477 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.06 seconds
19:43:02.660338 [debug] [Thread-3  ]: finished collecting timing info
19:43:02.660717 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
19:43:02.786390 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2cd1828b0>]}
19:43:02.787677 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 3.50s]
19:43:02.789215 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
19:43:02.791420 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_match_details
19:43:02.792789 [info ] [Thread-3  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
19:43:02.794940 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
19:43:02.795412 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
19:43:02.796814 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_match_details
19:43:02.806208 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
19:43:02.810012 [debug] [Thread-3  ]: finished collecting timing info
19:43:02.810821 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
19:43:02.815060 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
19:43:02.824861 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
19:43:02.825928 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
19:43:02.827144 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:43:02.994720 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.41 seconds
19:43:02.997688 [debug] [Thread-2  ]: finished collecting timing info
19:43:02.998775 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
19:43:03.201787 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2cd1827f0>]}
19:43:03.202473 [info ] [Thread-2  ]: 2 of 14 OK created table model PUBLIC.final_items .............................. [[32mSUCCESS 1[0m in 3.92s]
19:43:03.205440 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
19:43:03.208168 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_match_info
19:43:03.209891 [info ] [Thread-2  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
19:43:03.212414 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
19:43:03.214763 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
19:43:03.215694 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_match_info
19:43:03.221323 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
19:43:03.229546 [debug] [Thread-2  ]: finished collecting timing info
19:43:03.230242 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
19:43:03.238543 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
19:43:03.241745 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
19:43:03.242299 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
19:43:03.242963 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
19:43:03.657903 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.05 seconds
19:43:03.659837 [debug] [Thread-8  ]: finished collecting timing info
19:43:03.660195 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
19:43:03.698372 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 4.09 seconds
19:43:03.700700 [debug] [Thread-10 ]: finished collecting timing info
19:43:03.703819 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
19:43:03.790608 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.96 seconds
19:43:03.792446 [debug] [Thread-3  ]: finished collecting timing info
19:43:03.792752 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_details: Close
19:43:04.038516 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c82c5d90>]}
19:43:04.039245 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 4.75s]
19:43:04.040135 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
19:43:04.040642 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
19:43:04.041471 [info ] [Thread-8  ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
19:43:04.043436 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
19:43:04.044892 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
19:43:04.047269 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
19:43:04.052733 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
19:43:04.054298 [debug] [Thread-8  ]: finished collecting timing info
19:43:04.054692 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
19:43:04.058687 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
19:43:04.060257 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
19:43:04.060564 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
19:43:04.060825 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
19:43:04.071913 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2cd187a60>]}
19:43:04.073093 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c824e280>]}
19:43:04.073654 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 4.78s]
19:43:04.074296 [info ] [Thread-3  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 1.28s]
19:43:04.075271 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
19:43:04.076076 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
19:43:04.076473 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
19:43:04.077353 [info ] [Thread-10 ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
19:43:04.078150 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
19:43:04.078666 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
19:43:04.079619 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
19:43:04.083248 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
19:43:04.084408 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 4.5 seconds
19:43:04.096282 [debug] [Thread-10 ]: finished collecting timing info
19:43:04.097125 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:43:04.097613 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
19:43:04.098163 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 4.49 seconds
19:43:04.098579 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
19:43:04.102539 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
19:43:04.105437 [debug] [Thread-9  ]: finished collecting timing info
19:43:04.109562 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
19:43:04.111935 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
19:43:04.114211 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
19:43:04.114623 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
19:43:04.185505 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.08 seconds
19:43:04.190305 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:43:04.190699 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
19:43:04.234818 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c8189610>]}
19:43:04.246294 [info ] [Thread-9  ]: 9 of 14 OK created view model PUBLIC.stg_items ................................. [[32mSUCCESS 1[0m in 4.94s]
19:43:04.252954 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
19:43:04.254624 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.01 seconds
19:43:04.267931 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.68 seconds
19:43:04.268777 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.08 seconds
19:43:04.279586 [debug] [Thread-2  ]: finished collecting timing info
19:43:04.295727 [debug] [Thread-1  ]: finished collecting timing info
19:43:04.330523 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_info: Close
19:43:04.332923 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:43:04.357286 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
19:43:04.407944 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
19:43:04.481494 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.9 seconds
19:43:04.506212 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:43:04.514223 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
19:43:04.600430 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.13 seconds
19:43:04.655622 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2cd182640>]}
19:43:04.667858 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 5.38s]
19:43:04.672981 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
19:43:04.686002 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
19:43:04.693605 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2cd182490>]}
19:43:04.713264 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.19 seconds
19:43:04.715038 [info ] [Thread-2  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.48s]
19:43:04.716624 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:43:04.723177 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
19:43:04.729474 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:43:04.730671 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
19:43:04.740655 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
19:43:04.825979 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.08 seconds
19:43:04.839692 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:43:04.840942 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
19:43:04.843032 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 5.25 seconds
19:43:04.844064 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.1 seconds
19:43:04.845969 [debug] [Thread-6  ]: finished collecting timing info
19:43:04.851353 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:43:04.852751 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
19:43:04.853829 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
19:43:04.867722 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 5.27 seconds
19:43:04.869470 [debug] [Thread-7  ]: finished collecting timing info
19:43:04.869789 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
19:43:04.916325 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.07 seconds
19:43:04.938383 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
19:43:04.947031 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:43:04.948088 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
19:43:04.965193 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2cd187ee0>]}
19:43:04.966089 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2cd182f10>]}
19:43:04.966638 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 5.68s]
19:43:04.967692 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.68s]
19:43:04.968739 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
19:43:04.969441 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
19:43:05.043433 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.09 seconds
19:43:05.044177 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:43:05.044497 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
19:43:05.099617 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.04 seconds
19:43:05.101847 [debug] [Thread-8  ]: finished collecting timing info
19:43:05.102207 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
19:43:05.106448 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.99 seconds
19:43:05.109695 [debug] [Thread-10 ]: finished collecting timing info
19:43:05.110493 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.25 seconds
19:43:05.110877 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
19:43:05.111385 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:43:05.114355 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
19:43:05.210529 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c81ca250>]}
19:43:05.211035 [info ] [Thread-10 ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.13s]
19:43:05.211605 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
19:43:05.214877 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2c82a4670>]}
19:43:05.215390 [info ] [Thread-8  ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.17s]
19:43:05.215928 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
19:43:05.248572 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.13 seconds
19:43:05.250327 [debug] [Thread-5  ]: finished collecting timing info
19:43:05.250591 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
19:43:05.368958 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2cd187e50>]}
19:43:05.369563 [info ] [Thread-5  ]: 5 of 14 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 6.08s]
19:43:05.375281 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
19:43:06.050136 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.01 seconds
19:43:06.050556 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:43:06.050871 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
19:43:06.480114 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.43 seconds
19:43:06.483799 [debug] [Thread-4  ]: finished collecting timing info
19:43:06.484362 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
19:43:06.603870 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec428d2b-a319-461f-81ab-6a8943cf1649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a401e970>]}
19:43:06.604805 [info ] [Thread-4  ]: 4 of 14 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 7.32s]
19:43:06.605826 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
19:43:06.609871 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:43:06.610723 [info ] [MainThread]: 
19:43:06.611374 [info ] [MainThread]: Finished running 5 table models, 7 view models, 2 incremental models in 8.96s.
19:43:06.611793 [debug] [MainThread]: Connection 'master' was properly closed.
19:43:06.612000 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_champions' was properly closed.
19:43:06.612364 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
19:43:06.612602 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
19:43:06.613039 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
19:43:06.613390 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
19:43:06.613707 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
19:43:06.613927 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
19:43:06.614114 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
19:43:06.614321 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
19:43:06.614525 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
19:43:06.634536 [info ] [MainThread]: 
19:43:06.635106 [info ] [MainThread]: [32mCompleted successfully[0m
19:43:06.635745 [info ] [MainThread]: 
19:43:06.636358 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
19:43:06.636997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2cfae29d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2a408c160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa29c3267f0>]}


============================== 2022-06-15 19:59:51.509388 | a94807ed-35b5-4a91-8f30-dbfc39a9c041 ==============================
19:59:51.509412 [info ] [MainThread]: Running with dbt=1.1.0
19:59:51.510003 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
19:59:51.510230 [debug] [MainThread]: Tracking: tracking
19:59:51.510597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6e454640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6e4546a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6e454700>]}
19:59:51.568755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
19:59:51.569504 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
19:59:51.585116 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
19:59:51.640993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea135c160>]}
19:59:51.654793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea2869610>]}
19:59:51.655225 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
19:59:51.655653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea1359f40>]}
19:59:51.659396 [info ] [MainThread]: 
19:59:51.660215 [debug] [MainThread]: Acquiring new snowflake connection "master"
19:59:51.662244 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
19:59:51.677826 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
19:59:51.678134 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
19:59:51.678326 [debug] [ThreadPool]: Opening a new connection, currently in state init
19:59:52.681591 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
19:59:52.683351 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
19:59:52.815422 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
19:59:52.824308 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
19:59:52.824617 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
19:59:52.824857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
19:59:53.551026 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 0.73 seconds
19:59:53.554088 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
19:59:53.665385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea28c46d0>]}
19:59:53.666287 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
19:59:53.666859 [info ] [MainThread]: 
19:59:53.687263 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
19:59:53.687631 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
19:59:53.687852 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
19:59:53.688203 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
19:59:53.688435 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
19:59:53.688884 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
19:59:53.689211 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
19:59:53.689499 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
19:59:53.689777 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
19:59:53.690111 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
19:59:53.690363 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
19:59:53.690728 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
19:59:53.690955 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
19:59:53.691679 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
19:59:53.692124 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
19:59:53.692744 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
19:59:53.693351 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
19:59:53.694428 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
19:59:53.694906 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
19:59:53.695415 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
19:59:53.695813 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
19:59:53.696629 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
19:59:53.697056 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
19:59:53.697453 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
19:59:53.698187 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:59:53.699035 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:59:53.700124 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
19:59:53.700749 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
19:59:53.701653 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
19:59:53.702389 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
19:59:53.703261 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
19:59:53.703519 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
19:59:53.704379 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
19:59:53.704725 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
19:59:53.705067 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
19:59:53.705359 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
19:59:53.705596 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
19:59:53.705893 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
19:59:53.706194 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
19:59:53.706602 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
19:59:53.707178 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
19:59:53.707722 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
19:59:53.708164 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
19:59:53.711406 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
19:59:53.711848 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
19:59:53.712206 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
19:59:53.712620 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
19:59:53.716887 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
19:59:53.717238 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
19:59:53.717578 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
19:59:53.717872 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
19:59:53.721446 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
19:59:53.721896 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
19:59:53.738770 [debug] [Thread-1  ]: finished collecting timing info
19:59:53.740504 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
19:59:53.741435 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
19:59:53.744821 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
19:59:53.749293 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
19:59:53.807200 [debug] [Thread-2  ]: finished collecting timing info
19:59:53.810893 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
19:59:53.814911 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
19:59:53.819122 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
19:59:53.819828 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
19:59:53.820107 [debug] [Thread-3  ]: finished collecting timing info
19:59:53.821237 [debug] [Thread-5  ]: finished collecting timing info
19:59:53.821620 [debug] [Thread-4  ]: finished collecting timing info
19:59:53.821930 [debug] [Thread-6  ]: finished collecting timing info
19:59:53.822329 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
19:59:53.823388 [debug] [Thread-8  ]: finished collecting timing info
19:59:53.823712 [debug] [Thread-7  ]: finished collecting timing info
19:59:53.824233 [debug] [Thread-9  ]: finished collecting timing info
19:59:53.835154 [debug] [Thread-10 ]: finished collecting timing info
19:59:53.845531 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
19:59:53.854748 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
19:59:53.855204 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
19:59:53.855490 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
19:59:53.855735 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
19:59:53.858580 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
19:59:53.859039 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
19:59:53.859503 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
19:59:53.859947 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
19:59:53.860420 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
19:59:53.863499 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
19:59:53.881569 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
19:59:53.901037 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
19:59:53.904134 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:59:53.908064 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:59:53.922963 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
19:59:53.926399 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
19:59:53.938190 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
19:59:53.941373 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
19:59:53.945113 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
19:59:53.945781 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
19:59:53.947056 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
19:59:53.947523 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
19:59:53.948606 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
19:59:53.948912 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
19:59:53.949693 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        '11' as SummonersRift,
        '12' as HowlingAbyss,
        '21' as NexusBlitz,
        '22' as TeamfightTactics,
        'FlatHPPoolMod' as FlatHPPoolMod,
        'rFlatHPModPerLevel' as rFlatHPModPerLevel,
        'FlatMPPoolMod' as FlatMPPoolMod,
        'rFlatMPModPerLevel' as rFlatMPModPerLevel,
        'PercentHPPoolMod' as PercentHPPoolMod,
        'PercentMPPoolMod' as PercentMPPoolMod,
        'FlatHPRegenMod' as FlatHPRegenMod,
        'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
        'PercentHPRegenMod' as PercentHPRegenMod,
        'FlatMPRegenMod' as FlatMPRegenMod,
        'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
        'PercentMPRegenMod' as PercentMPRegenMod,
        'FlatArmorMod' as FlatArmorMod,
        'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
        'PercentArmorMod' as PercentArmorMod,
        'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
        'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
        'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
        'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
        'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
        'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
        'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
        'FlatMagicDamageMod' as FlatMagicDamageMod,
        'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
        'PercentMagicDamageMod' as PercentMagicDamageMod,
        'FlatMovementSpeedMod' as FlatMovementSpeedMod,
        'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
        'PercentMovementSpeedMod' as PercentMovementSpeedMod,
        'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
        'FlatAttackSpeedMod' as FlatAttackSpeedMod,
        'PercentAttackSpeedMod' as PercentAttackSpeedMod,
        'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
        'rFlatDodgeMod' as rFlatDodgeMod,
        'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
        'PercentDodgeMod' as PercentDodgeMod,
        'FlatCritChanceMod' as FlatCritChanceMod,
        'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
        'PercentCritChanceMod' as PercentCritChanceMod,
        'FlatCritDamageMod' as FlatCritDamageMod,
        'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
        'PercentCritDamageMod' as PercentCritDamageMod,
        'FlatBlockMod' as FlatBlockMod,
        'PercentBlockMod' as PercentBlockMod,
        'FlatSpellBlockMod' as FlatSpellBlockMod,
        'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
        'PercentSpellBlockMod' as PercentSpellBlockMod,
        'FlatEXPBonus' as FlatEXPBonus,
        'PercentEXPBonus' as PercentEXPBonus,
        'rPercentCooldownMod' as rPercentCooldownMod,
        'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
        'rFlatTimeDeadMod' as rFlatTimeDeadMod,
        'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
        'rPercentTimeDeadMod' as rPercentTimeDeadMod,
        'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
        'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
        'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
        'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
        'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
        'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
        'FlatEnergyRegenMod' as FlatEnergyRegenMod,
        'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
        'FlatEnergyPoolMod' as FlatEnergyPoolMod,
        'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
        'PercentLifeStealMod' as PercentLifeStealMod,
        'PercentSpellVampMod' as PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
19:59:53.950653 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
19:59:53.953790 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
19:59:53.954194 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
19:59:53.954864 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
19:59:53.960552 [debug] [Thread-5  ]: Opening a new connection, currently in state init
19:59:53.961751 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
19:59:53.962392 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
19:59:53.962754 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
19:59:53.963191 [debug] [Thread-4  ]: Opening a new connection, currently in state init
19:59:53.964037 [debug] [Thread-2  ]: Opening a new connection, currently in state init
19:59:53.964489 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
19:59:53.964960 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
19:59:53.968532 [debug] [Thread-3  ]: Opening a new connection, currently in state init
19:59:53.972233 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
19:59:53.973046 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
  SELECT
    item_id,
    name,
    gold_description,
    gold_base,
    gold_purchasable,
    gold_total,
    gold_sell,
    "'11'" as SummonersRift,
    "'12'" as HowlingAbyss,
    "'21'" as NexusBlitz,
    "'22'" as TeamfightTactics,
    'FlatHPPoolMod' as FlatHPPoolMod,
    'rFlatHPModPerLevel' as rFlatHPModPerLevel,
    'FlatMPPoolMod' as FlatMPPoolMod,
    'rFlatMPModPerLevel' as rFlatMPModPerLevel,
    'PercentHPPoolMod' as PercentHPPoolMod,
    'PercentMPPoolMod' as PercentMPPoolMod,
    'FlatHPRegenMod' as FlatHPRegenMod,
    'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
    'PercentHPRegenMod' as PercentHPRegenMod,
    'FlatMPRegenMod' as FlatMPRegenMod,
    'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
    'PercentMPRegenMod' as PercentMPRegenMod,
    'FlatArmorMod' as FlatArmorMod,
    'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
    'PercentArmorMod' as PercentArmorMod,
    'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
    'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
    'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
    'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
    'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
    'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
    'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
    'FlatMagicDamageMod' as FlatMagicDamageMod,
    'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
    'PercentMagicDamageMod' as PercentMagicDamageMod,
    'FlatMovementSpeedMod' as FlatMovementSpeedMod,
    'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
    'PercentMovementSpeedMod' as PercentMovementSpeedMod,
    'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
    'FlatAttackSpeedMod' as FlatAttackSpeedMod,
    'PercentAttackSpeedMod' as PercentAttackSpeedMod,
    'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
    'rFlatDodgeMod' as rFlatDodgeMod,
    'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
    'PercentDodgeMod' as PercentDodgeMod,
    'FlatCritChanceMod' as FlatCritChanceMod,
    'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
    'PercentCritChanceMod' as PercentCritChanceMod,
    'FlatCritDamageMod' as FlatCritDamageMod,
    'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
    'PercentCritDamageMod' as PercentCritDamageMod,
    'FlatBlockMod' as FlatBlockMod,
    'PercentBlockMod' as PercentBlockMod,
    'FlatSpellBlockMod' as FlatSpellBlockMod,
    'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
    'PercentSpellBlockMod' as PercentSpellBlockMod,
    'FlatEXPBonus' as FlatEXPBonus,
    'PercentEXPBonus' as PercentEXPBonus,
    'rPercentCooldownMod' as rPercentCooldownMod,
    'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
    'rFlatTimeDeadMod' as rFlatTimeDeadMod,
    'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
    'rPercentTimeDeadMod' as rPercentTimeDeadMod,
    'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
    'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
    'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
    'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
    'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
    'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
    'FlatEnergyRegenMod' as FlatEnergyRegenMod,
    'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
    'FlatEnergyPoolMod' as FlatEnergyPoolMod,
    'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
    'PercentLifeStealMod' as PercentLifeStealMod,
    'PercentSpellVampMod' as PercentSpellVampMod
  FROM pivot_source
  pivot(max(map_exists) for map_id in ('11','12','21','22'))
  pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY item_id
)

SELECT * FROM pivoted_items
  );
19:59:53.973960 [debug] [Thread-6  ]: Opening a new connection, currently in state init
19:59:53.979904 [debug] [Thread-7  ]: Opening a new connection, currently in state init
19:59:53.982240 [debug] [Thread-8  ]: Opening a new connection, currently in state init
19:59:53.984771 [debug] [Thread-10 ]: Opening a new connection, currently in state init
19:59:53.988241 [debug] [Thread-9  ]: Opening a new connection, currently in state init
19:59:57.016824 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.03 seconds
19:59:57.028573 [debug] [Thread-8  ]: finished collecting timing info
19:59:57.030470 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
19:59:57.362255 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea1191d90>]}
19:59:57.363012 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 3.66s]
19:59:57.364312 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
19:59:57.365127 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_match_details
19:59:57.365815 [info ] [Thread-8  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
19:59:57.366568 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
19:59:57.367027 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
19:59:57.367379 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_match_details
19:59:57.371477 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
19:59:57.374526 [debug] [Thread-8  ]: finished collecting timing info
19:59:57.376209 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
19:59:57.380343 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
19:59:57.399499 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
19:59:57.400493 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
19:59:57.401573 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
19:59:57.470438 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.49 seconds
19:59:57.472319 [debug] [Thread-10 ]: finished collecting timing info
19:59:57.472741 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
19:59:57.601207 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea1237dc0>]}
19:59:57.607092 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 3.90s]
19:59:57.618386 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
19:59:57.624166 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_match_info
19:59:57.640919 [info ] [Thread-10 ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
19:59:57.652178 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
19:59:57.652850 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
19:59:57.658631 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_match_info
19:59:57.672781 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
19:59:57.698682 [debug] [Thread-10 ]: finished collecting timing info
19:59:57.699509 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_match_info
19:59:57.704527 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
19:59:57.714170 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
19:59:57.715589 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
19:59:57.716185 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
19:59:57.724463 [debug] [Thread-9  ]: Snowflake adapter: Snowflake query id: 01a4f86f-0000-f89b-0000-d9690005329e
19:59:57.725056 [debug] [Thread-9  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 63 at position 4
invalid identifier '"'11'"'
19:59:57.725662 [debug] [Thread-9  ]: finished collecting timing info
19:59:57.726520 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
19:59:57.841848 [debug] [Thread-9  ]: Database Error in model stg_items (models/staging_datadragon/stg_items.sql)
  000904 (42000): SQL compilation error: error line 63 at position 4
  invalid identifier '"'11'"'
  compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_items.sql
19:59:57.842336 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde99a96550>]}
19:59:57.842897 [error] [Thread-9  ]: 9 of 14 ERROR creating view model PUBLIC.stg_items ............................. [[31mERROR[0m in 4.14s]
19:59:57.843483 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
19:59:57.843795 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
19:59:57.844543 [info ] [Thread-9  ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
19:59:57.845249 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
19:59:57.845535 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
19:59:57.845789 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
19:59:57.849130 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
19:59:57.850110 [debug] [Thread-9  ]: finished collecting timing info
19:59:57.855838 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
19:59:57.870146 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
19:59:57.916867 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
19:59:57.934041 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
19:59:57.939864 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
19:59:57.946085 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.98 seconds
19:59:58.004791 [debug] [Thread-3  ]: finished collecting timing info
19:59:58.010721 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
19:59:58.136977 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 4.16 seconds
19:59:58.138948 [debug] [Thread-6  ]: finished collecting timing info
19:59:58.139325 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
19:59:58.169800 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 4.21 seconds
19:59:58.170628 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.21 seconds
19:59:58.191295 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea1191850>]}
19:59:58.220303 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:59:58.227379 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 4.25 seconds
19:59:58.259781 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 0.86 seconds
19:59:58.273764 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:59:58.291400 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 4.49s]
19:59:58.305710 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
19:59:58.324466 [debug] [Thread-7  ]: finished collecting timing info
19:59:58.345401 [debug] [Thread-8  ]: finished collecting timing info
19:59:58.346485 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.39 seconds
19:59:58.352760 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.39 seconds
19:59:58.355055 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea1191be0>]}
19:59:58.356071 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
19:59:58.392939 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
19:59:58.409899 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
19:59:58.412314 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_match_details: Close
19:59:58.420948 [debug] [Thread-1  ]: finished collecting timing info
19:59:58.425835 [debug] [Thread-2  ]: finished collecting timing info
19:59:58.427023 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 4.66s]
19:59:58.432103 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
19:59:58.437874 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
19:59:58.441561 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
19:59:58.444201 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
19:59:58.446693 [info ] [Thread-3  ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
19:59:58.456708 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
19:59:58.458235 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
19:59:58.459071 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
19:59:58.464003 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
19:59:58.465062 [debug] [Thread-3  ]: finished collecting timing info
19:59:58.465587 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
19:59:58.470410 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
19:59:58.472358 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
19:59:58.472902 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
19:59:58.473202 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
19:59:58.546115 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.14 seconds
19:59:58.552122 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:59:58.552449 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
19:59:58.577105 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.15 seconds
19:59:58.588630 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:59:58.590153 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
19:59:58.612883 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.9 seconds
19:59:58.614899 [debug] [Thread-10 ]: finished collecting timing info
19:59:58.615317 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_match_info: Close
19:59:58.641013 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea11915e0>]}
19:59:58.641758 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 4.94s]
19:59:58.642405 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
19:59:58.696559 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9e20e6a0>]}
19:59:58.697443 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 5.00s]
19:59:58.698456 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
19:59:58.705222 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea1237700>]}
19:59:58.706149 [info ] [Thread-2  ]: 2 of 14 OK created table model PUBLIC.final_items .............................. [[32mSUCCESS 1[0m in 5.01s]
19:59:58.706863 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
19:59:58.728602 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.14 seconds
19:59:58.748023 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:59:58.749221 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
19:59:58.754533 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9e224d90>]}
19:59:58.755715 [info ] [Thread-8  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 1.39s]
19:59:58.758572 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
19:59:58.829137 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.28 seconds
19:59:58.851591 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:59:58.857426 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
19:59:58.918399 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea11912e0>]}
19:59:58.924559 [info ] [Thread-10 ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.27s]
19:59:58.931352 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.18 seconds
19:59:58.946849 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_match_info
19:59:59.006980 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
19:59:59.021589 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:59:59.022166 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
19:59:59.102105 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.24 seconds
19:59:59.107855 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
19:59:59.109827 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:59:59.110240 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
19:59:59.223697 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.11 seconds
19:59:59.224027 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:59:59.224260 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
19:59:59.260371 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 1.32 seconds
19:59:59.262154 [debug] [Thread-9  ]: finished collecting timing info
19:59:59.262507 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
19:59:59.292838 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.27 seconds
19:59:59.293613 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
19:59:59.293976 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
19:59:59.455040 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.98 seconds
19:59:59.457920 [debug] [Thread-3  ]: finished collecting timing info
19:59:59.458531 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
19:59:59.459375 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.23 seconds
19:59:59.461924 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
19:59:59.462791 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
19:59:59.481037 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6c2d6280>]}
19:59:59.481598 [info ] [Thread-9  ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.64s]
19:59:59.482170 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
19:59:59.575028 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde6e3ee070>]}
19:59:59.575626 [info ] [Thread-3  ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.12s]
19:59:59.576332 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
19:59:59.697834 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.23 seconds
19:59:59.700114 [debug] [Thread-5  ]: finished collecting timing info
19:59:59.700540 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
19:59:59.903485 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea12371c0>]}
19:59:59.904489 [info ] [Thread-5  ]: 5 of 14 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 6.20s]
19:59:59.905545 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
20:00:00.534916 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.24 seconds
20:00:00.535241 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:00:00.535495 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
20:00:00.775779 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.24 seconds
20:00:00.778517 [debug] [Thread-4  ]: finished collecting timing info
20:00:00.778863 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
20:00:01.047592 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a94807ed-35b5-4a91-8f30-dbfc39a9c041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea1237040>]}
20:00:01.048426 [info ] [Thread-4  ]: 4 of 14 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 7.35s]
20:00:01.049470 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
20:00:01.053019 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:00:01.053917 [info ] [MainThread]: 
20:00:01.054657 [info ] [MainThread]: Finished running 7 view models, 5 table models, 2 incremental models in 9.39s.
20:00:01.055402 [debug] [MainThread]: Connection 'master' was properly closed.
20:00:01.055871 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_champions' was properly closed.
20:00:01.056274 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_items' was properly closed.
20:00:01.056735 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
20:00:01.057115 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
20:00:01.057486 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
20:00:01.057930 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
20:00:01.058277 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
20:00:01.058635 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
20:00:01.058908 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
20:00:01.059201 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
20:00:01.074496 [info ] [MainThread]: 
20:00:01.075138 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:00:01.075779 [info ] [MainThread]: 
20:00:01.076541 [error] [MainThread]: [33mDatabase Error in model stg_items (models/staging_datadragon/stg_items.sql)[0m
20:00:01.077462 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 63 at position 4
20:00:01.078272 [error] [MainThread]:   invalid identifier '"'11'"'
20:00:01.079028 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_items.sql
20:00:01.079671 [info ] [MainThread]: 
20:00:01.080842 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
20:00:01.082125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea135c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdea12572b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde9e1cd790>]}


============================== 2022-06-15 20:01:43.021587 | b29dcc63-b650-430d-92bd-4fa63eaf3522 ==============================
20:01:43.021624 [info ] [MainThread]: Running with dbt=1.1.0
20:01:43.022474 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:01:43.023095 [debug] [MainThread]: Tracking: tracking
20:01:43.023720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa40dc8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa40dc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa40dc970>]}
20:01:43.092462 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:01:43.093233 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
20:01:43.109587 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
20:01:43.173027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0acced4430>]}
20:01:43.187323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad282e8b0>]}
20:01:43.187867 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
20:01:43.188473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad282ea00>]}
20:01:43.192113 [info ] [MainThread]: 
20:01:43.192882 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:01:43.195173 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
20:01:43.215482 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
20:01:43.215877 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
20:01:43.216116 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:01:44.359395 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.14 seconds
20:01:44.361522 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
20:01:44.615875 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
20:01:44.627550 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
20:01:44.627890 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
20:01:44.628103 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:01:45.940824 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 1.31 seconds
20:01:45.943260 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
20:01:46.507905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0aa4086f10>]}
20:01:46.508728 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:01:46.509149 [info ] [MainThread]: 
20:01:46.527406 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
20:01:46.527996 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
20:01:46.528393 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
20:01:46.529030 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
20:01:46.529402 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
20:01:46.529882 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
20:01:46.530316 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
20:01:46.530665 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
20:01:46.530978 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
20:01:46.531447 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
20:01:46.531857 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
20:01:46.532079 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
20:01:46.532387 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
20:01:46.533264 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
20:01:46.533677 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
20:01:46.534197 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
20:01:46.534701 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
20:01:46.536714 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
20:01:46.537632 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
20:01:46.538419 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
20:01:46.540742 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
20:01:46.541938 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
20:01:46.543037 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
20:01:46.543800 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
20:01:46.545029 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:01:46.546076 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:01:46.546925 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
20:01:46.547205 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
20:01:46.548062 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
20:01:46.548949 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
20:01:46.549451 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
20:01:46.550550 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
20:01:46.551644 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
20:01:46.551953 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
20:01:46.552348 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
20:01:46.552848 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
20:01:46.554915 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
20:01:46.555312 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
20:01:46.555685 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
20:01:46.555953 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
20:01:46.556278 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
20:01:46.556673 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
20:01:46.556984 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
20:01:46.560216 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
20:01:46.560582 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
20:01:46.560835 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
20:01:46.561063 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
20:01:46.565772 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
20:01:46.566198 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
20:01:46.566501 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
20:01:46.570409 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
20:01:46.570922 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
20:01:46.571323 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
20:01:46.591445 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
20:01:46.593061 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
20:01:46.593385 [debug] [Thread-1  ]: finished collecting timing info
20:01:46.596770 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
20:01:46.600702 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
20:01:46.605579 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
20:01:46.605982 [debug] [Thread-2  ]: finished collecting timing info
20:01:46.672424 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
20:01:46.672826 [debug] [Thread-3  ]: finished collecting timing info
20:01:46.676894 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
20:01:46.678231 [debug] [Thread-5  ]: finished collecting timing info
20:01:46.678499 [debug] [Thread-4  ]: finished collecting timing info
20:01:46.678859 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
20:01:46.679997 [debug] [Thread-6  ]: finished collecting timing info
20:01:46.680745 [debug] [Thread-7  ]: finished collecting timing info
20:01:46.681133 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
20:01:46.682032 [debug] [Thread-8  ]: finished collecting timing info
20:01:46.682531 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
20:01:46.683147 [debug] [Thread-9  ]: finished collecting timing info
20:01:46.683558 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
20:01:46.683978 [debug] [Thread-10 ]: finished collecting timing info
20:01:46.684239 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
20:01:46.705597 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
20:01:46.713739 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
20:01:46.714326 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
20:01:46.718625 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
20:01:46.719157 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
20:01:46.722041 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
20:01:46.722511 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
20:01:46.733631 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
20:01:46.767169 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:01:46.767750 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:01:46.770858 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
20:01:46.774484 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
20:01:46.776088 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
20:01:46.796428 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
20:01:46.808512 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
20:01:46.814660 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
20:01:46.815957 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
20:01:46.818981 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
20:01:46.819513 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
20:01:46.820150 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
20:01:46.821845 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
20:01:46.822685 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
20:01:46.823486 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
20:01:46.823920 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        '11' as SummonersRift,
        '12' as HowlingAbyss,
        '21' as NexusBlitz,
        '22' as TeamfightTactics,
        'FlatHPPoolMod' as FlatHPPoolMod,
        'rFlatHPModPerLevel' as rFlatHPModPerLevel,
        'FlatMPPoolMod' as FlatMPPoolMod,
        'rFlatMPModPerLevel' as rFlatMPModPerLevel,
        'PercentHPPoolMod' as PercentHPPoolMod,
        'PercentMPPoolMod' as PercentMPPoolMod,
        'FlatHPRegenMod' as FlatHPRegenMod,
        'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
        'PercentHPRegenMod' as PercentHPRegenMod,
        'FlatMPRegenMod' as FlatMPRegenMod,
        'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
        'PercentMPRegenMod' as PercentMPRegenMod,
        'FlatArmorMod' as FlatArmorMod,
        'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
        'PercentArmorMod' as PercentArmorMod,
        'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
        'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
        'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
        'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
        'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
        'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
        'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
        'FlatMagicDamageMod' as FlatMagicDamageMod,
        'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
        'PercentMagicDamageMod' as PercentMagicDamageMod,
        'FlatMovementSpeedMod' as FlatMovementSpeedMod,
        'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
        'PercentMovementSpeedMod' as PercentMovementSpeedMod,
        'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
        'FlatAttackSpeedMod' as FlatAttackSpeedMod,
        'PercentAttackSpeedMod' as PercentAttackSpeedMod,
        'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
        'rFlatDodgeMod' as rFlatDodgeMod,
        'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
        'PercentDodgeMod' as PercentDodgeMod,
        'FlatCritChanceMod' as FlatCritChanceMod,
        'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
        'PercentCritChanceMod' as PercentCritChanceMod,
        'FlatCritDamageMod' as FlatCritDamageMod,
        'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
        'PercentCritDamageMod' as PercentCritDamageMod,
        'FlatBlockMod' as FlatBlockMod,
        'PercentBlockMod' as PercentBlockMod,
        'FlatSpellBlockMod' as FlatSpellBlockMod,
        'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
        'PercentSpellBlockMod' as PercentSpellBlockMod,
        'FlatEXPBonus' as FlatEXPBonus,
        'PercentEXPBonus' as PercentEXPBonus,
        'rPercentCooldownMod' as rPercentCooldownMod,
        'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
        'rFlatTimeDeadMod' as rFlatTimeDeadMod,
        'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
        'rPercentTimeDeadMod' as rPercentTimeDeadMod,
        'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
        'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
        'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
        'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
        'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
        'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
        'FlatEnergyRegenMod' as FlatEnergyRegenMod,
        'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
        'FlatEnergyPoolMod' as FlatEnergyPoolMod,
        'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
        'PercentLifeStealMod' as PercentLifeStealMod,
        'PercentSpellVampMod' as PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
20:01:46.824377 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
20:01:46.825781 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:01:46.829064 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
20:01:46.829815 [debug] [Thread-5  ]: Opening a new connection, currently in state init
20:01:46.830855 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
20:01:46.835794 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
20:01:46.836103 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:01:46.836400 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
20:01:46.836720 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
20:01:46.837034 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:01:46.837288 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:01:46.840324 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
20:01:46.842200 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
20:01:46.846370 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
  SELECT
    item_id,
    name,
    gold_description,
    gold_base,
    gold_purchasable,
    gold_total,
    gold_sell,
    '11' as SummonersRift,
    '12' as HowlingAbyss,
    '21' as NexusBlitz,
    '22' as TeamfightTactics,
    'FlatHPPoolMod' as FlatHPPoolMod,
    'rFlatHPModPerLevel' as rFlatHPModPerLevel,
    'FlatMPPoolMod' as FlatMPPoolMod,
    'rFlatMPModPerLevel' as rFlatMPModPerLevel,
    'PercentHPPoolMod' as PercentHPPoolMod,
    'PercentMPPoolMod' as PercentMPPoolMod,
    'FlatHPRegenMod' as FlatHPRegenMod,
    'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
    'PercentHPRegenMod' as PercentHPRegenMod,
    'FlatMPRegenMod' as FlatMPRegenMod,
    'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
    'PercentMPRegenMod' as PercentMPRegenMod,
    'FlatArmorMod' as FlatArmorMod,
    'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
    'PercentArmorMod' as PercentArmorMod,
    'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
    'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
    'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
    'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
    'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
    'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
    'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
    'FlatMagicDamageMod' as FlatMagicDamageMod,
    'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
    'PercentMagicDamageMod' as PercentMagicDamageMod,
    'FlatMovementSpeedMod' as FlatMovementSpeedMod,
    'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
    'PercentMovementSpeedMod' as PercentMovementSpeedMod,
    'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
    'FlatAttackSpeedMod' as FlatAttackSpeedMod,
    'PercentAttackSpeedMod' as PercentAttackSpeedMod,
    'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
    'rFlatDodgeMod' as rFlatDodgeMod,
    'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
    'PercentDodgeMod' as PercentDodgeMod,
    'FlatCritChanceMod' as FlatCritChanceMod,
    'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
    'PercentCritChanceMod' as PercentCritChanceMod,
    'FlatCritDamageMod' as FlatCritDamageMod,
    'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
    'PercentCritDamageMod' as PercentCritDamageMod,
    'FlatBlockMod' as FlatBlockMod,
    'PercentBlockMod' as PercentBlockMod,
    'FlatSpellBlockMod' as FlatSpellBlockMod,
    'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
    'PercentSpellBlockMod' as PercentSpellBlockMod,
    'FlatEXPBonus' as FlatEXPBonus,
    'PercentEXPBonus' as PercentEXPBonus,
    'rPercentCooldownMod' as rPercentCooldownMod,
    'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
    'rFlatTimeDeadMod' as rFlatTimeDeadMod,
    'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
    'rPercentTimeDeadMod' as rPercentTimeDeadMod,
    'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
    'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
    'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
    'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
    'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
    'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
    'FlatEnergyRegenMod' as FlatEnergyRegenMod,
    'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
    'FlatEnergyPoolMod' as FlatEnergyPoolMod,
    'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
    'PercentLifeStealMod' as PercentLifeStealMod,
    'PercentSpellVampMod' as PercentSpellVampMod
  FROM pivot_source
  pivot(max(map_exists) for map_id in ('11','12','21','22'))
  pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
))
ORDER BY item_id
)

SELECT * FROM pivoted_items
  );
20:01:46.850824 [debug] [Thread-7  ]: Opening a new connection, currently in state init
20:01:46.853449 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:01:46.859024 [debug] [Thread-8  ]: Opening a new connection, currently in state init
20:01:46.862358 [debug] [Thread-10 ]: Opening a new connection, currently in state init
20:01:46.864083 [debug] [Thread-9  ]: Opening a new connection, currently in state init
20:01:49.353466 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.5 seconds
20:01:49.370378 [debug] [Thread-7  ]: finished collecting timing info
20:01:49.371725 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
20:01:49.706635 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7f78280>]}
20:01:49.707493 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 3.16s]
20:01:49.709329 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
20:01:49.714190 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_match_details
20:01:49.715647 [info ] [Thread-7  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
20:01:49.719060 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
20:01:49.719897 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
20:01:49.720798 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_match_details
20:01:49.725085 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
20:01:49.728253 [debug] [Thread-7  ]: finished collecting timing info
20:01:49.729420 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
20:01:49.735010 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
20:01:49.747589 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
20:01:49.749229 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
20:01:49.750428 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
20:01:50.880903 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 4.02 seconds
20:01:50.883075 [debug] [Thread-9  ]: finished collecting timing info
20:01:50.884620 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
20:01:51.166072 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7f78700>]}
20:01:51.166608 [info ] [Thread-9  ]: 9 of 14 OK created view model PUBLIC.stg_items ................................. [[32mSUCCESS 1[0m in 4.62s]
20:01:51.167201 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
20:01:51.167568 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_match_info
20:01:51.168313 [info ] [Thread-9  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
20:01:51.169160 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
20:01:51.169408 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
20:01:51.169656 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_match_info
20:01:51.173256 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
20:01:51.173796 [debug] [Thread-9  ]: finished collecting timing info
20:01:51.174069 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
20:01:51.178761 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
20:01:51.183969 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
20:01:51.184588 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
20:01:51.185275 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
20:01:51.387759 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 4.53 seconds
20:01:51.389515 [debug] [Thread-10 ]: finished collecting timing info
20:01:51.389788 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
20:01:51.518024 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.66 seconds
20:01:51.520227 [debug] [Thread-8  ]: finished collecting timing info
20:01:51.520602 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
20:01:51.657812 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 4.8 seconds
20:01:51.659474 [debug] [Thread-6  ]: finished collecting timing info
20:01:51.659744 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
20:01:51.699427 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7f78940>]}
20:01:51.700148 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 5.15s]
20:01:51.700790 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
20:01:51.701103 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
20:01:51.701714 [info ] [Thread-10 ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
20:01:51.702382 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
20:01:51.702713 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
20:01:51.703010 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
20:01:51.706319 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
20:01:51.706835 [debug] [Thread-10 ]: finished collecting timing info
20:01:51.707098 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
20:01:51.713318 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
20:01:51.714779 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
20:01:51.715181 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
20:01:51.715433 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
20:01:51.796560 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7f784f0>]}
20:01:51.797082 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 5.25s]
20:01:51.797628 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
20:01:51.798043 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
20:01:51.798731 [info ] [Thread-8  ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
20:01:51.799421 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 2.05 seconds
20:01:51.800263 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
20:01:51.802670 [debug] [Thread-7  ]: finished collecting timing info
20:01:51.803150 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
20:01:51.803517 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_match_details: Close
20:01:51.803808 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
20:01:51.810152 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
20:01:51.811277 [debug] [Thread-8  ]: finished collecting timing info
20:01:51.811690 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
20:01:51.815495 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
20:01:51.816748 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
20:01:51.817058 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
20:01:51.817225 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
20:01:51.857988 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7f748e0>]}
20:01:51.858531 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.31s]
20:01:51.859071 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
20:01:51.919766 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 5.09 seconds
20:01:51.947934 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:01:51.954172 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
20:01:51.984597 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5.15 seconds
20:01:51.987830 [debug] [Thread-3  ]: finished collecting timing info
20:01:51.988550 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
20:01:52.062355 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 5.23 seconds
20:01:52.069828 [debug] [Thread-1  ]: finished collecting timing info
20:01:52.080743 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
20:01:52.160731 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.19 seconds
20:01:52.178694 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:01:52.198050 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
20:01:52.245476 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a9c2d2a60>]}
20:01:52.251381 [info ] [Thread-7  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 2.53s]
20:01:52.269625 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
20:01:52.304854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7f749d0>]}
20:01:52.305618 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 5.77s]
20:01:52.314464 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
20:01:52.317639 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 5.48 seconds
20:01:52.319659 [debug] [Thread-2  ]: finished collecting timing info
20:01:52.320550 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
20:01:52.336161 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.14 seconds
20:01:52.346882 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:01:52.347546 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
20:01:52.430254 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7f749a0>]}
20:01:52.431279 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 5.89s]
20:01:52.431964 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 5.61 seconds
20:01:52.438263 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
20:01:52.439844 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.09 seconds
20:01:52.442893 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:01:52.451471 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
20:01:52.489006 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
20:01:52.496013 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:01:52.497090 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7f74760>]}
20:01:52.497480 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
20:01:52.498532 [info ] [Thread-2  ]: 2 of 14 OK created table model PUBLIC.final_items .............................. [[32mSUCCESS 1[0m in 5.96s]
20:01:52.504405 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
20:01:52.598122 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.13 seconds
20:01:52.609107 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:01:52.609583 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
20:01:52.636355 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.14 seconds
20:01:52.636750 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:01:52.636932 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
20:01:52.761639 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.15 seconds
20:01:52.772154 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:01:52.772514 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
20:01:52.788498 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.07 seconds
20:01:52.790180 [debug] [Thread-10 ]: finished collecting timing info
20:01:52.790428 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
20:01:52.846183 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 1.66 seconds
20:01:52.850580 [debug] [Thread-9  ]: finished collecting timing info
20:01:52.851001 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_match_info: Close
20:01:52.913554 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.28 seconds
20:01:52.913995 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:01:52.914241 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
20:01:52.983024 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7972fd0>]}
20:01:52.983646 [info ] [Thread-10 ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.28s]
20:01:52.984670 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.21 seconds
20:01:52.985419 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
20:01:52.999023 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
20:01:53.006465 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:01:53.006798 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
20:01:53.032644 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.22 seconds
20:01:53.034509 [debug] [Thread-8  ]: finished collecting timing info
20:01:53.034821 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
20:01:53.224476 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.31 seconds
20:01:53.226436 [debug] [Thread-5  ]: finished collecting timing info
20:01:53.226726 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
20:01:53.238946 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7a22d30>]}
20:01:53.239464 [info ] [Thread-9  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 2.07s]
20:01:53.240021 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
20:01:53.293946 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.29 seconds
20:01:53.294646 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:01:53.294879 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
20:01:53.315489 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac7f782e0>]}
20:01:53.316109 [info ] [Thread-8  ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.52s]
20:01:53.316813 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
20:01:53.358455 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad27593a0>]}
20:01:53.359075 [info ] [Thread-5  ]: 5 of 14 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 6.81s]
20:01:53.359804 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
20:01:54.575675 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.28 seconds
20:01:54.576011 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:01:54.576219 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
20:01:54.760432 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.18 seconds
20:01:54.762409 [debug] [Thread-4  ]: finished collecting timing info
20:01:54.762758 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
20:01:54.898915 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29dcc63-b650-430d-92bd-4fa63eaf3522', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac79b4670>]}
20:01:54.899471 [info ] [Thread-4  ]: 4 of 14 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 8.35s]
20:01:54.900134 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
20:01:54.903280 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:01:54.903816 [info ] [MainThread]: 
20:01:54.904187 [info ] [MainThread]: Finished running 5 table models, 7 view models, 2 incremental models in 11.71s.
20:01:54.904548 [debug] [MainThread]: Connection 'master' was properly closed.
20:01:54.904903 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_champions' was properly closed.
20:01:54.905178 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_items' was properly closed.
20:01:54.905499 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_maps' was properly closed.
20:01:54.905669 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
20:01:54.905854 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
20:01:54.906019 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
20:01:54.906189 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
20:01:54.906401 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
20:01:54.906585 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
20:01:54.906752 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
20:01:54.923335 [info ] [MainThread]: 
20:01:54.923782 [info ] [MainThread]: [32mCompleted successfully[0m
20:01:54.924186 [info ] [MainThread]: 
20:01:54.924554 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
20:01:54.925238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ac8034d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad282eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ad282ea30>]}


============================== 2022-06-15 20:11:36.092012 | ab2b9dc6-9215-48ef-b72c-a17658b46d38 ==============================
20:11:36.092040 [info ] [MainThread]: Running with dbt=1.1.0
20:11:36.092759 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:11:36.092971 [debug] [MainThread]: Tracking: tracking
20:11:36.093304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ab970850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ab9708b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ab970910>]}
20:11:36.152629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:11:36.153456 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
20:11:36.169808 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
20:11:36.226206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6da3e41c0>]}
20:11:36.239339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6dfd3f940>]}
20:11:36.239749 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
20:11:36.240108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6da3e3fa0>]}
20:11:36.243695 [info ] [MainThread]: 
20:11:36.244404 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:11:36.246170 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
20:11:36.261565 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
20:11:36.261837 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
20:11:36.262013 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:11:37.155634 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.89 seconds
20:11:37.157368 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
20:11:37.273734 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
20:11:37.282611 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
20:11:37.282873 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
20:11:37.283064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:11:37.788670 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 0.51 seconds
20:11:37.791229 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
20:11:37.953807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6ab91af10>]}
20:11:37.954521 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:11:37.954886 [info ] [MainThread]: 
20:11:37.971372 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
20:11:37.971690 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
20:11:37.972001 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
20:11:37.972217 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
20:11:37.972702 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
20:11:37.973456 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
20:11:37.973733 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
20:11:37.974230 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
20:11:37.974501 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
20:11:37.975186 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
20:11:37.975632 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
20:11:37.976083 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
20:11:37.976475 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
20:11:37.976710 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
20:11:37.977073 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
20:11:37.978062 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
20:11:37.978575 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
20:11:37.978998 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
20:11:37.979354 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
20:11:37.979775 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
20:11:37.980220 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
20:11:37.980608 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
20:11:37.981378 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
20:11:37.981821 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
20:11:37.982397 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
20:11:37.982792 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:11:37.983635 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:11:37.984288 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
20:11:37.985124 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
20:11:37.985919 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
20:11:37.986971 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
20:11:37.987361 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
20:11:37.987710 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
20:11:37.989813 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
20:11:37.990181 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
20:11:37.990532 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
20:11:37.990806 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
20:11:37.991094 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
20:11:37.991360 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
20:11:37.991675 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
20:11:37.991909 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
20:11:37.995533 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
20:11:37.995964 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
20:11:37.996250 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
20:11:37.999573 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
20:11:38.000252 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
20:11:38.000946 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
20:11:38.001554 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
20:11:38.002020 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
20:11:38.002284 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
20:11:38.002580 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
20:11:38.005568 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
20:11:38.006342 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
20:11:38.006649 [debug] [Thread-1  ]: finished collecting timing info
20:11:38.022949 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
20:11:38.023278 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
20:11:38.026895 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
20:11:38.027224 [debug] [Thread-2  ]: finished collecting timing info
20:11:38.030780 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
20:11:38.034872 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
20:11:38.095722 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
20:11:38.100288 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
20:11:38.100798 [debug] [Thread-3  ]: finished collecting timing info
20:11:38.101185 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
20:11:38.102778 [debug] [Thread-4  ]: finished collecting timing info
20:11:38.103034 [debug] [Thread-6  ]: finished collecting timing info
20:11:38.103266 [debug] [Thread-5  ]: finished collecting timing info
20:11:38.103655 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
20:11:38.105614 [debug] [Thread-8  ]: finished collecting timing info
20:11:38.106002 [debug] [Thread-9  ]: finished collecting timing info
20:11:38.106524 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
20:11:38.112567 [debug] [Thread-10 ]: finished collecting timing info
20:11:38.122748 [debug] [Thread-7  ]: finished collecting timing info
20:11:38.133174 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
20:11:38.135685 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
20:11:38.136173 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
20:11:38.136716 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
20:11:38.140523 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
20:11:38.140888 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
20:11:38.141156 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
20:11:38.143913 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
20:11:38.144275 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
20:11:38.144683 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
20:11:38.174992 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
20:11:38.180741 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:11:38.184821 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:11:38.186367 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
20:11:38.211655 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
20:11:38.217351 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
20:11:38.220538 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
20:11:38.224610 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
20:11:38.225900 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
20:11:38.228726 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
20:11:38.229666 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
20:11:38.230983 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
20:11:38.231338 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
20:11:38.231580 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
20:11:38.231811 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        '11' as SummonersRift,
        '12' as HowlingAbyss,
        '21' as NexusBlitz,
        '22' as TeamfightTactics,
        'FlatHPPoolMod' as FlatHPPoolMod,
        'rFlatHPModPerLevel' as rFlatHPModPerLevel,
        'FlatMPPoolMod' as FlatMPPoolMod,
        'rFlatMPModPerLevel' as rFlatMPModPerLevel,
        'PercentHPPoolMod' as PercentHPPoolMod,
        'PercentMPPoolMod' as PercentMPPoolMod,
        'FlatHPRegenMod' as FlatHPRegenMod,
        'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
        'PercentHPRegenMod' as PercentHPRegenMod,
        'FlatMPRegenMod' as FlatMPRegenMod,
        'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
        'PercentMPRegenMod' as PercentMPRegenMod,
        'FlatArmorMod' as FlatArmorMod,
        'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
        'PercentArmorMod' as PercentArmorMod,
        'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
        'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
        'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
        'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
        'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
        'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
        'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
        'FlatMagicDamageMod' as FlatMagicDamageMod,
        'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
        'PercentMagicDamageMod' as PercentMagicDamageMod,
        'FlatMovementSpeedMod' as FlatMovementSpeedMod,
        'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
        'PercentMovementSpeedMod' as PercentMovementSpeedMod,
        'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
        'FlatAttackSpeedMod' as FlatAttackSpeedMod,
        'PercentAttackSpeedMod' as PercentAttackSpeedMod,
        'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
        'rFlatDodgeMod' as rFlatDodgeMod,
        'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
        'PercentDodgeMod' as PercentDodgeMod,
        'FlatCritChanceMod' as FlatCritChanceMod,
        'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
        'PercentCritChanceMod' as PercentCritChanceMod,
        'FlatCritDamageMod' as FlatCritDamageMod,
        'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
        'PercentCritDamageMod' as PercentCritDamageMod,
        'FlatBlockMod' as FlatBlockMod,
        'PercentBlockMod' as PercentBlockMod,
        'FlatSpellBlockMod' as FlatSpellBlockMod,
        'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
        'PercentSpellBlockMod' as PercentSpellBlockMod,
        'FlatEXPBonus' as FlatEXPBonus,
        'PercentEXPBonus' as PercentEXPBonus,
        'rPercentCooldownMod' as rPercentCooldownMod,
        'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
        'rFlatTimeDeadMod' as rFlatTimeDeadMod,
        'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
        'rPercentTimeDeadMod' as rPercentTimeDeadMod,
        'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
        'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
        'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
        'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
        'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
        'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
        'FlatEnergyRegenMod' as FlatEnergyRegenMod,
        'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
        'FlatEnergyPoolMod' as FlatEnergyPoolMod,
        'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
        'PercentLifeStealMod' as PercentLifeStealMod,
        'PercentSpellVampMod' as PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
20:11:38.234986 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
20:11:38.235524 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
20:11:38.241833 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
20:11:38.243696 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
20:11:38.244029 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:11:38.244983 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
20:11:38.245234 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
20:11:38.245495 [debug] [Thread-5  ]: Opening a new connection, currently in state init
20:11:38.245737 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:11:38.245992 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:11:38.246244 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
20:11:38.246483 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:11:38.246725 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
  SELECT
    item_id,
    name,
    gold_description,
    gold_base,
    gold_purchasable,
    gold_total,
    gold_sell,
    '11' as SummonersRift,
    '12' as HowlingAbyss,
    '21' as NexusBlitz,
    '22' as TeamfightTactics,
    p2.'FlatHPPoolMod' as FlatHPPoolMod,
    'rFlatHPModPerLevel' as rFlatHPModPerLevel,
    'FlatMPPoolMod' as FlatMPPoolMod,
    'rFlatMPModPerLevel' as rFlatMPModPerLevel,
    'PercentHPPoolMod' as PercentHPPoolMod,
    'PercentMPPoolMod' as PercentMPPoolMod,
    'FlatHPRegenMod' as FlatHPRegenMod,
    'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
    'PercentHPRegenMod' as PercentHPRegenMod,
    'FlatMPRegenMod' as FlatMPRegenMod,
    'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
    'PercentMPRegenMod' as PercentMPRegenMod,
    'FlatArmorMod' as FlatArmorMod,
    'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
    'PercentArmorMod' as PercentArmorMod,
    'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
    'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
    'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
    'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
    'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
    'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
    'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
    'FlatMagicDamageMod' as FlatMagicDamageMod,
    'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
    'PercentMagicDamageMod' as PercentMagicDamageMod,
    'FlatMovementSpeedMod' as FlatMovementSpeedMod,
    'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
    'PercentMovementSpeedMod' as PercentMovementSpeedMod,
    'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
    'FlatAttackSpeedMod' as FlatAttackSpeedMod,
    'PercentAttackSpeedMod' as PercentAttackSpeedMod,
    'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
    'rFlatDodgeMod' as rFlatDodgeMod,
    'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
    'PercentDodgeMod' as PercentDodgeMod,
    'FlatCritChanceMod' as FlatCritChanceMod,
    'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
    'PercentCritChanceMod' as PercentCritChanceMod,
    'FlatCritDamageMod' as FlatCritDamageMod,
    'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
    'PercentCritDamageMod' as PercentCritDamageMod,
    'FlatBlockMod' as FlatBlockMod,
    'PercentBlockMod' as PercentBlockMod,
    'FlatSpellBlockMod' as FlatSpellBlockMod,
    'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
    'PercentSpellBlockMod' as PercentSpellBlockMod,
    'FlatEXPBonus' as FlatEXPBonus,
    'PercentEXPBonus' as PercentEXPBonus,
    'rPercentCooldownMod' as rPercentCooldownMod,
    'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
    'rFlatTimeDeadMod' as rFlatTimeDeadMod,
    'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
    'rPercentTimeDeadMod' as rPercentTimeDeadMod,
    'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
    'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
    'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
    'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
    'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
    'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
    'FlatEnergyRegenMod' as FlatEnergyRegenMod,
    'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
    'FlatEnergyPoolMod' as FlatEnergyPoolMod,
    'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
    'PercentLifeStealMod' as PercentLifeStealMod,
    'PercentSpellVampMod' as PercentSpellVampMod
  FROM pivot_source
  pivot(max(map_exists) for map_id in ('11','12','21','22'))
  pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
)as p2) 
ORDER BY item_id
)

SELECT * FROM pivoted_items
  );
20:11:38.247162 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
20:11:38.250725 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
20:11:38.251432 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:11:38.259152 [debug] [Thread-8  ]: Opening a new connection, currently in state init
20:11:38.265153 [debug] [Thread-9  ]: Opening a new connection, currently in state init
20:11:38.269506 [debug] [Thread-10 ]: Opening a new connection, currently in state init
20:11:38.270504 [debug] [Thread-7  ]: Opening a new connection, currently in state init
20:11:40.545553 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.3 seconds
20:11:40.559720 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:11:40.561315 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
20:11:40.697139 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.13 seconds
20:11:40.712756 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:11:40.715700 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
20:11:40.847039 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.13 seconds
20:11:40.864653 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:11:40.866207 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
20:11:41.014075 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.15 seconds
20:11:41.061733 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
20:11:41.071419 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:11:41.072132 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
20:11:41.116599 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.87 seconds
20:11:41.125094 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:11:41.126180 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
20:11:41.181037 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.11 seconds
20:11:41.182056 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:11:41.182538 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
20:11:41.227701 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.1 seconds
20:11:41.234268 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:11:41.235161 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
20:11:41.338199 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.1 seconds
20:11:41.344174 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:11:41.346423 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
20:11:41.465306 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.22 seconds
20:11:41.480610 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.13 seconds
20:11:41.483965 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
20:11:41.484915 [debug] [Thread-2  ]: finished collecting timing info
20:11:41.488246 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
20:11:41.497049 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:11:41.497425 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
20:11:41.572981 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.33 seconds
20:11:41.574610 [debug] [Thread-1  ]: finished collecting timing info
20:11:41.574893 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
20:11:41.596307 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.34 seconds
20:11:41.598269 [debug] [Thread-6  ]: finished collecting timing info
20:11:41.598887 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
20:11:41.620942 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.12 seconds
20:11:41.621570 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:11:41.621881 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
20:11:41.626617 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5481910>]}
20:11:41.627136 [info ] [Thread-2  ]: 2 of 14 OK created table model PUBLIC.final_items .............................. [[32mSUCCESS 1[0m in 3.65s]
20:11:41.627687 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
20:11:41.627974 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_match_details
20:11:41.628813 [info ] [Thread-2  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
20:11:41.629444 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
20:11:41.629642 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
20:11:41.629852 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_match_details
20:11:41.634179 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
20:11:41.634693 [debug] [Thread-2  ]: finished collecting timing info
20:11:41.634924 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
20:11:41.638139 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
20:11:41.643541 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
20:11:41.643803 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
20:11:41.644126 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:11:41.888122 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.27 seconds
20:11:41.893820 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:11:41.899408 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
20:11:42.038836 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.79 seconds
20:11:42.040533 [debug] [Thread-3  ]: finished collecting timing info
20:11:42.040799 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
20:11:42.053227 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.78 seconds
20:11:42.054941 [debug] [Thread-7  ]: finished collecting timing info
20:11:42.055266 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
20:11:42.058391 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.16 seconds
20:11:42.060970 [debug] [Thread-5  ]: finished collecting timing info
20:11:42.063654 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
20:11:42.064881 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5481b20>]}
20:11:42.066019 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5481790>]}
20:11:42.067517 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 4.08s]
20:11:42.069963 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 4.09s]
20:11:42.072061 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
20:11:42.072555 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_match_info
20:11:42.072929 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
20:11:42.073426 [info ] [Thread-6  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
20:11:42.073768 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
20:11:42.074598 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
20:11:42.075034 [info ] [Thread-1  ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
20:11:42.075374 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
20:11:42.076350 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
20:11:42.076768 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_match_info
20:11:42.077096 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
20:11:42.081058 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
20:11:42.081381 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
20:11:42.087903 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
20:11:42.088218 [debug] [Thread-6  ]: finished collecting timing info
20:11:42.089009 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
20:11:42.090731 [debug] [Thread-1  ]: finished collecting timing info
20:11:42.095331 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
20:11:42.099291 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
20:11:42.104903 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
20:11:42.111676 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
20:11:42.113950 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
20:11:42.114343 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
20:11:42.115592 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
20:11:42.119929 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
20:11:42.121234 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:11:42.132467 [debug] [Thread-9  ]: Snowflake adapter: Snowflake query id: 01a4f87b-0000-fa00-0000-d969000522fa
20:11:42.132862 [debug] [Thread-9  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 67 at position 7 unexpected ''FlatHPPoolMod''.
syntax error line 200 at position 1 unexpected 'as'.
syntax error line 201 at position 0 unexpected 'ORDER'.
syntax error line 204 at position 0 unexpected 'SELECT'.
20:11:42.133439 [debug] [Thread-9  ]: finished collecting timing info
20:11:42.133786 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
20:11:42.179881 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.91 seconds
20:11:42.181905 [debug] [Thread-10 ]: finished collecting timing info
20:11:42.182445 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
20:11:42.183636 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d54819d0>]}
20:11:42.185432 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 4.20s]
20:11:42.187327 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
20:11:42.190581 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
20:11:42.191628 [info ] [Thread-3  ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
20:11:42.192912 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
20:11:42.193324 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
20:11:42.193552 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
20:11:42.196956 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
20:11:42.197394 [debug] [Thread-3  ]: finished collecting timing info
20:11:42.197788 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
20:11:42.201286 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
20:11:42.203124 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.94 seconds
20:11:42.204201 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
20:11:42.205884 [debug] [Thread-8  ]: finished collecting timing info
20:11:42.206241 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
20:11:42.206652 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
20:11:42.207113 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:11:42.215805 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5489280>]}
20:11:42.217069 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 4.23s]
20:11:42.217977 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
20:11:42.227347 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d5481e80>]}
20:11:42.227865 [info ] [Thread-5  ]: 5 of 14 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 4.24s]
20:11:42.228443 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
20:11:42.248624 [debug] [Thread-9  ]: Database Error in model stg_items (models/staging_datadragon/stg_items.sql)
  001003 (42000): SQL compilation error:
  syntax error line 67 at position 7 unexpected ''FlatHPPoolMod''.
  syntax error line 200 at position 1 unexpected 'as'.
  syntax error line 201 at position 0 unexpected 'ORDER'.
  syntax error line 204 at position 0 unexpected 'SELECT'.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_items.sql
20:11:42.249056 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d500f250>]}
20:11:42.249487 [error] [Thread-9  ]: 9 of 14 ERROR creating view model PUBLIC.stg_items ............................. [[31mERROR[0m in 4.26s]
20:11:42.250026 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
20:11:42.299656 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d4ec4ca0>]}
20:11:42.306141 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 4.31s]
20:11:42.307323 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
20:11:42.401924 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d54894f0>]}
20:11:42.444903 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 4.42s]
20:11:42.460528 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
20:11:42.461264 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 0.82 seconds
20:11:42.473689 [debug] [Thread-2  ]: finished collecting timing info
20:11:42.475257 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_details: Close
20:11:42.623388 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.44 seconds
20:11:42.623862 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:11:42.624122 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
20:11:42.638371 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d4eb1dc0>]}
20:11:42.639898 [info ] [Thread-2  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 1.01s]
20:11:42.642559 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
20:11:42.796411 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.17 seconds
20:11:42.799628 [debug] [Thread-4  ]: finished collecting timing info
20:11:42.802908 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
20:11:42.912957 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.79 seconds
20:11:42.914884 [debug] [Thread-1  ]: finished collecting timing info
20:11:42.915290 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
20:11:42.983784 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d4f842b0>]}
20:11:42.985655 [info ] [Thread-4  ]: 4 of 14 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 5.00s]
20:11:42.986912 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
20:11:43.049731 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d4effc40>]}
20:11:43.050429 [info ] [Thread-1  ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 0.97s]
20:11:43.051105 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
20:11:43.247120 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.04 seconds
20:11:43.248788 [debug] [Thread-3  ]: finished collecting timing info
20:11:43.249102 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
20:11:43.261622 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.15 seconds
20:11:43.263406 [debug] [Thread-6  ]: finished collecting timing info
20:11:43.263703 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_info: Close
20:11:43.383092 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d4effc10>]}
20:11:43.384034 [info ] [Thread-6  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.31s]
20:11:43.385593 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
20:11:43.387285 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab2b9dc6-9215-48ef-b72c-a17658b46d38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d4f7b220>]}
20:11:43.387810 [info ] [Thread-3  ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.19s]
20:11:43.388367 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
20:11:43.391688 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:11:43.392231 [info ] [MainThread]: 
20:11:43.392669 [info ] [MainThread]: Finished running 5 table models, 2 incremental models, 7 view models in 7.15s.
20:11:43.392991 [debug] [MainThread]: Connection 'master' was properly closed.
20:11:43.393229 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
20:11:43.393430 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
20:11:43.393605 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
20:11:43.393821 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
20:11:43.393975 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
20:11:43.394126 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
20:11:43.394344 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
20:11:43.394507 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
20:11:43.394672 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
20:11:43.394938 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
20:11:43.410273 [info ] [MainThread]: 
20:11:43.410734 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:11:43.411479 [info ] [MainThread]: 
20:11:43.412255 [error] [MainThread]: [33mDatabase Error in model stg_items (models/staging_datadragon/stg_items.sql)[0m
20:11:43.412916 [error] [MainThread]:   001003 (42000): SQL compilation error:
20:11:43.413395 [error] [MainThread]:   syntax error line 67 at position 7 unexpected ''FlatHPPoolMod''.
20:11:43.413896 [error] [MainThread]:   syntax error line 200 at position 1 unexpected 'as'.
20:11:43.414298 [error] [MainThread]:   syntax error line 201 at position 0 unexpected 'ORDER'.
20:11:43.414752 [error] [MainThread]:   syntax error line 204 at position 0 unexpected 'SELECT'.
20:11:43.415107 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_items.sql
20:11:43.415542 [info ] [MainThread]: 
20:11:43.416024 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
20:11:43.416754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6dfd3f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6dfd3fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6dfd3fa00>]}


============================== 2022-06-15 20:12:09.671247 | 04d066e5-be1b-40c6-8eef-b86bd3bc46c2 ==============================
20:12:09.671274 [info ] [MainThread]: Running with dbt=1.1.0
20:12:09.671886 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:12:09.672213 [debug] [MainThread]: Tracking: tracking
20:12:09.672733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7748101700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7748101760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77481017c0>]}
20:12:09.731140 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
20:12:09.731888 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
20:12:09.749117 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
20:12:09.804386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777699e070>]}
20:12:09.816619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77782c07f0>]}
20:12:09.817092 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
20:12:09.817454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777699de50>]}
20:12:09.820681 [info ] [MainThread]: 
20:12:09.821379 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:12:09.823266 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
20:12:09.837868 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
20:12:09.838179 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
20:12:09.838406 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:12:10.665523 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.83 seconds
20:12:10.667273 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
20:12:10.787160 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
20:12:10.795945 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
20:12:10.796220 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
20:12:10.796388 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:12:11.264814 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 0.47 seconds
20:12:11.267261 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
20:12:11.389792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77783a65e0>]}
20:12:11.390488 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:12:11.390971 [info ] [MainThread]: 
20:12:11.408177 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
20:12:11.408890 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
20:12:11.409377 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
20:12:11.409658 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
20:12:11.410005 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
20:12:11.410406 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
20:12:11.410632 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
20:12:11.410937 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
20:12:11.411375 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
20:12:11.411761 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
20:12:11.412375 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
20:12:11.413110 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
20:12:11.413432 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
20:12:11.413689 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
20:12:11.414160 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
20:12:11.415152 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
20:12:11.415903 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
20:12:11.416441 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
20:12:11.416984 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
20:12:11.417455 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
20:12:11.417812 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
20:12:11.418276 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
20:12:11.419028 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
20:12:11.419566 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
20:12:11.420628 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:12:11.420914 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
20:12:11.421730 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:12:11.423289 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
20:12:11.424167 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
20:12:11.424528 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
20:12:11.424909 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
20:12:11.425685 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
20:12:11.426009 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
20:12:11.428514 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
20:12:11.429100 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
20:12:11.429674 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
20:12:11.430010 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
20:12:11.430254 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
20:12:11.430528 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
20:12:11.433695 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
20:12:11.434195 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
20:12:11.434672 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
20:12:11.435061 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
20:12:11.435462 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
20:12:11.435764 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
20:12:11.439571 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
20:12:11.439942 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
20:12:11.440184 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
20:12:11.440539 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
20:12:11.441461 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
20:12:11.442089 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
20:12:11.442888 [debug] [Thread-1  ]: finished collecting timing info
20:12:11.446002 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
20:12:11.446510 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
20:12:11.464207 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
20:12:11.465438 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
20:12:11.468829 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
20:12:11.469496 [debug] [Thread-2  ]: finished collecting timing info
20:12:11.473181 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
20:12:11.478534 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
20:12:11.539863 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
20:12:11.540282 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
20:12:11.543850 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
20:12:11.544645 [debug] [Thread-3  ]: finished collecting timing info
20:12:11.545744 [debug] [Thread-5  ]: finished collecting timing info
20:12:11.546286 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
20:12:11.547128 [debug] [Thread-4  ]: finished collecting timing info
20:12:11.547769 [debug] [Thread-7  ]: finished collecting timing info
20:12:11.548290 [debug] [Thread-6  ]: finished collecting timing info
20:12:11.565636 [debug] [Thread-9  ]: finished collecting timing info
20:12:11.577017 [debug] [Thread-10 ]: finished collecting timing info
20:12:11.580812 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
20:12:11.581131 [debug] [Thread-8  ]: finished collecting timing info
20:12:11.581527 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
20:12:11.581932 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
20:12:11.585125 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
20:12:11.585656 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
20:12:11.586053 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
20:12:11.586459 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
20:12:11.586844 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
20:12:11.587109 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
20:12:11.587765 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
20:12:11.590695 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
20:12:11.592960 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
20:12:11.641963 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:12:11.643083 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:12:11.646616 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
20:12:11.650152 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
20:12:11.653585 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
20:12:11.698031 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
20:12:11.703192 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
20:12:11.706596 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
20:12:11.707237 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
20:12:11.707638 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
20:12:11.708301 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
20:12:11.708629 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
20:12:11.708947 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        '11' as SummonersRift,
        '12' as HowlingAbyss,
        '21' as NexusBlitz,
        '22' as TeamfightTactics,
        'FlatHPPoolMod' as FlatHPPoolMod,
        'rFlatHPModPerLevel' as rFlatHPModPerLevel,
        'FlatMPPoolMod' as FlatMPPoolMod,
        'rFlatMPModPerLevel' as rFlatMPModPerLevel,
        'PercentHPPoolMod' as PercentHPPoolMod,
        'PercentMPPoolMod' as PercentMPPoolMod,
        'FlatHPRegenMod' as FlatHPRegenMod,
        'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
        'PercentHPRegenMod' as PercentHPRegenMod,
        'FlatMPRegenMod' as FlatMPRegenMod,
        'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
        'PercentMPRegenMod' as PercentMPRegenMod,
        'FlatArmorMod' as FlatArmorMod,
        'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
        'PercentArmorMod' as PercentArmorMod,
        'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
        'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
        'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
        'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
        'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
        'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
        'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
        'FlatMagicDamageMod' as FlatMagicDamageMod,
        'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
        'PercentMagicDamageMod' as PercentMagicDamageMod,
        'FlatMovementSpeedMod' as FlatMovementSpeedMod,
        'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
        'PercentMovementSpeedMod' as PercentMovementSpeedMod,
        'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
        'FlatAttackSpeedMod' as FlatAttackSpeedMod,
        'PercentAttackSpeedMod' as PercentAttackSpeedMod,
        'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
        'rFlatDodgeMod' as rFlatDodgeMod,
        'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
        'PercentDodgeMod' as PercentDodgeMod,
        'FlatCritChanceMod' as FlatCritChanceMod,
        'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
        'PercentCritChanceMod' as PercentCritChanceMod,
        'FlatCritDamageMod' as FlatCritDamageMod,
        'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
        'PercentCritDamageMod' as PercentCritDamageMod,
        'FlatBlockMod' as FlatBlockMod,
        'PercentBlockMod' as PercentBlockMod,
        'FlatSpellBlockMod' as FlatSpellBlockMod,
        'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
        'PercentSpellBlockMod' as PercentSpellBlockMod,
        'FlatEXPBonus' as FlatEXPBonus,
        'PercentEXPBonus' as PercentEXPBonus,
        'rPercentCooldownMod' as rPercentCooldownMod,
        'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
        'rFlatTimeDeadMod' as rFlatTimeDeadMod,
        'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
        'rPercentTimeDeadMod' as rPercentTimeDeadMod,
        'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
        'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
        'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
        'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
        'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
        'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
        'FlatEnergyRegenMod' as FlatEnergyRegenMod,
        'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
        'FlatEnergyPoolMod' as FlatEnergyPoolMod,
        'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
        'PercentLifeStealMod' as PercentLifeStealMod,
        'PercentSpellVampMod' as PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
20:12:11.710789 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
20:12:11.716910 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
20:12:11.718578 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
20:12:11.719303 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:12:11.721941 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
20:12:11.723079 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
20:12:11.723314 [debug] [Thread-5  ]: Opening a new connection, currently in state init
20:12:11.723575 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
20:12:11.723813 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:12:11.724074 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:12:11.724403 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
20:12:11.724700 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
  SELECT
    item_id,
    name,
    gold_description,
    gold_base,
    gold_purchasable,
    gold_total,
    gold_sell,
    '11' as SummonersRift,
    '12' as HowlingAbyss,
    '21' as NexusBlitz,
    '22' as TeamfightTactics,
    p2.'FlatHPPoolMod' as FlatHPPoolMod,
    'rFlatHPModPerLevel' as rFlatHPModPerLevel,
    'FlatMPPoolMod' as FlatMPPoolMod,
    'rFlatMPModPerLevel' as rFlatMPModPerLevel,
    'PercentHPPoolMod' as PercentHPPoolMod,
    'PercentMPPoolMod' as PercentMPPoolMod,
    'FlatHPRegenMod' as FlatHPRegenMod,
    'rFlatHPRegenModPerLevel' as rFlatHPRegenModPerLevel,
    'PercentHPRegenMod' as PercentHPRegenMod,
    'FlatMPRegenMod' as FlatMPRegenMod,
    'rFlatMPRegenModPerLevel' as rFlatMPRegenModPerLevel,
    'PercentMPRegenMod' as PercentMPRegenMod,
    'FlatArmorMod' as FlatArmorMod,
    'rFlatArmorModPerLevel' as rFlatArmorModPerLevel,
    'PercentArmorMod' as PercentArmorMod,
    'rFlatArmorPenetrationMod' as rFlatArmorPenetrationMod,
    'rFlatArmorPenetrationModPerLevel' as rFlatArmorPenetrationModPerLevel,
    'rPercentArmorPenetrationMod' as rPercentArmorPenetrationMod,
    'rPercentArmorPenetrationModPerLevel' as rPercentArmorPenetrationModPerLevel,
    'FlatPhysicalDamageMod' as FlatPhysicalDamageMod,
    'rFlatPhysicalDamageModPerLevel' as rFlatPhysicalDamageModPerLevel,
    'PercentPhysicalDamageMod' as PercentPhysicalDamageMod,
    'FlatMagicDamageMod' as FlatMagicDamageMod,
    'rFlatMagicDamageModPerLevel' as rFlatMagicDamageModPerLevel,
    'PercentMagicDamageMod' as PercentMagicDamageMod,
    'FlatMovementSpeedMod' as FlatMovementSpeedMod,
    'rFlatMovementSpeedModPerLevel' as rFlatMovementSpeedModPerLevel,
    'PercentMovementSpeedMod' as PercentMovementSpeedMod,
    'rPercentMovementSpeedModPerLevel' as rPercentMovementSpeedModPerLevel,
    'FlatAttackSpeedMod' as FlatAttackSpeedMod,
    'PercentAttackSpeedMod' as PercentAttackSpeedMod,
    'rPercentAttackSpeedModPerLevel' as rPercentAttackSpeedModPerLevel,
    'rFlatDodgeMod' as rFlatDodgeMod,
    'rFlatDodgeModPerLevel' as rFlatDodgeModPerLevel,
    'PercentDodgeMod' as PercentDodgeMod,
    'FlatCritChanceMod' as FlatCritChanceMod,
    'rFlatCritChanceModPerLevel' as rFlatCritChanceModPerLevel,
    'PercentCritChanceMod' as PercentCritChanceMod,
    'FlatCritDamageMod' as FlatCritDamageMod,
    'rFlatCritDamageModPerLevel' as rFlatCritDamageModPerLevel,
    'PercentCritDamageMod' as PercentCritDamageMod,
    'FlatBlockMod' as FlatBlockMod,
    'PercentBlockMod' as PercentBlockMod,
    'FlatSpellBlockMod' as FlatSpellBlockMod,
    'rFlatSpellBlockModPerLevel' as rFlatSpellBlockModPerLevel,
    'PercentSpellBlockMod' as PercentSpellBlockMod,
    'FlatEXPBonus' as FlatEXPBonus,
    'PercentEXPBonus' as PercentEXPBonus,
    'rPercentCooldownMod' as rPercentCooldownMod,
    'rPercentCooldownModPerLevel' as rPercentCooldownModPerLevel,
    'rFlatTimeDeadMod' as rFlatTimeDeadMod,
    'rFlatTimeDeadModPerLevel' as rFlatTimeDeadModPerLevel,
    'rPercentTimeDeadMod' as rPercentTimeDeadMod,
    'rPercentTimeDeadModPerLevel' as rPercentTimeDeadModPerLevel,
    'rFlatGoldPer10Mod' as rFlatGoldPer10Mod,
    'rFlatMagicPenetrationMod' as rFlatMagicPenetrationMod,
    'rFlatMagicPenetrationModPerLevel' as rFlatMagicPenetrationModPerLevel,
    'rPercentMagicPenetrationMod' as rPercentMagicPenetrationMod,
    'rPercentMagicPenetrationModPerLevel' as rPercentMagicPenetrationModPerLevel,
    'FlatEnergyRegenMod' as FlatEnergyRegenMod,
    'rFlatEnergyRegenModPerLevel' as rFlatEnergyRegenModPerLevel,
    'FlatEnergyPoolMod' as FlatEnergyPoolMod,
    'rFlatEnergyModPerLevel' as rFlatEnergyModPerLevel,
    'PercentLifeStealMod' as PercentLifeStealMod,
    'PercentSpellVampMod' as PercentSpellVampMod
  FROM pivot_source
  pivot(max(map_exists) for map_id in ('11','12','21','22'))
  pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
)) as p2
ORDER BY item_id
)

SELECT * FROM pivoted_items
  );
20:12:11.724976 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
20:12:11.728390 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
20:12:11.728804 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
20:12:11.733362 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:12:11.741208 [debug] [Thread-7  ]: Opening a new connection, currently in state init
20:12:11.742350 [debug] [Thread-9  ]: Opening a new connection, currently in state init
20:12:11.742822 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:12:11.743330 [debug] [Thread-8  ]: Opening a new connection, currently in state init
20:12:11.744027 [debug] [Thread-10 ]: Opening a new connection, currently in state init
20:12:13.984197 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.26 seconds
20:12:13.997487 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:12:14.000945 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
20:12:14.145681 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.14 seconds
20:12:14.156153 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:12:14.160296 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
20:12:14.165061 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.43 seconds
20:12:14.186142 [debug] [Thread-3  ]: finished collecting timing info
20:12:14.190155 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
20:12:14.195920 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.45 seconds
20:12:14.202141 [debug] [Thread-10 ]: finished collecting timing info
20:12:14.202541 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
20:12:14.350266 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.63 seconds
20:12:14.352468 [debug] [Thread-2  ]: finished collecting timing info
20:12:14.353069 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
20:12:14.375538 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.21 seconds
20:12:14.393170 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:12:14.394582 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
20:12:14.424806 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776da05850>]}
20:12:14.425593 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 3.01s]
20:12:14.426828 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
20:12:14.427567 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_match_details
20:12:14.428078 [info ] [Thread-3  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
20:12:14.429194 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
20:12:14.430034 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
20:12:14.430693 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_match_details
20:12:14.434982 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
20:12:14.439640 [debug] [Thread-3  ]: finished collecting timing info
20:12:14.441275 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
20:12:14.445337 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
20:12:14.447937 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776da0ba60>]}
20:12:14.449425 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 3.02s]
20:12:14.450641 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
20:12:14.451407 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_match_info
20:12:14.452258 [info ] [Thread-10 ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
20:12:14.458695 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
20:12:14.459371 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
20:12:14.459803 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
20:12:14.460599 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
20:12:14.461400 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
20:12:14.462198 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_match_info
20:12:14.467376 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
20:12:14.474102 [debug] [Thread-10 ]: finished collecting timing info
20:12:14.474866 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_match_info
20:12:14.479377 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
20:12:14.484756 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
20:12:14.486352 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
20:12:14.487868 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
20:12:14.500302 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.1 seconds
20:12:14.542615 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
20:12:14.547232 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.83 seconds
20:12:14.549552 [debug] [Thread-1  ]: finished collecting timing info
20:12:14.550358 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
20:12:14.558973 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:12:14.561667 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
20:12:14.665351 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.1 seconds
20:12:14.666778 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:12:14.667457 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
20:12:14.691154 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776da05790>]}
20:12:14.691767 [info ] [Thread-2  ]: 2 of 14 OK created table model PUBLIC.final_items .............................. [[32mSUCCESS 1[0m in 3.28s]
20:12:14.698614 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
20:12:14.699370 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
20:12:14.705129 [info ] [Thread-2  ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
20:12:14.712605 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
20:12:14.729782 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
20:12:14.735916 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
20:12:14.740894 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
20:12:14.789191 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776da055e0>]}
20:12:14.795492 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 3.38s]
20:12:14.813101 [debug] [Thread-2  ]: finished collecting timing info
20:12:14.818970 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
20:12:14.819672 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
20:12:14.823496 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
20:12:14.830885 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
20:12:14.884744 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
20:12:14.919662 [info ] [Thread-1  ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
20:12:14.926802 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
20:12:14.942255 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
20:12:14.961180 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:12:14.979312 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
20:12:15.006597 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
20:12:15.009899 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
20:12:15.042196 [debug] [Thread-1  ]: finished collecting timing info
20:12:15.049904 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
20:12:15.071309 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
20:12:15.084544 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
20:12:15.086073 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
20:12:15.088619 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:12:15.670592 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
20:12:15.671684 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
20:12:15.672650 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
20:12:15.892772 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.22 seconds
20:12:15.896445 [debug] [Thread-4  ]: finished collecting timing info
20:12:15.897125 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
20:12:16.011611 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776da05a90>]}
20:12:16.012237 [info ] [Thread-4  ]: 4 of 14 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 4.59s]
20:12:16.013353 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
20:12:16.055318 [debug] [Thread-9  ]: Snowflake adapter: Snowflake query id: 01a4f87c-0000-f89b-0000-d9690005335a
20:12:16.055927 [debug] [Thread-9  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 67 at position 7 unexpected ''FlatHPPoolMod''.
20:12:16.056699 [debug] [Thread-9  ]: finished collecting timing info
20:12:16.057110 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
20:12:16.206915 [debug] [Thread-9  ]: Database Error in model stg_items (models/staging_datadragon/stg_items.sql)
  001003 (42000): SQL compilation error:
  syntax error line 67 at position 7 unexpected ''FlatHPPoolMod''.
  compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_items.sql
20:12:16.207732 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7748050d30>]}
20:12:16.209403 [error] [Thread-9  ]: 9 of 14 ERROR creating view model PUBLIC.stg_items ............................. [[31mERROR[0m in 4.78s]
20:12:16.210130 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
20:12:16.239652 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.5 seconds
20:12:16.241577 [debug] [Thread-8  ]: finished collecting timing info
20:12:16.242243 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
20:12:16.392797 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776d556f40>]}
20:12:16.393369 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 4.97s]
20:12:16.393941 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
20:12:16.480242 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.99 seconds
20:12:16.482053 [debug] [Thread-10 ]: finished collecting timing info
20:12:16.482508 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_match_info: Close
20:12:16.588147 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7748037130>]}
20:12:16.588726 [info ] [Thread-10 ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 2.13s]
20:12:16.589480 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_match_info
20:12:16.605811 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.14 seconds
20:12:16.607876 [debug] [Thread-3  ]: finished collecting timing info
20:12:16.608253 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_details: Close
20:12:16.613772 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.53 seconds
20:12:16.615743 [debug] [Thread-1  ]: finished collecting timing info
20:12:16.616043 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
20:12:16.623534 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 4.88 seconds
20:12:16.625847 [debug] [Thread-6  ]: finished collecting timing info
20:12:16.626195 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
20:12:16.630578 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.67 seconds
20:12:16.633030 [debug] [Thread-2  ]: finished collecting timing info
20:12:16.633473 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
20:12:16.637541 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 4.91 seconds
20:12:16.644101 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:12:16.644423 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
20:12:16.716849 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 4.98 seconds
20:12:16.718738 [debug] [Thread-7  ]: finished collecting timing info
20:12:16.719088 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
20:12:16.729103 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774803b580>]}
20:12:16.729722 [info ] [Thread-3  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 2.30s]
20:12:16.730353 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
20:12:16.742235 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776d571280>]}
20:12:16.742929 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.32s]
20:12:16.743825 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
20:12:16.750030 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776d441a30>]}
20:12:16.750969 [info ] [Thread-1  ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.81s]
20:12:16.752164 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
20:12:16.794103 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.15 seconds
20:12:16.801494 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:12:16.801821 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
20:12:16.807286 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f774054d100>]}
20:12:16.807848 [info ] [Thread-2  ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 2.09s]
20:12:16.808522 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
20:12:16.851344 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776d4962e0>]}
20:12:16.851881 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 5.43s]
20:12:16.852453 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
20:12:16.897473 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.1 seconds
20:12:16.907151 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:12:16.907995 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
20:12:17.141680 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.23 seconds
20:12:17.152166 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
20:12:17.155271 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:12:17.155799 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
20:12:17.353792 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.2 seconds
20:12:17.354356 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:12:17.354675 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
20:12:17.640791 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.29 seconds
20:12:17.641177 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
20:12:17.641362 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
20:12:17.818972 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.18 seconds
20:12:17.821495 [debug] [Thread-5  ]: finished collecting timing info
20:12:17.821905 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
20:12:17.945743 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04d066e5-be1b-40c6-8eef-b86bd3bc46c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f776da0bdf0>]}
20:12:17.946580 [info ] [Thread-5  ]: 5 of 14 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 6.52s]
20:12:17.947290 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
20:12:17.950089 [debug] [MainThread]: Acquiring new snowflake connection "master"
20:12:17.950931 [info ] [MainThread]: 
20:12:17.951458 [info ] [MainThread]: Finished running 5 table models, 7 view models, 2 incremental models in 8.13s.
20:12:17.951798 [debug] [MainThread]: Connection 'master' was properly closed.
20:12:17.952028 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
20:12:17.952219 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
20:12:17.952474 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
20:12:17.952685 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
20:12:17.952872 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
20:12:17.953097 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
20:12:17.953277 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
20:12:17.953445 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
20:12:17.953663 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
20:12:17.953825 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
20:12:17.965807 [info ] [MainThread]: 
20:12:17.966197 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
20:12:17.966794 [info ] [MainThread]: 
20:12:17.967416 [error] [MainThread]: [33mDatabase Error in model stg_items (models/staging_datadragon/stg_items.sql)[0m
20:12:17.967976 [error] [MainThread]:   001003 (42000): SQL compilation error:
20:12:17.968440 [error] [MainThread]:   syntax error line 67 at position 7 unexpected ''FlatHPPoolMod''.
20:12:17.969023 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/staging_datadragon/stg_items.sql
20:12:17.969594 [info ] [MainThread]: 
20:12:17.970042 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
20:12:17.970757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777699ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f777699e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77783a63d0>]}


============================== 2022-06-15 21:28:00.129908 | a2777c0d-34f1-4833-833e-cb78aadbd006 ==============================
21:28:00.129940 [info ] [MainThread]: Running with dbt=1.1.0
21:28:00.130838 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:28:00.131220 [debug] [MainThread]: Tracking: tracking
21:28:00.132013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda300dc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda300dc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda300dc940>]}
21:28:00.234276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
21:28:00.235460 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_items.sql
21:28:00.236176 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
21:28:00.268155 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_items.sql
21:28:00.285059 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
21:28:00.342157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5d34bbe0>]}
21:28:00.360756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5e86b880>]}
21:28:00.361506 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
21:28:00.362388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5e86b9d0>]}
21:28:00.367245 [info ] [MainThread]: 
21:28:00.368481 [debug] [MainThread]: Acquiring new snowflake connection "master"
21:28:00.370683 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
21:28:00.389597 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
21:28:00.389881 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
21:28:00.390060 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:28:01.201987 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.81 seconds
21:28:01.204550 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
21:28:01.320475 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
21:28:01.331697 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
21:28:01.332360 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
21:28:01.332630 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:28:02.029674 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 0.7 seconds
21:28:02.034419 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
21:28:02.191749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda300f8df0>]}
21:28:02.193271 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
21:28:02.194462 [info ] [MainThread]: 
21:28:02.218282 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
21:28:02.218816 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
21:28:02.219396 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
21:28:02.219899 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
21:28:02.220530 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
21:28:02.223724 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
21:28:02.224141 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
21:28:02.224688 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
21:28:02.225204 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
21:28:02.225987 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
21:28:02.226571 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
21:28:02.227465 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
21:28:02.227895 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
21:28:02.229005 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
21:28:02.230075 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
21:28:02.231117 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
21:28:02.231619 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
21:28:02.232151 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
21:28:02.232777 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
21:28:02.233504 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
21:28:02.234361 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
21:28:02.235605 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
21:28:02.236248 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
21:28:02.236755 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
21:28:02.237665 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:28:02.238066 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
21:28:02.238958 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:28:02.240199 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
21:28:02.241291 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
21:28:02.241971 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
21:28:02.243518 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
21:28:02.244357 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
21:28:02.245730 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
21:28:02.246986 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
21:28:02.247442 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
21:28:02.247914 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
21:28:02.248298 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
21:28:02.248676 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
21:28:02.249001 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
21:28:02.253244 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
21:28:02.253871 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
21:28:02.254300 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
21:28:02.254722 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
21:28:02.255167 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
21:28:02.255695 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
21:28:02.259528 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
21:28:02.259984 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
21:28:02.260297 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
21:28:02.260636 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
21:28:02.261363 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
21:28:02.266180 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
21:28:02.266634 [debug] [Thread-1  ]: finished collecting timing info
21:28:02.267330 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
21:28:02.267931 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
21:28:02.284755 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
21:28:02.294245 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
21:28:02.290371 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
21:28:02.294740 [debug] [Thread-2  ]: finished collecting timing info
21:28:02.298692 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
21:28:02.303679 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
21:28:02.304564 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
21:28:02.401227 [debug] [Thread-3  ]: finished collecting timing info
21:28:02.406234 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
21:28:02.410709 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
21:28:02.412192 [debug] [Thread-4  ]: finished collecting timing info
21:28:02.413580 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
21:28:02.414354 [debug] [Thread-6  ]: finished collecting timing info
21:28:02.415406 [debug] [Thread-5  ]: finished collecting timing info
21:28:02.415829 [debug] [Thread-7  ]: finished collecting timing info
21:28:02.426881 [debug] [Thread-8  ]: finished collecting timing info
21:28:02.438653 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
21:28:02.450659 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
21:28:02.452030 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
21:28:02.452590 [debug] [Thread-10 ]: finished collecting timing info
21:28:02.455930 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
21:28:02.456349 [debug] [Thread-9  ]: finished collecting timing info
21:28:02.457008 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
21:28:02.457494 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
21:28:02.457920 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
21:28:02.458209 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
21:28:02.461746 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
21:28:02.474014 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
21:28:02.480779 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
21:28:02.503246 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:28:02.503787 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
21:28:02.507161 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
21:28:02.510425 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
21:28:02.517557 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:28:02.522040 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
21:28:02.533674 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
21:28:02.545909 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
21:28:02.562696 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
21:28:02.556918 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
21:28:02.565671 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
21:28:02.571007 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
21:28:02.571608 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        SummonersRift,
        HowlingAbyss,
        NexusBlitz,
        TeamfightTactics,
        FlatHPPoolMod,
        rFlatHPModPerLevel,
        FlatMPPoolMod,
        rFlatMPModPerLevel,
        PercentHPPoolMod,
        PercentMPPoolMod,
        FlatHPRegenMod,
        rFlatHPRegenModPerLevel,
        PercentHPRegenMod,
        FlatMPRegenMod,
        rFlatMPRegenModPerLevel,
        PercentMPRegenMod,
        FlatArmorMod,
        rFlatArmorModPerLevel,
        PercentArmorMod,
        rFlatArmorPenetrationMod,
        rFlatArmorPenetrationModPerLevel,
        rPercentArmorPenetrationMod,
        rPercentArmorPenetrationModPerLevel,
        FlatPhysicalDamageMod,
        rFlatPhysicalDamageModPerLevel,
        PercentPhysicalDamageMod,
        FlatMagicDamageMod,
        rFlatMagicDamageModPerLevel,
        PercentMagicDamageMod,
        FlatMovementSpeedMod,
        rFlatMovementSpeedModPerLevel,
        PercentMovementSpeedMod,
        rPercentMovementSpeedModPerLevel,
        FlatAttackSpeedMod,
        PercentAttackSpeedMod,
        rPercentAttackSpeedModPerLevel,
        rFlatDodgeMod,
        rFlatDodgeModPerLevel,
        PercentDodgeMod,
        FlatCritChanceMod,
        rFlatCritChanceModPerLevel,
        PercentCritChanceMod,
        FlatCritDamageMod,
        rFlatCritDamageModPerLevel,
        PercentCritDamageMod,
        FlatBlockMod,
        PercentBlockMod,
        FlatSpellBlockMod,
        rFlatSpellBlockModPerLevel,
        PercentSpellBlockMod,
        FlatEXPBonus,
        PercentEXPBonus,
        rPercentCooldownMod,
        rPercentCooldownModPerLevel,
        rFlatTimeDeadMod,
        rFlatTimeDeadModPerLevel,
        rPercentTimeDeadMod,
        rPercentTimeDeadModPerLevel,
        rFlatGoldPer10Mod,
        rFlatMagicPenetrationMod,
        rFlatMagicPenetrationModPerLevel,
        rPercentMagicPenetrationMod,
        rPercentMagicPenetrationModPerLevel,
        FlatEnergyRegenMod,
        rFlatEnergyRegenModPerLevel,
        FlatEnergyPoolMod,
        rFlatEnergyModPerLevel,
        PercentLifeStealMod,
        PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
21:28:02.572181 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
21:28:02.572969 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:28:02.574489 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
21:28:02.575007 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
21:28:02.575969 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
21:28:02.576692 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:28:02.581560 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
21:28:02.582524 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:28:02.584472 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
21:28:02.585029 [debug] [Thread-5  ]: Opening a new connection, currently in state init
21:28:02.591243 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
21:28:02.592874 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
21:28:02.596380 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:28:02.597033 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
21:28:02.600839 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
21:28:02.606033 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
21:28:02.612075 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
  SELECT
    *
  FROM pivot_source
  pivot(max(map_exists) for map_id in ('11','12','21','22'))
  pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
)) as node2 (
  item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  SummonersRift,
  HowlingAbyss,
  NexusBlitz,
  TeamfightTactics,
  FlatHPPoolMod,
  rFlatHPModPerLevel,
  FlatMPPoolMod,
  rFlatMPModPerLevel,
  PercentHPPoolMod,
  PercentMPPoolMod,
  FlatHPRegenMod,
  rFlatHPRegenModPerLevel,
  PercentHPRegenMod,
  FlatMPRegenMod,
  rFlatMPRegenModPerLevel,
  PercentMPRegenMod,
  FlatArmorMod,
  rFlatArmorModPerLevel,
  PercentArmorMod,
  rFlatArmorPenetrationMod,
  rFlatArmorPenetrationModPerLevel,
  rPercentArmorPenetrationMod,
  rPercentArmorPenetrationModPerLevel,
  FlatPhysicalDamageMod,
  rFlatPhysicalDamageModPerLevel,
  PercentPhysicalDamageMod,
  FlatMagicDamageMod,
  rFlatMagicDamageModPerLevel,
  PercentMagicDamageMod,
  FlatMovementSpeedMod,
  rFlatMovementSpeedModPerLevel,
  PercentMovementSpeedMod,
  rPercentMovementSpeedModPerLevel,
  FlatAttackSpeedMod,
  PercentAttackSpeedMod,
  rPercentAttackSpeedModPerLevel,
  rFlatDodgeMod,
  rFlatDodgeModPerLevel,
  PercentDodgeMod,
  FlatCritChanceMod,
  rFlatCritChanceModPerLevel,
  PercentCritChanceMod,
  FlatCritDamageMod,
  rFlatCritDamageModPerLevel,
  PercentCritDamageMod,
  FlatBlockMod,
  PercentBlockMod,
  FlatSpellBlockMod,
  rFlatSpellBlockModPerLevel,
  PercentSpellBlockMod,
  FlatEXPBonus,
  PercentEXPBonus,
  rPercentCooldownMod,
  rPercentCooldownModPerLevel,
  rFlatTimeDeadMod,
  rFlatTimeDeadModPerLevel,
  rPercentTimeDeadMod,
  rPercentTimeDeadModPerLevel,
  rFlatGoldPer10Mod,
  rFlatMagicPenetrationMod,
  rFlatMagicPenetrationModPerLevel,
  rPercentMagicPenetrationMod,
  rPercentMagicPenetrationModPerLevel,
  FlatEnergyRegenMod,
  rFlatEnergyRegenModPerLevel,
  FlatEnergyPoolMod,
  rFlatEnergyModPerLevel,
  PercentLifeStealMod,
  PercentSpellVampMod
)
)

SELECT * FROM pivoted_items
  );
21:28:02.615283 [debug] [Thread-6  ]: Opening a new connection, currently in state init
21:28:02.619452 [debug] [Thread-7  ]: Opening a new connection, currently in state init
21:28:02.623279 [debug] [Thread-8  ]: Opening a new connection, currently in state init
21:28:02.624119 [debug] [Thread-10 ]: Opening a new connection, currently in state init
21:28:02.625052 [debug] [Thread-9  ]: Opening a new connection, currently in state init
21:28:04.988839 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.4 seconds
21:28:05.010903 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:28:05.011805 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
21:28:05.304546 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.29 seconds
21:28:05.327096 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:28:05.327790 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
21:28:05.588055 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.26 seconds
21:28:05.604866 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:28:05.606215 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
21:28:05.750959 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.14 seconds
21:28:05.788266 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
21:28:05.795242 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:28:05.796168 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
21:28:05.937834 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.14 seconds
21:28:05.939139 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:28:05.940381 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
21:28:06.011268 [debug] [Thread-2  ]: Snowflake adapter: Snowflake query id: 01a4f8c8-0000-f89b-0000-d96900053656
21:28:06.012607 [debug] [Thread-2  ]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 8
invalid identifier 'NAME'
21:28:06.014093 [debug] [Thread-2  ]: finished collecting timing info
21:28:06.015773 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
21:28:06.149907 [debug] [Thread-2  ]: Database Error in model final_items (models/warehouse/final_items.sql)
  000904 (42000): SQL compilation error: error line 10 at position 8
  invalid identifier 'NAME'
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
21:28:06.151481 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda51943a90>]}
21:28:06.152294 [error] [Thread-2  ]: 2 of 14 ERROR creating table model PUBLIC.final_items .......................... [[31mERROR[0m in 3.92s]
21:28:06.156505 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
21:28:06.157382 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_match_details
21:28:06.160936 [info ] [Thread-2  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
21:28:06.162564 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
21:28:06.163324 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
21:28:06.165233 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_match_details
21:28:06.171740 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
21:28:06.175107 [debug] [Thread-2  ]: finished collecting timing info
21:28:06.175964 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
21:28:06.181421 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
21:28:06.197351 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
21:28:06.199097 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
21:28:06.202534 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
21:28:06.537909 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.6 seconds
21:28:06.539026 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:28:06.540429 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
21:28:06.757493 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.22 seconds
21:28:06.775919 [debug] [Thread-5  ]: finished collecting timing info
21:28:06.776528 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
21:28:06.945316 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda53f0b250>]}
21:28:06.946055 [info ] [Thread-5  ]: 5 of 14 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 4.71s]
21:28:06.947374 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 4.32 seconds
21:28:06.948123 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
21:28:06.950863 [debug] [Thread-10 ]: finished collecting timing info
21:28:06.951564 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_match_info
21:28:06.952086 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
21:28:06.952483 [info ] [Thread-5  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
21:28:06.957109 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
21:28:06.958020 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
21:28:06.958836 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_match_info
21:28:06.963905 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
21:28:06.964505 [debug] [Thread-5  ]: finished collecting timing info
21:28:06.964957 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
21:28:06.968651 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
21:28:06.970155 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
21:28:06.970499 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
21:28:06.970733 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
21:28:07.015301 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.39 seconds
21:28:07.017565 [debug] [Thread-8  ]: finished collecting timing info
21:28:07.018399 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
21:28:07.072164 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 4.45 seconds
21:28:07.075266 [debug] [Thread-9  ]: finished collecting timing info
21:28:07.075848 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
21:28:07.196068 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda53e79430>]}
21:28:07.196647 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 4.95s]
21:28:07.197373 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
21:28:07.197936 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
21:28:07.199075 [info ] [Thread-10 ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
21:28:07.200157 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
21:28:07.200633 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
21:28:07.201079 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
21:28:07.206541 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
21:28:07.207958 [debug] [Thread-10 ]: finished collecting timing info
21:28:07.208554 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
21:28:07.218455 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
21:28:07.253114 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
21:28:07.255492 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5d30f700>]}
21:28:07.256088 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
21:28:07.274296 [info ] [Thread-9  ]: 9 of 14 OK created view model PUBLIC.stg_items ................................. [[32mSUCCESS 1[0m in 5.01s]
21:28:07.284945 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5d195a90>]}
21:28:07.323244 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 4.75 seconds
21:28:07.323778 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
21:28:07.339334 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.14 seconds
21:28:07.345557 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
21:28:07.362010 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 5.04s]
21:28:07.374458 [debug] [Thread-1  ]: finished collecting timing info
21:28:07.401044 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 4.78 seconds
21:28:07.411255 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 4.83 seconds
21:28:07.433865 [debug] [Thread-2  ]: finished collecting timing info
21:28:07.442114 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
21:28:07.444892 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
21:28:07.446686 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
21:28:07.457592 [debug] [Thread-7  ]: finished collecting timing info
21:28:07.463893 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_details: Close
21:28:07.464597 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:28:07.465308 [info ] [Thread-9  ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
21:28:07.471690 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
21:28:07.475862 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
21:28:07.478635 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
21:28:07.487476 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
21:28:07.488570 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
21:28:07.493586 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
21:28:07.496582 [debug] [Thread-9  ]: finished collecting timing info
21:28:07.497422 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
21:28:07.503339 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
21:28:07.506951 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
21:28:07.507475 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
21:28:07.507908 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
21:28:07.624200 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.14 seconds
21:28:07.637131 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:28:07.637986 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
21:28:07.646627 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda53f0b2e0>]}
21:28:07.647647 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 5.42s]
21:28:07.651373 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
21:28:07.653935 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5184f520>]}
21:28:07.656047 [info ] [Thread-2  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 1.49s]
21:28:07.658111 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
21:28:07.725643 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda53e797f0>]}
21:28:07.745599 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 5.48s]
21:28:07.759765 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
21:28:07.767320 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.13 seconds
21:28:07.829612 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:28:07.830667 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 5.23 seconds
21:28:07.853151 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
21:28:07.880821 [debug] [Thread-3  ]: finished collecting timing info
21:28:07.900679 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 5.29 seconds
21:28:07.945940 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
21:28:07.987756 [debug] [Thread-6  ]: finished collecting timing info
21:28:08.026673 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
21:28:08.031197 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 1.06 seconds
21:28:08.039562 [debug] [Thread-5  ]: finished collecting timing info
21:28:08.040547 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_match_info: Close
21:28:08.079086 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.16 seconds
21:28:08.099695 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
21:28:08.120168 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:28:08.126116 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
21:28:08.242030 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5e8a9100>]}
21:28:08.242918 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 6.01s]
21:28:08.244044 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
21:28:08.304178 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.17 seconds
21:28:08.306573 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:28:08.307374 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
21:28:08.320056 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda517c5850>]}
21:28:08.320980 [info ] [Thread-5  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.36s]
21:28:08.322130 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
21:28:08.370079 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda30088bb0>]}
21:28:08.371023 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 6.13s]
21:28:08.371955 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
21:28:08.750478 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.43 seconds
21:28:08.752181 [debug] [Thread-10 ]: finished collecting timing info
21:28:08.752471 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
21:28:08.815865 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 1.31 seconds
21:28:08.817828 [debug] [Thread-9  ]: finished collecting timing info
21:28:08.818232 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
21:28:08.931728 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda518e8e80>]}
21:28:08.932703 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda517442e0>]}
21:28:08.933242 [info ] [Thread-10 ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.73s]
21:28:08.933817 [info ] [Thread-9  ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.45s]
21:28:08.934500 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
21:28:08.935867 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
21:28:09.498587 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.19 seconds
21:28:09.498938 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:28:09.499185 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
21:28:09.698725 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.2 seconds
21:28:09.701336 [debug] [Thread-4  ]: finished collecting timing info
21:28:09.701693 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
21:28:09.824069 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2777c0d-34f1-4833-833e-cb78aadbd006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda518e8b20>]}
21:28:09.824666 [info ] [Thread-4  ]: 4 of 14 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 7.59s]
21:28:09.825383 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
21:28:09.827925 [debug] [MainThread]: Acquiring new snowflake connection "master"
21:28:09.828761 [info ] [MainThread]: 
21:28:09.829149 [info ] [MainThread]: Finished running 5 table models, 2 incremental models, 7 view models in 9.46s.
21:28:09.829509 [debug] [MainThread]: Connection 'master' was properly closed.
21:28:09.829680 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_champions' was properly closed.
21:28:09.829959 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
21:28:09.830143 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_maps' was properly closed.
21:28:09.830348 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
21:28:09.830520 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
21:28:09.830736 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
21:28:09.831009 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
21:28:09.831184 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
21:28:09.831344 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
21:28:09.831641 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
21:28:09.844515 [info ] [MainThread]: 
21:28:09.845094 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
21:28:09.845617 [info ] [MainThread]: 
21:28:09.846185 [error] [MainThread]: [33mDatabase Error in model final_items (models/warehouse/final_items.sql)[0m
21:28:09.846662 [error] [MainThread]:   000904 (42000): SQL compilation error: error line 10 at position 8
21:28:09.847036 [error] [MainThread]:   invalid identifier 'NAME'
21:28:09.847437 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_items.sql
21:28:09.847832 [info ] [MainThread]: 
21:28:09.848347 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
21:28:09.848867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5e7d3970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5e7d3a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda5e7d39a0>]}


============================== 2022-06-15 21:32:46.799662 | 4d02b475-7fe4-4067-b41e-0294d129ac86 ==============================
21:32:46.799684 [info ] [MainThread]: Running with dbt=1.1.0
21:32:46.800237 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
21:32:46.800888 [debug] [MainThread]: Tracking: tracking
21:32:46.801952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee202f4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee202f48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee202f4940>]}
21:32:46.865179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
21:32:46.865512 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
21:32:46.874286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee506164c0>]}
21:32:46.889567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee507e5760>]}
21:32:46.889979 [info ] [MainThread]: Found 14 models, 28 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 14 sources, 0 exposures, 0 metrics
21:32:46.890311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee50688190>]}
21:32:46.894022 [info ] [MainThread]: 
21:32:46.894743 [debug] [MainThread]: Acquiring new snowflake connection "master"
21:32:46.896533 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
21:32:46.914927 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
21:32:46.915328 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
21:32:46.915525 [debug] [ThreadPool]: Opening a new connection, currently in state init
21:32:47.769818 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.85 seconds
21:32:47.772036 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
21:32:47.884863 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
21:32:47.893971 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
21:32:47.894255 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
21:32:47.894429 [debug] [ThreadPool]: Opening a new connection, currently in state closed
21:32:48.415372 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 0.52 seconds
21:32:48.417572 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
21:32:48.596567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee5061f340>]}
21:32:48.597217 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
21:32:48.597613 [info ] [MainThread]: 
21:32:48.617243 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
21:32:48.617678 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
21:32:48.618161 [info ] [Thread-1  ]: 1 of 14 START table model PUBLIC.final_champions ............................... [RUN]
21:32:48.618675 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
21:32:48.619251 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
21:32:48.620085 [info ] [Thread-2  ]: 2 of 14 START table model PUBLIC.final_items ................................... [RUN]
21:32:48.620548 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
21:32:48.621085 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
21:32:48.621391 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
21:32:48.621960 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_champions
21:32:48.622708 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
21:32:48.622999 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_items
21:32:48.623368 [info ] [Thread-3  ]: 3 of 14 START table model PUBLIC.final_maps .................................... [RUN]
21:32:48.623586 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_maps
21:32:48.624146 [info ] [Thread-4  ]: 4 of 14 START incremental model PUBLIC.final_match_details ..................... [RUN]
21:32:48.624952 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
21:32:48.625390 [info ] [Thread-5  ]: 5 of 14 START incremental model PUBLIC.final_match_info ........................ [RUN]
21:32:48.625810 [info ] [Thread-6  ]: 6 of 14 START table model PUBLIC.final_runes_reforged .......................... [RUN]
21:32:48.626154 [info ] [Thread-7  ]: 7 of 14 START table model PUBLIC.final_summonerspells .......................... [RUN]
21:32:48.626605 [info ] [Thread-8  ]: 8 of 14 START view model PUBLIC.stg_champions .................................. [RUN]
21:32:48.627030 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
21:32:48.627621 [info ] [Thread-9  ]: 9 of 14 START view model PUBLIC.stg_items ...................................... [RUN]
21:32:48.628454 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
21:32:48.628855 [info ] [Thread-10 ]: 10 of 14 START view model PUBLIC.stg_maps ...................................... [RUN]
21:32:48.629929 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:32:48.630473 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
21:32:48.631465 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:32:48.632487 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
21:32:48.633404 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
21:32:48.634385 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
21:32:48.635065 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
21:32:48.635855 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
21:32:48.636263 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
21:32:48.637259 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
21:32:48.637522 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
21:32:48.637931 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
21:32:48.638233 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
21:32:48.638497 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
21:32:48.638801 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
21:32:48.642598 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
21:32:48.643019 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
21:32:48.643347 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_items
21:32:48.643680 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
21:32:48.643930 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_maps
21:32:48.644229 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
21:32:48.647753 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
21:32:48.649102 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
21:32:48.649493 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
21:32:48.649806 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
21:32:48.650380 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_champions
21:32:48.650850 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_items
21:32:48.651091 [debug] [Thread-1  ]: finished collecting timing info
21:32:48.655444 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
21:32:48.656018 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_maps
21:32:48.668455 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
21:32:48.674117 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
21:32:48.674680 [debug] [Thread-2  ]: finished collecting timing info
21:32:48.678505 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
21:32:48.683865 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
21:32:48.687631 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
21:32:48.692414 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
21:32:48.692900 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
21:32:48.696621 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
21:32:48.698013 [debug] [Thread-3  ]: finished collecting timing info
21:32:48.698726 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
21:32:48.699341 [debug] [Thread-5  ]: finished collecting timing info
21:32:48.699665 [debug] [Thread-4  ]: finished collecting timing info
21:32:48.701710 [debug] [Thread-6  ]: finished collecting timing info
21:32:48.712616 [debug] [Thread-8  ]: finished collecting timing info
21:32:48.718447 [debug] [Thread-7  ]: finished collecting timing info
21:32:48.735141 [debug] [Thread-9  ]: finished collecting timing info
21:32:48.735690 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
21:32:48.736156 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
21:32:48.736446 [debug] [Thread-10 ]: finished collecting timing info
21:32:48.740594 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
21:32:48.741008 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
21:32:48.741307 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
21:32:48.741697 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
21:32:48.742081 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_champions
21:32:48.742330 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
21:32:48.742778 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_items
21:32:48.747610 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
21:32:48.748294 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_maps
21:32:48.750165 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
21:32:48.764052 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
21:32:48.785252 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
21:32:48.901747 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:32:48.904854 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
21:32:48.930025 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
21:32:48.932423 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
21:32:48.940828 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:32:48.944931 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
21:32:48.945385 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
21:32:48.946582 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
21:32:48.947902 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        SummonersRift,
        HowlingAbyss,
        NexusBlitz,
        TeamfightTactics,
        FlatHPPoolMod,
        rFlatHPModPerLevel,
        FlatMPPoolMod,
        rFlatMPModPerLevel,
        PercentHPPoolMod,
        PercentMPPoolMod,
        FlatHPRegenMod,
        rFlatHPRegenModPerLevel,
        PercentHPRegenMod,
        FlatMPRegenMod,
        rFlatMPRegenModPerLevel,
        PercentMPRegenMod,
        FlatArmorMod,
        rFlatArmorModPerLevel,
        PercentArmorMod,
        rFlatArmorPenetrationMod,
        rFlatArmorPenetrationModPerLevel,
        rPercentArmorPenetrationMod,
        rPercentArmorPenetrationModPerLevel,
        FlatPhysicalDamageMod,
        rFlatPhysicalDamageModPerLevel,
        PercentPhysicalDamageMod,
        FlatMagicDamageMod,
        rFlatMagicDamageModPerLevel,
        PercentMagicDamageMod,
        FlatMovementSpeedMod,
        rFlatMovementSpeedModPerLevel,
        PercentMovementSpeedMod,
        rPercentMovementSpeedModPerLevel,
        FlatAttackSpeedMod,
        PercentAttackSpeedMod,
        rPercentAttackSpeedModPerLevel,
        rFlatDodgeMod,
        rFlatDodgeModPerLevel,
        PercentDodgeMod,
        FlatCritChanceMod,
        rFlatCritChanceModPerLevel,
        PercentCritChanceMod,
        FlatCritDamageMod,
        rFlatCritDamageModPerLevel,
        PercentCritDamageMod,
        FlatBlockMod,
        PercentBlockMod,
        FlatSpellBlockMod,
        rFlatSpellBlockModPerLevel,
        PercentSpellBlockMod,
        FlatEXPBonus,
        PercentEXPBonus,
        rPercentCooldownMod,
        rPercentCooldownModPerLevel,
        rFlatTimeDeadMod,
        rFlatTimeDeadModPerLevel,
        rPercentTimeDeadMod,
        rPercentTimeDeadModPerLevel,
        rFlatGoldPer10Mod,
        rFlatMagicPenetrationMod,
        rFlatMagicPenetrationModPerLevel,
        rPercentMagicPenetrationMod,
        rPercentMagicPenetrationModPerLevel,
        FlatEnergyRegenMod,
        rFlatEnergyRegenModPerLevel,
        FlatEnergyPoolMod,
        rFlatEnergyModPerLevel,
        PercentLifeStealMod,
        PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
21:32:48.948992 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
21:32:48.950177 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
21:32:48.952227 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
21:32:48.952684 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
21:32:48.958098 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
21:32:48.960578 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
21:32:48.961110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:32:48.961634 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
21:32:48.962488 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
21:32:48.962756 [debug] [Thread-2  ]: Opening a new connection, currently in state init
21:32:48.963240 [debug] [Thread-5  ]: Opening a new connection, currently in state init
21:32:48.963515 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
21:32:48.963769 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
21:32:48.964100 [debug] [Thread-4  ]: Opening a new connection, currently in state init
21:32:48.964544 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
  SELECT
    *
  FROM pivot_source
  pivot(max(map_exists) for map_id in ('11','12','21','22'))
  pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
)) as node2 (
  item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  SummonersRift,
  HowlingAbyss,
  NexusBlitz,
  TeamfightTactics,
  FlatHPPoolMod,
  rFlatHPModPerLevel,
  FlatMPPoolMod,
  rFlatMPModPerLevel,
  PercentHPPoolMod,
  PercentMPPoolMod,
  FlatHPRegenMod,
  rFlatHPRegenModPerLevel,
  PercentHPRegenMod,
  FlatMPRegenMod,
  rFlatMPRegenModPerLevel,
  PercentMPRegenMod,
  FlatArmorMod,
  rFlatArmorModPerLevel,
  PercentArmorMod,
  rFlatArmorPenetrationMod,
  rFlatArmorPenetrationModPerLevel,
  rPercentArmorPenetrationMod,
  rPercentArmorPenetrationModPerLevel,
  FlatPhysicalDamageMod,
  rFlatPhysicalDamageModPerLevel,
  PercentPhysicalDamageMod,
  FlatMagicDamageMod,
  rFlatMagicDamageModPerLevel,
  PercentMagicDamageMod,
  FlatMovementSpeedMod,
  rFlatMovementSpeedModPerLevel,
  PercentMovementSpeedMod,
  rPercentMovementSpeedModPerLevel,
  FlatAttackSpeedMod,
  PercentAttackSpeedMod,
  rPercentAttackSpeedModPerLevel,
  rFlatDodgeMod,
  rFlatDodgeModPerLevel,
  PercentDodgeMod,
  FlatCritChanceMod,
  rFlatCritChanceModPerLevel,
  PercentCritChanceMod,
  FlatCritDamageMod,
  rFlatCritDamageModPerLevel,
  PercentCritDamageMod,
  FlatBlockMod,
  PercentBlockMod,
  FlatSpellBlockMod,
  rFlatSpellBlockModPerLevel,
  PercentSpellBlockMod,
  FlatEXPBonus,
  PercentEXPBonus,
  rPercentCooldownMod,
  rPercentCooldownModPerLevel,
  rFlatTimeDeadMod,
  rFlatTimeDeadModPerLevel,
  rPercentTimeDeadMod,
  rPercentTimeDeadModPerLevel,
  rFlatGoldPer10Mod,
  rFlatMagicPenetrationMod,
  rFlatMagicPenetrationModPerLevel,
  rPercentMagicPenetrationMod,
  rPercentMagicPenetrationModPerLevel,
  FlatEnergyRegenMod,
  rFlatEnergyRegenModPerLevel,
  FlatEnergyPoolMod,
  rFlatEnergyModPerLevel,
  PercentLifeStealMod,
  PercentSpellVampMod
)
)

SELECT * FROM pivoted_items
  );
21:32:48.964899 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
21:32:48.969442 [debug] [Thread-3  ]: Opening a new connection, currently in state init
21:32:48.970530 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
21:32:48.978472 [debug] [Thread-6  ]: Opening a new connection, currently in state init
21:32:48.979318 [debug] [Thread-7  ]: Opening a new connection, currently in state init
21:32:48.985039 [debug] [Thread-9  ]: Opening a new connection, currently in state init
21:32:48.985775 [debug] [Thread-8  ]: Opening a new connection, currently in state init
21:32:48.987507 [debug] [Thread-10 ]: Opening a new connection, currently in state init
21:32:50.541288 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.58 seconds
21:32:50.555012 [debug] [Thread-1  ]: finished collecting timing info
21:32:50.555496 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
21:32:50.690291 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4ffcb3a0>]}
21:32:50.692078 [info ] [Thread-1  ]: 1 of 14 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 2.07s]
21:32:50.701144 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
21:32:50.702708 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_match_details
21:32:50.705700 [info ] [Thread-1  ]: 11 of 14 START view model PUBLIC.stg_match_details ............................. [RUN]
21:32:50.708310 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
21:32:50.709932 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
21:32:50.710773 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_match_details
21:32:50.722181 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
21:32:50.730417 [debug] [Thread-1  ]: finished collecting timing info
21:32:50.731560 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
21:32:50.736634 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
21:32:50.756380 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
21:32:50.757174 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
21:32:50.761399 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
21:32:51.656624 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.69 seconds
21:32:51.679895 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:32:51.691209 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
21:32:51.848870 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.12 seconds
21:32:51.857560 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:32:51.858428 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
21:32:51.967253 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.11 seconds
21:32:51.979481 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:32:51.980178 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
21:32:52.060767 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.08 seconds
21:32:52.093717 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
21:32:52.099047 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:32:52.099668 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
21:32:52.228903 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.13 seconds
21:32:52.229908 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:32:52.230520 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
21:32:52.237792 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.27 seconds
21:32:52.241237 [debug] [Thread-3  ]: finished collecting timing info
21:32:52.242021 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
21:32:52.295622 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.33 seconds
21:32:52.300303 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:32:52.301860 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
21:32:52.406918 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4ffcb5e0>]}
21:32:52.408243 [info ] [Thread-3  ]: 3 of 14 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 3.78s]
21:32:52.411063 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
21:32:52.411914 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_match_info
21:32:52.414004 [info ] [Thread-3  ]: 12 of 14 START view model PUBLIC.stg_match_info ................................ [RUN]
21:32:52.417154 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
21:32:52.418074 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
21:32:52.420651 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_match_info
21:32:52.422735 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.11 seconds
21:32:52.426694 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
21:32:52.439206 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:32:52.441727 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
21:32:52.444126 [debug] [Thread-3  ]: finished collecting timing info
21:32:52.445177 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
21:32:52.449857 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
21:32:52.458860 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
21:32:52.459578 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
21:32:52.461193 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
21:32:52.594888 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.15 seconds
21:32:52.608821 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:32:52.609553 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
21:32:52.698607 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.47 seconds
21:32:52.705425 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
21:32:52.707401 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
21:32:52.726805 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.12 seconds
21:32:52.750038 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
21:32:52.779867 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:32:52.797756 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
21:32:52.904602 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.11 seconds
21:32:52.907346 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:32:52.908740 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
21:32:52.950269 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.22 seconds
21:32:52.952937 [debug] [Thread-5  ]: finished collecting timing info
21:32:52.955048 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
21:32:53.095458 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4ffcba60>]}
21:32:53.096255 [info ] [Thread-5  ]: 5 of 14 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 4.46s]
21:32:53.097330 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
21:32:53.097838 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
21:32:53.098596 [info ] [Thread-5  ]: 13 of 14 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
21:32:53.099848 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
21:32:53.100905 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
21:32:53.101519 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
21:32:53.107420 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
21:32:53.109899 [debug] [Thread-5  ]: finished collecting timing info
21:32:53.111758 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
21:32:53.117621 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
21:32:53.120428 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
21:32:53.120966 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
21:32:53.121470 [debug] [Thread-5  ]: Opening a new connection, currently in state closed
21:32:53.240964 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 4.25 seconds
21:32:53.243109 [debug] [Thread-10 ]: finished collecting timing info
21:32:53.243387 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_maps: Close
21:32:53.353891 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 4.37 seconds
21:32:53.361486 [debug] [Thread-8  ]: finished collecting timing info
21:32:53.367056 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_champions: Close
21:32:53.411641 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 0.95 seconds
21:32:53.424197 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4ffd5820>]}
21:32:53.425802 [debug] [Thread-3  ]: finished collecting timing info
21:32:53.437715 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 4.45 seconds
21:32:53.438298 [info ] [Thread-10 ]: 10 of 14 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 4.79s]
21:32:53.441395 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_info: Close
21:32:53.443527 [debug] [Thread-9  ]: finished collecting timing info
21:32:53.453879 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_maps
21:32:53.455610 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_items: Close
21:32:53.456359 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.69 seconds
21:32:53.457291 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
21:32:53.463624 [debug] [Thread-1  ]: finished collecting timing info
21:32:53.466049 [info ] [Thread-10 ]: 14 of 14 START view model PUBLIC.stg_summonerspells ............................ [RUN]
21:32:53.467273 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_match_details: Close
21:32:53.469818 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
21:32:53.475817 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
21:32:53.476679 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
21:32:53.481166 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
21:32:53.483633 [debug] [Thread-10 ]: finished collecting timing info
21:32:53.484043 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
21:32:53.489277 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
21:32:53.491644 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
21:32:53.492232 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
21:32:53.492544 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
21:32:53.530095 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee53db6220>]}
21:32:53.531802 [info ] [Thread-8  ]: 8 of 14 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 4.90s]
21:32:53.533781 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_champions
21:32:53.611036 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 4.63 seconds
21:32:53.613015 [debug] [Thread-7  ]: finished collecting timing info
21:32:53.613374 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
21:32:53.682335 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.72 seconds
21:32:53.685852 [debug] [Thread-2  ]: finished collecting timing info
21:32:53.686702 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
21:32:53.723264 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4fa431f0>]}
21:32:53.723785 [info ] [Thread-1  ]: 11 of 14 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 3.02s]
21:32:53.724342 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
21:32:53.741562 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4f944790>]}
21:32:53.742414 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4f9021f0>]}
21:32:53.742946 [info ] [Thread-9  ]: 9 of 14 OK created view model PUBLIC.stg_items ................................. [[32mSUCCESS 1[0m in 5.11s]
21:32:53.743487 [info ] [Thread-3  ]: 12 of 14 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.33s]
21:32:53.744191 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_items
21:32:53.744875 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
21:32:53.764894 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4f90fcd0>]}
21:32:53.765443 [info ] [Thread-7  ]: 7 of 14 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 5.13s]
21:32:53.766030 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
21:32:53.821237 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee500f6460>]}
21:32:53.826998 [info ] [Thread-2  ]: 2 of 14 OK created table model PUBLIC.final_items .............................. [[32mSUCCESS 1[0m in 5.20s]
21:32:53.838227 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
21:32:53.887012 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.77 seconds
21:32:53.894388 [debug] [Thread-5  ]: finished collecting timing info
21:32:53.899998 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
21:32:54.071684 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2034de50>]}
21:32:54.072415 [info ] [Thread-5  ]: 13 of 14 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 0.97s]
21:32:54.073424 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
21:32:54.175803 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.27 seconds
21:32:54.176145 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
21:32:54.176372 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
21:32:54.214912 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 5.24 seconds
21:32:54.216615 [debug] [Thread-6  ]: finished collecting timing info
21:32:54.216911 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
21:32:54.333107 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee4f90f9a0>]}
21:32:54.333603 [info ] [Thread-6  ]: 6 of 14 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.70s]
21:32:54.334186 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
21:32:54.339837 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.16 seconds
21:32:54.341675 [debug] [Thread-4  ]: finished collecting timing info
21:32:54.341944 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
21:32:54.373899 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.88 seconds
21:32:54.375580 [debug] [Thread-10 ]: finished collecting timing info
21:32:54.375912 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
21:32:54.474004 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee53c21580>]}
21:32:54.474958 [info ] [Thread-4  ]: 4 of 14 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 5.84s]
21:32:54.476181 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
21:32:54.479754 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d02b475-7fe4-4067-b41e-0294d129ac86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee2025c880>]}
21:32:54.480296 [info ] [Thread-10 ]: 14 of 14 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.01s]
21:32:54.480890 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
21:32:54.485857 [debug] [MainThread]: Acquiring new snowflake connection "master"
21:32:54.488205 [info ] [MainThread]: 
21:32:54.489568 [info ] [MainThread]: Finished running 5 table models, 2 incremental models, 7 view models in 7.59s.
21:32:54.490143 [debug] [MainThread]: Connection 'master' was properly closed.
21:32:54.490376 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
21:32:54.490587 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_items' was properly closed.
21:32:54.490816 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
21:32:54.490983 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
21:32:54.491170 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
21:32:54.491416 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
21:32:54.491657 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
21:32:54.491943 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_champions' was properly closed.
21:32:54.492116 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_items' was properly closed.
21:32:54.492327 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
21:32:54.506713 [info ] [MainThread]: 
21:32:54.507138 [info ] [MainThread]: [32mCompleted successfully[0m
21:32:54.507579 [info ] [MainThread]: 
21:32:54.508056 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
21:32:54.508671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee50616340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee507e52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fee507e5400>]}


============================== 2022-06-20 06:50:39.033564 | a640b9ab-d11d-4e3a-b3cf-b0dbc7865be2 ==============================
06:50:39.033581 [info ] [MainThread]: Running with dbt=1.1.0
06:50:39.035552 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
06:50:39.035782 [debug] [MainThread]: Tracking: tracking
06:50:39.036941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898dfe340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898dfeee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898dfec70>]}
06:50:39.038090 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-r7gl13hd'
06:50:39.038561 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
06:50:39.392287 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
06:50:39.393088 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
06:50:39.699696 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
06:50:39.754755 [info ] [MainThread]: Installing dbt-labs/dbt_utils
06:50:40.330449 [info ] [MainThread]:   Installed from version 0.8.5
06:50:40.330854 [info ] [MainThread]:   Updated version available: 0.8.6
06:50:40.331256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a640b9ab-d11d-4e3a-b3cf-b0dbc7865be2', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898dfe7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898f83160>]}
06:50:40.331530 [info ] [MainThread]: 
06:50:40.331837 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
06:50:40.332432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898f8e790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898de16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0898dfe880>]}


============================== 2022-06-20 06:50:44.426575 | bcac2574-3d82-4db2-985e-6088549e6342 ==============================
06:50:44.426676 [info ] [MainThread]: Running with dbt=1.1.0
06:50:44.427902 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
06:50:44.428299 [debug] [MainThread]: Tracking: tracking
06:50:44.428935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2bb37820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2bb37880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2bb378e0>]}
06:50:44.512552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b5fedfbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2bab7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b2bab70a0>]}


============================== 2022-06-20 06:56:27.360755 | 82f0905b-c410-4b6c-85f0-09ea37ba4512 ==============================
06:56:27.360776 [info ] [MainThread]: Running with dbt=1.1.0
06:56:27.361304 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
06:56:27.361517 [debug] [MainThread]: Tracking: tracking
06:56:27.362677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7aac0040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7aac0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7aac0bb0>]}
06:56:27.363818 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lxodaw6m'
06:56:27.364356 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
06:56:27.738494 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
06:56:27.739231 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
06:56:28.056635 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
06:56:28.112950 [info ] [MainThread]: Installing dbt-labs/dbt_utils
06:56:28.689263 [info ] [MainThread]:   Installed from version 0.8.5
06:56:28.689730 [info ] [MainThread]:   Updated version available: 0.8.6
06:56:28.690101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '82f0905b-c410-4b6c-85f0-09ea37ba4512', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7aa97e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7ab86b20>]}
06:56:28.690380 [info ] [MainThread]: 
06:56:28.690732 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
06:56:28.691324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7fdc32e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7aab9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b7aac0b20>]}


============================== 2022-06-20 06:56:33.113767 | 0a7c0328-75e5-4453-94e0-31ff3807c946 ==============================
06:56:33.113819 [info ] [MainThread]: Running with dbt=1.1.0
06:56:33.114410 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
06:56:33.114610 [debug] [MainThread]: Tracking: tracking
06:56:33.114987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31800c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31800c700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31800c760>]}
06:56:33.223952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 3 files changed.
06:56:33.224738 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/views/smurfs_analysis.sql
06:56:33.225298 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/views/schema.yml
06:56:33.225788 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/warehouse/final_players.sql
06:56:33.226265 [debug] [MainThread]: Partial parsing: added file: leagueoflegendsdbt://models/staging/stg_players.sql
06:56:33.227053 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.stage_data.stg_match_details
06:56:33.227742 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.stage_data.stg_match_info
06:56:33.228201 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.stage_data.stg_champions
06:56:33.228619 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.stage_data.stg_maps
06:56:33.229046 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.stage_data.stg_items
06:56:33.229442 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.stage_data.stg_runes_reforged
06:56:33.229847 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.stage_data.stg_summonerspells
06:56:33.230289 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/warehouse/schema.yml
06:56:33.230934 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.match_stage_data.staging_matchdetails
06:56:33.231433 [debug] [MainThread]: Partial parsing: deleted source source.leagueoflegendsdbt.match_stage_data.staging_matchinfo
06:56:33.231841 [debug] [MainThread]: Partial parsing: update schema file: leagueoflegendsdbt://models/staging/schema.yml
06:56:33.232442 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/staging_datadragon/stg_items.sql
06:56:33.255300 [debug] [MainThread]: 1699: static parser successfully parsed views/smurfs_analysis.sql
06:56:33.274149 [debug] [MainThread]: 1603: static parser failed on warehouse/final_players.sql
06:56:33.285212 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_players.sql
06:56:33.287018 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_players.sql
06:56:33.290508 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_details.sql
06:56:33.296881 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_details.sql
06:56:33.298623 [debug] [MainThread]: 1603: static parser failed on warehouse/final_match_info.sql
06:56:33.304322 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_match_info.sql
06:56:33.305700 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_champions.sql
06:56:33.308911 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_maps.sql
06:56:33.311767 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_items.sql
06:56:33.315101 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_runes_reforged.sql
06:56:33.318180 [debug] [MainThread]: 1699: static parser successfully parsed warehouse/final_summonerspells.sql
06:56:33.321215 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_details.sql
06:56:33.324215 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
06:56:33.327530 [debug] [MainThread]: 1699: static parser successfully parsed staging_datadragon/stg_items.sql
06:56:33.340982 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'smurf_analysis' in the 'models' section of file 'models/views/schema.yml'
06:56:33.478060 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.leagueoflegendsdbt.not_null_smurf_analysis_summonerspell_id.d02daaf6b3' (models/views/schema.yml) depends on a node named 'smurf_analysis' which was not found
06:56:33.478559 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.leagueoflegendsdbt.unique_smurf_analysis_summonerspell_id.99c5d81a5b' (models/views/schema.yml) depends on a node named 'smurf_analysis' which was not found
06:56:33.498174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3429255e0>]}
06:56:33.513560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc346372400>]}
06:56:33.513997 [info ] [MainThread]: Found 17 models, 32 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 24 sources, 0 exposures, 0 metrics
06:56:33.514412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc342a056a0>]}
06:56:33.518046 [info ] [MainThread]: 
06:56:33.518779 [debug] [MainThread]: Acquiring new snowflake connection "master"
06:56:33.520673 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
06:56:33.538784 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
06:56:33.539063 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
06:56:33.539258 [debug] [ThreadPool]: Opening a new connection, currently in state init
06:56:34.262096 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.72 seconds
06:56:34.264082 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
06:56:34.368082 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
06:56:34.376425 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
06:56:34.376721 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
06:56:34.376951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
06:56:34.818798 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 0.44 seconds
06:56:34.821612 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
06:56:34.923766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3462f1bb0>]}
06:56:34.924688 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
06:56:34.925264 [info ] [MainThread]: 
06:56:34.945098 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
06:56:34.945607 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
06:56:34.946328 [info ] [Thread-1  ]: 1 of 16 START table model PUBLIC.final_champions ............................... [RUN]
06:56:34.946914 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
06:56:34.947569 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
06:56:34.948020 [info ] [Thread-2  ]: 2 of 16 START table model PUBLIC.final_items ................................... [RUN]
06:56:34.948350 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
06:56:34.948724 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_players
06:56:34.949168 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
06:56:34.949828 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
06:56:34.950286 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_champions
06:56:34.950821 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
06:56:34.951202 [info ] [Thread-3  ]: 3 of 16 START table model PUBLIC.final_maps .................................... [RUN]
06:56:34.951426 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_items
06:56:34.952179 [info ] [Thread-4  ]: 4 of 16 START incremental model PUBLIC.final_match_details ..................... [RUN]
06:56:34.953461 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
06:56:34.954064 [info ] [Thread-5  ]: 5 of 16 START incremental model PUBLIC.final_match_info ........................ [RUN]
06:56:34.954617 [info ] [Thread-6  ]: 6 of 16 START incremental model PUBLIC.final_players ........................... [RUN]
06:56:34.955163 [info ] [Thread-7  ]: 7 of 16 START table model PUBLIC.final_runes_reforged .......................... [RUN]
06:56:34.955592 [info ] [Thread-8  ]: 8 of 16 START table model PUBLIC.final_summonerspells .......................... [RUN]
06:56:34.956238 [info ] [Thread-9  ]: 9 of 16 START view model PUBLIC.stg_champions .................................. [RUN]
06:56:34.956643 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
06:56:34.957460 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
06:56:34.957838 [info ] [Thread-10 ]: 10 of 16 START view model PUBLIC.stg_items ..................................... [RUN]
06:56:34.958706 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:56:34.958937 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
06:56:34.960042 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:56:34.960844 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_players"
06:56:34.961439 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
06:56:34.962147 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
06:56:34.962754 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
06:56:34.963228 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
06:56:34.963661 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
06:56:34.964543 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
06:56:34.964905 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
06:56:34.965442 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
06:56:34.966055 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
06:56:34.966558 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_players
06:56:34.966975 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
06:56:34.967396 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
06:56:34.967746 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
06:56:34.972114 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
06:56:34.972628 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
06:56:34.973332 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_items
06:56:34.973948 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
06:56:34.977665 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
06:56:34.978086 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
06:56:34.978365 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_players
06:56:34.978928 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
06:56:34.979579 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
06:56:34.979903 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_champions
06:56:34.983576 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
06:56:34.984069 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_items
06:56:34.984307 [debug] [Thread-1  ]: finished collecting timing info
06:56:34.992068 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
06:56:34.997410 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
06:56:35.003408 [debug] [Thread-2  ]: finished collecting timing info
06:56:35.004125 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_players"
06:56:35.006939 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
06:56:35.012145 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
06:56:35.016687 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
06:56:35.022159 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
06:56:35.023126 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
06:56:35.023658 [debug] [Thread-3  ]: finished collecting timing info
06:56:35.024626 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
06:56:35.025076 [debug] [Thread-4  ]: finished collecting timing info
06:56:35.025880 [debug] [Thread-5  ]: finished collecting timing info
06:56:35.026538 [debug] [Thread-6  ]: finished collecting timing info
06:56:35.026990 [debug] [Thread-7  ]: finished collecting timing info
06:56:35.028036 [debug] [Thread-8  ]: finished collecting timing info
06:56:35.039820 [debug] [Thread-10 ]: finished collecting timing info
06:56:35.040103 [debug] [Thread-9  ]: finished collecting timing info
06:56:35.040346 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
06:56:35.072070 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
06:56:35.077147 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
06:56:35.077729 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
06:56:35.078396 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
06:56:35.078866 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_players
06:56:35.079376 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
06:56:35.079750 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
06:56:35.080102 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_items
06:56:35.080541 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_champions
06:56:35.083802 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
06:56:35.095427 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
06:56:35.117941 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
06:56:35.150249 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_players"
06:56:35.151537 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:56:35.158044 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:56:35.161061 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
06:56:35.164569 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
06:56:35.195077 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
06:56:35.200612 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
06:56:35.201196 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        SummonersRift,
        HowlingAbyss,
        NexusBlitz,
        TeamfightTactics,
        FlatHPPoolMod,
        rFlatHPModPerLevel,
        FlatMPPoolMod,
        rFlatMPModPerLevel,
        PercentHPPoolMod,
        PercentMPPoolMod,
        FlatHPRegenMod,
        rFlatHPRegenModPerLevel,
        PercentHPRegenMod,
        FlatMPRegenMod,
        rFlatMPRegenModPerLevel,
        PercentMPRegenMod,
        FlatArmorMod,
        rFlatArmorModPerLevel,
        PercentArmorMod,
        rFlatArmorPenetrationMod,
        rFlatArmorPenetrationModPerLevel,
        rPercentArmorPenetrationMod,
        rPercentArmorPenetrationModPerLevel,
        FlatPhysicalDamageMod,
        rFlatPhysicalDamageModPerLevel,
        PercentPhysicalDamageMod,
        FlatMagicDamageMod,
        rFlatMagicDamageModPerLevel,
        PercentMagicDamageMod,
        FlatMovementSpeedMod,
        rFlatMovementSpeedModPerLevel,
        PercentMovementSpeedMod,
        rPercentMovementSpeedModPerLevel,
        FlatAttackSpeedMod,
        PercentAttackSpeedMod,
        rPercentAttackSpeedModPerLevel,
        rFlatDodgeMod,
        rFlatDodgeModPerLevel,
        PercentDodgeMod,
        FlatCritChanceMod,
        rFlatCritChanceModPerLevel,
        PercentCritChanceMod,
        FlatCritDamageMod,
        rFlatCritDamageModPerLevel,
        PercentCritDamageMod,
        FlatBlockMod,
        PercentBlockMod,
        FlatSpellBlockMod,
        rFlatSpellBlockModPerLevel,
        PercentSpellBlockMod,
        FlatEXPBonus,
        PercentEXPBonus,
        rPercentCooldownMod,
        rPercentCooldownModPerLevel,
        rFlatTimeDeadMod,
        rFlatTimeDeadModPerLevel,
        rPercentTimeDeadMod,
        rPercentTimeDeadModPerLevel,
        rFlatGoldPer10Mod,
        rFlatMagicPenetrationMod,
        rFlatMagicPenetrationModPerLevel,
        rPercentMagicPenetrationMod,
        rPercentMagicPenetrationModPerLevel,
        FlatEnergyRegenMod,
        rFlatEnergyRegenModPerLevel,
        FlatEnergyPoolMod,
        rFlatEnergyModPerLevel,
        PercentLifeStealMod,
        PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
06:56:35.201853 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
06:56:35.203002 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
06:56:35.204044 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
06:56:35.205041 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_players"
06:56:35.205572 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
06:56:35.207894 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
06:56:35.208591 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
06:56:35.209326 [debug] [Thread-2  ]: Opening a new connection, currently in state init
06:56:35.214176 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
06:56:35.214584 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:56:35.216715 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
06:56:35.217330 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
06:56:35.217792 [debug] [Thread-5  ]: Opening a new connection, currently in state init
06:56:35.218158 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_players: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_players"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_players  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_players
),

final_players as (
    SELECT
        summonerId,
        summoner_name,
        league_id,
        inactive,
        queue_type,
        rank,
        tier,
        veteran,
        league_points,
        wins,
        losses,
        fresh_blood,
        hot_streak
    FROM source
    
)
      );
06:56:35.218585 [debug] [Thread-4  ]: Opening a new connection, currently in state init
06:56:35.218983 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
06:56:35.219323 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
06:56:35.223212 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
  SELECT
    *
  FROM pivot_source
  pivot(max(map_exists) for map_id in ('11','12','21','22'))
  pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
)) as node2 (
    item_id,
    name,
    gold_description,
    gold_base,
    gold_purchasable,
    gold_total,
    gold_sell,
    SummonersRift,
    HowlingAbyss,
    NexusBlitz,
    TeamfightTactics,
    FlatHPPoolMod,
    rFlatHPModPerLevel,
    FlatMPPoolMod,
    rFlatMPModPerLevel,
    PercentHPPoolMod,
    PercentMPPoolMod,
    FlatHPRegenMod,
    rFlatHPRegenModPerLevel,
    PercentHPRegenMod,
    FlatMPRegenMod,
    rFlatMPRegenModPerLevel,
    PercentMPRegenMod,
    FlatArmorMod,
    rFlatArmorModPerLevel,
    PercentArmorMod,
    rFlatArmorPenetrationMod,
    rFlatArmorPenetrationModPerLevel,
    rPercentArmorPenetrationMod,
    rPercentArmorPenetrationModPerLevel,
    FlatPhysicalDamageMod,
    rFlatPhysicalDamageModPerLevel,
    PercentPhysicalDamageMod,
    FlatMagicDamageMod,
    rFlatMagicDamageModPerLevel,
    PercentMagicDamageMod,
    FlatMovementSpeedMod,
    rFlatMovementSpeedModPerLevel,
    PercentMovementSpeedMod,
    rPercentMovementSpeedModPerLevel,
    FlatAttackSpeedMod,
    PercentAttackSpeedMod,
    rPercentAttackSpeedModPerLevel,
    rFlatDodgeMod,
    rFlatDodgeModPerLevel,
    PercentDodgeMod,
    FlatCritChanceMod,
    rFlatCritChanceModPerLevel,
    PercentCritChanceMod,
    FlatCritDamageMod,
    rFlatCritDamageModPerLevel,
    PercentCritDamageMod,
    FlatBlockMod,
    PercentBlockMod,
    FlatSpellBlockMod,
    rFlatSpellBlockModPerLevel,
    PercentSpellBlockMod,
    FlatEXPBonus,
    PercentEXPBonus,
    rPercentCooldownMod,
    rPercentCooldownModPerLevel,
    rFlatTimeDeadMod,
    rFlatTimeDeadModPerLevel,
    rPercentTimeDeadMod,
    rPercentTimeDeadModPerLevel,
    rFlatGoldPer10Mod,
    rFlatMagicPenetrationMod,
    rFlatMagicPenetrationModPerLevel,
    rPercentMagicPenetrationMod,
    rPercentMagicPenetrationModPerLevel,
    FlatEnergyRegenMod,
    rFlatEnergyRegenModPerLevel,
    FlatEnergyPoolMod,
    rFlatEnergyModPerLevel,
    PercentLifeStealMod,
    PercentSpellVampMod
)
)

SELECT * FROM pivoted_items
  );
06:56:35.225857 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
06:56:35.228919 [debug] [Thread-3  ]: Opening a new connection, currently in state init
06:56:35.230801 [debug] [Thread-6  ]: Opening a new connection, currently in state init
06:56:35.239025 [debug] [Thread-8  ]: Opening a new connection, currently in state init
06:56:35.239704 [debug] [Thread-7  ]: Opening a new connection, currently in state init
06:56:35.240352 [debug] [Thread-10 ]: Opening a new connection, currently in state init
06:56:35.240864 [debug] [Thread-9  ]: Opening a new connection, currently in state init
06:56:37.118696 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.9 seconds
06:56:37.134156 [debug] [Thread-1  ]: finished collecting timing info
06:56:37.134977 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
06:56:37.213299 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.0 seconds
06:56:37.215115 [debug] [Thread-2  ]: finished collecting timing info
06:56:37.219495 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
06:56:37.261461 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33bb30c40>]}
06:56:37.263876 [info ] [Thread-1  ]: 1 of 16 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 2.31s]
06:56:37.265277 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
06:56:37.265752 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_maps
06:56:37.267432 [info ] [Thread-1  ]: 11 of 16 START view model PUBLIC.stg_maps ...................................... [RUN]
06:56:37.268724 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
06:56:37.271406 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
06:56:37.271894 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_maps
06:56:37.275877 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
06:56:37.281722 [debug] [Thread-1  ]: finished collecting timing info
06:56:37.282351 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_maps
06:56:37.289908 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
06:56:37.292922 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
06:56:37.293512 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
06:56:37.294285 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:56:37.359964 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33bb30c10>]}
06:56:37.360611 [info ] [Thread-2  ]: 2 of 16 OK created table model PUBLIC.final_items .............................. [[32mSUCCESS 1[0m in 2.41s]
06:56:37.362462 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
06:56:37.363320 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_match_details
06:56:37.363834 [info ] [Thread-2  ]: 12 of 16 START view model PUBLIC.stg_match_details ............................. [RUN]
06:56:37.365938 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
06:56:37.366850 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
06:56:37.367554 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_match_details
06:56:37.372663 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
06:56:37.377317 [debug] [Thread-2  ]: finished collecting timing info
06:56:37.378394 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
06:56:37.383033 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
06:56:37.393162 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
06:56:37.393755 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
06:56:37.395120 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
06:56:37.487774 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.27 seconds
06:56:37.510918 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:56:37.517152 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
06:56:37.596321 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01a51180-0000-fac3-0000-d969000557c6
06:56:37.602317 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 27 at position 6 unexpected ')'.
06:56:37.608209 [debug] [Thread-6  ]: finished collecting timing info
06:56:37.616200 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_players: Close
06:56:37.643341 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.12 seconds
06:56:37.649838 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:56:37.650685 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
06:56:37.730928 [debug] [Thread-6  ]: Database Error in model final_players (models/warehouse/final_players.sql)
  001003 (42000): SQL compilation error:
  syntax error line 27 at position 6 unexpected ')'.
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_players.sql
06:56:37.732015 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b580070>]}
06:56:37.733205 [error] [Thread-6  ]: 6 of 16 ERROR creating incremental model PUBLIC.final_players .................. [[31mERROR[0m in 2.77s]
06:56:37.735540 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_players
06:56:37.741786 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_match_info
06:56:37.747792 [info ] [Thread-6  ]: 13 of 16 START view model PUBLIC.stg_match_info ................................ [RUN]
06:56:37.763034 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
06:56:37.763816 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
06:56:37.764954 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.11 seconds
06:56:37.765717 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_match_info
06:56:37.784758 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:56:37.785423 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
06:56:37.786102 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
06:56:37.795860 [debug] [Thread-6  ]: finished collecting timing info
06:56:37.797174 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
06:56:37.802143 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
06:56:37.807589 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
06:56:37.808843 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
06:56:37.811596 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
06:56:37.862732 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.08 seconds
06:56:37.905117 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
06:56:37.910550 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:56:37.913334 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
06:56:38.014946 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.1 seconds
06:56:38.016942 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:56:38.017829 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
06:56:38.274175 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.03 seconds
06:56:38.275273 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.98 seconds
06:56:38.276226 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 3.04 seconds
06:56:38.278153 [debug] [Thread-10 ]: finished collecting timing info
06:56:38.281314 [debug] [Thread-1  ]: finished collecting timing info
06:56:38.283562 [debug] [Thread-9  ]: finished collecting timing info
06:56:38.284107 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_items: Close
06:56:38.284573 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_maps: Close
06:56:38.284980 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_champions: Close
06:56:38.328872 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 0.52 seconds
06:56:38.331276 [debug] [Thread-6  ]: finished collecting timing info
06:56:38.331702 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_info: Close
06:56:38.357662 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.13 seconds
06:56:38.359811 [debug] [Thread-3  ]: finished collecting timing info
06:56:38.360177 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
06:56:38.390835 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 1.0 seconds
06:56:38.393259 [debug] [Thread-2  ]: finished collecting timing info
06:56:38.394361 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b4ecac0>]}
06:56:38.394706 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_details: Close
06:56:38.399905 [info ] [Thread-10 ]: 10 of 16 OK created view model PUBLIC.stg_items ................................ [[32mSUCCESS 1[0m in 3.43s]
06:56:38.403124 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33bb34ca0>]}
06:56:38.405145 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_items
06:56:38.408196 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b5d2760>]}
06:56:38.408988 [info ] [Thread-9  ]: 9 of 16 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 3.44s]
06:56:38.409803 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_players
06:56:38.410564 [info ] [Thread-1  ]: 11 of 16 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 1.14s]
06:56:38.411307 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_champions
06:56:38.411839 [info ] [Thread-10 ]: 14 of 16 START view model PUBLIC.stg_players ................................... [RUN]
06:56:38.412820 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_maps
06:56:38.413287 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
06:56:38.414436 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_players"
06:56:38.414817 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
06:56:38.415519 [info ] [Thread-9  ]: 15 of 16 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
06:56:38.416108 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_players
06:56:38.416657 [info ] [Thread-1  ]: 16 of 16 START view model PUBLIC.stg_summonerspells ............................ [RUN]
06:56:38.417647 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
06:56:38.418020 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_players
06:56:38.419451 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
06:56:38.419731 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
06:56:38.421644 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
06:56:38.424601 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_players"
06:56:38.424926 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
06:56:38.425440 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
06:56:38.430056 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
06:56:38.430392 [debug] [Thread-10 ]: finished collecting timing info
06:56:38.436145 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
06:56:38.437410 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_players
06:56:38.438426 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc31062af40>]}
06:56:38.439498 [debug] [Thread-9  ]: finished collecting timing info
06:56:38.443051 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_players"
06:56:38.443558 [debug] [Thread-1  ]: finished collecting timing info
06:56:38.444304 [info ] [Thread-6  ]: 13 of 16 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 0.68s]
06:56:38.444577 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
06:56:38.445577 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
06:56:38.447828 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_players"
06:56:38.448474 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
06:56:38.451968 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
06:56:38.457345 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
06:56:38.457808 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_players: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_players"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_players
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_players
),

stg_players as ( 
SELECT
    json_data:summonerId as summonerId,
    json_data:summonerName as summoner_name,
    json_data:leagueId as league_id,
    json_data:inactive as inactive,
    json_data:queueType as queue_type,
    json_data:rank as rank,
    json_data:tier as tier,
    json_data:veteran as veteran,
    json_data:leaguePoints as league_points,
    json_data:wins as wins,
    json_data:losses as losses,
    json_data:freshBlood as fresh_blood,
    json_data:hotStreak as hot_streak
FROM source
)

SELECT *
FROM stg_players
  );
06:56:38.463797 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
06:56:38.469627 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33bb30eb0>]}
06:56:38.470845 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
06:56:38.471609 [info ] [Thread-3  ]: 3 of 16 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 3.51s]
06:56:38.473495 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
06:56:38.473884 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
06:56:38.477880 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
06:56:38.478752 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
06:56:38.479177 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:56:38.479994 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
06:56:38.523212 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b496850>]}
06:56:38.524020 [info ] [Thread-2  ]: 12 of 16 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 1.16s]
06:56:38.524804 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
06:56:38.579904 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.34 seconds
06:56:38.582144 [debug] [Thread-8  ]: finished collecting timing info
06:56:38.582566 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
06:56:38.782698 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3105c6670>]}
06:56:38.810807 [info ] [Thread-8  ]: 8 of 16 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 3.82s]
06:56:38.812798 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
06:56:38.823776 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.81 seconds
06:56:38.824970 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:56:38.825411 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
06:56:38.914275 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.7 seconds
06:56:38.918528 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:56:38.920083 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
06:56:39.003904 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.18 seconds
06:56:39.007300 [debug] [Thread-5  ]: finished collecting timing info
06:56:39.007969 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
06:56:39.019866 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.09 seconds
06:56:39.034847 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:56:39.035570 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
06:56:39.125535 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.09 seconds
06:56:39.142172 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:56:39.143353 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33bb340d0>]}
06:56:39.144009 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
06:56:39.148509 [info ] [Thread-5  ]: 5 of 16 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 4.18s]
06:56:39.153224 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
06:56:39.177034 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.94 seconds
06:56:39.179221 [debug] [Thread-7  ]: finished collecting timing info
06:56:39.179535 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
06:56:39.221465 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.07 seconds
06:56:39.236816 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
06:56:39.250599 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:56:39.253581 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
06:56:39.278982 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b58ed90>]}
06:56:39.279634 [info ] [Thread-7  ]: 7 of 16 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 4.32s]
06:56:39.280416 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
06:56:39.315586 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.85 seconds
06:56:39.317975 [debug] [Thread-10 ]: finished collecting timing info
06:56:39.318430 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_players: Close
06:56:39.366672 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.11 seconds
06:56:39.367677 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:56:39.370173 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
06:56:39.405510 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 0.93 seconds
06:56:39.407912 [debug] [Thread-9  ]: finished collecting timing info
06:56:39.408317 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
06:56:39.413215 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.93 seconds
06:56:39.415544 [debug] [Thread-1  ]: finished collecting timing info
06:56:39.415912 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
06:56:39.462099 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b495550>]}
06:56:39.463065 [info ] [Thread-10 ]: 14 of 16 OK created view model PUBLIC.stg_players .............................. [[32mSUCCESS 1[0m in 1.05s]
06:56:39.467469 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_players
06:56:39.517176 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b5bf400>]}
06:56:39.517863 [info ] [Thread-9  ]: 15 of 16 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 1.10s]
06:56:39.518461 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
06:56:39.524893 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b580670>]}
06:56:39.525481 [info ] [Thread-1  ]: 16 of 16 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.11s]
06:56:39.526108 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
06:56:40.375245 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.0 seconds
06:56:40.375598 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:56:40.375782 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
06:56:40.565151 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.19 seconds
06:56:40.567672 [debug] [Thread-4  ]: finished collecting timing info
06:56:40.568266 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
06:56:40.671358 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a7c0328-75e5-4453-94e0-31ff3807c946', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b570580>]}
06:56:40.671893 [info ] [Thread-4  ]: 4 of 16 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 5.71s]
06:56:40.672446 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
06:56:40.675613 [debug] [MainThread]: Acquiring new snowflake connection "master"
06:56:40.676494 [info ] [MainThread]: 
06:56:40.677180 [info ] [MainThread]: Finished running 5 table models, 3 incremental models, 8 view models in 7.16s.
06:56:40.677778 [debug] [MainThread]: Connection 'master' was properly closed.
06:56:40.678067 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
06:56:40.678271 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
06:56:40.678441 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_maps' was properly closed.
06:56:40.678648 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
06:56:40.678817 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
06:56:40.678986 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
06:56:40.679193 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
06:56:40.679361 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
06:56:40.679529 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
06:56:40.679746 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_players' was properly closed.
06:56:40.694021 [info ] [MainThread]: 
06:56:40.694452 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
06:56:40.694790 [info ] [MainThread]: 
06:56:40.695029 [error] [MainThread]: [33mDatabase Error in model final_players (models/warehouse/final_players.sql)[0m
06:56:40.695343 [error] [MainThread]:   001003 (42000): SQL compilation error:
06:56:40.696474 [error] [MainThread]:   syntax error line 27 at position 6 unexpected ')'.
06:56:40.697256 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_players.sql
06:56:40.697776 [info ] [MainThread]: 
06:56:40.698257 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
06:56:40.698934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b632e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3462e7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc33b609fa0>]}


============================== 2022-06-20 06:57:49.722621 | e5fd8e13-dd26-41c9-8434-609f815e907d ==============================
06:57:49.722635 [info ] [MainThread]: Running with dbt=1.1.0
06:57:49.723066 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
06:57:49.723241 [debug] [MainThread]: Tracking: tracking
06:57:49.724280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2299e21c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2299e2d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2299e2dc0>]}
06:57:49.724972 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4ew___l_'
06:57:49.725266 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
06:57:50.112230 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
06:57:50.113539 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
06:57:50.426578 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
06:57:50.479511 [info ] [MainThread]: Installing dbt-labs/dbt_utils
06:57:51.048310 [info ] [MainThread]:   Installed from version 0.8.5
06:57:51.048717 [info ] [MainThread]:   Updated version available: 0.8.6
06:57:51.049131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e5fd8e13-dd26-41c9-8434-609f815e907d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2299c5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb229b67460>]}
06:57:51.049419 [info ] [MainThread]: 
06:57:51.049741 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
06:57:51.050347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb22eda62e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2299cc6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2299e21c0>]}


============================== 2022-06-20 06:57:55.469763 | fe5df9ab-4b42-46f3-83f8-6811ccf61e8c ==============================
06:57:55.469795 [info ] [MainThread]: Running with dbt=1.1.0
06:57:55.470501 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
06:57:55.470703 [debug] [MainThread]: Tracking: tracking
06:57:55.471018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316c0c2520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316c0c2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316c0c2af0>]}
06:57:55.539653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
06:57:55.540478 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_players.sql
06:57:55.555987 [debug] [MainThread]: 1603: static parser failed on warehouse/final_players.sql
06:57:55.578332 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_players.sql
06:57:55.625906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319b5404f0>]}
06:57:55.645260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316c0494c0>]}
06:57:55.645801 [info ] [MainThread]: Found 17 models, 32 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 24 sources, 0 exposures, 0 metrics
06:57:55.646264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319b4e2fd0>]}
06:57:55.649714 [info ] [MainThread]: 
06:57:55.651066 [debug] [MainThread]: Acquiring new snowflake connection "master"
06:57:55.653252 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
06:57:55.669719 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
06:57:55.670013 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
06:57:55.670204 [debug] [ThreadPool]: Opening a new connection, currently in state init
06:57:56.349147 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.68 seconds
06:57:56.351075 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
06:57:56.457366 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
06:57:56.467180 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
06:57:56.467473 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
06:57:56.467663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
06:57:56.974329 [debug] [ThreadPool]: SQL status: SUCCESS 26 in 0.51 seconds
06:57:56.977768 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
06:57:57.072550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316c049370>]}
06:57:57.073522 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
06:57:57.074208 [info ] [MainThread]: 
06:57:57.093914 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
06:57:57.094417 [info ] [Thread-1  ]: 1 of 16 START table model PUBLIC.final_champions ............................... [RUN]
06:57:57.094977 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
06:57:57.096126 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
06:57:57.096659 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
06:57:57.097182 [info ] [Thread-2  ]: 2 of 16 START table model PUBLIC.final_items ................................... [RUN]
06:57:57.097725 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
06:57:57.098283 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
06:57:57.098665 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
06:57:57.099034 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_players
06:57:57.099509 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
06:57:57.099986 [info ] [Thread-3  ]: 3 of 16 START table model PUBLIC.final_maps .................................... [RUN]
06:57:57.100380 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
06:57:57.100843 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_champions
06:57:57.101498 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_items
06:57:57.102488 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
06:57:57.103071 [info ] [Thread-4  ]: 4 of 16 START incremental model PUBLIC.final_match_details ..................... [RUN]
06:57:57.103772 [info ] [Thread-5  ]: 5 of 16 START incremental model PUBLIC.final_match_info ........................ [RUN]
06:57:57.104432 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
06:57:57.105173 [info ] [Thread-6  ]: 6 of 16 START incremental model PUBLIC.final_players ........................... [RUN]
06:57:57.105788 [info ] [Thread-7  ]: 7 of 16 START table model PUBLIC.final_runes_reforged .......................... [RUN]
06:57:57.106868 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
06:57:57.107386 [info ] [Thread-8  ]: 8 of 16 START table model PUBLIC.final_summonerspells .......................... [RUN]
06:57:57.107844 [info ] [Thread-9  ]: 9 of 16 START view model PUBLIC.stg_champions .................................. [RUN]
06:57:57.108223 [info ] [Thread-10 ]: 10 of 16 START view model PUBLIC.stg_items ..................................... [RUN]
06:57:57.108576 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
06:57:57.109582 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:57:57.110673 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:57:57.115017 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
06:57:57.116389 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_players"
06:57:57.117553 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
06:57:57.117907 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
06:57:57.118988 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
06:57:57.120247 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
06:57:57.121238 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
06:57:57.121536 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
06:57:57.122102 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
06:57:57.122527 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
06:57:57.123164 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_players
06:57:57.123943 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
06:57:57.124286 [debug] [Thread-1  ]: finished collecting timing info
06:57:57.124628 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
06:57:57.124944 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
06:57:57.125241 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
06:57:57.125606 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_items
06:57:57.129499 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
06:57:57.130108 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
06:57:57.130674 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
06:57:57.131132 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_players
06:57:57.131726 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
06:57:57.132254 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
06:57:57.135698 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
06:57:57.136223 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
06:57:57.136814 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_champions
06:57:57.137367 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_items
06:57:57.147090 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
06:57:57.228856 [debug] [Thread-2  ]: finished collecting timing info
06:57:57.230530 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
06:57:57.237977 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_players"
06:57:57.241829 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
06:57:57.269193 [debug] [Thread-3  ]: finished collecting timing info
06:57:57.283187 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
06:57:57.285669 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
06:57:57.289775 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
06:57:57.294388 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
06:57:57.295087 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
06:57:57.295489 [debug] [Thread-4  ]: finished collecting timing info
06:57:57.296655 [debug] [Thread-5  ]: finished collecting timing info
06:57:57.297621 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
06:57:57.298652 [debug] [Thread-7  ]: finished collecting timing info
06:57:57.299080 [debug] [Thread-6  ]: finished collecting timing info
06:57:57.299987 [debug] [Thread-8  ]: finished collecting timing info
06:57:57.302304 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
06:57:57.302929 [debug] [Thread-9  ]: finished collecting timing info
06:57:57.303582 [debug] [Thread-10 ]: finished collecting timing info
06:57:57.308636 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
06:57:57.309108 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
06:57:57.309522 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
06:57:57.315435 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
06:57:57.315796 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
06:57:57.316134 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_players
06:57:57.316398 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
06:57:57.316693 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
06:57:57.317124 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_champions
06:57:57.317645 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_items
06:57:57.332913 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
06:57:57.378137 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:57:57.382313 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:57:57.385919 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
06:57:57.386989 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
06:57:57.391439 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_players"
06:57:57.395250 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
06:57:57.395731 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:57:57.423326 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        SummonersRift,
        HowlingAbyss,
        NexusBlitz,
        TeamfightTactics,
        FlatHPPoolMod,
        rFlatHPModPerLevel,
        FlatMPPoolMod,
        rFlatMPModPerLevel,
        PercentHPPoolMod,
        PercentMPPoolMod,
        FlatHPRegenMod,
        rFlatHPRegenModPerLevel,
        PercentHPRegenMod,
        FlatMPRegenMod,
        rFlatMPRegenModPerLevel,
        PercentMPRegenMod,
        FlatArmorMod,
        rFlatArmorModPerLevel,
        PercentArmorMod,
        rFlatArmorPenetrationMod,
        rFlatArmorPenetrationModPerLevel,
        rPercentArmorPenetrationMod,
        rPercentArmorPenetrationModPerLevel,
        FlatPhysicalDamageMod,
        rFlatPhysicalDamageModPerLevel,
        PercentPhysicalDamageMod,
        FlatMagicDamageMod,
        rFlatMagicDamageModPerLevel,
        PercentMagicDamageMod,
        FlatMovementSpeedMod,
        rFlatMovementSpeedModPerLevel,
        PercentMovementSpeedMod,
        rPercentMovementSpeedModPerLevel,
        FlatAttackSpeedMod,
        PercentAttackSpeedMod,
        rPercentAttackSpeedModPerLevel,
        rFlatDodgeMod,
        rFlatDodgeModPerLevel,
        PercentDodgeMod,
        FlatCritChanceMod,
        rFlatCritChanceModPerLevel,
        PercentCritChanceMod,
        FlatCritDamageMod,
        rFlatCritDamageModPerLevel,
        PercentCritDamageMod,
        FlatBlockMod,
        PercentBlockMod,
        FlatSpellBlockMod,
        rFlatSpellBlockModPerLevel,
        PercentSpellBlockMod,
        FlatEXPBonus,
        PercentEXPBonus,
        rPercentCooldownMod,
        rPercentCooldownModPerLevel,
        rFlatTimeDeadMod,
        rFlatTimeDeadModPerLevel,
        rPercentTimeDeadMod,
        rPercentTimeDeadModPerLevel,
        rFlatGoldPer10Mod,
        rFlatMagicPenetrationMod,
        rFlatMagicPenetrationModPerLevel,
        rPercentMagicPenetrationMod,
        rPercentMagicPenetrationModPerLevel,
        FlatEnergyRegenMod,
        rFlatEnergyRegenModPerLevel,
        FlatEnergyPoolMod,
        rFlatEnergyModPerLevel,
        PercentLifeStealMod,
        PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
06:57:57.438951 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
06:57:57.446400 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
06:57:57.452156 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
06:57:57.452694 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
06:57:57.453348 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
06:57:57.454933 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
06:57:57.458231 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
06:57:57.460732 [debug] [Thread-2  ]: Opening a new connection, currently in state init
06:57:57.462169 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_players"
06:57:57.462691 [debug] [Thread-5  ]: Opening a new connection, currently in state init
06:57:57.464413 [debug] [Thread-4  ]: Opening a new connection, currently in state init
06:57:57.467983 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
06:57:57.468542 [debug] [Thread-3  ]: Opening a new connection, currently in state init
06:57:57.473729 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
06:57:57.474249 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
06:57:57.474562 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
06:57:57.476875 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_players: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_players"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_players  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_players
),

final_players as (
    SELECT
        summonerId,
        summoner_name,
        league_id,
        inactive,
        queue_type,
        rank,
        tier,
        veteran,
        league_points,
        wins,
        losses,
        fresh_blood,
        hot_streak
    FROM source
    
)

SELECT *
final_players
      );
06:57:57.485707 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
06:57:57.492065 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
  SELECT
    *
  FROM pivot_source
  pivot(max(map_exists) for map_id in ('11','12','21','22'))
  pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
)) as node2 (
    item_id,
    name,
    gold_description,
    gold_base,
    gold_purchasable,
    gold_total,
    gold_sell,
    SummonersRift,
    HowlingAbyss,
    NexusBlitz,
    TeamfightTactics,
    FlatHPPoolMod,
    rFlatHPModPerLevel,
    FlatMPPoolMod,
    rFlatMPModPerLevel,
    PercentHPPoolMod,
    PercentMPPoolMod,
    FlatHPRegenMod,
    rFlatHPRegenModPerLevel,
    PercentHPRegenMod,
    FlatMPRegenMod,
    rFlatMPRegenModPerLevel,
    PercentMPRegenMod,
    FlatArmorMod,
    rFlatArmorModPerLevel,
    PercentArmorMod,
    rFlatArmorPenetrationMod,
    rFlatArmorPenetrationModPerLevel,
    rPercentArmorPenetrationMod,
    rPercentArmorPenetrationModPerLevel,
    FlatPhysicalDamageMod,
    rFlatPhysicalDamageModPerLevel,
    PercentPhysicalDamageMod,
    FlatMagicDamageMod,
    rFlatMagicDamageModPerLevel,
    PercentMagicDamageMod,
    FlatMovementSpeedMod,
    rFlatMovementSpeedModPerLevel,
    PercentMovementSpeedMod,
    rPercentMovementSpeedModPerLevel,
    FlatAttackSpeedMod,
    PercentAttackSpeedMod,
    rPercentAttackSpeedModPerLevel,
    rFlatDodgeMod,
    rFlatDodgeModPerLevel,
    PercentDodgeMod,
    FlatCritChanceMod,
    rFlatCritChanceModPerLevel,
    PercentCritChanceMod,
    FlatCritDamageMod,
    rFlatCritDamageModPerLevel,
    PercentCritDamageMod,
    FlatBlockMod,
    PercentBlockMod,
    FlatSpellBlockMod,
    rFlatSpellBlockModPerLevel,
    PercentSpellBlockMod,
    FlatEXPBonus,
    PercentEXPBonus,
    rPercentCooldownMod,
    rPercentCooldownModPerLevel,
    rFlatTimeDeadMod,
    rFlatTimeDeadModPerLevel,
    rPercentTimeDeadMod,
    rPercentTimeDeadModPerLevel,
    rFlatGoldPer10Mod,
    rFlatMagicPenetrationMod,
    rFlatMagicPenetrationModPerLevel,
    rPercentMagicPenetrationMod,
    rPercentMagicPenetrationModPerLevel,
    FlatEnergyRegenMod,
    rFlatEnergyRegenModPerLevel,
    FlatEnergyPoolMod,
    rFlatEnergyModPerLevel,
    PercentLifeStealMod,
    PercentSpellVampMod
)
)

SELECT * FROM pivoted_items
  );
06:57:57.496076 [debug] [Thread-7  ]: Opening a new connection, currently in state init
06:57:57.496627 [debug] [Thread-8  ]: Opening a new connection, currently in state init
06:57:57.497249 [debug] [Thread-6  ]: Opening a new connection, currently in state init
06:57:57.498054 [debug] [Thread-9  ]: Opening a new connection, currently in state init
06:57:57.499599 [debug] [Thread-10 ]: Opening a new connection, currently in state init
06:57:59.937371 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 2.44 seconds
06:57:59.946331 [debug] [Thread-9  ]: finished collecting timing info
06:57:59.946879 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_champions: Close
06:57:59.954045 [debug] [Thread-6  ]: Snowflake adapter: Snowflake query id: 01a51182-0000-fac3-0000-d96900055812
06:57:59.954351 [debug] [Thread-6  ]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 0 unexpected 'final_players'.
06:57:59.954892 [debug] [Thread-6  ]: finished collecting timing info
06:57:59.955441 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_players: Close
06:57:59.958160 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 2.49 seconds
06:57:59.967576 [debug] [Thread-3  ]: finished collecting timing info
06:57:59.968513 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
06:57:59.969325 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 2.51 seconds
06:57:59.987222 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:57:59.987662 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
06:58:00.050348 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a7c6ac0>]}
06:58:00.051621 [info ] [Thread-9  ]: 9 of 16 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 2.93s]
06:58:00.053150 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_champions
06:58:00.054041 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_maps
06:58:00.055135 [info ] [Thread-9  ]: 11 of 16 START view model PUBLIC.stg_maps ...................................... [RUN]
06:58:00.056602 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
06:58:00.057171 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
06:58:00.057734 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_maps
06:58:00.062362 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
06:58:00.063100 [debug] [Thread-9  ]: finished collecting timing info
06:58:00.063460 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_maps
06:58:00.067817 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
06:58:00.069691 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
06:58:00.070802 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
06:58:00.071553 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
06:58:00.072535 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.08 seconds
06:58:00.083864 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:58:00.085163 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
06:58:00.087507 [debug] [Thread-6  ]: Database Error in model final_players (models/warehouse/final_players.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 0 unexpected 'final_players'.
  compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_players.sql
06:58:00.088593 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a8928b0>]}
06:58:00.091705 [error] [Thread-6  ]: 6 of 16 ERROR creating incremental model PUBLIC.final_players .................. [[31mERROR[0m in 2.97s]
06:58:00.094338 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_players
06:58:00.095686 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a7c26a0>]}
06:58:00.097686 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.stg_match_details
06:58:00.098716 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.6 seconds
06:58:00.099370 [info ] [Thread-3  ]: 3 of 16 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 2.99s]
06:58:00.099894 [info ] [Thread-6  ]: 12 of 16 START view model PUBLIC.stg_match_details ............................. [RUN]
06:58:00.101830 [debug] [Thread-10 ]: finished collecting timing info
06:58:00.103149 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
06:58:00.104050 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
06:58:00.104434 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_items: Close
06:58:00.104959 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.stg_match_info
06:58:00.105456 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
06:58:00.108120 [info ] [Thread-3  ]: 13 of 16 START view model PUBLIC.stg_match_info ................................ [RUN]
06:58:00.108881 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.stg_match_details
06:58:00.112176 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
06:58:00.120050 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
06:58:00.121028 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
06:58:00.122792 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.stg_match_info
06:58:00.127197 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
06:58:00.128061 [debug] [Thread-6  ]: finished collecting timing info
06:58:00.128961 [debug] [Thread-3  ]: finished collecting timing info
06:58:00.129349 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
06:58:00.129768 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
06:58:00.133926 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
06:58:00.137705 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
06:58:00.139810 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
06:58:00.145419 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
06:58:00.145978 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
06:58:00.146268 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
06:58:00.146602 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
06:58:00.148173 [debug] [Thread-6  ]: Opening a new connection, currently in state closed
06:58:00.169740 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.08 seconds
06:58:00.185032 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:58:00.185574 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
06:58:00.259185 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a7c6d00>]}
06:58:00.276768 [info ] [Thread-10 ]: 10 of 16 OK created view model PUBLIC.stg_items ................................ [[32mSUCCESS 1[0m in 3.14s]
06:58:00.283268 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_items
06:58:00.284242 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_players
06:58:00.284999 [info ] [Thread-10 ]: 14 of 16 START view model PUBLIC.stg_players ................................... [RUN]
06:58:00.302372 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.12 seconds
06:58:00.323843 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_players"
06:58:00.329566 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_players
06:58:00.340945 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_players
06:58:00.345231 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_players"
06:58:00.360867 [debug] [Thread-10 ]: finished collecting timing info
06:58:00.361869 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 2.9 seconds
06:58:00.362447 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
06:58:00.363052 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_players
06:58:00.367537 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:58:00.376673 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_players"
06:58:00.383562 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:58:00.385145 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
06:58:00.387838 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
06:58:00.394429 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_players"
06:58:00.396379 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_players: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_players"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_players
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_players
),

stg_players as ( 
SELECT
    json_data:summonerId as summonerId,
    json_data:summonerName as summoner_name,
    json_data:leagueId as league_id,
    json_data:inactive as inactive,
    json_data:queueType as queue_type,
    json_data:rank as rank,
    json_data:tier as tier,
    json_data:veteran as veteran,
    json_data:leaguePoints as league_points,
    json_data:wins as wins,
    json_data:losses as losses,
    json_data:freshBlood as fresh_blood,
    json_data:hotStreak as hot_streak
FROM source
)

SELECT *
FROM stg_players
  );
06:58:00.397778 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
06:58:00.519441 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.13 seconds
06:58:00.536556 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:58:00.556604 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
06:58:00.558668 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.17 seconds
06:58:00.573764 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 3.18 seconds
06:58:00.581148 [debug] [Thread-1  ]: finished collecting timing info
06:58:00.587313 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
06:58:00.594414 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:58:00.598401 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
06:58:00.722854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3167016bb0>]}
06:58:00.723948 [info ] [Thread-1  ]: 1 of 16 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 3.63s]
06:58:00.725775 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.13 seconds
06:58:00.727686 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
06:58:00.742565 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:58:00.743795 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
06:58:00.744892 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
06:58:00.746620 [info ] [Thread-1  ]: 15 of 16 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
06:58:00.750689 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
06:58:00.751259 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
06:58:00.751913 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
06:58:00.756525 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
06:58:00.762454 [debug] [Thread-1  ]: finished collecting timing info
06:58:00.763401 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
06:58:00.767892 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
06:58:00.772832 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
06:58:00.773614 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
06:58:00.774377 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:58:00.962222 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.21 seconds
06:58:00.987013 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
06:58:00.999020 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.5 seconds
06:58:01.002517 [debug] [Thread-8  ]: finished collecting timing info
06:58:01.025738 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:58:01.026142 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
06:58:01.033049 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
06:58:01.110216 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.55 seconds
06:58:01.115004 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
06:58:01.115720 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
06:58:01.171762 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.1 seconds
06:58:01.173165 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:58:01.173536 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
06:58:01.182921 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a7c68b0>]}
06:58:01.183820 [info ] [Thread-8  ]: 8 of 16 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 4.06s]
06:58:01.184850 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
06:58:01.185312 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
06:58:01.186292 [info ] [Thread-8  ]: 16 of 16 START view model PUBLIC.stg_summonerspells ............................ [RUN]
06:58:01.187304 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
06:58:01.187627 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
06:58:01.187837 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
06:58:01.191503 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
06:58:01.192163 [debug] [Thread-8  ]: finished collecting timing info
06:58:01.192713 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
06:58:01.197328 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
06:58:01.198799 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
06:58:01.199385 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
06:58:01.200781 [debug] [Thread-8  ]: Opening a new connection, currently in state closed
06:58:01.210231 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 1.06 seconds
06:58:01.214361 [debug] [Thread-3  ]: finished collecting timing info
06:58:01.215376 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.stg_match_info: Close
06:58:01.336813 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a8b59d0>]}
06:58:01.337564 [info ] [Thread-3  ]: 13 of 16 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 1.23s]
06:58:01.338758 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
06:58:01.385068 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.61 seconds
06:58:01.387734 [debug] [Thread-1  ]: finished collecting timing info
06:58:01.388344 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
06:58:01.392463 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.9 seconds
06:58:01.395863 [debug] [Thread-7  ]: finished collecting timing info
06:58:01.397041 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
06:58:01.516921 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a7c2310>]}
06:58:01.517640 [info ] [Thread-1  ]: 15 of 16 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 0.77s]
06:58:01.518329 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
06:58:01.557934 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 4.1 seconds
06:58:01.560085 [debug] [Thread-2  ]: finished collecting timing info
06:58:01.565210 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.45 seconds
06:58:01.566517 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
06:58:01.569420 [debug] [Thread-5  ]: finished collecting timing info
06:58:01.571629 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
06:58:02.033733 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 1.89 seconds
06:58:02.037377 [debug] [Thread-6  ]: finished collecting timing info
06:58:02.037798 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.stg_match_details: Close
06:58:02.097778 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 0.92 seconds
06:58:02.098834 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
06:58:02.099499 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
06:58:02.135830 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a7c6d60>]}
06:58:02.136446 [info ] [Thread-2  ]: 2 of 16 OK created table model PUBLIC.final_items .............................. [[32mSUCCESS 1[0m in 5.03s]
06:58:02.137180 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
06:58:02.159676 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a7d62e0>]}
06:58:02.160724 [info ] [Thread-7  ]: 7 of 16 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 5.04s]
06:58:02.161795 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
06:58:02.166723 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a8c1790>]}
06:58:02.167349 [info ] [Thread-5  ]: 5 of 16 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 5.06s]
06:58:02.168157 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
06:58:02.205536 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 2.13 seconds
06:58:02.213073 [debug] [Thread-9  ]: finished collecting timing info
06:58:02.218764 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_maps: Close
06:58:02.259011 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a78f7c0>]}
06:58:02.270416 [info ] [Thread-6  ]: 12 of 16 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 2.15s]
06:58:02.271441 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 1.87 seconds
06:58:02.272149 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.17 seconds
06:58:02.288108 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
06:58:02.293365 [debug] [Thread-10 ]: finished collecting timing info
06:58:02.297439 [debug] [Thread-4  ]: finished collecting timing info
06:58:02.300489 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_players: Close
06:58:02.302330 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
06:58:02.369206 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a8ac670>]}
06:58:02.371095 [info ] [Thread-9  ]: 11 of 16 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 2.31s]
06:58:02.373972 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_maps
06:58:02.454535 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319afc0670>]}
06:58:02.455103 [info ] [Thread-4  ]: 4 of 16 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 5.35s]
06:58:02.455717 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
06:58:02.494992 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319a8b58e0>]}
06:58:02.495562 [info ] [Thread-10 ]: 14 of 16 OK created view model PUBLIC.stg_players .............................. [[32mSUCCESS 1[0m in 2.17s]
06:58:02.496076 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_players
06:58:02.695117 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 1.49 seconds
06:58:02.697309 [debug] [Thread-8  ]: finished collecting timing info
06:58:02.697675 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
06:58:02.815500 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe5df9ab-4b42-46f3-83f8-6811ccf61e8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3166f42b20>]}
06:58:02.816043 [info ] [Thread-8  ]: 16 of 16 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.63s]
06:58:02.816650 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
06:58:02.819511 [debug] [MainThread]: Acquiring new snowflake connection "master"
06:58:02.820160 [info ] [MainThread]: 
06:58:02.820685 [info ] [MainThread]: Finished running 8 view models, 3 incremental models, 5 table models in 7.17s.
06:58:02.821148 [debug] [MainThread]: Connection 'master' was properly closed.
06:58:02.821368 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
06:58:02.821553 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_items' was properly closed.
06:58:02.821729 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
06:58:02.821993 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
06:58:02.822177 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
06:58:02.822349 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
06:58:02.822570 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_runes_reforged' was properly closed.
06:58:02.822747 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
06:58:02.822922 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_maps' was properly closed.
06:58:02.823150 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_players' was properly closed.
06:58:02.837017 [info ] [MainThread]: 
06:58:02.837448 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
06:58:02.837827 [info ] [MainThread]: 
06:58:02.838119 [error] [MainThread]: [33mDatabase Error in model final_players (models/warehouse/final_players.sql)[0m
06:58:02.838584 [error] [MainThread]:   001003 (42000): SQL compilation error:
06:58:02.839086 [error] [MainThread]:   syntax error line 29 at position 0 unexpected 'final_players'.
06:58:02.839399 [error] [MainThread]:   compiled SQL at target/run/leagueoflegendsdbt/models/warehouse/final_players.sql
06:58:02.840033 [info ] [MainThread]: 
06:58:02.840908 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=1 SKIP=0 TOTAL=16
06:58:02.841650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316700c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f316c0492b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f319ae7a820>]}


============================== 2022-06-20 07:00:19.110608 | 56f4a2fe-8d20-4243-8c30-77f7100be10b ==============================
07:00:19.110626 [info ] [MainThread]: Running with dbt=1.1.0
07:00:19.111314 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
07:00:19.111567 [debug] [MainThread]: Tracking: tracking
07:00:19.113142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a85ac250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a85ace50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a85acdc0>]}
07:00:19.114167 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ivj2rfnk'
07:00:19.114688 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
07:00:19.472386 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
07:00:19.473273 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
07:00:19.782766 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
07:00:19.843519 [info ] [MainThread]: Installing dbt-labs/dbt_utils
07:00:20.461605 [info ] [MainThread]:   Installed from version 0.8.5
07:00:20.462277 [info ] [MainThread]:   Updated version available: 0.8.6
07:00:20.462889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '56f4a2fe-8d20-4243-8c30-77f7100be10b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a85acaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a85acd90>]}
07:00:20.463278 [info ] [MainThread]: 
07:00:20.463728 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
07:00:20.464466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29ad9702e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a85962e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a858fb20>]}


============================== 2022-06-20 07:00:25.383032 | b0252419-b6b0-429a-a57c-7b690921c721 ==============================
07:00:25.383056 [info ] [MainThread]: Running with dbt=1.1.0
07:00:25.383743 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/airflow/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:00:25.383985 [debug] [MainThread]: Tracking: tracking
07:00:25.384430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d40da790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d40da7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d40da850>]}
07:00:25.488877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:00:25.489893 [debug] [MainThread]: Partial parsing: updated file: leagueoflegendsdbt://models/warehouse/final_players.sql
07:00:25.516243 [debug] [MainThread]: 1603: static parser failed on warehouse/final_players.sql
07:00:25.567875 [debug] [MainThread]: 1602: parser fallback to jinja rendering on warehouse/final_players.sql
07:00:25.636560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe603f522e0>]}
07:00:25.656497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe603fe0640>]}
07:00:25.657029 [info ] [MainThread]: Found 17 models, 32 tests, 0 snapshots, 0 analyses, 400 macros, 0 operations, 0 seed files, 24 sources, 0 exposures, 0 metrics
07:00:25.657763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe603ef2d30>]}
07:00:25.661761 [info ] [MainThread]: 
07:00:25.662644 [debug] [MainThread]: Acquiring new snowflake connection "master"
07:00:25.665039 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB"
07:00:25.683244 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB"
07:00:25.683571 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB"} */

    show terse schemas in database LEAGUE_OF_LEGENDSDB
    limit 10000
07:00:25.683794 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:00:26.599081 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.92 seconds
07:00:26.601983 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB: Close
07:00:26.764150 [debug] [ThreadPool]: Acquiring new snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
07:00:26.775800 [debug] [ThreadPool]: Using snowflake connection "list_LEAGUE_OF_LEGENDSDB_PUBLIC"
07:00:26.776209 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "connection_name": "list_LEAGUE_OF_LEGENDSDB_PUBLIC"} */

    show terse objects in LEAGUE_OF_LEGENDSDB.PUBLIC
07:00:26.776528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:00:27.366424 [debug] [ThreadPool]: SQL status: SUCCESS 26 in 0.59 seconds
07:00:27.369374 [debug] [ThreadPool]: On list_LEAGUE_OF_LEGENDSDB_PUBLIC: Close
07:00:27.496149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d4060250>]}
07:00:27.496932 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
07:00:27.497469 [info ] [MainThread]: 
07:00:27.515696 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.final_champions
07:00:27.516080 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.final_items
07:00:27.516464 [debug] [Thread-3  ]: Began running node model.leagueoflegendsdbt.final_maps
07:00:27.517015 [info ] [Thread-1  ]: 1 of 16 START table model PUBLIC.final_champions ............................... [RUN]
07:00:27.517419 [debug] [Thread-4  ]: Began running node model.leagueoflegendsdbt.final_match_details
07:00:27.517919 [debug] [Thread-5  ]: Began running node model.leagueoflegendsdbt.final_match_info
07:00:27.518520 [info ] [Thread-2  ]: 2 of 16 START table model PUBLIC.final_items ................................... [RUN]
07:00:27.518993 [debug] [Thread-6  ]: Began running node model.leagueoflegendsdbt.final_players
07:00:27.519589 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.final_runes_reforged
07:00:27.520384 [info ] [Thread-3  ]: 3 of 16 START table model PUBLIC.final_maps .................................... [RUN]
07:00:27.521218 [debug] [Thread-8  ]: Began running node model.leagueoflegendsdbt.final_summonerspells
07:00:27.521700 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_champions
07:00:27.522134 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_items
07:00:27.523021 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_champions"
07:00:27.523470 [info ] [Thread-4  ]: 4 of 16 START incremental model PUBLIC.final_match_details ..................... [RUN]
07:00:27.524049 [info ] [Thread-5  ]: 5 of 16 START incremental model PUBLIC.final_match_info ........................ [RUN]
07:00:27.524853 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_items"
07:00:27.525300 [info ] [Thread-6  ]: 6 of 16 START incremental model PUBLIC.final_players ........................... [RUN]
07:00:27.525910 [info ] [Thread-7  ]: 7 of 16 START table model PUBLIC.final_runes_reforged .......................... [RUN]
07:00:27.526950 [debug] [Thread-3  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_maps"
07:00:27.527465 [info ] [Thread-8  ]: 8 of 16 START table model PUBLIC.final_summonerspells .......................... [RUN]
07:00:27.528118 [info ] [Thread-9  ]: 9 of 16 START view model PUBLIC.stg_champions .................................. [RUN]
07:00:27.528923 [info ] [Thread-10 ]: 10 of 16 START view model PUBLIC.stg_items ..................................... [RUN]
07:00:27.529655 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.final_champions
07:00:27.531034 [debug] [Thread-4  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_details"
07:00:27.532334 [debug] [Thread-5  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_match_info"
07:00:27.532775 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.final_items
07:00:27.533636 [debug] [Thread-6  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_players"
07:00:27.538840 [debug] [Thread-6  ]: Began compiling node model.leagueoflegendsdbt.final_players
07:00:27.534604 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
07:00:27.535751 [debug] [Thread-8  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
07:00:27.536420 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_champions"
07:00:27.537148 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_items"
07:00:27.537434 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.final_champions
07:00:27.537705 [debug] [Thread-4  ]: Began compiling node model.leagueoflegendsdbt.final_match_details
07:00:27.538046 [debug] [Thread-5  ]: Began compiling node model.leagueoflegendsdbt.final_match_info
07:00:27.538576 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.final_items
07:00:27.534923 [debug] [Thread-3  ]: Began compiling node model.leagueoflegendsdbt.final_maps
07:00:27.539111 [debug] [Thread-6  ]: Compiling model.leagueoflegendsdbt.final_players
07:00:27.539646 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.final_runes_reforged
07:00:27.540138 [debug] [Thread-8  ]: Began compiling node model.leagueoflegendsdbt.final_summonerspells
07:00:27.540817 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_champions
07:00:27.541278 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_items
07:00:27.544601 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_champions"
07:00:27.545028 [debug] [Thread-4  ]: Compiling model.leagueoflegendsdbt.final_match_details
07:00:27.545414 [debug] [Thread-5  ]: Compiling model.leagueoflegendsdbt.final_match_info
07:00:27.549750 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_items"
07:00:27.550160 [debug] [Thread-3  ]: Compiling model.leagueoflegendsdbt.final_maps
07:00:27.554933 [debug] [Thread-6  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_players"
07:00:27.555476 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.final_runes_reforged
07:00:27.555988 [debug] [Thread-8  ]: Compiling model.leagueoflegendsdbt.final_summonerspells
07:00:27.556449 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_champions
07:00:27.556835 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_items
07:00:27.565617 [debug] [Thread-4  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_details"
07:00:27.566199 [debug] [Thread-1  ]: finished collecting timing info
07:00:27.572415 [debug] [Thread-5  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_match_info"
07:00:27.642476 [debug] [Thread-3  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_maps"
07:00:27.646943 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
07:00:27.647322 [debug] [Thread-6  ]: finished collecting timing info
07:00:27.647639 [debug] [Thread-2  ]: finished collecting timing info
07:00:27.650547 [debug] [Thread-8  ]: Writing injected SQL for node "model.leagueoflegendsdbt.final_summonerspells"
07:00:27.654769 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_champions"
07:00:27.658849 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_items"
07:00:27.659673 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.final_champions
07:00:27.660483 [debug] [Thread-4  ]: finished collecting timing info
07:00:27.662257 [debug] [Thread-6  ]: Began executing node model.leagueoflegendsdbt.final_players
07:00:27.662816 [debug] [Thread-3  ]: finished collecting timing info
07:00:27.663194 [debug] [Thread-5  ]: finished collecting timing info
07:00:27.663604 [debug] [Thread-7  ]: finished collecting timing info
07:00:27.663928 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.final_items
07:00:27.665242 [debug] [Thread-8  ]: finished collecting timing info
07:00:27.687642 [debug] [Thread-4  ]: Began executing node model.leagueoflegendsdbt.final_match_details
07:00:27.693658 [debug] [Thread-9  ]: finished collecting timing info
07:00:27.700404 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_champions"
07:00:27.706366 [debug] [Thread-10 ]: finished collecting timing info
07:00:27.716773 [debug] [Thread-3  ]: Began executing node model.leagueoflegendsdbt.final_maps
07:00:27.732717 [debug] [Thread-5  ]: Began executing node model.leagueoflegendsdbt.final_match_info
07:00:27.740254 [debug] [Thread-6  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_players"
07:00:27.740733 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.final_runes_reforged
07:00:27.744804 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_items"
07:00:27.745293 [debug] [Thread-8  ]: Began executing node model.leagueoflegendsdbt.final_summonerspells
07:00:27.752963 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
07:00:27.753457 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_champions
07:00:27.754065 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_items
07:00:27.758387 [debug] [Thread-3  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_maps"
07:00:27.763344 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
07:00:27.764661 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.final_champions"
07:00:27.769468 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_runes_reforged"
07:00:27.771216 [debug] [Thread-6  ]: Using snowflake connection "model.leagueoflegendsdbt.final_players"
07:00:27.774106 [debug] [Thread-8  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_summonerspells"
07:00:27.774765 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
),

final_match_details as (
    SELECT 
        matchId,
        assists,
        baronKills,
        bountyLevel,
        champExperience,
        champLevel,
        championId,
        championName,
        championTransform,
        consumablesPurchased,
        damageDealtToBuildings,
        damageDealtToObjectives,
        damageDealtToTurrets,
        damageSelfMitigated,
        deaths,
        detectorWardsPlaced,
        doubleKills,
        dragonKills,
        eligibleForProgression,
        firstBloodAssist,
        firstBloodKill,
        firstTowerAssist,
        firstTowerKill,
        gameEndedInEarlySurrender,
        gameEndedInSurrender,
        goldEarned,
        goldSpent,
        individualPosition,
        inhibitorKills,
        inhibitorTakedowns,
        inhibitorsLost,
        item0_damage,
        item1_damage,
        item2_damage,
        item3_damage,
        item4_damage,
        item5_damage,
        item6_damage,
        itemsPurchased,
        killingSprees,
        kills,
        lane,
        largestCriticalStrike,
        largestKillingSpree,
        largestMultiKill,
        longestTimeSpentLiving,
        magicDamageDealt,
        magicDamageDealtToChampions,
        magicDamageTaken,
        neutralMinionsKilled,
        nexusKills,
        nexusLost,
        nexusTakedowns,
        objectivesStolen,
        objectivesStolenAssists,
        participantId,
        pentaKills,
        physicalDamageDealt,
        physicalDamageDealtToChampions,
        physicalDamageTaken,
        profileIcon,
        puuid,
        quadraKills,
        riotIdName,
        riotIdTagline,
        role,
        sightWardsBoughtInGame,
        spell1Casts,
        spell2Casts,
        spell3Casts,
        spell4Casts,
        summoner1Casts,
        summoner1Id,
        summoner2Casts,
        summoner2Id,
        summonerId,
        summonerLevel,
        summonerName,
        teamEarlySurrendered,
        teamId,
        teamPosition,
        timeCCingOthers,
        timePlayed,
        totalDamageDealt,
        totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates,
        totalDamageTaken,
        totalHeal,
        totalHealsOnTeammates,
        totalMinionsKilled,
        totalTimeCCDealt,
        totalTimeSpentDead,
        totalUnitsHealed,
        tripleKills,
        trueDamageDealt,
        trueDamageDealtToChampions,
        trueDamageTaken,
        turretKills,
        turretTakedowns,
        turretsLost,
        unrealKills,
        visionScore,
        visionWardsBoughtInGame,
        wardsKilled,
        wardsPlaced,
        win
    FROM source
    
      -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details)
    
)

SELECT * FROM final_match_details
      );
07:00:27.778107 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.final_items"
07:00:27.811710 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_champions"
07:00:27.812129 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    

      create or replace temporary table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
),

final_match_info as (
    SELECT
        matchId,
        gameEndTimestamp,
        gameId,
        gameMode,
        gameName,
        gameStartTimestamp,
        gameType,
        gameVersion,
        mapId,
        platformId,
        queueId,
        tournamentCode
    FROM source
    
  -- this filter will only be applied on an incremental run
      WHERE matchId > (SELECT max(matchId) from LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info)
    
)

SELECT * FROM final_match_info
      );
07:00:27.819973 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_items"
07:00:27.820355 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_champions"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_champions  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
),

final_datadragon_champions as (
    SELECT
        champion_id,
        blurb,
        attack,
        defense,
        magic,
        difficulty,
        hp,
        hpperlevel,
        mp,
        mpperlevel,
        movespeed,
        armor,
        armorperlevel,
        spellblock,
        spellblockperlevel,
        attackrange,
        hpregen,
        hpregenperlevel,
        mpregen,
        mpregenperlevel,
        crit,
        critperlevel,
        attackdamage,
        attackdamageperlevel,
        attackspeedperlevel,
        attackspeed
    FROM source
)

SELECT *
FROM final_datadragon_champions
      );
07:00:27.821243 [debug] [Thread-3  ]: Using snowflake connection "model.leagueoflegendsdbt.final_maps"
07:00:27.821917 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_players: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_players"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_players  as
      (

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_players
),

final_players as (
    SELECT
        summonerId,
        summoner_name,
        league_id,
        inactive,
        queue_type,
        rank,
        tier,
        veteran,
        league_points,
        wins,
        losses,
        fresh_blood,
        hot_streak
    FROM source
    
)

SELECT *
FROM final_players
      );
07:00:27.823009 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.final_runes_reforged"
07:00:27.823620 [debug] [Thread-4  ]: Opening a new connection, currently in state init
07:00:27.825116 [debug] [Thread-8  ]: Using snowflake connection "model.leagueoflegendsdbt.final_summonerspells"
07:00:27.825615 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_items"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_items  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
),

final_datadragon_items as (
    SELECT
        item_id,
        name,
        gold_description,
        gold_base,
        gold_purchasable,
        gold_total,
        gold_sell,
        SummonersRift,
        HowlingAbyss,
        NexusBlitz,
        TeamfightTactics,
        FlatHPPoolMod,
        rFlatHPModPerLevel,
        FlatMPPoolMod,
        rFlatMPModPerLevel,
        PercentHPPoolMod,
        PercentMPPoolMod,
        FlatHPRegenMod,
        rFlatHPRegenModPerLevel,
        PercentHPRegenMod,
        FlatMPRegenMod,
        rFlatMPRegenModPerLevel,
        PercentMPRegenMod,
        FlatArmorMod,
        rFlatArmorModPerLevel,
        PercentArmorMod,
        rFlatArmorPenetrationMod,
        rFlatArmorPenetrationModPerLevel,
        rPercentArmorPenetrationMod,
        rPercentArmorPenetrationModPerLevel,
        FlatPhysicalDamageMod,
        rFlatPhysicalDamageModPerLevel,
        PercentPhysicalDamageMod,
        FlatMagicDamageMod,
        rFlatMagicDamageModPerLevel,
        PercentMagicDamageMod,
        FlatMovementSpeedMod,
        rFlatMovementSpeedModPerLevel,
        PercentMovementSpeedMod,
        rPercentMovementSpeedModPerLevel,
        FlatAttackSpeedMod,
        PercentAttackSpeedMod,
        rPercentAttackSpeedModPerLevel,
        rFlatDodgeMod,
        rFlatDodgeModPerLevel,
        PercentDodgeMod,
        FlatCritChanceMod,
        rFlatCritChanceModPerLevel,
        PercentCritChanceMod,
        FlatCritDamageMod,
        rFlatCritDamageModPerLevel,
        PercentCritDamageMod,
        FlatBlockMod,
        PercentBlockMod,
        FlatSpellBlockMod,
        rFlatSpellBlockModPerLevel,
        PercentSpellBlockMod,
        FlatEXPBonus,
        PercentEXPBonus,
        rPercentCooldownMod,
        rPercentCooldownModPerLevel,
        rFlatTimeDeadMod,
        rFlatTimeDeadModPerLevel,
        rPercentTimeDeadMod,
        rPercentTimeDeadModPerLevel,
        rFlatGoldPer10Mod,
        rFlatMagicPenetrationMod,
        rFlatMagicPenetrationModPerLevel,
        rPercentMagicPenetrationMod,
        rPercentMagicPenetrationModPerLevel,
        FlatEnergyRegenMod,
        rFlatEnergyRegenModPerLevel,
        FlatEnergyPoolMod,
        rFlatEnergyModPerLevel,
        PercentLifeStealMod,
        PercentSpellVampMod
    FROM source
)

SELECT *
FROM final_datadragon_items
      );
07:00:27.826367 [debug] [Thread-5  ]: Opening a new connection, currently in state init
07:00:27.829210 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_champions"
07:00:27.829890 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:00:27.830328 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_maps"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_maps  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
),

final_datadragon_maps as (
SELECT 
    map_id,
    map_name
FROM source
)

SELECT *
FROM final_datadragon_maps
      );
07:00:27.835163 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_items"
07:00:27.835695 [debug] [Thread-6  ]: Opening a new connection, currently in state init
07:00:27.836207 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_runes_reforged"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_runes_reforged  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
),

final_datadragon_runes_reforged as (
    SELECT
        rune_id,
        rune_name
    FROM source
)

SELECT *
FROM final_datadragon_runes_reforged
      );
07:00:27.840232 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.final_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_summonerspells"} */


      create or replace transient table LEAGUE_OF_LEGENDSDB.PUBLIC.final_summonerspells  as
      (WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
),

final_datadragon_summonerspells as (
    SELECT
        summonerspell_id,
        cooldown,
        range,
        summoner_level
    FROM source
)

SELECT *
FROM final_datadragon_summonerspells
      );
07:00:27.840635 [debug] [Thread-2  ]: Opening a new connection, currently in state init
07:00:27.842440 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_champions: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_champions"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_champions
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_champions,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_champions as (
    SELECT
        key as champion_id,
        value:blurb as blurb,
        value:info:attack as attack,
        value:info:defense as defense,
        value:info:magic as magic,
        value:info:difficulty as difficulty,
        value:stats:hp as hp,
        value:stats:hpperlevel as hpperlevel,
        value:stats:mp as mp,
        value:stats:mpperlevel as mpperlevel,
        value:stats:movespeed as movespeed,
        value:stats:armor as armor,
        value:stats:armorperlevel as armorperlevel,
        value:stats:spellblock as spellblock,
        value:stats:spellblockperlevel as spellblockperlevel,
        value:stats:attackrange as attackrange,
        value:stats:hpregen as hpregen,
        value:stats:hpregenperlevel as hpregenperlevel,
        value:stats:mpregen as mpregen,
        value:stats:mpregenperlevel as mpregenperlevel,
        value:stats:crit as crit,
        value:stats:critperlevel as critperlevel,
        value:stats:attackdamage as attackdamage,
        value:stats:attackdamageperlevel as attackdamageperlevel,
        value:stats:attackspeedperlevel as attackspeedperlevel,
        value:stats:attackspeed as attackspeed
    FROM source
)

SELECT *
FROM stg_datadragon_champions
  );
07:00:27.851078 [debug] [Thread-3  ]: Opening a new connection, currently in state init
07:00:27.853131 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_items: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_items"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_items
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_ITEMS
WITH tbl_items AS
(
SELECT *
  FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_items,
  LATERAL FLATTEN(input => json_data)
WHERE key = 'data'
),

transform_1 AS (
SELECT
  t.key as key,
  t.value as value
FROM tbl_items,
  LATERAL FLATTEN(input => value, OUTER => TRUE) as t
),

transform_2 AS(
SELECT
  key,
  value:name as name,
  value:description as gold_description,
  value:gold:base as gold_base,
  value:gold:purchasable as gold_purchasable,
  value:gold:total as gold_total,
  value:gold:sell as gold_sell,
  value:stats as stats,
  value:maps as maps
FROM
  transform_1
),

pivot_source AS(
SELECT
  tbl1.key as item_id,
  name,
  gold_description,
  gold_base,
  gold_purchasable,
  gold_total,
  gold_sell,
  tbl2.KEY as stat_name,
  tbl2.value as stat_value,
  tbl3.KEY as map_id,
  tbl3.value as map_exists
FROM transform_2 as tbl1,
  LATERAL FLATTEN(input => stats, OUTER => TRUE) as tbl2,
  LATERAL FLATTEN(input => maps, OUTER => TRUE) as tbl3
),

pivoted_items AS(
  SELECT
    *
  FROM pivot_source
  pivot(max(map_exists) for map_id in ('11','12','21','22'))
  pivot(max(stat_value) for stat_name in (      
    'FlatHPPoolMod',
    'rFlatHPModPerLevel',
    'FlatMPPoolMod',
    'rFlatMPModPerLevel',
    'PercentHPPoolMod',
    'PercentMPPoolMod',
    'FlatHPRegenMod',
    'rFlatHPRegenModPerLevel',
    'PercentHPRegenMod',
    'FlatMPRegenMod',
    'rFlatMPRegenModPerLevel',
    'PercentMPRegenMod',
    'FlatArmorMod',
    'rFlatArmorModPerLevel',
    'PercentArmorMod',
    'rFlatArmorPenetrationMod',
    'rFlatArmorPenetrationModPerLevel',
    'rPercentArmorPenetrationMod',
    'rPercentArmorPenetrationModPerLevel',
    'FlatPhysicalDamageMod',
    'rFlatPhysicalDamageModPerLevel',
    'PercentPhysicalDamageMod',
    'FlatMagicDamageMod',
    'rFlatMagicDamageModPerLevel',
    'PercentMagicDamageMod',
    'FlatMovementSpeedMod',
    'rFlatMovementSpeedModPerLevel',
    'PercentMovementSpeedMod',
    'rPercentMovementSpeedModPerLevel',
    'FlatAttackSpeedMod',
    'PercentAttackSpeedMod',
    'rPercentAttackSpeedModPerLevel',
    'rFlatDodgeMod',
    'rFlatDodgeModPerLevel',
    'PercentDodgeMod',
    'FlatCritChanceMod',
    'rFlatCritChanceModPerLevel',
    'PercentCritChanceMod',
    'FlatCritDamageMod',
    'rFlatCritDamageModPerLevel',
    'PercentCritDamageMod',
    'FlatBlockMod',
    'PercentBlockMod',
    'FlatSpellBlockMod',
    'rFlatSpellBlockModPerLevel',
    'PercentSpellBlockMod',
    'FlatEXPBonus',
    'PercentEXPBonus',
    'rPercentCooldownMod',
    'rPercentCooldownModPerLevel',
    'rFlatTimeDeadMod',
    'rFlatTimeDeadModPerLevel',
    'rPercentTimeDeadMod',
    'rPercentTimeDeadModPerLevel',
    'rFlatGoldPer10Mod',
    'rFlatMagicPenetrationMod',
    'rFlatMagicPenetrationModPerLevel',
    'rPercentMagicPenetrationMod',
    'rPercentMagicPenetrationModPerLevel',
    'FlatEnergyRegenMod',
    'rFlatEnergyRegenModPerLevel',
    'FlatEnergyPoolMod',
    'rFlatEnergyModPerLevel',
    'PercentLifeStealMod',
    'PercentSpellVampMod'
)) as node2 (
    item_id,
    name,
    gold_description,
    gold_base,
    gold_purchasable,
    gold_total,
    gold_sell,
    SummonersRift,
    HowlingAbyss,
    NexusBlitz,
    TeamfightTactics,
    FlatHPPoolMod,
    rFlatHPModPerLevel,
    FlatMPPoolMod,
    rFlatMPModPerLevel,
    PercentHPPoolMod,
    PercentMPPoolMod,
    FlatHPRegenMod,
    rFlatHPRegenModPerLevel,
    PercentHPRegenMod,
    FlatMPRegenMod,
    rFlatMPRegenModPerLevel,
    PercentMPRegenMod,
    FlatArmorMod,
    rFlatArmorModPerLevel,
    PercentArmorMod,
    rFlatArmorPenetrationMod,
    rFlatArmorPenetrationModPerLevel,
    rPercentArmorPenetrationMod,
    rPercentArmorPenetrationModPerLevel,
    FlatPhysicalDamageMod,
    rFlatPhysicalDamageModPerLevel,
    PercentPhysicalDamageMod,
    FlatMagicDamageMod,
    rFlatMagicDamageModPerLevel,
    PercentMagicDamageMod,
    FlatMovementSpeedMod,
    rFlatMovementSpeedModPerLevel,
    PercentMovementSpeedMod,
    rPercentMovementSpeedModPerLevel,
    FlatAttackSpeedMod,
    PercentAttackSpeedMod,
    rPercentAttackSpeedModPerLevel,
    rFlatDodgeMod,
    rFlatDodgeModPerLevel,
    PercentDodgeMod,
    FlatCritChanceMod,
    rFlatCritChanceModPerLevel,
    PercentCritChanceMod,
    FlatCritDamageMod,
    rFlatCritDamageModPerLevel,
    PercentCritDamageMod,
    FlatBlockMod,
    PercentBlockMod,
    FlatSpellBlockMod,
    rFlatSpellBlockModPerLevel,
    PercentSpellBlockMod,
    FlatEXPBonus,
    PercentEXPBonus,
    rPercentCooldownMod,
    rPercentCooldownModPerLevel,
    rFlatTimeDeadMod,
    rFlatTimeDeadModPerLevel,
    rPercentTimeDeadMod,
    rPercentTimeDeadModPerLevel,
    rFlatGoldPer10Mod,
    rFlatMagicPenetrationMod,
    rFlatMagicPenetrationModPerLevel,
    rPercentMagicPenetrationMod,
    rPercentMagicPenetrationModPerLevel,
    FlatEnergyRegenMod,
    rFlatEnergyRegenModPerLevel,
    FlatEnergyPoolMod,
    rFlatEnergyModPerLevel,
    PercentLifeStealMod,
    PercentSpellVampMod
)
)

SELECT * FROM pivoted_items
  );
07:00:27.859399 [debug] [Thread-7  ]: Opening a new connection, currently in state init
07:00:27.861092 [debug] [Thread-8  ]: Opening a new connection, currently in state init
07:00:27.863671 [debug] [Thread-9  ]: Opening a new connection, currently in state init
07:00:27.870986 [debug] [Thread-10 ]: Opening a new connection, currently in state init
07:00:29.955159 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 2.13 seconds
07:00:29.976515 [debug] [Thread-1  ]: finished collecting timing info
07:00:29.977119 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.final_champions: Close
07:00:30.116325 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031d4730>]}
07:00:30.119378 [info ] [Thread-1  ]: 1 of 16 OK created table model PUBLIC.final_champions .......................... [[32mSUCCESS 1[0m in 2.59s]
07:00:30.121306 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.final_champions
07:00:30.122810 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_maps
07:00:30.124519 [info ] [Thread-1  ]: 11 of 16 START view model PUBLIC.stg_maps ...................................... [RUN]
07:00:30.126892 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_maps"
07:00:30.128608 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_maps
07:00:30.129058 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_maps
07:00:30.133625 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_maps"
07:00:30.143104 [debug] [Thread-1  ]: finished collecting timing info
07:00:30.144351 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_maps
07:00:30.150405 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_maps"
07:00:30.155291 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_maps"
07:00:30.156824 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_maps: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_maps"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_maps
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_MAPS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_MAPS"
-- FROM @MY_AZURE_DATADRAGON_MAPS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_maps,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_maps as (
SELECT 
    key as map_id,
    value:MapName as map_name
FROM source
)

SELECT *
FROM stg_datadragon_maps
  );
07:00:30.158726 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:00:30.745263 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 2.88 seconds
07:00:30.747629 [debug] [Thread-9  ]: finished collecting timing info
07:00:30.748132 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_champions: Close
07:00:30.870482 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 3.03 seconds
07:00:30.873456 [debug] [Thread-2  ]: finished collecting timing info
07:00:30.874009 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.final_items: Close
07:00:30.911818 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031df4c0>]}
07:00:30.912689 [info ] [Thread-9  ]: 9 of 16 OK created view model PUBLIC.stg_champions ............................. [[32mSUCCESS 1[0m in 3.38s]
07:00:30.913590 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_champions
07:00:30.914095 [debug] [Thread-9  ]: Began running node model.leagueoflegendsdbt.stg_match_details
07:00:30.914737 [info ] [Thread-9  ]: 12 of 16 START view model PUBLIC.stg_match_details ............................. [RUN]
07:00:30.916091 [debug] [Thread-9  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_details"
07:00:30.916641 [debug] [Thread-9  ]: Began compiling node model.leagueoflegendsdbt.stg_match_details
07:00:30.917177 [debug] [Thread-9  ]: Compiling model.leagueoflegendsdbt.stg_match_details
07:00:30.923617 [debug] [Thread-9  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_details"
07:00:30.927864 [debug] [Thread-9  ]: finished collecting timing info
07:00:30.929650 [debug] [Thread-9  ]: Began executing node model.leagueoflegendsdbt.stg_match_details
07:00:30.938614 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 3.07 seconds
07:00:30.941232 [debug] [Thread-10 ]: finished collecting timing info
07:00:30.941760 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_items: Close
07:00:30.943269 [debug] [Thread-9  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_details"
07:00:30.953692 [debug] [Thread-9  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_details"
07:00:30.954036 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_details"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_details
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchdetails
),


stg_match_details as (
    SELECT 
        matchId as matchId,
        assists as assists,
        baronKills as baronKills,
        bountyLevel as bountyLevel,
        champExperience as champExperience,
        champLevel as champLevel,
        championId as championId,
        championName as championName,
        championTransform as championTransform,
        consumablesPurchased as consumablesPurchased,
        damageDealtToBuildings as damageDealtToBuildings,
        damageDealtToObjectives as damageDealtToObjectives,
        damageDealtToTurrets as damageDealtToTurrets,
        damageSelfMitigated as damageSelfMitigated,
        deaths as deaths,
        detectorWardsPlaced as detectorWardsPlaced,
        doubleKills as doubleKills,
        dragonKills as dragonKills,
        eligibleForProgression as eligibleForProgression,
        firstBloodAssist as firstBloodAssist,
        firstBloodKill as firstBloodKill,
        firstTowerAssist as firstTowerAssist,
        firstTowerKill as firstTowerKill,
        gameEndedInEarlySurrender as gameEndedInEarlySurrender,
        gameEndedInSurrender as gameEndedInSurrender,
        goldEarned as goldEarned,
        goldSpent as goldSpent,
        individualPosition as individualPosition,
        inhibitorKills as inhibitorKills,
        inhibitorTakedowns as inhibitorTakedowns,
        inhibitorsLost as inhibitorsLost,
        item0 as item0_damage,
        item1 as item1_damage,
        item2 as item2_damage,
        item3 as item3_damage,
        item4 as item4_damage,
        item5 as item5_damage,
        item6 as item6_damage,
        itemsPurchased as itemsPurchased,
        killingSprees as killingSprees,
        kills as kills,
        lane as lane,
        largestCriticalStrike as largestCriticalStrike,
        largestKillingSpree as largestKillingSpree,
        largestMultiKill as largestMultiKill,
        longestTimeSpentLiving as longestTimeSpentLiving,
        magicDamageDealt as magicDamageDealt,
        magicDamageDealtToChampions as magicDamageDealtToChampions,
        magicDamageTaken as magicDamageTaken,
        neutralMinionsKilled as neutralMinionsKilled,
        nexusKills as nexusKills,
        nexusLost as nexusLost,
        nexusTakedowns as nexusTakedowns,
        objectivesStolen as objectivesStolen,
        objectivesStolenAssists as objectivesStolenAssists,
        participantId as participantId,
        pentaKills as pentaKills,
        physicalDamageDealt as physicalDamageDealt,
        physicalDamageDealtToChampions as physicalDamageDealtToChampions,
        physicalDamageTaken as physicalDamageTaken,
        profileIcon as profileIcon,
        puuid as puuid,
        quadraKills as quadraKills,
        riotIdName as riotIdName,
        riotIdTagline as riotIdTagline,
        role as role,
        sightWardsBoughtInGame as sightWardsBoughtInGame,
        spell1Casts as spell1Casts,
        spell2Casts as spell2Casts,
        spell3Casts as spell3Casts,
        spell4Casts as spell4Casts,
        summoner1Casts as summoner1Casts,
        summoner1Id as summoner1Id,
        summoner2Casts as summoner2Casts,
        summoner2Id as summoner2Id,
        summonerId as summonerId,
        summonerLevel as summonerLevel,
        summonerName as summonerName,
        teamEarlySurrendered as teamEarlySurrendered,
        teamId as teamId,
        teamPosition as teamPosition,
        timeCCingOthers as timeCCingOthers,
        timePlayed as timePlayed,
        totalDamageDealt as totalDamageDealt,
        totalDamageDealtToChampions as totalDamageDealtToChampions,
        totalDamageShieldedOnTeammates as totalDamageShieldedOnTeammates,
        totalDamageTaken as totalDamageTaken,
        totalHeal as totalHeal,
        totalHealsOnTeammates as totalHealsOnTeammates,
        totalMinionsKilled as totalMinionsKilled,
        totalTimeCCDealt as totalTimeCCDealt,
        totalTimeSpentDead as totalTimeSpentDead,
        totalUnitsHealed as totalUnitsHealed,
        tripleKills as tripleKills,
        trueDamageDealt as trueDamageDealt,
        trueDamageDealtToChampions as trueDamageDealtToChampions,
        trueDamageTaken as trueDamageTaken,
        turretKills as turretKills,
        turretTakedowns as turretTakedowns,
        turretsLost as turretsLost,
        unrealKills as unrealKills,
        visionScore as visionScore,
        visionWardsBoughtInGame as visionWardsBoughtInGame,
        wardsKilled as wardsKilled,
        wardsPlaced as wardsPlaced,
        win as win
    FROM source
)

SELECT *
FROM stg_match_details
  );
07:00:30.954259 [debug] [Thread-9  ]: Opening a new connection, currently in state closed
07:00:30.992124 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031d4bb0>]}
07:00:30.993090 [info ] [Thread-2  ]: 2 of 16 OK created table model PUBLIC.final_items .............................. [[32mSUCCESS 1[0m in 3.47s]
07:00:30.994442 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.final_items
07:00:30.995065 [debug] [Thread-2  ]: Began running node model.leagueoflegendsdbt.stg_match_info
07:00:30.995811 [info ] [Thread-2  ]: 13 of 16 START view model PUBLIC.stg_match_info ................................ [RUN]
07:00:30.997023 [debug] [Thread-2  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_match_info"
07:00:30.997604 [debug] [Thread-2  ]: Began compiling node model.leagueoflegendsdbt.stg_match_info
07:00:30.997997 [debug] [Thread-2  ]: Compiling model.leagueoflegendsdbt.stg_match_info
07:00:31.002539 [debug] [Thread-2  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_match_info"
07:00:31.003413 [debug] [Thread-2  ]: finished collecting timing info
07:00:31.003924 [debug] [Thread-2  ]: Began executing node model.leagueoflegendsdbt.stg_match_info
07:00:31.008674 [debug] [Thread-2  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_match_info"
07:00:31.010078 [debug] [Thread-2  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_match_info"
07:00:31.010329 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_match_info"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_match_info
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_matchinfo
),


stg_match_info as (
    SELECT
        matchId as matchId,
        gameEndTimestamp as gameEndTimestamp,
        gameId as gameId,
        gameMode as gameMode,
        gameName as gameName,
        gameStartTimestamp as gameStartTimestamp,
        gameType as gameType,
        gameVersion as gameVersion,
        mapId as mapId,
        platformId as platformId,
        queueId as queueId,
        tournamentCode as tournamentCode
    FROM source
)

SELECT *
FROM stg_match_info
  );
07:00:31.010548 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
07:00:31.049062 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 0.89 seconds
07:00:31.053011 [debug] [Thread-1  ]: finished collecting timing info
07:00:31.053849 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_maps: Close
07:00:31.069745 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031df6d0>]}
07:00:31.071038 [info ] [Thread-10 ]: 10 of 16 OK created view model PUBLIC.stg_items ................................ [[32mSUCCESS 1[0m in 3.53s]
07:00:31.072422 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_items
07:00:31.073040 [debug] [Thread-10 ]: Began running node model.leagueoflegendsdbt.stg_players
07:00:31.074141 [info ] [Thread-10 ]: 14 of 16 START view model PUBLIC.stg_players ................................... [RUN]
07:00:31.075283 [debug] [Thread-10 ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_players"
07:00:31.075852 [debug] [Thread-10 ]: Began compiling node model.leagueoflegendsdbt.stg_players
07:00:31.076757 [debug] [Thread-10 ]: Compiling model.leagueoflegendsdbt.stg_players
07:00:31.083898 [debug] [Thread-10 ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_players"
07:00:31.084859 [debug] [Thread-10 ]: finished collecting timing info
07:00:31.085478 [debug] [Thread-10 ]: Began executing node model.leagueoflegendsdbt.stg_players
07:00:31.092341 [debug] [Thread-10 ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_players"
07:00:31.094480 [debug] [Thread-10 ]: Using snowflake connection "model.leagueoflegendsdbt.stg_players"
07:00:31.094989 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_players: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_players"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_players
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_players
),

stg_players as ( 
SELECT
    json_data:summonerId as summonerId,
    json_data:summonerName as summoner_name,
    json_data:leagueId as league_id,
    json_data:inactive as inactive,
    json_data:queueType as queue_type,
    json_data:rank as rank,
    json_data:tier as tier,
    json_data:veteran as veteran,
    json_data:leaguePoints as league_points,
    json_data:wins as wins,
    json_data:losses as losses,
    json_data:freshBlood as fresh_blood,
    json_data:hotStreak as hot_streak
FROM source
)

SELECT *
FROM stg_players
  );
07:00:31.100270 [debug] [Thread-10 ]: Opening a new connection, currently in state closed
07:00:31.223811 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031d4160>]}
07:00:31.231275 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 3.37 seconds
07:00:31.238085 [debug] [Thread-3  ]: SQL status: SUCCESS 1 in 3.39 seconds
07:00:31.253362 [info ] [Thread-1  ]: 11 of 16 OK created view model PUBLIC.stg_maps ................................. [[32mSUCCESS 1[0m in 1.10s]
07:00:31.266746 [debug] [Thread-7  ]: finished collecting timing info
07:00:31.293277 [debug] [Thread-3  ]: finished collecting timing info
07:00:31.317874 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_maps
07:00:31.325337 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.final_runes_reforged: Close
07:00:31.341118 [debug] [Thread-3  ]: On model.leagueoflegendsdbt.final_maps: Close
07:00:31.351381 [debug] [Thread-1  ]: Began running node model.leagueoflegendsdbt.stg_runes_reforged
07:00:31.357903 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 3.53 seconds
07:00:31.432111 [info ] [Thread-1  ]: 15 of 16 START view model PUBLIC.stg_runes_reforged ............................ [RUN]
07:00:31.466896 [debug] [Thread-1  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
07:00:31.472688 [debug] [Thread-1  ]: Began compiling node model.leagueoflegendsdbt.stg_runes_reforged
07:00:31.472191 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
07:00:31.483541 [debug] [Thread-1  ]: Compiling model.leagueoflegendsdbt.stg_runes_reforged
07:00:31.501340 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp
07:00:31.511245 [debug] [Thread-1  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
07:00:31.528731 [debug] [Thread-1  ]: finished collecting timing info
07:00:31.534965 [debug] [Thread-1  ]: Began executing node model.leagueoflegendsdbt.stg_runes_reforged
07:00:31.554742 [debug] [Thread-1  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_runes_reforged"
07:00:31.559009 [debug] [Thread-8  ]: SQL status: SUCCESS 1 in 3.7 seconds
07:00:31.561353 [debug] [Thread-8  ]: finished collecting timing info
07:00:31.561951 [debug] [Thread-8  ]: On model.leagueoflegendsdbt.final_summonerspells: Close
07:00:31.566178 [debug] [Thread-1  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_runes_reforged"
07:00:31.567634 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_runes_reforged: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_runes_reforged"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_runes_reforged
  
   as (
    WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_runes_reforged,
    LATERAL FLATTEN(input => json_data)
),

tbl_runes AS
(
SELECT 
    *
FROM
    STAGING_DATADRAGON_RUNES_REFORGED,
    LATERAL FLATTEN(input => json_data)
),
tbl AS
(
SELECT
    Seq as id,
    value as value_extract
FROM tbl_runes
    WHERE key = 'slots'
)

SELECT
    ID as rune_id,
    f1.value:key as rune_name
FROM tbl,
    LATERAL FLATTEN(input => value_extract) f,
    LATERAL FLATTEN(input => value:runes) f1
  );
07:00:31.571387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:00:31.580730 [debug] [Thread-6  ]: SQL status: SUCCESS 1 in 3.75 seconds
07:00:31.585618 [debug] [Thread-6  ]: finished collecting timing info
07:00:31.587935 [debug] [Thread-6  ]: On model.leagueoflegendsdbt.final_players: Close
07:00:31.590037 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031dff40>]}
07:00:31.592382 [info ] [Thread-7  ]: 7 of 16 OK created table model PUBLIC.final_runes_reforged ..................... [[32mSUCCESS 1[0m in 4.06s]
07:00:31.597414 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.final_runes_reforged
07:00:31.598341 [debug] [Thread-7  ]: Began running node model.leagueoflegendsdbt.stg_summonerspells
07:00:31.599810 [info ] [Thread-7  ]: 16 of 16 START view model PUBLIC.stg_summonerspells ............................ [RUN]
07:00:31.601567 [debug] [Thread-7  ]: Acquiring new snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
07:00:31.603728 [debug] [Thread-7  ]: Began compiling node model.leagueoflegendsdbt.stg_summonerspells
07:00:31.604419 [debug] [Thread-7  ]: Compiling model.leagueoflegendsdbt.stg_summonerspells
07:00:31.609567 [debug] [Thread-7  ]: Writing injected SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
07:00:31.617049 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 3.79 seconds
07:00:31.642632 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
07:00:31.657066 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp
07:00:31.658917 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.14 seconds
07:00:31.659392 [debug] [Thread-7  ]: finished collecting timing info
07:00:31.685254 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
07:00:31.705210 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031d4700>]}
07:00:31.740275 [debug] [Thread-7  ]: Began executing node model.leagueoflegendsdbt.stg_summonerspells
07:00:31.751256 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031df2b0>]}
07:00:31.757309 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info
07:00:31.761680 [info ] [Thread-3  ]: 3 of 16 OK created table model PUBLIC.final_maps ............................... [[32mSUCCESS 1[0m in 4.18s]
07:00:31.768521 [debug] [Thread-7  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.stg_summonerspells"
07:00:31.770269 [info ] [Thread-8  ]: 8 of 16 OK created table model PUBLIC.final_summonerspells ..................... [[32mSUCCESS 1[0m in 4.22s]
07:00:31.777686 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031d4df0>]}
07:00:31.789106 [debug] [Thread-3  ]: Finished running node model.leagueoflegendsdbt.final_maps
07:00:31.793528 [debug] [Thread-8  ]: Finished running node model.leagueoflegendsdbt.final_summonerspells
07:00:31.794900 [debug] [Thread-7  ]: Using snowflake connection "model.leagueoflegendsdbt.stg_summonerspells"
07:00:31.795925 [info ] [Thread-6  ]: 6 of 16 OK created incremental model PUBLIC.final_players ...................... [[32mSUCCESS 1[0m in 4.24s]
07:00:31.800658 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.stg_summonerspells"} */

  create or replace  view LEAGUE_OF_LEGENDSDB.PUBLIC.stg_summonerspells
  
   as (
    -- CREATE OR REPLACE TABLE STAGING_DATADRAGON_SUMMONERSPELLS
-- (
--     json_data variant
-- );

-- COPY INTO "STAGING_DATADRAGON_SUMMONERSPELLS"
-- FROM @MY_AZURE_DATADRAGON_SUMMONERSPELLS_STAGE
-- file_format = datadragon_fileformat;

WITH source AS(
    SELECT *
    FROM LEAGUE_OF_LEGENDSDB.PUBLIC.staging_datadragon_summonerspells,
    LATERAL FLATTEN(input => json_data)
),

stg_datadragon_summonerspells as (
SELECT 
    key as summonerspell_id,
    value:cooldown[0] as cooldown,
    value:range[0] as range,
    value:summonerLevel as summoner_level
FROM source
)

SELECT *
FROM stg_datadragon_summonerspells
  );
07:00:31.803977 [debug] [Thread-6  ]: Finished running node model.leagueoflegendsdbt.final_players
07:00:31.804931 [debug] [Thread-7  ]: Opening a new connection, currently in state closed
07:00:31.829060 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.16 seconds
07:00:31.844338 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
07:00:31.845632 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details
07:00:31.871268 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.1 seconds
07:00:31.884056 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
07:00:31.885019 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_INFO"
07:00:31.969633 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.12 seconds
07:00:32.027789 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
07:00:32.034489 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */

    describe table "LEAGUE_OF_LEGENDSDB"."PUBLIC"."FINAL_MATCH_DETAILS"
07:00:32.105451 [debug] [Thread-5  ]: SQL status: SUCCESS 12 in 0.22 seconds
07:00:32.175689 [debug] [Thread-4  ]: SQL status: SUCCESS 106 in 0.14 seconds
07:00:32.268956 [debug] [Thread-5  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_info"
07:00:32.300879 [debug] [Thread-4  ]: Writing runtime SQL for node "model.leagueoflegendsdbt.final_match_details"
07:00:32.315260 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
07:00:32.338862 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_info"} */
begin;
07:00:32.368910 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
07:00:32.370740 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "leagueoflegendsdbt", "target_name": "dev", "node_id": "model.leagueoflegendsdbt.final_match_details"} */
begin;
07:00:32.503682 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.15 seconds
07:00:32.504659 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
07:00:32.506654 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_info__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","GAMEENDTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMEENDTIMESTAMP","GAMEID" = DBT_INTERNAL_SOURCE."GAMEID","GAMEMODE" = DBT_INTERNAL_SOURCE."GAMEMODE","GAMENAME" = DBT_INTERNAL_SOURCE."GAMENAME","GAMESTARTTIMESTAMP" = DBT_INTERNAL_SOURCE."GAMESTARTTIMESTAMP","GAMETYPE" = DBT_INTERNAL_SOURCE."GAMETYPE","GAMEVERSION" = DBT_INTERNAL_SOURCE."GAMEVERSION","MAPID" = DBT_INTERNAL_SOURCE."MAPID","PLATFORMID" = DBT_INTERNAL_SOURCE."PLATFORMID","QUEUEID" = DBT_INTERNAL_SOURCE."QUEUEID","TOURNAMENTCODE" = DBT_INTERNAL_SOURCE."TOURNAMENTCODE"
    

    when not matched then insert
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")
    values
        ("MATCHID", "GAMEENDTIMESTAMP", "GAMEID", "GAMEMODE", "GAMENAME", "GAMESTARTTIMESTAMP", "GAMETYPE", "GAMEVERSION", "MAPID", "PLATFORMID", "QUEUEID", "TOURNAMENTCODE")

;
07:00:32.542540 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.17 seconds
07:00:32.543962 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
07:00:32.545366 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: merge into LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details as DBT_INTERNAL_DEST
        using LEAGUE_OF_LEGENDSDB.PUBLIC.final_match_details__dbt_tmp as DBT_INTERNAL_SOURCE
        on 
                DBT_INTERNAL_SOURCE.matchId = DBT_INTERNAL_DEST.matchId
            

    
    when matched then update set
        "MATCHID" = DBT_INTERNAL_SOURCE."MATCHID","ASSISTS" = DBT_INTERNAL_SOURCE."ASSISTS","BARONKILLS" = DBT_INTERNAL_SOURCE."BARONKILLS","BOUNTYLEVEL" = DBT_INTERNAL_SOURCE."BOUNTYLEVEL","CHAMPEXPERIENCE" = DBT_INTERNAL_SOURCE."CHAMPEXPERIENCE","CHAMPLEVEL" = DBT_INTERNAL_SOURCE."CHAMPLEVEL","CHAMPIONID" = DBT_INTERNAL_SOURCE."CHAMPIONID","CHAMPIONNAME" = DBT_INTERNAL_SOURCE."CHAMPIONNAME","CHAMPIONTRANSFORM" = DBT_INTERNAL_SOURCE."CHAMPIONTRANSFORM","CONSUMABLESPURCHASED" = DBT_INTERNAL_SOURCE."CONSUMABLESPURCHASED","DAMAGEDEALTTOBUILDINGS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOBUILDINGS","DAMAGEDEALTTOOBJECTIVES" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOOBJECTIVES","DAMAGEDEALTTOTURRETS" = DBT_INTERNAL_SOURCE."DAMAGEDEALTTOTURRETS","DAMAGESELFMITIGATED" = DBT_INTERNAL_SOURCE."DAMAGESELFMITIGATED","DEATHS" = DBT_INTERNAL_SOURCE."DEATHS","DETECTORWARDSPLACED" = DBT_INTERNAL_SOURCE."DETECTORWARDSPLACED","DOUBLEKILLS" = DBT_INTERNAL_SOURCE."DOUBLEKILLS","DRAGONKILLS" = DBT_INTERNAL_SOURCE."DRAGONKILLS","ELIGIBLEFORPROGRESSION" = DBT_INTERNAL_SOURCE."ELIGIBLEFORPROGRESSION","FIRSTBLOODASSIST" = DBT_INTERNAL_SOURCE."FIRSTBLOODASSIST","FIRSTBLOODKILL" = DBT_INTERNAL_SOURCE."FIRSTBLOODKILL","FIRSTTOWERASSIST" = DBT_INTERNAL_SOURCE."FIRSTTOWERASSIST","FIRSTTOWERKILL" = DBT_INTERNAL_SOURCE."FIRSTTOWERKILL","GAMEENDEDINEARLYSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINEARLYSURRENDER","GAMEENDEDINSURRENDER" = DBT_INTERNAL_SOURCE."GAMEENDEDINSURRENDER","GOLDEARNED" = DBT_INTERNAL_SOURCE."GOLDEARNED","GOLDSPENT" = DBT_INTERNAL_SOURCE."GOLDSPENT","INDIVIDUALPOSITION" = DBT_INTERNAL_SOURCE."INDIVIDUALPOSITION","INHIBITORKILLS" = DBT_INTERNAL_SOURCE."INHIBITORKILLS","INHIBITORTAKEDOWNS" = DBT_INTERNAL_SOURCE."INHIBITORTAKEDOWNS","INHIBITORSLOST" = DBT_INTERNAL_SOURCE."INHIBITORSLOST","ITEM0_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM0_DAMAGE","ITEM1_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM1_DAMAGE","ITEM2_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM2_DAMAGE","ITEM3_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM3_DAMAGE","ITEM4_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM4_DAMAGE","ITEM5_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM5_DAMAGE","ITEM6_DAMAGE" = DBT_INTERNAL_SOURCE."ITEM6_DAMAGE","ITEMSPURCHASED" = DBT_INTERNAL_SOURCE."ITEMSPURCHASED","KILLINGSPREES" = DBT_INTERNAL_SOURCE."KILLINGSPREES","KILLS" = DBT_INTERNAL_SOURCE."KILLS","LANE" = DBT_INTERNAL_SOURCE."LANE","LARGESTCRITICALSTRIKE" = DBT_INTERNAL_SOURCE."LARGESTCRITICALSTRIKE","LARGESTKILLINGSPREE" = DBT_INTERNAL_SOURCE."LARGESTKILLINGSPREE","LARGESTMULTIKILL" = DBT_INTERNAL_SOURCE."LARGESTMULTIKILL","LONGESTTIMESPENTLIVING" = DBT_INTERNAL_SOURCE."LONGESTTIMESPENTLIVING","MAGICDAMAGEDEALT" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALT","MAGICDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."MAGICDAMAGEDEALTTOCHAMPIONS","MAGICDAMAGETAKEN" = DBT_INTERNAL_SOURCE."MAGICDAMAGETAKEN","NEUTRALMINIONSKILLED" = DBT_INTERNAL_SOURCE."NEUTRALMINIONSKILLED","NEXUSKILLS" = DBT_INTERNAL_SOURCE."NEXUSKILLS","NEXUSLOST" = DBT_INTERNAL_SOURCE."NEXUSLOST","NEXUSTAKEDOWNS" = DBT_INTERNAL_SOURCE."NEXUSTAKEDOWNS","OBJECTIVESSTOLEN" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLEN","OBJECTIVESSTOLENASSISTS" = DBT_INTERNAL_SOURCE."OBJECTIVESSTOLENASSISTS","PARTICIPANTID" = DBT_INTERNAL_SOURCE."PARTICIPANTID","PENTAKILLS" = DBT_INTERNAL_SOURCE."PENTAKILLS","PHYSICALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALT","PHYSICALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGEDEALTTOCHAMPIONS","PHYSICALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."PHYSICALDAMAGETAKEN","PROFILEICON" = DBT_INTERNAL_SOURCE."PROFILEICON","PUUID" = DBT_INTERNAL_SOURCE."PUUID","QUADRAKILLS" = DBT_INTERNAL_SOURCE."QUADRAKILLS","RIOTIDNAME" = DBT_INTERNAL_SOURCE."RIOTIDNAME","RIOTIDTAGLINE" = DBT_INTERNAL_SOURCE."RIOTIDTAGLINE","ROLE" = DBT_INTERNAL_SOURCE."ROLE","SIGHTWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."SIGHTWARDSBOUGHTINGAME","SPELL1CASTS" = DBT_INTERNAL_SOURCE."SPELL1CASTS","SPELL2CASTS" = DBT_INTERNAL_SOURCE."SPELL2CASTS","SPELL3CASTS" = DBT_INTERNAL_SOURCE."SPELL3CASTS","SPELL4CASTS" = DBT_INTERNAL_SOURCE."SPELL4CASTS","SUMMONER1CASTS" = DBT_INTERNAL_SOURCE."SUMMONER1CASTS","SUMMONER1ID" = DBT_INTERNAL_SOURCE."SUMMONER1ID","SUMMONER2CASTS" = DBT_INTERNAL_SOURCE."SUMMONER2CASTS","SUMMONER2ID" = DBT_INTERNAL_SOURCE."SUMMONER2ID","SUMMONERID" = DBT_INTERNAL_SOURCE."SUMMONERID","SUMMONERLEVEL" = DBT_INTERNAL_SOURCE."SUMMONERLEVEL","SUMMONERNAME" = DBT_INTERNAL_SOURCE."SUMMONERNAME","TEAMEARLYSURRENDERED" = DBT_INTERNAL_SOURCE."TEAMEARLYSURRENDERED","TEAMID" = DBT_INTERNAL_SOURCE."TEAMID","TEAMPOSITION" = DBT_INTERNAL_SOURCE."TEAMPOSITION","TIMECCINGOTHERS" = DBT_INTERNAL_SOURCE."TIMECCINGOTHERS","TIMEPLAYED" = DBT_INTERNAL_SOURCE."TIMEPLAYED","TOTALDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALT","TOTALDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TOTALDAMAGEDEALTTOCHAMPIONS","TOTALDAMAGESHIELDEDONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALDAMAGESHIELDEDONTEAMMATES","TOTALDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TOTALDAMAGETAKEN","TOTALHEAL" = DBT_INTERNAL_SOURCE."TOTALHEAL","TOTALHEALSONTEAMMATES" = DBT_INTERNAL_SOURCE."TOTALHEALSONTEAMMATES","TOTALMINIONSKILLED" = DBT_INTERNAL_SOURCE."TOTALMINIONSKILLED","TOTALTIMECCDEALT" = DBT_INTERNAL_SOURCE."TOTALTIMECCDEALT","TOTALTIMESPENTDEAD" = DBT_INTERNAL_SOURCE."TOTALTIMESPENTDEAD","TOTALUNITSHEALED" = DBT_INTERNAL_SOURCE."TOTALUNITSHEALED","TRIPLEKILLS" = DBT_INTERNAL_SOURCE."TRIPLEKILLS","TRUEDAMAGEDEALT" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALT","TRUEDAMAGEDEALTTOCHAMPIONS" = DBT_INTERNAL_SOURCE."TRUEDAMAGEDEALTTOCHAMPIONS","TRUEDAMAGETAKEN" = DBT_INTERNAL_SOURCE."TRUEDAMAGETAKEN","TURRETKILLS" = DBT_INTERNAL_SOURCE."TURRETKILLS","TURRETTAKEDOWNS" = DBT_INTERNAL_SOURCE."TURRETTAKEDOWNS","TURRETSLOST" = DBT_INTERNAL_SOURCE."TURRETSLOST","UNREALKILLS" = DBT_INTERNAL_SOURCE."UNREALKILLS","VISIONSCORE" = DBT_INTERNAL_SOURCE."VISIONSCORE","VISIONWARDSBOUGHTINGAME" = DBT_INTERNAL_SOURCE."VISIONWARDSBOUGHTINGAME","WARDSKILLED" = DBT_INTERNAL_SOURCE."WARDSKILLED","WARDSPLACED" = DBT_INTERNAL_SOURCE."WARDSPLACED","WIN" = DBT_INTERNAL_SOURCE."WIN"
    

    when not matched then insert
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")
    values
        ("MATCHID", "ASSISTS", "BARONKILLS", "BOUNTYLEVEL", "CHAMPEXPERIENCE", "CHAMPLEVEL", "CHAMPIONID", "CHAMPIONNAME", "CHAMPIONTRANSFORM", "CONSUMABLESPURCHASED", "DAMAGEDEALTTOBUILDINGS", "DAMAGEDEALTTOOBJECTIVES", "DAMAGEDEALTTOTURRETS", "DAMAGESELFMITIGATED", "DEATHS", "DETECTORWARDSPLACED", "DOUBLEKILLS", "DRAGONKILLS", "ELIGIBLEFORPROGRESSION", "FIRSTBLOODASSIST", "FIRSTBLOODKILL", "FIRSTTOWERASSIST", "FIRSTTOWERKILL", "GAMEENDEDINEARLYSURRENDER", "GAMEENDEDINSURRENDER", "GOLDEARNED", "GOLDSPENT", "INDIVIDUALPOSITION", "INHIBITORKILLS", "INHIBITORTAKEDOWNS", "INHIBITORSLOST", "ITEM0_DAMAGE", "ITEM1_DAMAGE", "ITEM2_DAMAGE", "ITEM3_DAMAGE", "ITEM4_DAMAGE", "ITEM5_DAMAGE", "ITEM6_DAMAGE", "ITEMSPURCHASED", "KILLINGSPREES", "KILLS", "LANE", "LARGESTCRITICALSTRIKE", "LARGESTKILLINGSPREE", "LARGESTMULTIKILL", "LONGESTTIMESPENTLIVING", "MAGICDAMAGEDEALT", "MAGICDAMAGEDEALTTOCHAMPIONS", "MAGICDAMAGETAKEN", "NEUTRALMINIONSKILLED", "NEXUSKILLS", "NEXUSLOST", "NEXUSTAKEDOWNS", "OBJECTIVESSTOLEN", "OBJECTIVESSTOLENASSISTS", "PARTICIPANTID", "PENTAKILLS", "PHYSICALDAMAGEDEALT", "PHYSICALDAMAGEDEALTTOCHAMPIONS", "PHYSICALDAMAGETAKEN", "PROFILEICON", "PUUID", "QUADRAKILLS", "RIOTIDNAME", "RIOTIDTAGLINE", "ROLE", "SIGHTWARDSBOUGHTINGAME", "SPELL1CASTS", "SPELL2CASTS", "SPELL3CASTS", "SPELL4CASTS", "SUMMONER1CASTS", "SUMMONER1ID", "SUMMONER2CASTS", "SUMMONER2ID", "SUMMONERID", "SUMMONERLEVEL", "SUMMONERNAME", "TEAMEARLYSURRENDERED", "TEAMID", "TEAMPOSITION", "TIMECCINGOTHERS", "TIMEPLAYED", "TOTALDAMAGEDEALT", "TOTALDAMAGEDEALTTOCHAMPIONS", "TOTALDAMAGESHIELDEDONTEAMMATES", "TOTALDAMAGETAKEN", "TOTALHEAL", "TOTALHEALSONTEAMMATES", "TOTALMINIONSKILLED", "TOTALTIMECCDEALT", "TOTALTIMESPENTDEAD", "TOTALUNITSHEALED", "TRIPLEKILLS", "TRUEDAMAGEDEALT", "TRUEDAMAGEDEALTTOCHAMPIONS", "TRUEDAMAGETAKEN", "TURRETKILLS", "TURRETTAKEDOWNS", "TURRETSLOST", "UNREALKILLS", "VISIONSCORE", "VISIONWARDSBOUGHTINGAME", "WARDSKILLED", "WARDSPLACED", "WIN")

;
07:00:32.829551 [debug] [Thread-5  ]: SQL status: SUCCESS 0 in 0.32 seconds
07:00:32.829977 [debug] [Thread-5  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_info"
07:00:32.831039 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: commit;
07:00:33.088044 [debug] [Thread-5  ]: SQL status: SUCCESS 1 in 0.26 seconds
07:00:33.096683 [debug] [Thread-5  ]: finished collecting timing info
07:00:33.099156 [debug] [Thread-5  ]: On model.leagueoflegendsdbt.final_match_info: Close
07:00:33.247069 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031dfa00>]}
07:00:33.247821 [info ] [Thread-5  ]: 5 of 16 OK created incremental model PUBLIC.final_match_info ................... [[32mSUCCESS 1[0m in 5.71s]
07:00:33.248893 [debug] [Thread-5  ]: Finished running node model.leagueoflegendsdbt.final_match_info
07:00:33.257602 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 2.16 seconds
07:00:33.259505 [debug] [Thread-10 ]: finished collecting timing info
07:00:33.259811 [debug] [Thread-10 ]: On model.leagueoflegendsdbt.stg_players: Close
07:00:33.346363 [debug] [Thread-2  ]: SQL status: SUCCESS 1 in 2.34 seconds
07:00:33.348464 [debug] [Thread-2  ]: finished collecting timing info
07:00:33.348871 [debug] [Thread-2  ]: On model.leagueoflegendsdbt.stg_match_info: Close
07:00:33.350375 [debug] [Thread-1  ]: SQL status: SUCCESS 1 in 1.78 seconds
07:00:33.354892 [debug] [Thread-1  ]: finished collecting timing info
07:00:33.355899 [debug] [Thread-1  ]: On model.leagueoflegendsdbt.stg_runes_reforged: Close
07:00:33.403478 [debug] [Thread-7  ]: SQL status: SUCCESS 1 in 1.6 seconds
07:00:33.405668 [debug] [Thread-7  ]: finished collecting timing info
07:00:33.406663 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5cfa60cd0>]}
07:00:33.406985 [debug] [Thread-7  ]: On model.leagueoflegendsdbt.stg_summonerspells: Close
07:00:33.407618 [info ] [Thread-10 ]: 14 of 16 OK created view model PUBLIC.stg_players .............................. [[32mSUCCESS 1[0m in 2.33s]
07:00:33.411694 [debug] [Thread-10 ]: Finished running node model.leagueoflegendsdbt.stg_players
07:00:33.454189 [debug] [Thread-9  ]: SQL status: SUCCESS 1 in 2.5 seconds
07:00:33.456705 [debug] [Thread-9  ]: finished collecting timing info
07:00:33.457447 [debug] [Thread-9  ]: On model.leagueoflegendsdbt.stg_match_details: Close
07:00:33.463687 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031dbf70>]}
07:00:33.464451 [info ] [Thread-2  ]: 13 of 16 OK created view model PUBLIC.stg_match_info ........................... [[32mSUCCESS 1[0m in 2.47s]
07:00:33.465327 [debug] [Thread-2  ]: Finished running node model.leagueoflegendsdbt.stg_match_info
07:00:33.492859 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031fb550>]}
07:00:33.493872 [info ] [Thread-1  ]: 15 of 16 OK created view model PUBLIC.stg_runes_reforged ....................... [[32mSUCCESS 1[0m in 2.03s]
07:00:33.494876 [debug] [Thread-1  ]: Finished running node model.leagueoflegendsdbt.stg_runes_reforged
07:00:33.522104 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5cfa118e0>]}
07:00:33.523023 [info ] [Thread-7  ]: 16 of 16 OK created view model PUBLIC.stg_summonerspells ....................... [[32mSUCCESS 1[0m in 1.92s]
07:00:33.524073 [debug] [Thread-7  ]: Finished running node model.leagueoflegendsdbt.stg_summonerspells
07:00:33.584228 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe603291f40>]}
07:00:33.584797 [info ] [Thread-9  ]: 12 of 16 OK created view model PUBLIC.stg_match_details ........................ [[32mSUCCESS 1[0m in 2.67s]
07:00:33.586052 [debug] [Thread-9  ]: Finished running node model.leagueoflegendsdbt.stg_match_details
07:00:33.912467 [debug] [Thread-4  ]: SQL status: SUCCESS 0 in 1.37 seconds
07:00:33.912840 [debug] [Thread-4  ]: Using snowflake connection "model.leagueoflegendsdbt.final_match_details"
07:00:33.913105 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: commit;
07:00:34.103849 [debug] [Thread-4  ]: SQL status: SUCCESS 1 in 0.19 seconds
07:00:34.106527 [debug] [Thread-4  ]: finished collecting timing info
07:00:34.106894 [debug] [Thread-4  ]: On model.leagueoflegendsdbt.final_match_details: Close
07:00:34.243394 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b0252419-b6b0-429a-a57c-7b690921c721', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe6031dfa30>]}
07:00:34.243995 [info ] [Thread-4  ]: 4 of 16 OK created incremental model PUBLIC.final_match_details ................ [[32mSUCCESS 1[0m in 6.71s]
07:00:34.244618 [debug] [Thread-4  ]: Finished running node model.leagueoflegendsdbt.final_match_details
07:00:34.247893 [debug] [MainThread]: Acquiring new snowflake connection "master"
07:00:34.248605 [info ] [MainThread]: 
07:00:34.249511 [info ] [MainThread]: Finished running 5 table models, 8 view models, 3 incremental models in 8.59s.
07:00:34.250149 [debug] [MainThread]: Connection 'master' was properly closed.
07:00:34.250440 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_runes_reforged' was properly closed.
07:00:34.250700 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_info' was properly closed.
07:00:34.250921 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_maps' was properly closed.
07:00:34.251206 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_details' was properly closed.
07:00:34.251403 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_match_info' was properly closed.
07:00:34.251638 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_players' was properly closed.
07:00:34.251823 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_summonerspells' was properly closed.
07:00:34.252047 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.final_summonerspells' was properly closed.
07:00:34.252230 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_match_details' was properly closed.
07:00:34.252409 [debug] [MainThread]: Connection 'model.leagueoflegendsdbt.stg_players' was properly closed.
07:00:34.268261 [info ] [MainThread]: 
07:00:34.268769 [info ] [MainThread]: [32mCompleted successfully[0m
07:00:34.269338 [info ] [MainThread]: 
07:00:34.269928 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=0 SKIP=0 TOTAL=16
07:00:34.270792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe603f52400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d4060fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5cfa50ca0>]}
